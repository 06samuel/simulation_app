<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenValley Estates - Manajemen Properti Impian Anda</title>
    <meta name="description"
        content="Temukan apartemen, rumah, dan properti impian Anda di GreenValley Estates. Platform manajemen properti modern dengan daftar terkini dan antarmuka yang memukau.">
    <meta name="keywords"
        content="apartemen, rumah, properti, sewa, jual, greenvalley, real estate, manajemen properti, modern, fancy">
    <!-- Menggunakan emoji sebagai favicon sederhana, tanpa SVG file eksternal -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè°</text></svg>">

    <!-- Bootstrap Icons (Online Gratis) -->
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Google Fonts (Poppins & Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <style>
        /* --- CSS RESET & DASAR --- */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            /* Untuk rendering font yang lebih halus di WebKit */
            -moz-osx-font-smoothing: grayscale;
            /* Untuk rendering font yang lebih halus di Firefox */
        }

        :root {
            /* Palet Warna Utama (Terinspirasi Alam & Modern) */
            --primary-color: #2ECC71;
            /* Hijau Segar */
            --primary-dark: #27AE60;
            --primary-light: #A9DFBF;

            --secondary-color: #3498DB;
            /* Biru Langit */
            --secondary-dark: #2980B9;
            --secondary-light: #AED6F1;

            --accent-color: #F39C12;
            /* Oranye Hangat */
            --accent-dark: #D35400;
            --accent-light: #FAD7A0;

            /* Warna Netral & Teks */
            --bg-light: #F4F6F8;
            --bg-dark: #1C2833;
            --card-bg-light: #FFFFFF;
            --card-bg-dark: #283747;
            --text-light: #212F3D;
            --text-dark: #ECF0F1;
            --text-muted-light: #566573;
            --text-muted-dark: #AAB7B8;
            --border-light: #D5DBDB;
            --border-dark: #424949;
            --input-bg-light: #FFFFFF;
            --input-bg-dark: #34495E;

            /* Tipografi */
            --font-display: 'Poppins', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            --font-sans: 'Inter', 'Helvetica Neue', Helvetica, Arial, sans-serif;

            /* Bayangan (Shadows) */
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.07);
            --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.1);

            /* Sudut & Spasi */
            --rounded-sm: 0.25rem;
            --rounded-md: 0.5rem;
            --rounded-lg: 0.75rem;
            --rounded-full: 9999px;

            --space-xs: 0.25rem;
            /* 4px */
            --space-sm: 0.5rem;
            /* 8px */
            --space-md: 1rem;
            /* 16px */
            --space-lg: 1.5rem;
            /* 24px */
            --space-xl: 2.5rem;
            /* 40px */

            /* Transisi */
            --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);

            /* Z-Index */
            --z-dropdown: 1000;
            --z-sticky: 1020;
            --z-modal-backdrop: 1040;
            --z-modal: 1050;
            --z-tooltip: 1070;

            /* Default ke tema terang */
            --current-bg: var(--bg-light);
            --current-card-bg: var(--card-bg-light);
            --current-text: var(--text-light);
            --current-text-muted: var(--text-muted-light);
            --current-border: var(--border-light);
            --current-input-bg: var(--input-bg-light);
        }

        html.dark {
            --current-bg: var(--bg-dark);
            --current-card-bg: var(--card-bg-dark);
            --current-text: var(--text-dark);
            --current-text-muted: var(--text-muted-dark);
            --current-border: var(--border-dark);
            --current-input-bg: var(--input-bg-dark);
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
            /* Basis untuk REM */
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--current-bg);
            color: var(--current-text);
            line-height: 1.65;
            min-height: 100vh;
            display: flex;
            /* Untuk footer menempel di bawah */
            flex-direction: column;
            transition: background-color var(--transition-normal), color var(--transition-normal);
        }

        /* --- TIPOGRAFI ELEGAN --- */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: var(--font-display);
            font-weight: 700;
            color: var(--primary-color);
            line-height: 1.3;
            margin-bottom: var(--space-md);
        }

        h1 {
            font-size: clamp(2rem, 5vw, 3rem);
        }

        /* Responsif */
        h2 {
            font-size: clamp(1.5rem, 4vw, 2.25rem);
        }

        h3 {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
        }

        p {
            margin-bottom: var(--space-md);
            font-size: 1rem;
        }

        a {
            color: var(--secondary-color);
            text-decoration: none;
            transition: var(--transition-fast);
        }

        a:hover,
        a:focus {
            color: var(--secondary-dark);
            text-decoration: underline;
            outline: 2px solid var(--secondary-light);
            /* Aksesibilitas: fokus terlihat */
            outline-offset: 2px;
        }

        strong {
            font-weight: 600;
        }

        small {
            font-size: 0.875em;
        }

        /* --- STRUKTUR UTAMA APLIKASI --- */
        .app-container {
            flex: 1;
            /* Konten utama mengisi ruang yang tersedia */
            display: flex;
            flex-direction: column;
        }

        .page-content-wrapper {
            max-width: 1320px;
            /* Sedikit lebih lebar untuk desain modern */
            width: 90%;
            margin: 0 auto;
            padding: var(--space-xl) 0;
            /* Padding atas-bawah lebih besar */
            flex: 1;
        }

        /* --- NAVBAR / HEADER --- */
        #navbar-container {
            position: sticky;
            top: 0;
            background-color: var(--current-card-bg);
            box-shadow: var(--shadow-md);
            z-index: var(--z-sticky);
            transition: background-color var(--transition-normal);
            border-bottom: 1px solid var(--current-border);
        }

        .navbar-content {
            max-width: 1320px;
            width: 90%;
            margin: 0 auto;
            padding: var(--space-sm) 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 70px;
            /* Tinggi navbar yang lebih baik */
        }

        .navbar-brand {
            font-family: var(--font-display);
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .navbar-brand i {
            font-size: 1.5rem;
            color: var(--primary-dark);
        }

        .navbar-brand:hover,
        .navbar-brand:focus {
            color: var(--primary-dark);
            text-decoration: none;
        }

        .navbar-nav {
            display: flex;
            gap: var(--space-sm);
            /* Spasi antar link navigasi */
        }

        .nav-link {
            padding: var(--space-sm) var(--space-md);
            color: var(--current-text-muted);
            font-weight: 500;
            border-radius: var(--rounded-md);
            transition: color var(--transition-fast), background-color var(--transition-fast);
            display: inline-flex;
            /* Untuk ikon dan teks sejajar */
            align-items: center;
            gap: var(--space-xs);
        }

        .nav-link i {
            font-size: 1.1em;
            /* Ukuran ikon relatif terhadap teks */
        }

        .nav-link:hover,
        .nav-link:focus {
            color: var(--primary-color);
            background-color: rgba(var(--primary-rgb, 46, 204, 113), 0.1);
            /* Warna primer dengan alpha */
            text-decoration: none;
        }

        .nav-link.active {
            color: var(--primary-dark);
            font-weight: 700;
            background-color: rgba(var(--primary-rgb, 46, 204, 113), 0.15);
        }

        .navbar-actions {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        /* --- FOOTER --- */
        #footer-container {
            background-color: var(--current-card-bg);
            color: var(--current-text-muted);
            padding: var(--space-lg) 0;
            text-align: center;
            font-size: 0.9rem;
            border-top: 1px solid var(--current-border);
            margin-top: var(--space-xl);
            /* Beri jarak dari konten di atas */
            transition: background-color var(--transition-normal), color var(--transition-normal);
        }

        .footer-content {
            max-width: 1320px;
            width: 90%;
            margin: 0 auto;
        }

        .footer-content p {
            margin-bottom: var(--space-xs);
        }

        .footer-content a {
            color: var(--secondary-color);
            font-weight: 500;
        }

        .footer-content a:hover {
            color: var(--secondary-dark);
        }

        /* --- KOMPONEN UI UMUM --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
            padding: calc(var(--space-sm) + 2px) var(--space-lg);
            /* Padding lebih proporsional */
            font-family: var(--font-sans);
            font-weight: 600;
            font-size: 0.95rem;
            border-radius: var(--rounded-md);
            cursor: pointer;
            transition: var(--transition-fast);
            border: 1px solid transparent;
            text-align: center;
            white-space: nowrap;
            /* Mencegah teks tombol terlipat */
        }

        .btn:focus {
            outline: 2px solid var(--primary-light);
            outline-offset: 2px;
        }

        .btn i {
            font-size: 1.2em;
            /* Ikon sedikit lebih besar dari teks tombol */
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }

        .btn-primary:hover,
        .btn-primary:focus {
            background-color: var(--primary-dark);
            border-color: var(--primary-dark);
            color: #fff;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(var(--primary-rgb, 46, 204, 113), 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: #fff;
            border-color: var(--secondary-color);
        }

        .btn-secondary:hover,
        .btn-secondary:focus {
            background-color: var(--secondary-dark);
            border-color: var(--secondary-dark);
            color: #fff;
            text-decoration: none;
            box-shadow: 0 2px 8px rgba(var(--secondary-rgb, 52, 152, 219), 0.3);
        }

        .btn-outline-primary {
            background-color: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover,
        .btn-outline-primary:focus {
            background-color: var(--primary-color);
            color: #fff;
            text-decoration: none;
        }

        .btn-icon {
            /* Tombol khusus ikon */
            padding: var(--space-sm);
            font-size: 1.25rem;
            line-height: 1;
            /* Penting untuk ikon */
            background-color: transparent;
            color: var(--current-text-muted);
            border: none;
        }

        .btn-icon:hover,
        .btn-icon:focus {
            color: var(--primary-color);
            background-color: rgba(var(--primary-rgb, 46, 204, 113), 0.1);
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-label {
            display: block;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--current-text);
            margin-bottom: var(--space-sm);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--current-border);
            border-radius: var(--rounded-md);
            background-color: var(--current-input-bg);
            color: var(--current-text);
            font-family: var(--font-sans);
            font-size: 1rem;
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-rgb, 46, 204, 113), 0.2);
            outline: none;
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        .form-check {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .form-check-input {
            width: auto;
            accent-color: var(--primary-color);
            /* Warna centang */
        }

        .card {
            background-color: var(--current-card-bg);
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            /* Untuk gambar di dalam card */
            transition: background-color var(--transition-normal), box-shadow var(--transition-normal), transform var(--transition-normal);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid var(--current-border);
        }

        .card-body {
            padding: var(--space-lg);
        }

        .card-footer {
            padding: var(--space-md) var(--space-lg);
            border-top: 1px solid var(--current-border);
            background-color: rgba(0, 0, 0, 0.02);
            /* Sedikit beda warna */
        }

        html.dark .card-footer {
            background-color: rgba(255, 255, 255, 0.02);
        }

        /* --- KARTU PROPERTI --- */
        .property-card {
            /* Menggunakan kelas .card sebagai basis */
            display: flex;
            flex-direction: column;
        }

        .property-card-image-wrapper {
            position: relative;
            width: 100%;
            padding-top: 66.66%;
            /* Rasio aspek 3:2 untuk gambar */
            overflow: hidden;
            background-color: var(--current-border);
            /* Placeholder jika gambar lambat loading */
        }

        .property-card-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* Gambar mengisi tanpa distorsi */
            transition: transform 0.4s ease-out;
        }

        .property-card:hover .property-card-image {
            transform: scale(1.05);
            /* Efek zoom halus pada hover */
        }

        .property-card-badge {
            position: absolute;
            top: var(--space-md);
            left: var(--space-md);
            background-color: rgba(var(--primary-rgb, 46, 204, 113), 0.9);
            color: #fff;
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--rounded-sm);
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .property-card-body {
            padding: var(--space-lg);
            flex-grow: 1;
            /* Memastikan body mengisi ruang jika konten berbeda tinggi */
            display: flex;
            flex-direction: column;
        }

        .property-card-title {
            font-size: 1.35rem;
            font-weight: 600;
            margin-bottom: var(--space-xs);
            color: var(--current-text);
            /* Judul kartu tidak selalu hijau */
        }

        .property-card-location {
            color: var(--current-text-muted);
            font-size: 0.9rem;
            margin-bottom: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .property-card-features {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
            color: var(--current-text-muted);
            font-size: 0.9rem;
        }

        .property-card-features span {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .property-card-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-top: auto;
            /* Mendorong harga ke bawah jika ada ruang */
            margin-bottom: var(--space-md);
        }

        .property-card-price small {
            font-size: 0.8rem;
            font-weight: 400;
            color: var(--current-text-muted);
        }

        .property-card-actions {
            border-top: 1px solid var(--current-border);
            padding: var(--space-md) var(--space-lg);
            display: flex;
            justify-content: flex-end;
            /* Tombol ke kanan */
        }

        /* --- DAFTAR PROPERTI (GRID SYSTEM) --- */
        .property-list-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            /* Kolom responsif */
            gap: var(--space-lg);
            margin-top: var(--space-xl);
        }

        @media (min-width: 768px) {

            /* Untuk layar sedang */
            .property-list-grid {
                grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            }
        }

        @media (min-width: 1200px) {

            /* Untuk layar besar */
            .property-list-grid {
                grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            }
        }

        /* --- FORM FILTER --- */
        .filter-form-container {
            background-color: var(--current-card-bg);
            padding: var(--space-lg);
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-sm);
            margin-bottom: var(--space-xl);
            transition: background-color var(--transition-normal);
        }

        .filter-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            align-items: end;
            /* Tombol filter sejajar dengan bottom input */
        }

        .filter-form .form-group {
            margin-bottom: 0;
            /* Hapus margin bawah default karena sudah diatur oleh gap grid */
        }

        /* --- HALAMAN DETAIL PROPERTI --- */
        .property-detail-grid {
            display: grid;
            grid-template-columns: 1fr;
            /* Default 1 kolom untuk mobile */
            gap: var(--space-xl);
        }

        @media (min-width: 992px) {

            /* 2 kolom untuk layar lebih besar */
            .property-detail-grid {
                grid-template-columns: 2fr 1fr;
                /* Gambar lebih besar, info lebih kecil */
            }
        }

        .property-detail-image-gallery {
            /* Placeholder untuk galeri, bisa dikembangkan lebih lanjut */
            width: 100%;
            max-height: 500px;
            /* Batasi tinggi gambar utama */
            border-radius: var(--rounded-lg);
            overflow: hidden;
            background-color: var(--current-border);
        }

        .property-detail-image-gallery img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .property-detail-info .price {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: var(--space-sm);
        }

        .property-detail-info .location {
            font-size: 1.1rem;
            color: var(--current-text-muted);
            margin-bottom: var(--space-lg);
        }

        .property-detail-info .features-list {
            list-style: none;
            padding: 0;
            margin-bottom: var(--space-lg);
        }

        .property-detail-info .features-list li {
            padding: var(--space-sm) 0;
            border-bottom: 1px dashed var(--current-border);
            display: flex;
            justify-content: space-between;
        }

        .property-detail-info .features-list li:last-child {
            border-bottom: none;
        }

        .property-detail-info .features-list li strong {
            color: var(--current-text);
        }

        /* --- HALAMAN KELOLA PROPERTI --- */
        .manage-property-form .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-md);
        }

        @media (min-width: 768px) {
            .manage-property-form .form-grid {
                grid-template-columns: 1fr 1fr;
                /* 2 kolom untuk form */
            }

            .manage-property-form .form-group-full {
                grid-column: 1 / -1;
                /* Span full width */
            }
        }

        .manage-property-list table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--space-lg);
        }

        .manage-property-list th,
        .manage-property-list td {
            padding: var(--space-sm) var(--space-md);
            text-align: left;
            border-bottom: 1px solid var(--current-border);
        }

        .manage-property-list th {
            background-color: rgba(0, 0, 0, 0.03);
            font-weight: 600;
        }

        html.dark .manage-property-list th {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .manage-property-list .actions a {
            margin-right: var(--space-sm);
            font-size: 1.2rem;
            /* Ukuran ikon aksi */
        }

        .manage-property-list .actions a.delete-btn {
            color: #E74C3C;
            /* Merah untuk hapus */
        }

        .manage-property-list .actions a.delete-btn:hover {
            color: #C0392B;
        }

        /* --- ANIMASI & UTILITAS --- */
        .fade-in {
            animation: fadeInAnimation 0.5s ease-in-out;
        }

        @keyframes fadeInAnimation {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading-indicator {
            text-align: center;
            padding: var(--space-xl);
            font-size: 1.2rem;
            color: var(--current-text-muted);
        }

        .loading-indicator i {
            margin-right: var(--space-sm);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .empty-state {
            text-align: center;
            padding: var(--space-xl);
            border: 2px dashed var(--current-border);
            border-radius: var(--rounded-lg);
            background-color: rgba(0, 0, 0, 0.01);
        }

        html.dark .empty-state {
            background-color: rgba(255, 255, 255, 0.01);
        }

        .empty-state i {
            font-size: 3rem;
            color: var(--current-text-muted);
            margin-bottom: var(--space-md);
        }

        .empty-state p {
            font-size: 1.1rem;
            color: var(--current-text-muted);
        }

        /* --- MODAL (SANGAT DASAR) --- */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: var(--z-modal-backdrop);
            display: none;
            /* Default tersembunyi */
            align-items: center;
            justify-content: center;
        }

        .modal-backdrop.active {
            display: flex;
        }

        .modal-content {
            background-color: var(--current-card-bg);
            padding: var(--space-xl);
            border-radius: var(--rounded-lg);
            box-shadow: var(--shadow-lg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalOpen 0.3s ease-out;
        }

        @keyframes modalOpen {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }

            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--current-border);
        }

        .modal-header h3 {
            margin-bottom: 0;
        }

        .modal-close-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: var(--current-text-muted);
            cursor: pointer;
            padding: 0;
            /* Hapus padding agar lebih rapat */
        }

        .modal-close-btn:hover {
            color: var(--current-text);
        }

        /* Responsivitas Tambahan */
        @media (max-width: 768px) {
            .navbar-content {
                flex-direction: column;
                align-items: flex-start;
                gap: var(--space-md);
                padding: var(--space-md) 0;
            }

            .navbar-nav {
                flex-direction: column;
                width: 100%;
                align-items: flex-start;
            }

            .nav-link {
                width: 100%;
                justify-content: flex-start;
            }

            .navbar-actions {
                width: 100%;
                justify-content: flex-start;
            }

            .filter-form {
                grid-template-columns: 1fr;
                /* Semua filter menjadi 1 kolom di mobile */
            }
        }
    </style>
</head>

<body>
    <div id="app-container" class="app-container">
        <!-- Navbar akan dirender di sini oleh JavaScript -->
        <header id="navbar-container" role="banner"></header>

        <!-- Konten halaman utama akan dirender di sini -->
        <main id="page-content-container" role="main">
            <!-- Wrapper untuk padding konten halaman -->
            <div class="page-content-wrapper">
                <!-- Konten dinamis dari JavaScript -->
            </div>
        </main>

        <!-- Footer akan dirender di sini oleh JavaScript -->
        <footer id="footer-container" role="contentinfo"></footer>

        <!-- Modal (Struktur Dasar, Konten Dinamis) -->
        <div id="app-modal-backdrop" class="modal-backdrop">
            <div id="app-modal-content" class="modal-content" role="dialog" aria-modal="true"
                aria-labelledby="modal-title">
                <!-- Konten modal akan dirender di sini -->
            </div>
        </div>
    </div>

    <script type="text/javascript">
        // "use strict"; // Mengaktifkan mode ketat untuk penulisan kode yang lebih aman

        // --- KONSTANTA APLIKASI ---
        const APP_NAME = 'GreenValley Estates';
        const APP_SLOGAN = 'Wujudkan Properti Impian Anda Bersama Kami';
        const NAV_LINKS = [
            { id: 'dashboard', name: 'Dasbor', path: '#/', icon: 'bi-speedometer2', pageTitle: `Dasbor - ${APP_NAME}` },
            { id: 'properties', name: 'Daftar Properti', path: '#/properti', icon: 'bi-buildings', pageTitle: `Properti Tersedia - ${APP_NAME}` },
            { id: 'manage', name: 'Kelola Properti', path: '#/kelola', icon: 'bi-pencil-square', pageTitle: `Kelola Properti - ${APP_NAME}` },
            // Tambahkan link lain jika perlu, misal: { id: 'about', name: 'Tentang Kami', path: '#/tentang', icon: 'bi-info-circle' }
        ];
        const PROPERTY_TYPES = ['Semua', 'Apartemen', 'Rumah', 'Villa', 'Tanah'];
        const BEDROOM_OPTIONS = ['Semua', '1', '2', '3', '4', '5+'];

        // --- DATA AWAL (MOCK DATA) ---
        // Sebaiknya data ini diambil dari API di aplikasi nyata
        const MOCK_PROPERTIES = [
            { id: 'p1', nama: 'Apartemen Sky Tower Bliss', lokasi: 'Pusat Kota Jakarta', harga: 2500000000, tipe: 'Apartemen', kamarTidur: 2, kamarMandi: 1, luasBangunan: 75, luasTanah: 0, imageUrl: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60', deskripsi: 'Apartemen mewah dengan pemandangan kota yang menakjubkan, fasilitas lengkap, dan lokasi strategis.', fasilitas: ['Kolam Renang', 'Gym', 'Keamanan 24 Jam', 'Parkir Basement'], tahunDibangun: 2020, status: 'Dijual' },
            { id: 'p2', nama: 'Rumah Klasik Oakwood Residence', lokasi: 'Bandung Utara', harga: 4500000000, tipe: 'Rumah', kamarTidur: 4, kamarMandi: 3, luasBangunan: 300, luasTanah: 500, imageUrl: 'https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8bHV4dXJ5JTIwaG91c2V8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60', deskripsi: 'Rumah bergaya klasik modern dengan halaman luas, udara sejuk, dan desain interior yang elegan.', fasilitas: ['Taman Luas', 'Garasi 2 Mobil', 'Dapur Modern', 'Ruang Keluarga Besar'], tahunDibangun: 2018, status: 'Dijual' },
            { id: 'p3', nama: 'Villa Pantai Horizon View', lokasi: 'Seminyak, Bali', harga: 7800000000, tipe: 'Villa', kamarTidur: 3, kamarMandi: 3, luasBangunan: 250, luasTanah: 400, imageUrl: 'https://images.unsplash.com/photo-1613977257363-707ba9348227?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8dmlsbGF8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60', deskripsi: 'Villa eksklusif dengan pemandangan langsung ke pantai, kolam renang pribadi, dan arsitektur tropis.', fasilitas: ['Kolam Renang Pribadi', 'Akses Pantai Langsung', 'Gazebo', 'Pelayan Pribadi'], tahunDibangun: 2021, status: 'Disewakan' },
            { id: 'p4', nama: 'Apartemen Urban Nest Studio', lokasi: 'Surabaya Pusat', harga: 850000000, tipe: 'Apartemen', kamarTidur: 1, kamarMandi: 1, luasBangunan: 40, luasTanah: 0, imageUrl: 'https://images.unsplash.com/photo-1522708323590-d24DBb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8c3R1ZGlvJTIwYXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=800&q=60', deskripsi: 'Studio apartemen modern dan fungsional, cocok untuk profesional muda atau investasi.', fasilitas: ['Co-working Space', 'Smart Home System', 'Rooftop Garden'], tahunDibangun: 2022, status: 'Dijual' },
            { id: 'p5', nama: 'Tanah Kavling Green Hills', lokasi: 'Bogor Highland', harga: 500000000, tipe: 'Tanah', kamarTidur: 0, kamarMandi: 0, luasBangunan: 0, luasTanah: 1000, imageUrl: 'https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8bGFuZHxlbnwwfHwwfHx8MA%3D&auto=format&fit=crop&w=800&q=60', deskripsi: 'Tanah kavling strategis dengan pemandangan pegunungan, cocok untuk dibangun villa atau investasi jangka panjang.', fasilitas: ['Akses Jalan Aspal', 'Dekat Fasilitas Umum'], tahunDibangun: 0, status: 'Dijual' },
        ];

        // --- STATE APLIKASI (SINGLE SOURCE OF TRUTH) ---
        const appState = {
            theme: localStorage.getItem('theme') || 'light', // 'light' atau 'dark'
            currentPage: '', // Akan diisi dari hash URL saat init
            properties: [], // Diisi dari MOCK_PROPERTIES atau API
            filteredProperties: [],
            filters: {
                searchTerm: '',
                propertyType: 'Semua',
                bedrooms: 'Semua',
                minPrice: '',
                maxPrice: '',
            },
            selectedPropertyId: null, // Untuk halaman detail atau edit
            isLoading: false,
            error: null, // Menyimpan pesan error
            isModalOpen: false,
            modalContent: { // Untuk konten modal
                title: '',
                body: '',
                footer: ''
            }
        };

        // --- ELEMEN DOM UTAMA (di-cache untuk performa) ---
        let navbarContainer, pageContentContainer, footerContainer, appModalBackdrop, appModalContent;

        // --- FUNGSI UTILITAS ---
        function formatCurrency(number, currency = 'IDR') {
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: currency, minimumFractionDigits: 0 }).format(number);
        }

        function sanitizeHTML(str) { // Fungsi sanitasi dasar untuk mencegah XSS sederhana
            const temp = document.createElement('div');
            temp.textContent = str;
            return temp.innerHTML;
        }

        function debounce(func, delay) { // Mencegah fungsi dieksekusi terlalu sering
            let timeout;
            return function (...args) {
                const context = this;
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(context, args), delay);
            };
        }

        function generateId() { // Untuk properti baru
            return 'p' + Date.now().toString(36) + Math.random().toString(36).substr(2, 5);
        }

        // --- MANAJEMEN TEMA ---
        function applyTheme() {
            document.documentElement.classList.toggle('dark', appState.theme === 'dark');
            localStorage.setItem('theme', appState.theme);
            // Update warna primary-rgb dan secondary-rgb untuk style inline jika diperlukan
            const rootStyle = document.documentElement.style;
            if (appState.theme === 'dark') {
                rootStyle.setProperty('--primary-rgb', '46, 204, 113'); // Sesuaikan dengan var(--primary-color)
                rootStyle.setProperty('--secondary-rgb', '52, 152, 219'); // Sesuaikan dengan var(--secondary-color)
            } else {
                rootStyle.setProperty('--primary-rgb', '46, 204, 113');
                rootStyle.setProperty('--secondary-rgb', '52, 152, 219');
            }
        }

        function toggleTheme() {
            appState.theme = appState.theme === 'light' ? 'dark' : 'light';
            applyTheme();
            // Re-render navbar untuk update ikon tema
            renderNavbar();
        }

        // --- RENDER KOMPONEN UI ---
        // Setiap fungsi render idealnya hanya mengembalikan string HTML atau memanipulasi DOM yang spesifik

        function renderNavbar() {
            if (!navbarContainer) return;
            const currentPath = location.hash || '#/';
            navbarContainer.innerHTML = `
            <div class="navbar-content">
                <a href="#/" class="navbar-brand" aria-label="${APP_NAME} - Beranda">
                    <i class="bi bi-house-heart-fill"></i>
                    <span>${APP_NAME}</span>
                </a>
                <nav class="navbar-nav" aria-label="Navigasi Utama">
                    ${NAV_LINKS.map(link => `
                        <a href="${link.path}" class="nav-link ${currentPath === link.path ? 'active' : ''}" 
                           aria-current="${currentPath === link.path ? 'page' : 'false'}">
                            <i class="${link.icon}"></i> ${link.name}
                        </a>
                    `).join('')}
                </nav>
                <div class="navbar-actions">
                    <button id="theme-toggle-btn" class="btn btn-icon" aria-label="Ganti ke mode ${appState.theme === 'light' ? 'gelap' : 'terang'}">
                        <i class="${appState.theme === 'light' ? 'bi-moon-stars-fill' : 'bi-sun-fill'}"></i>
                    </button>
                    <!-- Bisa tambahkan tombol login/profil di sini -->
                </div>
            </div>
        `;
            const themeToggleBtn = navbarContainer.querySelector('#theme-toggle-btn');
            if (themeToggleBtn) {
                themeToggleBtn.removeEventListener('click', toggleTheme); // Hapus listener lama jika ada
                themeToggleBtn.addEventListener('click', toggleTheme);
            }
        }

        function renderFooter() {
            if (!footerContainer) return;
            footerContainer.innerHTML = `
            <div class="footer-content">
                <p>¬© ${new Date().getFullYear()} ${APP_NAME}. Hak Cipta Dilindungi.</p>
                <p>Didesain dengan <i class="bi bi-heart-fill" style="color: var(--accent-color);"></i> di Indonesia. ${APP_SLOGAN}</p>
                <p><a href="#/privasi">Kebijakan Privasi</a> | <a href="#/syarat-ketentuan">Syarat & Ketentuan</a></p>
            </div>
        `;
        }

        // Fungsi untuk menampilkan indikator loading
        function renderLoadingIndicator(container) {
            container.innerHTML = `
            <div class="loading-indicator">
                <i class="bi bi-arrow-repeat"></i> Memuat data...
            </div>
        `;
        }

        // Fungsi untuk menampilkan pesan error
        function renderErrorState(container, message) {
            container.innerHTML = `
            <div class="empty-state">
                <i class="bi bi-exclamation-triangle-fill" style="color: var(--accent-dark);"></i>
                <h2>Terjadi Kesalahan</h2>
                <p>${sanitizeHTML(message)}</p>
                <button class="btn btn-primary" onclick="location.reload()">Coba Lagi</button>
            </div>
        `;
        }

        // Fungsi untuk menampilkan state kosong (misal: tidak ada properti ditemukan)
        function renderEmptyState(container, message, iconClass = 'bi-search-heart') {
            container.innerHTML = `
            <div class="empty-state fade-in">
                <i class="${iconClass}"></i>
                <p>${sanitizeHTML(message)}</p>
            </div>
        `;
        }

        // --- FUNGSI RENDER HALAMAN ---

        function renderDashboardPage() {
            const stats = {
                totalProperties: appState.properties.length,
                forSale: appState.properties.filter(p => p.status === 'Dijual').length,
                forRent: appState.properties.filter(p => p.status === 'Disewakan').length,
            };

            return `
            <div class="fade-in">
                <header class="page-header" style="text-align: center; margin-bottom: var(--space-xl);">
                    <h1>Selamat Datang di ${APP_NAME}</h1>
                    <p style="font-size: 1.2rem; color: var(--current-text-muted);">${APP_SLOGAN}</p>
                </header>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-lg); margin-bottom: var(--space-xl);">
                    <div class="card">
                        <div class="card-body" style="text-align: center;">
                            <i class="bi bi-buildings" style="font-size: 3rem; color: var(--primary-color); margin-bottom: var(--space-sm);"></i>
                            <h3 style="font-size: 2rem; margin-bottom: var(--space-xs);">${stats.totalProperties}</h3>
                            <p style="color: var(--current-text-muted); margin-bottom:0;">Total Properti Terdaftar</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body" style="text-align: center;">
                            <i class="bi bi-tags-fill" style="font-size: 3rem; color: var(--secondary-color); margin-bottom: var(--space-sm);"></i>
                            <h3 style="font-size: 2rem; margin-bottom: var(--space-xs);">${stats.forSale}</h3>
                            <p style="color: var(--current-text-muted); margin-bottom:0;">Properti Dijual</p>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-body" style="text-align: center;">
                            <i class="bi bi-key-fill" style="font-size: 3rem; color: var(--accent-color); margin-bottom: var(--space-sm);"></i>
                            <h3 style="font-size: 2rem; margin-bottom: var(--space-xs);">${stats.forRent}</h3>
                            <p style="color: var(--current-text-muted); margin-bottom:0;">Properti Disewakan</p>
                        </div>
                    </div>
                </div>

                <h2>Properti Unggulan</h2>
                <p>Lihat beberapa properti terbaik yang kami tawarkan.</p>
                ${renderPropertyList(appState.properties.slice(0, 3))} <!-- Tampilkan 3 properti pertama sebagai unggulan -->

                <div style="text-align: center; margin-top: var(--space-xl);">
                    <a href="#/properti" class="btn btn-primary btn-lg">
                        <i class="bi bi-arrow-right-circle-fill"></i> Lihat Semua Properti
                    </a>
                </div>
            </div>
        `;
        }

        function renderPropertiesPage() {
            // Fungsi ini akan dipanggil setiap kali filter berubah juga
            return `
            <div class="fade-in">
                <header class="page-header" style="margin-bottom: var(--space-xl);">
                    <h1>Daftar Properti Kami</h1>
                    <p style="color: var(--current-text-muted);">Temukan properti yang sesuai dengan kebutuhan dan impian Anda.</p>
                </header>
                ${renderFilterForm()}
                <div id="property-list-container">
                    ${renderPropertyList(appState.filteredProperties)}
                </div>
            </div>
        `;
        }

        function renderFilterForm() {
            return `
            <div class="filter-form-container">
                <form id="filter-form" class="filter-form">
                    <div class="form-group">
                        <label for="searchTerm" class="form-label">Kata Kunci</label>
                        <input type="text" id="searchTerm" class="form-input" placeholder="cth: Nama, Lokasi" value="${sanitizeHTML(appState.filters.searchTerm)}">
                    </div>
                    <div class="form-group">
                        <label for="propertyType" class="form-label">Tipe Properti</label>
                        <select id="propertyType" class="form-select">
                            ${PROPERTY_TYPES.map(type => `<option value="${type}" ${appState.filters.propertyType === type ? 'selected' : ''}>${type}</option>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="bedrooms" class="form-label">Jumlah Kamar</label>
                        <select id="bedrooms" class="form-select">
                            ${BEDROOM_OPTIONS.map(opt => `<option value="${opt}" ${appState.filters.bedrooms === opt ? 'selected' : ''}>${opt}</option>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="minPrice" class="form-label">Harga Min</label>
                        <input type="number" id="minPrice" class="form-input" placeholder="cth: 500000000" value="${sanitizeHTML(appState.filters.minPrice)}">
                    </div>
                    <div class="form-group">
                        <label for="maxPrice" class="form-label">Harga Max</label>
                        <input type="number" id="maxPrice" class="form-input" placeholder="cth: 2000000000" value="${sanitizeHTML(appState.filters.maxPrice)}">
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1; display: flex; gap: var(--space-md); justify-content: flex-end;">
                        <button type="reset" id="reset-filter-btn" class="btn btn-outline-primary">
                            <i class="bi bi-arrow-counterclockwise"></i> Reset Filter
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-funnel-fill"></i> Terapkan Filter
                        </button>
                    </div>
                </form>
            </div>
        `;
        }

        function renderPropertyCard(property) {
            return `
            <article class="card property-card" aria-labelledby="property-title-${property.id}">
                <div class="property-card-image-wrapper">
                    <img src="${sanitizeHTML(property.imageUrl)}" alt="Tampilan ${sanitizeHTML(property.nama)}" class="property-card-image" loading="lazy">
                    ${property.status ? `<span class="property-card-badge">${sanitizeHTML(property.status)}</span>` : ''}
                </div>
                <div class="property-card-body">
                    <h3 id="property-title-${property.id}" class="property-card-title">
                        <a href="#/properti/${property.id}" class="stretched-link">${sanitizeHTML(property.nama)}</a>
                    </h3>
                    <p class="property-card-location">
                        <i class="bi bi-geo-alt-fill"></i> ${sanitizeHTML(property.lokasi)}
                    </p>
                    <div class="property-card-features">
                        ${property.tipe !== 'Tanah' ? `
                        <span><i class="bi bi-door-open-fill"></i> ${property.kamarTidur} KT</span>
                        <span><i class="bi bi-droplet-half"></i> ${property.kamarMandi} KM</span>
                        ` : ''}
                        <span><i class="bi bi-arrows-fullscreen"></i> ${property.luasBangunan > 0 ? `${property.luasBangunan} m¬≤ Bgn` : `${property.luasTanah} m¬≤ Tnh`}</span>
                    </div>
                    <p class="property-card-price">
                        ${formatCurrency(property.harga)}
                        ${property.status === 'Disewakan' ? '<small>/bulan</small>' : ''}
                    </p>
                </div>
                <div class="property-card-actions">
                     <a href="#/properti/${property.id}" class="btn btn-secondary">
                        <i class="bi bi-eye-fill"></i> Lihat Detail
                    </a>
                </div>
            </article>
        `;
        }

        function renderPropertyList(propertiesToRender) {
            if (appState.isLoading) {
                return `<div class="loading-indicator"><i class="bi bi-arrow-repeat"></i> Memuat properti...</div>`;
            }
            if (!propertiesToRender || propertiesToRender.length === 0) {
                return renderEmptyState({ innerHTML: '' }, 'Tidak ada properti yang cocok dengan kriteria Anda saat ini.', 'bi-house-slash-fill');
            }
            return `
            <div class="property-list-grid">
                ${propertiesToRender.map(p => renderPropertyCard(p)).join('')}
            </div>
        `;
        }

        function renderPropertyDetailPage(propertyId) {
            const property = appState.properties.find(p => p.id === propertyId);
            if (!property) {
                return renderNotFoundPage('Properti tidak ditemukan.');
            }

            // Update judul halaman dokumen
            document.title = `${property.nama} - ${APP_NAME}`;

            return `
            <div class="property-detail-page fade-in">
                <nav aria-label="breadcrumb" style="margin-bottom: var(--space-md);">
                    <ol style="display: flex; list-style: none; padding: 0; gap: var(--space-xs); font-size: 0.9rem; color: var(--current-text-muted);">
                        <li><a href="#/">Dasbor</a></li>
                        <li><span aria-hidden="true">/</span> <a href="#/properti">Properti</a></li>
                        <li aria-current="page"><span aria-hidden="true">/</span> ${sanitizeHTML(property.nama)}</li>
                    </ol>
                </nav>

                <div class="property-detail-grid">
                    <div class="property-detail-image-gallery card">
                        <img src="${sanitizeHTML(property.imageUrl)}" alt="Gambar utama ${sanitizeHTML(property.nama)}">
                        <!-- TODO: Tambahkan galeri gambar kecil jika ada lebih dari 1 gambar -->
                    </div>
                    <div class="property-detail-info card">
                        <div class="card-body">
                            <h1>${sanitizeHTML(property.nama)}</h1>
                            <p class="location"><i class="bi bi-geo-alt-fill"></i> ${sanitizeHTML(property.lokasi)}</p>
                            <p class="price">${formatCurrency(property.harga)} ${property.status === 'Disewakan' ? '<small>/bulan</small>' : ''}</p>
                            
                            <h3 style="margin-top: var(--space-lg);">Deskripsi Properti</h3>
                            <p>${sanitizeHTML(property.deskripsi)}</p>

                            <h3 style="margin-top: var(--space-lg);">Detail Utama</h3>
                            <ul class="features-list">
                                <li><strong>Tipe:</strong> <span>${sanitizeHTML(property.tipe)}</span></li>
                                ${property.tipe !== 'Tanah' ? `
                                <li><strong>Kamar Tidur:</strong> <span>${property.kamarTidur}</span></li>
                                <li><strong>Kamar Mandi:</strong> <span>${property.kamarMandi}</span></li>
                                ` : ''}
                                <li><strong>Luas Bangunan:</strong> <span>${property.luasBangunan > 0 ? `${property.luasBangunan} m¬≤` : '-'}</span></li>
                                <li><strong>Luas Tanah:</strong> <span>${property.luasTanah > 0 ? `${property.luasTanah} m¬≤` : '-'}</span></li>
                                <li><strong>Tahun Dibangun:</strong> <span>${property.tahunDibangun > 0 ? property.tahunDibangun : '-'}</span></li>
                                <li><strong>Status:</strong> <span style="font-weight:bold; color: ${property.status === 'Dijual' ? 'var(--primary-color)' : 'var(--accent-color)'};">${sanitizeHTML(property.status)}</span></li>
                            </ul>

                            ${property.fasilitas && property.fasilitas.length > 0 ? `
                            <h3 style="margin-top: var(--space-lg);">Fasilitas</h3>
                            <ul style="list-style: none; padding: 0; display: flex; flex-wrap: wrap; gap: var(--space-sm);">
                                ${property.fasilitas.map(f => `<li style="background-color: rgba(var(--primary-rgb, 46, 204, 113),0.1); padding: var(--space-xs) var(--space-sm); border-radius: var(--rounded-sm); font-size: 0.9rem;"><i class="bi bi-check-circle-fill" style="color:var(--primary-color);"></i> ${sanitizeHTML(f)}</li>`).join('')}
                            </ul>
                            ` : ''}
                            
                            <div style="margin-top: var(--space-xl); display:flex; gap: var(--space-md);">
                                <button class="btn btn-primary btn-lg"><i class="bi bi-telephone-fill"></i> Hubungi Agen</button>
                                <button class="btn btn-secondary btn-lg"><i class="bi bi-heart"></i> Simpan ke Favorit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        }

        function renderManagePropertyPage() {
            const isEditing = appState.selectedPropertyId !== null;
            const propertyToEdit = isEditing ? appState.properties.find(p => p.id === appState.selectedPropertyId) : {};

            // Data untuk form, jika null atau undefined, berikan string kosong
            const formData = {
                id: propertyToEdit?.id || '',
                nama: propertyToEdit?.nama || '',
                lokasi: propertyToEdit?.lokasi || '',
                harga: propertyToEdit?.harga || '',
                tipe: propertyToEdit?.tipe || PROPERTY_TYPES[1], // Default ke 'Apartemen' jika baru
                kamarTidur: propertyToEdit?.kamarTidur || '',
                kamarMandi: propertyToEdit?.kamarMandi || '',
                luasBangunan: propertyToEdit?.luasBangunan || '',
                luasTanah: propertyToEdit?.luasTanah || '',
                imageUrl: propertyToEdit?.imageUrl || '',
                deskripsi: propertyToEdit?.deskripsi || '',
                status: propertyToEdit?.status || 'Dijual',
                fasilitas: propertyToEdit?.fasilitas?.join(', ') || '',
                tahunDibangun: propertyToEdit?.tahunDibangun || ''
            };


            return `
            <div class="fade-in">
                <h1>${isEditing ? 'Edit Properti' : 'Tambah Properti Baru'}</h1>
                <p>${isEditing ? `Mengedit detail untuk ${sanitizeHTML(formData.nama)}.` : 'Isi formulir di bawah untuk menambahkan properti baru ke daftar.'}</p>
                
                <form id="manage-property-form" class="manage-property-form card">
                    <div class="card-body">
                        <input type="hidden" id="propertyId" value="${sanitizeHTML(formData.id)}">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="nama" class="form-label">Nama Properti</label>
                                <input type="text" id="nama" class="form-input" required value="${sanitizeHTML(formData.nama)}">
                            </div>
                            <div class="form-group">
                                <label for="lokasi" class="form-label">Lokasi</label>
                                <input type="text" id="lokasi" class="form-input" required value="${sanitizeHTML(formData.lokasi)}">
                            </div>
                            <div class="form-group">
                                <label for="harga" class="form-label">Harga (IDR)</label>
                                <input type="number" id="harga" class="form-input" required value="${sanitizeHTML(String(formData.harga))}">
                            </div>
                            <div class="form-group">
                                <label for="tipe" class="form-label">Tipe Properti</label>
                                <select id="tipe" class="form-select" required>
                                    ${PROPERTY_TYPES.filter(t => t !== 'Semua').map(type => `<option value="${type}" ${formData.tipe === type ? 'selected' : ''}>${type}</option>`).join('')}
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="kamarTidur" class="form-label">Kamar Tidur</label>
                                <input type="number" id="kamarTidur" class="form-input" min="0" value="${sanitizeHTML(String(formData.kamarTidur))}">
                            </div>
                            <div class="form-group">
                                <label for="kamarMandi" class="form-label">Kamar Mandi</label>
                                <input type="number" id="kamarMandi" class="form-input" min="0" value="${sanitizeHTML(String(formData.kamarMandi))}">
                            </div>
                            <div class="form-group">
                                <label for="luasBangunan" class="form-label">Luas Bangunan (m¬≤)</label>
                                <input type="number" id="luasBangunan" class="form-input" min="0" value="${sanitizeHTML(String(formData.luasBangunan))}">
                            </div>
                            <div class="form-group">
                                <label for="luasTanah" class="form-label">Luas Tanah (m¬≤)</label>
                                <input type="number" id="luasTanah" class="form-input" min="0" value="${sanitizeHTML(String(formData.luasTanah))}">
                            </div>
                             <div class="form-group">
                                <label for="tahunDibangun" class="form-label">Tahun Dibangun</label>
                                <input type="number" id="tahunDibangun" class="form-input" min="1900" max="${new Date().getFullYear()}" value="${sanitizeHTML(String(formData.tahunDibangun))}">
                            </div>
                            <div class="form-group">
                                <label for="status" class="form-label">Status</label>
                                <select id="status" class="form-select" required>
                                    <option value="Dijual" ${formData.status === 'Dijual' ? 'selected' : ''}>Dijual</option>
                                    <option value="Disewakan" ${formData.status === 'Disewakan' ? 'selected' : ''}>Disewakan</option>
                                </select>
                            </div>
                            <div class="form-group form-group-full">
                                <label for="imageUrl" class="form-label">URL Gambar Utama</label>
                                <input type="url" id="imageUrl" class="form-input" placeholder="https://example.com/image.jpg" required value="${sanitizeHTML(formData.imageUrl)}">
                            </div>
                            <div class="form-group form-group-full">
                                <label for="fasilitas" class="form-label">Fasilitas (pisahkan dengan koma)</label>
                                <input type="text" id="fasilitas" class="form-input" placeholder="cth: Kolam Renang, Gym, Taman" value="${sanitizeHTML(formData.fasilitas)}">
                            </div>
                            <div class="form-group form-group-full">
                                <label for="deskripsi" class="form-label">Deskripsi</label>
                                <textarea id="deskripsi" class="form-textarea" rows="4" required>${sanitizeHTML(formData.deskripsi)}</textarea>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer" style="display:flex; justify-content:flex-end; gap: var(--space-md);">
                        ${isEditing ? `<button type="button" id="cancel-edit-btn" class="btn btn-outline-primary"><i class="bi bi-x-circle"></i> Batal Edit</button>` : ''}
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle-fill"></i> ${isEditing ? 'Simpan Perubahan' : 'Tambah Properti'}
                        </button>
                    </div>
                </form>

                <h2 style="margin-top: var(--space-xl);">Daftar Properti Saat Ini</h2>
                <div id="manage-property-list-container" class="card">
                    <div class="card-body">
                        ${renderManagePropertyList()}
                    </div>
                </div>
            </div>
        `;
        }

        function renderManagePropertyList() {
            if (appState.properties.length === 0) {
                return renderEmptyState({ innerHTML: '' }, 'Belum ada properti yang ditambahkan.', 'bi-database-fill-add');
            }
            return `
            <div class="manage-property-list" style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>Nama</th>
                            <th>Lokasi</th>
                            <th>Harga</th>
                            <th>Tipe</th>
                            <th>Status</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${appState.properties.map(p => `
                            <tr>
                                <td>${sanitizeHTML(p.nama)}</td>
                                <td>${sanitizeHTML(p.lokasi)}</td>
                                <td>${formatCurrency(p.harga)}</td>
                                <td>${sanitizeHTML(p.tipe)}</td>
                                <td>${sanitizeHTML(p.status)}</td>
                                <td class="actions">
                                    <a href="#/kelola?edit=${p.id}" class="edit-btn" title="Edit ${sanitizeHTML(p.nama)}" aria-label="Edit ${sanitizeHTML(p.nama)}"><i class="bi bi-pencil-fill"></i></a>
                                    <a href="#" class="delete-btn" data-id="${p.id}" title="Hapus ${sanitizeHTML(p.nama)}" aria-label="Hapus ${sanitizeHTML(p.nama)}"><i class="bi bi-trash-fill"></i></a>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            </div>
        `;
        }

        function renderNotFoundPage(message = 'Halaman yang Anda cari tidak dapat ditemukan.') {
            document.title = `404 Tidak Ditemukan - ${APP_NAME}`;
            return `
            <div class="empty-state fade-in" style="padding-top: var(--space-xl); padding-bottom: var(--space-xl);">
                <i class="bi bi-compass" style="font-size: 5rem; color: var(--primary-color);"></i>
                <h1>404 - Tidak Ditemukan</h1>
                <p>${sanitizeHTML(message)}</p>
                <a href="#/" class="btn btn-primary">
                    <i class="bi bi-house-door-fill"></i> Kembali ke Dasbor
                </a>
            </div>
        `;
        }

        function renderStaticPage(title, content) {
            document.title = `${title} - ${APP_NAME}`;
            return `
            <div class="fade-in card">
                <div class="card-body">
                    <h1>${sanitizeHTML(title)}</h1>
                    ${content}
                </div>
            </div>
        `;
        }


        // --- MODAL ---
        function openModal(title, bodyHTML, footerHTML = '') {
            appState.isModalOpen = true;
            appState.modalContent = { title, body: bodyHTML, footer: footerHTML };
            renderModal();
            if (appModalBackdrop) appModalBackdrop.classList.add('active');
            // Trap focus inside modal (sederhana)
            const firstFocusable = appModalContent.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            if (firstFocusable) firstFocusable.focus();
        }

        function closeModal() {
            appState.isModalOpen = false;
            if (appModalBackdrop) appModalBackdrop.classList.remove('active');
            // Kembalikan fokus ke elemen yang membuka modal jika ada
        }

        function renderModal() {
            if (!appModalContent) return;
            appModalContent.innerHTML = `
            <div class="modal-header">
                <h3 id="modal-title">${sanitizeHTML(appState.modalContent.title)}</h3>
                <button class="modal-close-btn" aria-label="Tutup modal" onclick="closeModal()"><i class="bi bi-x-lg"></i></button>
            </div>
            <div class="modal-body">
                ${appState.modalContent.body} <!-- Konten HTML, pastikan aman jika dari user input -->
            </div>
            ${appState.modalContent.footer ? `<div class="modal-footer" style="margin-top: var(--space-lg); display:flex; justify-content:flex-end; gap: var(--space-md);">${appState.modalContent.footer}</div>` : ''}
        `;
            // Tambahkan event listener untuk tombol tutup di dalam footer jika ada
            appModalContent.querySelectorAll('.modal-action-close').forEach(btn => {
                btn.removeEventListener('click', closeModal);
                btn.addEventListener('click', closeModal);
            });
        }


        // --- LOGIKA APLIKASI (Filter, CRUD, dll.) ---
        function applyFilters() {
            appState.isLoading = true;
            // Simulasikan penundaan untuk efek loading (hapus di produksi jika data cepat)
            setTimeout(() => {
                const { searchTerm, propertyType, bedrooms, minPrice, maxPrice } = appState.filters;
                const searchLower = searchTerm.toLowerCase();
                const minP = parseFloat(minPrice) || 0;
                const maxP = parseFloat(maxPrice) || Infinity;

                appState.filteredProperties = appState.properties.filter(p => {
                    const nameMatch = p.nama.toLowerCase().includes(searchLower);
                    const locationMatch = p.lokasi.toLowerCase().includes(searchLower);
                    const typeMatch = propertyType === 'Semua' || p.tipe === propertyType;
                    const bedroomMatch = bedrooms === 'Semua' ||
                        (bedrooms === '5+' && p.kamarTidur >= 5) ||
                        (p.kamarTidur === parseInt(bedrooms));
                    const priceMatch = p.harga >= minP && p.harga <= maxP;

                    return (nameMatch || locationMatch) && typeMatch && bedroomMatch && priceMatch;
                });
                appState.isLoading = false;
                // Re-render hanya bagian list properti, bukan seluruh halaman
                const propertyListContainer = document.getElementById('property-list-container');
                if (propertyListContainer) {
                    propertyListContainer.innerHTML = renderPropertyList(appState.filteredProperties);
                }
            }, 300); // Penundaan 300ms
        }
        const debouncedApplyFilters = debounce(applyFilters, 500); // Debounce untuk input teks


        function handleFilterFormSubmit(event) {
            event.preventDefault();
            appState.filters.searchTerm = document.getElementById('searchTerm')?.value || '';
            appState.filters.propertyType = document.getElementById('propertyType')?.value || 'Semua';
            appState.filters.bedrooms = document.getElementById('bedrooms')?.value || 'Semua';
            appState.filters.minPrice = document.getElementById('minPrice')?.value || '';
            appState.filters.maxPrice = document.getElementById('maxPrice')?.value || '';
            applyFilters();
        }

        function handleResetFilters() {
            appState.filters = {
                searchTerm: '',
                propertyType: 'Semua',
                bedrooms: 'Semua',
                minPrice: '',
                maxPrice: '',
            };
            // Reset nilai di form juga
            const filterForm = document.getElementById('filter-form');
            if (filterForm) filterForm.reset();

            // Setelah reset, panggil applyFilters untuk memperbarui tampilan
            applyFilters();

            // Kembalikan fokus ke input pertama jika perlu
            const firstInput = document.getElementById('searchTerm');
            if (firstInput) firstInput.focus();
        }


        function handleManagePropertyFormSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const id = form.querySelector('#propertyId').value;
            const newPropertyData = {
                id: id || generateId(),
                nama: form.querySelector('#nama').value,
                lokasi: form.querySelector('#lokasi').value,
                harga: parseFloat(form.querySelector('#harga').value),
                tipe: form.querySelector('#tipe').value,
                kamarTidur: parseInt(form.querySelector('#kamarTidur').value) || 0,
                kamarMandi: parseInt(form.querySelector('#kamarMandi').value) || 0,
                luasBangunan: parseInt(form.querySelector('#luasBangunan').value) || 0,
                luasTanah: parseInt(form.querySelector('#luasTanah').value) || 0,
                imageUrl: form.querySelector('#imageUrl').value,
                deskripsi: form.querySelector('#deskripsi').value,
                status: form.querySelector('#status').value,
                fasilitas: form.querySelector('#fasilitas').value.split(',').map(f => f.trim()).filter(f => f), // array of strings
                tahunDibangun: parseInt(form.querySelector('#tahunDibangun').value) || 0
            };

            if (id) { // Edit mode
                appState.properties = appState.properties.map(p => p.id === id ? newPropertyData : p);
            } else { // Add mode
                appState.properties.push(newPropertyData);
            }
            // Update local storage atau kirim ke API
            savePropertiesToLocalStorage();

            appState.selectedPropertyId = null; // Reset selected ID
            applyFilters(); // Update filtered list
            renderPageContent(); // Re-render halaman kelola (termasuk form dan list)
            showNotification(`${id ? 'Properti berhasil diperbarui' : 'Properti baru berhasil ditambahkan'}!`, 'success');
        }

        function handleDeleteProperty(propertyId) {
            const propertyName = appState.properties.find(p => p.id === propertyId)?.nama || 'Properti';

            openModal(
                `Konfirmasi Hapus Properti`,
                `<p>Apakah Anda yakin ingin menghapus properti <strong>"${sanitizeHTML(propertyName)}"</strong>? Tindakan ini tidak dapat diurungkan.</p>`,
                `<button class="btn btn-outline-primary modal-action-close">Batal</button>
             <button id="confirm-delete-btn" class="btn btn-danger" data-id="${propertyId}"><i class="bi bi-trash-fill"></i> Ya, Hapus</button>`
            );

            // Tambahkan listener untuk tombol konfirmasi hapus di modal
            const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
            if (confirmDeleteBtn) {
                confirmDeleteBtn.addEventListener('click', () => {
                    appState.properties = appState.properties.filter(p => p.id !== propertyId);
                    savePropertiesToLocalStorage();
                    applyFilters();
                    renderPageContent(); // Re-render halaman kelola
                    closeModal();
                    showNotification(`Properti "${sanitizeHTML(propertyName)}" berhasil dihapus.`, 'info');
                });
            }
        }

        function handleCancelEdit() {
            appState.selectedPropertyId = null;
            renderPageContent(); // Re-render halaman kelola untuk membersihkan form
        }

        // --- NOTIFIKASI SEDERHANA ---
        function showNotification(message, type = 'info') { // type: 'info', 'success', 'warning', 'error'
            const notificationArea = document.getElementById('notification-area') || createNotificationArea();

            const notification = document.createElement('div');
            notification.className = `app-notification notification-${type}`;
            notification.setAttribute('role', 'alert');
            notification.innerHTML = `<i class="bi ${type === 'success' ? 'bi-check-circle-fill' : type === 'error' ? 'bi-x-octagon-fill' : 'bi-info-circle-fill'}"></i> ${sanitizeHTML(message)}`;

            notificationArea.appendChild(notification);

            // Hapus notifikasi setelah beberapa detik
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 500); // Waktu untuk transisi fade out
            }, 5000); // Notifikasi hilang setelah 5 detik
        }

        function createNotificationArea() {
            const area = document.createElement('div');
            area.id = 'notification-area';
            area.style.position = 'fixed';
            area.style.bottom = 'var(--space-lg)';
            area.style.right = 'var(--space-lg)';
            area.style.zIndex = 'var(--z-tooltip)'; // Di atas segalanya
            area.style.display = 'flex';
            area.style.flexDirection = 'column';
            area.style.gap = 'var(--space-sm)';
            document.body.appendChild(area);

            // Tambahkan style untuk notifikasi
            const style = document.createElement('style');
            style.textContent = `
            .app-notification {
                padding: var(--space-md) var(--space-lg);
                border-radius: var(--rounded-md);
                color: #fff;
                box-shadow: var(--shadow-lg);
                opacity: 1;
                transition: opacity 0.5s ease-in-out;
                display: flex;
                align-items: center;
                gap: var(--space-sm);
            }
            .notification-info { background-color: var(--secondary-color); }
            .notification-success { background-color: var(--primary-color); }
            .notification-warning { background-color: var(--accent-color); color: var(--text-light); }
            .notification-error { background-color: #E74C3C; } /* Merah untuk error */
        `;
            document.head.appendChild(style);
            return area;
        }


        // --- PERSISTENSI DATA (LOCAL STORAGE) ---
        function loadPropertiesFromLocalStorage() {
            const storedProperties = localStorage.getItem('greenValleyProperties');
            if (storedProperties) {
                try {
                    appState.properties = JSON.parse(storedProperties);
                } catch (e) {
                    console.error("Gagal memuat properti dari localStorage:", e);
                    appState.properties = [...MOCK_PROPERTIES]; // Fallback ke mock jika parse gagal
                    savePropertiesToLocalStorage(); // Simpan mock agar konsisten
                }
            } else {
                appState.properties = [...MOCK_PROPERTIES]; // Gunakan mock jika tidak ada di localStorage
                savePropertiesToLocalStorage();
            }
            appState.filteredProperties = [...appState.properties];
        }

        function savePropertiesToLocalStorage() {
            try {
                localStorage.setItem('greenValleyProperties', JSON.stringify(appState.properties));
            } catch (e) {
                console.error("Gagal menyimpan properti ke localStorage:", e);
                showNotification('Gagal menyimpan data properti. LocalStorage mungkin penuh.', 'error');
            }
        }


        // --- ROUTER DAN RENDER HALAMAN UTAMA ---
        function renderPageContent() {
            if (!pageContentContainer) {
                console.error('Elemen page-content-container tidak ditemukan di DOM.');
                return;
            }
            // Selalu reset scroll ke atas saat pindah halaman
            window.scrollTo(0, 0);

            // Dapatkan elemen wrapper di dalam pageContentContainer
            const contentWrapper = pageContentContainer.querySelector('.page-content-wrapper');
            if (!contentWrapper) {
                console.error('Elemen .page-content-wrapper tidak ditemukan.');
                pageContentContainer.innerHTML = '<div class="page-content-wrapper"></div>'; // Buat jika tidak ada
                // Coba lagi setelah membuat wrapper
                setTimeout(renderPageContent, 0);
                return;
            }

            renderLoadingIndicator(contentWrapper); // Tampilkan loading sementara konten dimuat

            // setTimeout untuk mensimulasikan pemuatan konten dan memungkinkan UI diperbarui
            setTimeout(() => {
                let pageHTML = '';
                const path = appState.currentPage;
                let pageTitle = APP_NAME; // Default title

                const route = NAV_LINKS.find(link => link.path === path);
                if (route) {
                    pageTitle = route.pageTitle || `${route.name} - ${APP_NAME}`;
                }

                if (path === '#/' || path === '') {
                    pageHTML = renderDashboardPage();
                } else if (path === '#/properti') {
                    pageHTML = renderPropertiesPage();
                } else if (path.startsWith('#/properti/')) {
                    const propertyId = path.split('/')[2];
                    pageHTML = renderPropertyDetailPage(propertyId);
                    // Judul halaman untuk detail di-set di dalam renderPropertyDetailPage
                } else if (path.startsWith('#/kelola')) {
                    const urlParams = new URLSearchParams(path.split('?')[1] || '');
                    const editId = urlParams.get('edit');
                    appState.selectedPropertyId = editId || null;
                    pageHTML = renderManagePropertyPage();
                    pageTitle = (editId ? 'Edit Properti' : 'Kelola Properti') + ` - ${APP_NAME}`;
                } else if (path === '#/privasi') {
                    pageHTML = renderStaticPage('Kebijakan Privasi', '<p>Isi kebijakan privasi akan ditampilkan di sini...</p><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>');
                } else if (path === '#/syarat-ketentuan') {
                    pageHTML = renderStaticPage('Syarat & Ketentuan', '<p>Isi syarat dan ketentuan penggunaan aplikasi akan ditampilkan di sini...</p><p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>');
                } else {
                    pageHTML = renderNotFoundPage();
                    pageTitle = `404 Tidak Ditemukan - ${APP_NAME}`;
                }

                document.title = pageTitle;
                contentWrapper.innerHTML = pageHTML;
                attachPageSpecificEventListeners(path);
            }, 50); // Sedikit delay untuk efek loading yang terlihat
        }

        function attachPageSpecificEventListeners(currentPath) {
            // Hapus listener lama untuk mencegah duplikasi (jika ada yang lebih kompleks)

            if (currentPath === '#/properti') {
                const filterForm = document.getElementById('filter-form');
                if (filterForm) {
                    filterForm.removeEventListener('submit', handleFilterFormSubmit); // Cegah duplikasi
                    filterForm.addEventListener('submit', handleFilterFormSubmit);

                    // Debounce untuk input teks
                    const searchTermInput = document.getElementById('searchTerm');
                    if (searchTermInput) {
                        searchTermInput.removeEventListener('input', () => {
                            appState.filters.searchTerm = searchTermInput.value;
                            debouncedApplyFilters();
                        });
                        searchTermInput.addEventListener('input', () => {
                            appState.filters.searchTerm = searchTermInput.value;
                            debouncedApplyFilters();
                        });
                    }
                    // Listener untuk reset
                    const resetBtn = document.getElementById('reset-filter-btn');
                    if (resetBtn) {
                        resetBtn.removeEventListener('click', handleResetFilters);
                        resetBtn.addEventListener('click', handleResetFilters);
                    }
                }
            } else if (currentPath.startsWith('#/kelola')) {
                const manageForm = document.getElementById('manage-property-form');
                if (manageForm) {
                    manageForm.removeEventListener('submit', handleManagePropertyFormSubmit);
                    manageForm.addEventListener('submit', handleManagePropertyFormSubmit);
                }

                const cancelEditBtn = document.getElementById('cancel-edit-btn');
                if (cancelEditBtn) {
                    cancelEditBtn.removeEventListener('click', handleCancelEdit);
                    cancelEditBtn.addEventListener('click', handleCancelEdit);
                }

                const propertyListContainer = document.getElementById('manage-property-list-container');
                if (propertyListContainer) {
                    propertyListContainer.querySelectorAll('.delete-btn').forEach(btn => {
                        // Hapus listener lama sebelum menambah yang baru
                        const newBtn = btn.cloneNode(true); // Clone untuk menghapus semua listener
                        btn.parentNode.replaceChild(newBtn, btn);
                        newBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            handleDeleteProperty(newBtn.dataset.id);
                        });
                    });
                    // Tidak perlu listener untuk edit-btn karena itu link hash
                }
            }
        }

        function handleHashChange() {
            appState.currentPage = location.hash || '#/';
            renderNavbar(); // Update active link di navbar
            renderPageContent(); // Render konten halaman yang sesuai
        }

        // --- INISIALISASI APLIKASI ---
        function initApp() {
            // Cache elemen DOM utama
            navbarContainer = document.getElementById('navbar-container');
            pageContentContainer = document.getElementById('page-content-container');
            footerContainer = document.getElementById('footer-container');
            appModalBackdrop = document.getElementById('app-modal-backdrop');
            appModalContent = document.getElementById('app-modal-content');

            if (!navbarContainer || !pageContentContainer || !footerContainer || !appModalBackdrop || !appModalContent) {
                console.error('Satu atau lebih elemen DOM penting tidak ditemukan. Aplikasi mungkin tidak berfungsi dengan benar.');
                document.body.innerHTML = '<p style="color:red; font-size:1.5rem; padding:20px; text-align:center;">Terjadi kesalahan kritis saat memuat aplikasi. Elemen penting tidak ditemukan.</p>';
                return; // Hentikan inisialisasi jika elemen penting tidak ada
            }

            // Muat properti dari localStorage atau gunakan mock
            loadPropertiesFromLocalStorage();

            applyTheme(); // Terapkan tema awal
            renderNavbar();
            renderFooter();

            // Set halaman awal berdasarkan hash atau default ke dasbor
            appState.currentPage = location.hash || '#/';
            handleHashChange(); // Panggil sekali untuk render halaman awal

            // Listener untuk perubahan hash URL (navigasi SPA)
            window.addEventListener('hashchange', handleHashChange);

            // Listener untuk menutup modal dengan tombol Escape
            window.addEventListener('keydown', (event) => {
                if (event.key === 'Escape' && appState.isModalOpen) {
                    closeModal();
                }
            });
            // Listener untuk menutup modal saat klik di luar konten modal
            if (appModalBackdrop) {
                appModalBackdrop.addEventListener('click', (event) => {
                    if (event.target === appModalBackdrop) { // Pastikan klik di backdrop, bukan di konten modal
                        closeModal();
                    }
                });
            }

            console.log(`${APP_NAME} berhasil diinisialisasi. Status saat ini:`, appState);
            showNotification(`Selamat datang di ${APP_NAME}!`, 'info');
        }

        // Jalankan initApp setelah seluruh DOM siap
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initApp);
        } else {
            // DOM sudah siap
            initApp();
        }

    </script>
</body>

</html>