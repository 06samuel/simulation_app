<!DOCTYPE html>
<html lang="id" data-theme="light"> <!-- Default tema terang, bisa diubah via JS -->

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ApartemenOS | Sistem Manajemen Rental Apartemen</title>
    <meta name="description"
        content="Sistem manajemen rental apartemen SaaS modern dengan dasbor notifikasi, listing properti, manajemen booking, dan UI/UX profesional. Dibangun dengan Vanilla HTML, CSS, dan JavaScript.">
    <meta name="keywords"
        content="manajemen apartemen, rental, booking, notifikasi, dashboard, saas, vanilla js, spa, native, monolith">
    <meta name="author" content="Pengembang Aplikasi Anda">
    <meta name="theme-color" content="#6366f1"> <!-- Warna tema untuk address bar mobile (Indigo 500) -->

    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¢</text></svg>">

    <!-- Font Awesome (Ikon Online Gratis via CDN) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /*=============================================
=            VARIABEL GLOBAL & RESET          =
Design System Terpusat (CSS Variables)
Arsitektur: Monolith dengan pemisahan logis styling.
Layer: Global, Layout, Utilities, Components, Pages.
Prinsip: Konsistensi, Skalabilitas, Maintainabilitas.
=============================================*/
        :root {
            /* Skema Warna Dasar (Mode Terang) - Layer Warna */
            --primary-color-rgb: 99, 102, 241;
            --primary-color: #6366f1;
            --primary-color-hover: #4f46e5;
            --primary-color-light: #e0e7ff;
            --primary-color-dark-text: #4338ca;

            --secondary-color-rgb: 16, 185, 129;
            --secondary-color: #10b981;
            --secondary-color-hover: #059669;
            --secondary-color-light: #d1fae5;

            --accent-color-rgb: 245, 158, 11;
            --accent-color: #f59e0b;
            --accent-color-hover: #d97706;
            --accent-color-light: #fef3c7;

            --danger-color-rgb: 239, 68, 68;
            --danger-color: #ef4444;
            --danger-color-hover: #dc2626;
            --danger-color-light: #fee2e2;

            --success-color-rgb: 34, 197, 94;
            --success-color: #22c55e;
            --success-color-light: #dcfce7;
            --success-color-hover: #16a34a;

            --warning-color-rgb: 234, 179, 8;
            --warning-color: #eab308;
            --warning-color-light: #fef9c3;
            --warning-color-hover: #ca8a04;

            --info-color-rgb: 59, 130, 246;
            --info-color: #3b82f6;
            --info-color-light: #dbeafe;
            --info-color-hover: #2563eb;

            --bg-color: #f8fafc;
            --bg-color-alt: #ffffff;
            --text-color: #1e293b;
            --text-color-muted: #64748b;
            --text-color-subtle: #94a3b8;
            --border-color: #e2e8f0;
            --border-color-strong: #cbd5e1;
            --card-bg-color: #ffffff;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -2px rgba(0, 0, 0, 0.05);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -4px rgba(0, 0, 0, 0.05);
            --input-bg-color: #f1f5f9;
            --input-border-color: var(--border-color-strong);
            --focus-ring-color: rgba(var(--primary-color-rgb), 0.4);

            /* Tipografi - Layer Tipografi */
            --font-family-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-size-base: 1rem;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;
            --line-height-normal: 1.6;
            --line-height-tight: 1.3;
            --line-height-snug: 1.45;

            /* Border Radius - Layer Bentuk */
            --border-radius-sm: 0.25rem;
            --border-radius-md: 0.5rem;
            --border-radius-lg: 0.75rem;
            --border-radius-xl: 1rem;
            --border-radius-full: 9999px;

            /* Spasi (menggunakan kelipatan 4px) - Layer Spasi */
            --spacing-unit: 0.25rem;
            --spacing-px: 1px;
            --spacing-0: 0;
            --spacing-1: calc(1 * var(--spacing-unit));
            --spacing-2: calc(2 * var(--spacing-unit));
            --spacing-3: calc(3 * var(--spacing-unit));
            --spacing-4: calc(4 * var(--spacing-unit));
            --spacing-5: calc(5 * var(--spacing-unit));
            --spacing-6: calc(6 * var(--spacing-unit));
            --spacing-8: calc(8 * var(--spacing-unit));
            --spacing-10: calc(10 * var(--spacing-unit));
            --spacing-12: calc(12 * var(--spacing-unit));

            /* Transisi - Layer Animasi */
            --transition-fast: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);

            /* Layout - Layer Struktur */
            --max-width-container: 1280px;
            --header-height: 68px;
            --sidebar-width-desktop: 260px;
            --sidebar-width-collapsed: 80px;
        }

        /* Skema Warna Mode Gelap */
        [data-theme="dark"] {
            --primary-color-rgb: 129, 140, 248;
            --primary-color: #818cf8;
            --primary-color-hover: #a5b4fc;
            --primary-color-light: #3730a3;
            --primary-color-dark-text: #c7d2fe;

            --secondary-color-rgb: 52, 211, 153;
            --secondary-color: #34d399;
            --secondary-color-hover: #6ee7b7;
            --secondary-color-light: #065f46;

            --accent-color-rgb: 251, 191, 36;
            --accent-color: #fbbf24;
            --accent-color-hover: #fcd34d;
            --accent-color-light: #78350f;

            --danger-color-rgb: 248, 113, 113;
            --danger-color: #f87171;
            --danger-color-hover: #ef4444;
            --danger-color-light: #7f1d1d;

            --success-color-rgb: 74, 222, 128;
            --success-color: #4ade80;
            --success-color-light: #166534;
            --success-color-hover: #22c55e;

            --warning-color-rgb: 250, 204, 21;
            --warning-color: #facc15;
            --warning-color-light: #713f12;
            --warning-color-hover: #eab308;

            --info-color-rgb: 96, 165, 250;
            --info-color: #60a5fa;
            --info-color-light: #1e40af;
            --info-color-hover: #3b82f6;

            --bg-color: #0f172a;
            --bg-color-alt: #1e293b;
            --text-color: #f1f5f9;
            --text-color-muted: #94a3b8;
            --text-color-subtle: #64748b;
            --border-color: #334155;
            --border-color-strong: #475569;
            --card-bg-color: #1e293b;
            --input-bg-color: #334155;
            --input-border-color: var(--border-color-strong);
            --focus-ring-color: rgba(var(--primary-color-rgb), 0.5);
        }

        /* Reset Dasar & Gaya Global - Layer Reset */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            font-size: 100%;
            scroll-behavior: smooth;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-family-sans);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-normal);
            line-height: var(--line-height-normal);
            color: var(--text-color);
            background-color: var(--bg-color);
            min-height: 100vh;
            display: flex;
            /* Untuk struktur #app-shell */
            flex-direction: column;
            transition: background-color var(--transition-normal), color var(--transition-normal);
            overflow-x: hidden;
            /* Mencegah scroll horizontal karena sidebar mobile */
        }

        #app-shell {
            display: flex;
            flex-grow: 1;
            /* Mengisi sisa tinggi body */
            position: relative;
            /* Untuk positioning sidebar mobile */
            overflow-x: hidden;
            /* Mencegah app-shell menyebabkan scroll horizontal */
        }

        #main-area-wrapper {
            /* Wrapper untuk header dan main-content */
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
            /* Default untuk mobile, akan diubah oleh JS/CSS untuk desktop */
            transition: margin-left var(--transition-normal);
            /* Animasi saat sidebar desktop muncul/hilang */
        }

        img,
        picture,
        video,
        canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }

        input,
        button,
        textarea,
        select {
            font: inherit;
            border: none;
            outline: none;
        }

        button {
            cursor: pointer;
            background: none;
            color: inherit;
            padding: 0;
            -webkit-appearance: none;
            appearance: none;
        }

        a {
            text-decoration: none;
            color: var(--primary-color);
            transition: color var(--transition-fast);
        }

        a:hover {
            color: var(--primary-color-hover);
            text-decoration: underline;
        }

        ul,
        ol {
            list-style: none;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-weight: var(--font-weight-bold);
            line-height: var(--line-height-tight);
            color: var(--text-color);
            margin-top: 0;
        }

        h1 {
            font-size: var(--font-size-3xl);
            margin-bottom: var(--spacing-6);
        }

        h2 {
            font-size: var(--font-size-2xl);
            margin-bottom: var(--spacing-5);
        }

        h3 {
            font-size: var(--font-size-xl);
            margin-bottom: var(--spacing-4);
        }

        h4 {
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-3);
        }

        p {
            line-height: var(--line-height-snug);
            margin-bottom: var(--spacing-4);
        }

        p:last-child {
            margin-bottom: 0;
        }

        /* Fokus Universal (Aksesibilitas) - Layer Aksesibilitas */
        *:focus-visible {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
            box-shadow: 0 0 0 3px var(--focus-ring-color);
            border-radius: var(--border-radius-sm);
        }

        input:focus-visible,
        textarea:focus-visible,
        select:focus-visible {
            border-color: var(--primary-color) !important;
        }

        /*=============================================
=                LAYOUT CONTAINER             =
=============================================*/
        .container {
            width: 100%;
            max-width: var(--max-width-container);
            margin-left: auto;
            margin-right: auto;
            padding-left: var(--spacing-4);
            padding-right: var(--spacing-4);
        }

        @media (max-width: 767.98px) {
            .container {
                padding-left: var(--spacing-3);
                padding-right: var(--spacing-3);
            }
        }

        /*=============================================
=               UTILITY CLASSES               =
=============================================*/
        .d-none {
            display: none !important;
        }

        .d-block {
            display: block !important;
        }

        .d-inline {
            display: inline !important;
        }

        .d-inline-block {
            display: inline-block !important;
        }

        .d-flex {
            display: flex !important;
        }

        .d-grid {
            display: grid !important;
        }

        .flex-column {
            flex-direction: column !important;
        }

        .flex-row {
            flex-direction: row !important;
        }

        .justify-start {
            justify-content: flex-start !important;
        }

        .justify-end {
            justify-content: flex-end !important;
        }

        .justify-center {
            justify-content: center !important;
        }

        .justify-between {
            justify-content: space-between !important;
        }

        .justify-around {
            justify-content: space-around !important;
        }

        .align-start {
            align-items: flex-start !important;
        }

        .align-end {
            align-items: flex-end !important;
        }

        .align-center {
            align-items: center !important;
        }

        .align-stretch {
            align-items: stretch !important;
        }

        .flex-wrap {
            flex-wrap: wrap !important;
        }

        .flex-nowrap {
            flex-wrap: nowrap !important;
        }

        .flex-grow-1 {
            flex-grow: 1 !important;
        }

        .gap-1 {
            gap: var(--spacing-1);
        }

        .gap-2 {
            gap: var(--spacing-2);
        }

        .gap-3 {
            gap: var(--spacing-3);
        }

        .gap-4 {
            gap: var(--spacing-4);
        }

        .gap-6 {
            gap: var(--spacing-6);
        }

        .gap-8 {
            gap: var(--spacing-8);
        }

        .text-center {
            text-align: center !important;
        }

        .text-left {
            text-align: left !important;
        }

        .text-right {
            text-align: right !important;
        }

        .w-full {
            width: 100% !important;
        }

        .h-full {
            height: 100% !important;
        }

        .m-0 {
            margin: var(--spacing-0) !important;
        }

        .mt-auto {
            margin-top: auto !important;
        }

        .mt-1 {
            margin-top: var(--spacing-1) !important;
        }

        .mb-1 {
            margin-bottom: var(--spacing-1) !important;
        }

        .mt-2 {
            margin-top: var(--spacing-2) !important;
        }

        .mb-2 {
            margin-bottom: var(--spacing-2) !important;
        }

        .mt-3 {
            margin-top: var(--spacing-3) !important;
        }

        .mb-3 {
            margin-bottom: var(--spacing-3) !important;
        }

        .mt-4 {
            margin-top: var(--spacing-4) !important;
        }

        .mb-4 {
            margin-bottom: var(--spacing-4) !important;
        }

        .mt-6 {
            margin-top: var(--spacing-6) !important;
        }

        .mb-6 {
            margin-bottom: var(--spacing-6) !important;
        }

        .mt-8 {
            margin-top: var(--spacing-8) !important;
        }

        .mb-8 {
            margin-bottom: var(--spacing-8) !important;
        }

        .p-0 {
            padding: var(--spacing-0) !important;
        }

        .p-1 {
            padding: var(--spacing-1) !important;
        }

        .py-1 {
            padding-top: var(--spacing-1) !important;
            padding-bottom: var(--spacing-1) !important;
        }

        .px-1 {
            padding-left: var(--spacing-1) !important;
            padding-right: var(--spacing-1) !important;
        }

        .p-2 {
            padding: var(--spacing-2) !important;
        }

        .py-2 {
            padding-top: var(--spacing-2) !important;
            padding-bottom: var(--spacing-2) !important;
        }

        .px-2 {
            padding-left: var(--spacing-2) !important;
            padding-right: var(--spacing-2) !important;
        }

        .p-3 {
            padding: var(--spacing-3) !important;
        }

        .py-3 {
            padding-top: var(--spacing-3) !important;
            padding-bottom: var(--spacing-3) !important;
        }

        .px-3 {
            padding-left: var(--spacing-3) !important;
            padding-right: var(--spacing-3) !important;
        }

        .p-4 {
            padding: var(--spacing-4) !important;
        }

        .py-4 {
            padding-top: var(--spacing-4) !important;
            padding-bottom: var(--spacing-4) !important;
        }

        .px-4 {
            padding-left: var(--spacing-4) !important;
            padding-right: var(--spacing-4) !important;
        }

        .p-6 {
            padding: var(--spacing-6) !important;
        }

        .py-6 {
            padding-top: var(--spacing-6) !important;
            padding-bottom: var(--spacing-6) !important;
        }

        .px-6 {
            padding-left: var(--spacing-6) !important;
            padding-right: var(--spacing-6) !important;
        }

        .rounded-sm {
            border-radius: var(--border-radius-sm);
        }

        .rounded-md {
            border-radius: var(--border-radius-md);
        }

        .rounded-lg {
            border-radius: var(--border-radius-lg);
        }

        .rounded-xl {
            border-radius: var(--border-radius-xl);
        }

        .rounded-full {
            border-radius: var(--border-radius-full);
        }

        .shadow-sm {
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        .shadow-md {
            box-shadow: var(--card-shadow);
        }

        .shadow-lg {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .shadow-xl {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .text-primary {
            color: var(--primary-color) !important;
        }

        .text-secondary {
            color: var(--secondary-color) !important;
        }

        .text-accent {
            color: var(--accent-color) !important;
        }

        .text-muted {
            color: var(--text-color-muted) !important;
        }

        .text-subtle {
            color: var(--text-color-subtle) !important;
        }

        .text-danger {
            color: var(--danger-color) !important;
        }

        .text-success {
            color: var(--success-color) !important;
        }

        .text-white {
            color: #ffffff !important;
        }

        .text-black {
            color: #000000 !important;
        }

        .fw-light {
            font-weight: var(--font-weight-light) !important;
        }

        .fw-normal {
            font-weight: var(--font-weight-normal) !important;
        }

        .fw-medium {
            font-weight: var(--font-weight-medium) !important;
        }

        .fw-semibold {
            font-weight: var(--font-weight-semibold) !important;
        }

        .fw-bold {
            font-weight: var(--font-weight-bold) !important;
        }

        .fs-xs {
            font-size: var(--font-size-xs) !important;
        }

        .fs-sm {
            font-size: var(--font-size-sm) !important;
        }

        .fs-base {
            font-size: var(--font-size-base) !important;
        }

        .fs-lg {
            font-size: var(--font-size-lg) !important;
        }

        .fs-xl {
            font-size: var(--font-size-xl) !important;
        }

        .sr-only {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            white-space: nowrap !important;
            border-width: 0 !important;
        }

        .mr-1 {
            margin-right: var(--spacing-1);
        }

        .mr-2 {
            margin-right: var(--spacing-2);
        }

        .ml-1 {
            margin-left: var(--spacing-1);
        }

        .ml-2 {
            margin-left: var(--spacing-2);
        }

        /*=============================================
=            KOMPONEN SIDEBAR                 =
Sidebar Aplikasi - Layer Komponen
=============================================*/
        .app-sidebar {
            width: var(--sidebar-width-desktop);
            background-color: var(--card-bg-color);
            /* Atau --bg-color-alt */
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
            /* Sidebar mengisi tinggi viewport */
            position: fixed;
            /* Agar tetap saat scroll konten */
            top: 0;
            left: 0;
            z-index: 1100;
            /* Di atas konten, di bawah modal mungkin */
            transition: transform var(--transition-normal), width var(--transition-normal);
            overflow-y: auto;
            /* Scroll jika konten sidebar panjang */
            padding-bottom: var(--spacing-4);
            /* Ruang di bawah */
        }

        .sidebar-header {
            padding: var(--spacing-4);
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            border-bottom: 1px solid var(--border-color);
            height: var(--header-height);
            /* Samakan dengan tinggi header utama */
            flex-shrink: 0;
            /* Agar tidak mengecil */
        }

        .sidebar-logo-icon {
            font-size: var(--font-size-2xl);
            color: var(--primary-color);
        }

        .sidebar-logo-text {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-color);
        }

        .sidebar-logo-highlight {
            color: var(--primary-color);
        }

        .sidebar-profile {
            padding: var(--spacing-4);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            flex-shrink: 0;
        }

        .sidebar-profile-img {
            width: 48px;
            height: 48px;
            border-radius: var(--border-radius-full);
            object-fit: cover;
            /* Pastikan gambar terisi baik */
            border: 2px solid var(--border-color-strong);
        }

        .sidebar-profile-info .name {
            font-weight: var(--font-weight-semibold);
            color: var(--text-color);
            display: block;
        }

        .sidebar-profile-info .role {
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
        }

        .sidebar-nav {
            flex-grow: 1;
            /* Mengisi sisa ruang di sidebar */
            padding: var(--spacing-4) 0;
        }

        .sidebar-nav .nav-list {
            display: flex;
            flex-direction: column;
        }

        .sidebar-nav .nav-item {
            /* Tidak ada margin/padding di sini, atur di link */
        }

        .sidebar-nav .nav-link {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            /* Jarak ikon dan teks */
            padding: var(--spacing-3) var(--spacing-4);
            color: var(--text-color-muted);
            font-weight: var(--font-weight-medium);
            transition: color var(--transition-fast), background-color var(--transition-fast);
            text-decoration: none;
            border-left: 3px solid transparent;
            /* Indikator aktif */
            margin: var(--spacing-1) var(--spacing-2);
            /* Jarak antar link */
            border-radius: var(--border-radius-md);
        }

        .sidebar-nav .nav-link i {
            width: 20px;
            /* Lebar tetap untuk ikon agar teks sejajar */
            text-align: center;
            font-size: var(--font-size-lg);
            flex-shrink: 0;
            /* Agar ikon tidak mengecil */
            color: var(--text-color-subtle);
            /* Warna ikon default */
            transition: color var(--transition-fast);
        }

        .sidebar-nav .nav-link .nav-text {
            transition: opacity var(--transition-fast);
        }

        .sidebar-nav .nav-link:hover,
        .sidebar-nav .nav-link.active {
            color: var(--primary-color);
            background-color: var(--primary-color-light);
            border-left-color: var(--primary-color);
            /* Hanya untuk desktop full */
        }

        .sidebar-nav .nav-link:hover i,
        .sidebar-nav .nav-link.active i {
            color: var(--primary-color);
            /* Warna ikon saat aktif/hover */
        }

        [data-theme="dark"] .sidebar-nav .nav-link:hover,
        [data-theme="dark"] .sidebar-nav .nav-link.active {
            color: var(--primary-color-dark-text);
            background-color: rgba(var(--primary-color-rgb), 0.2);
            /* Lebih subtle di dark */
            border-left-color: var(--primary-color);
        }

        [data-theme="dark"] .sidebar-nav .nav-link:hover i,
        [data-theme="dark"] .sidebar-nav .nav-link.active i {
            color: var(--primary-color-dark-text);
        }

        /* Sidebar Collapsed State (Tablet/Desktop Kecil) */
        .app-sidebar.collapsed {
            width: var(--sidebar-width-collapsed);
        }

        .app-sidebar.collapsed .sidebar-logo-text,
        .app-sidebar.collapsed .sidebar-profile-info,
        .app-sidebar.collapsed .nav-link .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
            white-space: nowrap;
        }

        .app-sidebar.collapsed .sidebar-header,
        .app-sidebar.collapsed .sidebar-profile {
            justify-content: center;
            /* Pusatkan ikon logo/profile */
        }

        .app-sidebar.collapsed .nav-link {
            justify-content: center;
            /* Pusatkan ikon nav */
            padding: var(--spacing-3);
            border-left-color: transparent !important;
            /* Hilangkan border saat collapsed */
        }

        .app-sidebar.collapsed .nav-link.active {
            background-color: var(--primary-color-light);
            /* Tetap ada bg color */
        }

        [data-theme="dark"] .app-sidebar.collapsed .nav-link.active {
            background-color: rgba(var(--primary-color-rgb), 0.2);
        }

        .app-sidebar.collapsed .nav-link i {
            margin-right: 0;
        }

        /* Sidebar Mobile State */
        @media (max-width: 767.98px) {
            .app-sidebar {
                transform: translateX(-100%);
                /* Sembunyikan di kiri */
                box-shadow: var(--card-shadow-hover);
                /* Bayangan saat muncul */
            }

            .app-sidebar.open {
                transform: translateX(0);
            }

            #main-area-wrapper {
                margin-left: 0 !important;
                /* Pastikan tidak ada margin di mobile */
                width: 100% !important;
            }

            .sidebar-overlay {
                /* Overlay saat sidebar mobile terbuka */
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 1099;
                /* Di bawah sidebar */
                opacity: 0;
                visibility: hidden;
                transition: opacity var(--transition-normal), visibility var(--transition-normal);
            }

            .sidebar-overlay.active {
                opacity: 1;
                visibility: visible;
            }
        }

        /* Sidebar Tablet (collapsed by default) & Desktop */
        @media (min-width: 768px) {
            #main-area-wrapper {
                margin-left: var(--sidebar-width-collapsed);
                width: calc(100% - var(--sidebar-width-collapsed));
            }

            .app-sidebar.open {
                /* Saat sidebar 'open' (full width) di tablet/desktop */
                width: var(--sidebar-width-desktop);
            }

            .app-sidebar.open+#main-area-wrapper {
                margin-left: var(--sidebar-width-desktop);
                width: calc(100% - var(--sidebar-width-desktop));
            }

            .app-sidebar:not(.open) {
                /* default collapsed di tablet */
                width: var(--sidebar-width-collapsed);
            }

            .app-sidebar:not(.open) .sidebar-logo-text,
            .app-sidebar:not(.open) .sidebar-profile-info,
            .app-sidebar:not(.open) .nav-link .nav-text {
                opacity: 0;
                width: 0;
                overflow: hidden;
                white-space: nowrap;
            }

            .app-sidebar:not(.open) .sidebar-header,
            .app-sidebar:not(.open) .sidebar-profile {
                justify-content: center;
            }

            .app-sidebar:not(.open) .nav-link {
                justify-content: center;
                padding: var(--spacing-3);
                border-left-color: transparent !important;
            }

            .app-sidebar:not(.open) .nav-link.active {
                background-color: var(--primary-color-light);
            }

            [data-theme="dark"] .app-sidebar:not(.open) .nav-link.active {
                background-color: rgba(var(--primary-color-rgb), 0.2);
            }
        }


        /*=============================================
=            KOMPONEN HEADER APLIKASI         =
=============================================*/
        .app-header {
            background-color: var(--card-bg-color);
            box-shadow: var(--card-shadow);
            padding: 0 var(--spacing-4);
            /* Padding kiri-kanan */
            height: var(--header-height);
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: background-color var(--transition-normal);
            width: 100%;
            /* Mengisi lebar #main-area-wrapper */
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
        }

        .sidebar-toggle-btn,
        /* Tombol untuk sidebar desktop/tablet collapsed/full */
        .theme-toggle-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-color-muted);
            width: 40px;
            height: 40px;
            border-radius: var(--border-radius-full);
            display: inline-flex;
            justify-content: center;
            align-items: center;
            font-size: var(--font-size-lg);
            transition: var(--transition-normal);
        }

        .sidebar-toggle-btn:hover,
        .theme-toggle-btn:hover {
            background-color: var(--bg-color);
            border-color: var(--border-color-strong);
            color: var(--primary-color);
        }

        [data-theme="dark"] .sidebar-toggle-btn,
        [data-theme="dark"] .theme-toggle-btn {
            border-color: var(--border-color-strong);
        }

        [data-theme="dark"] .sidebar-toggle-btn:hover,
        [data-theme="dark"] .theme-toggle-btn:hover {
            background-color: var(--card-bg-color);
            border-color: var(--border-color);
        }

        /* Badge Notifikasi di Header */
        .header-actions .badge {
            background-color: var(--danger-color);
            color: var(--bg-color-alt);
            font-size: var(--font-size-xs);
            padding: var(--spacing-px) var(--spacing-1);
            border-radius: var(--border-radius-full);
            font-weight: var(--font-weight-bold);
            line-height: 1;
            min-width: 18px;
            text-align: center;
            position: absolute;
            /* Relatif terhadap tombol notifikasi */
            top: -5px;
            right: -5px;
        }

        .notification-btn-wrapper {
            position: relative;
            /* Untuk positioning badge */
        }


        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
        }


        /*=============================================
=            KONTEN UTAMA & LOADER            =
=============================================*/
        .main-content {
            flex-grow: 1;
            padding: var(--spacing-6);
            /* Padding lebih konsisten */
            transition: opacity 0.3s ease-in-out;
            background-color: var(--bg-color);
            /* Pastikan main-content punya BG sendiri */
        }

        @media (max-width: 767.98px) {
            .main-content {
                padding: var(--spacing-4);
            }
        }


        .page-container {
            animation: fadeInPage 0.5s ease-out;
        }

        @keyframes fadeInPage {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loader-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 300px;
            text-align: center;
            padding: var(--spacing-6);
        }

        .loader {
            border: 5px solid var(--bg-color);
            border-top: 5px solid var(--primary-color);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spinLoader 1s linear infinite;
        }

        @keyframes spinLoader {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .initial-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            opacity: 1;
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
        }

        .initial-loader .loader {
            width: 60px;
            height: 60px;
            border-width: 6px;
        }

        .initial-loader p {
            margin-top: var(--spacing-4);
            color: var(--text-color-muted);
            font-size: var(--font-size-lg);
        }

        /*=============================================
=               KOMPONEN KARTU (CARD)          =
=============================================*/
        .card {
            background-color: var(--card-bg-color);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--card-shadow);
            padding: var(--spacing-6);
            transition: var(--transition-normal);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: var(--card-shadow-hover);
        }

        .card-header {
            margin: calc(-1 * var(--spacing-6)) calc(-1 * var(--spacing-6)) var(--spacing-4) calc(-1 * var(--spacing-6));
            padding: var(--spacing-4) var(--spacing-6);
            border-bottom: 1px solid var(--border-color);
            background-color: var(--bg-color-alt);
        }

        [data-theme="dark"] .card-header {
            background-color: var(--bg-color);
        }

        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-1);
        }

        .card-subtitle {
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
            margin-top: calc(-1 * var(--spacing-1));
            display: block;
        }

        .card-body {
            font-size: var(--font-size-base);
        }

        .card-footer {
            margin: var(--spacing-4) calc(-1 * var(--spacing-6)) calc(-1 * var(--spacing-6)) calc(-1 * var(--spacing-6));
            padding: var(--spacing-3) var(--spacing-6);
            border-top: 1px solid var(--border-color);
            background-color: var(--bg-color-alt);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-2);
        }

        [data-theme="dark"] .card-footer {
            background-color: var(--bg-color);
        }

        .card.card-border-left {
            padding-left: calc(var(--spacing-6) + 5px);
            border-left-width: 5px;
            border-left-style: solid;
        }

        .card-info.card-border-left {
            border-left-color: var(--info-color);
        }

        .card-success.card-border-left {
            border-left-color: var(--success-color);
        }

        .card-warning.card-border-left {
            border-left-color: var(--warning-color);
        }

        .card-danger.card-border-left {
            border-left-color: var(--danger-color);
        }

        /*=============================================
=               KOMPONEN TOMBOL (BUTTON)      =
=============================================*/
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-2);
            padding: var(--spacing-2) var(--spacing-4);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            border-radius: var(--border-radius-md);
            border: 1px solid transparent;
            transition: var(--transition-fast);
            text-decoration: none;
            line-height: 1.5;
            user-select: none;
            white-space: nowrap;
        }

        .btn:focus-visible {
            outline-offset: 1px;
            box-shadow: 0 0 0 2px var(--bg-color), 0 0 0 4px var(--primary-color);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn i,
        .btn .fas,
        .btn .far,
        .btn .fab {
            font-size: 1.1em;
            line-height: 1;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--bg-color-alt);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: var(--primary-color-hover);
            border-color: var(--primary-color-hover);
            color: var(--bg-color-alt);
            text-decoration: none;
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--bg-color-alt);
            border-color: var(--secondary-color);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-color-hover);
            border-color: var(--secondary-color-hover);
            color: var(--bg-color-alt);
            text-decoration: none;
        }

        .btn-outline-primary {
            background-color: transparent;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            background-color: var(--primary-color-light);
            color: var(--primary-color-dark-text);
            text-decoration: none;
        }

        [data-theme="dark"] .btn-outline-primary:hover {
            background-color: rgba(var(--primary-color-rgb), 0.15);
            color: var(--primary-color);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: var(--bg-color-alt);
            border-color: var(--danger-color);
        }

        .btn-danger:hover {
            background-color: var(--danger-color-hover);
            border-color: var(--danger-color-hover);
            color: var(--bg-color-alt);
            text-decoration: none;
        }

        .btn-sm {
            padding: var(--spacing-1) var(--spacing-2);
            font-size: var(--font-size-sm);
        }

        .btn-lg {
            padding: var(--spacing-3) var(--spacing-6);
            font-size: var(--font-size-lg);
        }

        .btn-block {
            width: 100%;
            display: flex;
        }

        .btn-icon-only {
            padding: var(--spacing-2);
            width: calc(var(--font-size-base) * 1.5 + var(--spacing-2) * 2);
            height: calc(var(--font-size-base) * 1.5 + var(--spacing-2) * 2);
            gap: 0;
        }

        .btn-icon-only i {
            margin: 0;
            font-size: 1.2em;
        }

        /*=============================================
=                KOMPONEN FORMULIR            =
=============================================*/
        .form-group {
            margin-bottom: var(--spacing-4);
        }

        .form-label {
            display: block;
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--spacing-1);
            color: var(--text-color);
            font-size: var(--font-size-sm);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: var(--spacing-2) var(--spacing-3);
            font-size: var(--font-size-base);
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--input-bg-color);
            background-clip: padding-box;
            border: 1px solid var(--input-border-color);
            appearance: none;
            border-radius: var(--border-radius-md);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: 0;
            box-shadow: 0 0 0 3px var(--focus-ring-color);
        }

        .form-control::placeholder {
            color: var(--text-color-subtle);
            opacity: 1;
        }

        textarea.form-control {
            min-height: calc(1.5em * 3 + (var(--spacing-2) * 2) + 2px);
            resize: vertical;
        }

        /* Custom Select with FontAwesome Icon */
        .select-wrapper {
            position: relative;
        }

        select.form-control {
            padding-right: var(--spacing-8);
            /* Ruang untuk ikon */
        }

        .select-wrapper::after {
            /* Ikon dropdown */
            content: "\f078";
            /* FontAwesome chevron-down */
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            /* Solid icon */
            position: absolute;
            top: 50%;
            right: var(--spacing-3);
            transform: translateY(-50%);
            pointer-events: none;
            /* Agar tidak mengganggu klik select */
            color: var(--text-color-muted);
            font-size: var(--font-size-sm);
        }

        [data-theme="dark"] .select-wrapper::after {
            color: var(--text-color-subtle);
        }


        .form-check {
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            margin-bottom: var(--spacing-2);
        }

        .form-check-input {
            /* Sembunyikan input asli, tapi tetap aksesibel */
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
        }

        .form-check-label {
            font-weight: var(--font-weight-normal);
            color: var(--text-color);
            cursor: pointer;
            font-size: var(--font-size-base);
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-2);
            position: relative;
            /* Untuk custom checkbox/radio */
        }

        /* Custom Checkbox/Radio Box */
        .form-check-label::before {
            content: "";
            display: inline-block;
            width: 1.25em;
            height: 1.25em;
            border: 1px solid var(--input-border-color);
            background-color: var(--input-bg-color);
            border-radius: var(--border-radius-sm);
            transition: var(--transition-fast);
            flex-shrink: 0;
        }

        .form-check-input[type="radio"]+.form-check-label::before {
            border-radius: 50%;
            /* Bulat untuk radio */
        }

        /* Custom Checkbox/Radio Icon (Checked State) */
        .form-check-label::after {
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
            /* Solid icons */
            position: absolute;
            left: 0.3em;
            /* Penyesuaian posisi ikon */
            top: 50%;
            transform: translateY(-50%) scale(0);
            /* Sembunyikan awal */
            transition: transform var(--transition-fast);
            color: var(--bg-color-alt);
            /* Warna ikon centang/dot */
            font-size: 0.75em;
            /* Ukuran ikon dalam box */
        }

        .form-check-input[type="checkbox"]+.form-check-label::after {
            content: "\f00c";
            /* fa-check */
        }

        .form-check-input[type="radio"]+.form-check-label::after {
            content: "\f111";
            /* fa-circle (sebagai dot) */
            font-size: 0.6em;
            /* Dot lebih kecil */
            left: 0.325em;
            /* Posisi dot sedikit beda */
        }

        /* Checked State Styling */
        .form-check-input:checked+.form-check-label::before {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .form-check-input:checked+.form-check-label::after {
            transform: translateY(-50%) scale(1);
            /* Tampilkan ikon saat checked */
        }

        /* Focus State untuk custom checkbox/radio */
        .form-check-input:focus-visible+.form-check-label::before {
            outline: 2px solid var(--primary-color);
            outline-offset: 1px;
            box-shadow: 0 0 0 3px var(--focus-ring-color);
        }

        .form-text {
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
            margin-top: var(--spacing-1);
            display: block;
        }

        .alert {
            padding: var(--spacing-3) var(--spacing-4);
            margin-bottom: var(--spacing-4);
            border: 1px solid transparent;
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            gap: var(--spacing-2);
            font-size: var(--font-size-sm);
        }

        .alert i,
        .alert .fas {
            font-size: var(--font-size-lg);
            flex-shrink: 0;
        }

        .alert-success {
            color: var(--success-color-hover);
            background-color: var(--success-color-light);
            border-color: var(--success-color);
        }

        [data-theme="dark"] .alert-success {
            color: var(--text-color);
            background-color: rgba(var(--success-color-rgb), 0.25);
            border-color: var(--success-color);
        }

        .alert-danger {
            color: var(--danger-color-hover);
            background-color: var(--danger-color-light);
            border-color: var(--danger-color);
        }

        [data-theme="dark"] .alert-danger {
            color: var(--text-color);
            background-color: rgba(var(--danger-color-rgb), 0.25);
            border-color: var(--danger-color);
        }

        .alert-info {
            color: var(--info-color-hover);
            background-color: var(--info-color-light);
            border-color: var(--info-color);
        }

        [data-theme="dark"] .alert-info {
            color: var(--text-color);
            background-color: rgba(var(--info-color-rgb), 0.25);
            border-color: var(--info-color);
        }

        /*=============================================
=               GRID SYSTEM SEDERHANA         =
=============================================*/
        .grid {
            display: grid;
            gap: var(--spacing-6);
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, minmax(0, 1fr));
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }

        /* Span (contoh) */
        .col-span-2 {
            grid-column: span 2 / span 2;
        }

        @media (max-width: 1023.98px) {

            /* Tablet (md) */
            .md-grid-cols-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .md-grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .md-grid-cols-3 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (max-width: 767.98px) {

            /* Mobile (sm) */
            .grid {
                gap: var(--spacing-4);
            }

            .sm-grid-cols-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .sm-grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }


        /*=============================================
=            FOOTER APLIKASI                  =
=============================================*/
        .app-footer {
            background-color: var(--card-bg-color);
            color: var(--text-color-muted);
            padding: var(--spacing-4) 0;
            /* Padding lebih kecil dari sebelumnya */
            text-align: center;
            font-size: var(--font-size-sm);
            border-top: 1px solid var(--border-color);
            /* Dihapus margin-top: auto; karena #main-area-wrapper sekarang flex-column */
            transition: background-color var(--transition-normal), color var(--transition-normal), border-color var(--transition-normal);
        }

        [data-theme="dark"] .app-footer {
            background-color: var(--bg-color);
        }

        .app-footer p {
            margin-bottom: var(--spacing-1);
            line-height: var(--line-height-normal);
        }

        .app-footer p:last-child {
            margin-bottom: 0;
        }

        .app-footer .fas.fa-heart {
            color: var(--danger-color);
            transition: color var(--transition-fast);
        }

        .app-footer .fas.fa-mug-hot {
            color: var(--accent-color);
            transition: color var(--transition-fast);
        }

        /*=============================================
=            HALAMAN SPESIFIK (CONTOH)        =
=============================================*/
        /* Halaman Dashboard (Stat Cards) */
        .stat-card {
            text-align: center;
            padding: var(--spacing-4);
            /* Padding lebih kecil untuk stat card */
        }

        .stat-card .stat-icon {
            font-size: var(--font-size-3xl);
            margin-bottom: var(--spacing-3);
            display: block;
        }

        .stat-card .stat-value {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            color: var(--text-color);
            display: block;
            margin-bottom: var(--spacing-1);
        }

        .stat-card .stat-label {
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
        }

        /* Halaman Apartemen (Listing Cards) */
        .apartment-card {
            display: flex;
            flex-direction: column;
        }

        .apartment-card .card-img-top {
            width: 100%;
            height: 200px;
            /* Tinggi gambar tetap */
            object-fit: cover;
            /* Pastikan gambar terisi baik */
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
            background-color: var(--border-color);
            /* Placeholder jika gambar tidak ada */
        }

        .apartment-card .card-body {
            flex-grow: 1;
            /* Agar body mengisi sisa ruang */
            display: flex;
            flex-direction: column;
        }

        .apartment-card .details {
            display: flex;
            justify-content: space-between;
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
            margin-bottom: var(--spacing-3);
            gap: var(--spacing-2);
            flex-wrap: wrap;
            /* Jika terlalu banyak detail */
        }

        .apartment-card .details span {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-1);
        }

        .apartment-card .price {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--primary-color);
            margin-top: auto;
            /* Dorong harga dan tombol ke bawah */
            margin-bottom: var(--spacing-3);
        }

        .apartment-search-filter {
            margin-bottom: var(--spacing-6);
            display: flex;
            gap: var(--spacing-3);
        }

        .apartment-search-filter .form-control {
            max-width: 400px;
            /* Batasi lebar input pencarian */
        }


        /* Halaman Notifikasi (dari kode asli, disesuaikan sedikit) */
        .notification-filters {
            margin-bottom: var(--spacing-6);
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-3);
            align-items: center;
        }

        .notification-filters .form-control {
            width: auto;
            min-width: 180px;
            display: inline-block;
        }

        .notification-item {
            display: flex;
            gap: var(--spacing-4);
            align-items: flex-start;
            border: none;
            padding: var(--spacing-4);
            border-bottom: 1px solid var(--border-color);
            border-radius: 0;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item .icon-wrapper {
            font-size: var(--font-size-xl);
            padding-top: var(--spacing-px);
            flex-shrink: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--border-radius-full);
        }

        .notification-item .icon-wrapper.type-info {
            background-color: var(--info-color-light);
            color: var(--info-color);
        }

        .notification-item .icon-wrapper.type-success {
            background-color: var(--success-color-light);
            color: var(--success-color);
        }

        .notification-item .icon-wrapper.type-warning {
            background-color: var(--warning-color-light);
            color: var(--warning-color);
        }

        .notification-item .icon-wrapper.type-danger {
            background-color: var(--danger-color-light);
            color: var(--danger-color);
        }

        .notification-item .content {
            flex-grow: 1;
        }

        .notification-item .content h5 {
            margin-bottom: var(--spacing-1);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-semibold);
        }

        .notification-item .content p {
            font-size: var(--font-size-sm);
            color: var(--text-color-muted);
            line-height: var(--line-height-normal);
        }

        .notification-item .meta {
            font-size: var(--font-size-xs);
            color: var(--text-color-subtle);
            margin-top: var(--spacing-2);
        }

        .notification-item.unread {
            background-color: var(--primary-color-light);
            border-left: 3px solid var(--primary-color);
        }

        .notification-item.unread .content h5 {
            font-weight: var(--font-weight-bold);
        }

        [data-theme="dark"] .notification-item.unread {
            background-color: rgba(var(--primary-color-rgb), 0.15);
            border-left-color: var(--primary-color);
        }

        .notification-item .actions {
            margin-left: auto;
            padding-left: var(--spacing-3);
            display: flex;
            align-items: center;
        }

        /* Halaman Kontak (dari kode asli) */
        .contact-form-container {
            max-width: 700px;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <!-- Shell Aplikasi Utama (Struktur Dasar SPA) -->
    <div id="app-shell">

        <!-- Sidebar Aplikasi -->
        <aside class="app-sidebar" id="app-sidebar" aria-label="Navigasi Utama Aplikasi">
            <div class="sidebar-header">
                <i class="fas fa-building-user sidebar-logo-icon" aria-hidden="true"></i>
                <span class="sidebar-logo-text">Apartemen<span class="sidebar-logo-highlight">OS</span></span>
            </div>
            <div class="sidebar-profile">
                <img src="https://via.placeholder.com/48/6366f1/FFFFFF?text=U" alt="Foto Profil Pengguna"
                    class="sidebar-profile-img" id="sidebar-profile-img-el">
                <div class="sidebar-profile-info">
                    <span class="name" id="sidebar-profile-name-el">Nama Pengguna</span>
                    <span class="role" id="sidebar-profile-role-el">Penyewa</span>
                </div>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item"><a href="#/dashboard" class="nav-link" data-route="dashboard"><i
                                class="fas fa-tachometer-alt fa-fw"></i> <span class="nav-text">Dashboard</span></a>
                    </li>
                    <li class="nav-item"><a href="#/profile" class="nav-link" data-route="profile"><i
                                class="fas fa-user-circle fa-fw"></i> <span class="nav-text">Profil</span></a></li>
                    <li class="nav-item"><a href="#/apartments" class="nav-link" data-route="apartments"><i
                                class="fas fa-city fa-fw"></i> <span class="nav-text">Apartemen</span></a></li>
                    <li class="nav-item"><a href="#/bookings" class="nav-link" data-route="bookings"><i
                                class="fas fa-calendar-check fa-fw"></i> <span class="nav-text">Booking</span></a></li>
                    <li class="nav-item"><a href="#/favorites" class="nav-link" data-route="favorites"><i
                                class="fas fa-heart fa-fw"></i> <span class="nav-text">Favorit</span></a></li>
                    <li class="nav-item"><a href="#/payments" class="nav-link" data-route="payments"><i
                                class="fas fa-credit-card fa-fw"></i> <span class="nav-text">Pembayaran</span></a></li>
                    <li class="nav-item"><a href="#/maintenance" class="nav-link" data-route="maintenance"><i
                                class="fas fa-tools fa-fw"></i> <span class="nav-text">Maintenance</span></a></li>
                    <li class="nav-item"><a href="#/messages" class="nav-link" data-route="messages"><i
                                class="fas fa-envelope fa-fw"></i> <span class="nav-text">Pesan</span>
                            <span class="badge d-none" id="messages-badge-count">0</span></a></li>
                    <li class="nav-item"><a href="#/notifications" class="nav-link" data-route="notifications"><i
                                class="fas fa-bell fa-fw"></i> <span class="nav-text">Notifikasi</span>
                            <span class="badge d-none" id="notif-badge-count-sidebar">0</span></a></li>
                </ul>
            </nav>
        </aside>
        <div class="sidebar-overlay" id="sidebar-overlay"></div>


        <!-- Wrapper untuk Header dan Konten Utama -->
        <div id="main-area-wrapper">
            <!-- Header Aplikasi -->
            <header class="app-header" role="banner">
                <div class="container header-container">
                    <div class="header-left">
                        <button id="sidebar-toggle-btn" class="sidebar-toggle-btn"
                            aria-label="Buka atau tutup navigasi sidebar" aria-expanded="false"
                            aria-controls="app-sidebar">
                            <i class="fas fa-bars" aria-hidden="true"></i>
                        </button>
                        <!-- Judul Halaman Dinamis bisa ditambahkan di sini jika perlu -->
                    </div>

                    <div class="header-actions">
                        <div class="notification-btn-wrapper">
                            <a href="#/notifications" class="theme-toggle-btn" aria-label="Lihat Notifikasi"
                                title="Notifikasi">
                                <i class="fas fa-bell" aria-hidden="true"></i>
                                <span class="badge d-none" id="notif-badge-count-header">0</span>
                            </a>
                        </div>
                        <button id="theme-toggle-btn" class="theme-toggle-btn" aria-label="Ganti Tema Aplikasi"
                            title="Ganti Tema">
                            <i class="fas fa-sun" aria-hidden="true"></i> <!-- Ikon akan berubah via JS -->
                        </button>
                    </div>
                </div>
            </header>

            <!-- Konten Utama (Dinamis, diisi oleh JavaScript Router) -->
            <main id="main-content" class="main-content" aria-live="polite" role="main">
                <!-- Konten halaman akan dimuat di sini. -->
            </main>

            <!-- Footer Aplikasi -->
            <footer class="app-footer" role="contentinfo">
                <div class="container">
                    <p>¬© <span id="current-year"></span> ApartemenOS. Semua hak cipta dilindungi.</p>
                    <p>Dirancang dengan <i class="fas fa-heart text-danger" aria-hidden="true"></i> dan <i
                            class="fas fa-mug-hot text-accent" aria-hidden="true"></i> menggunakan Vanilla HTML, CSS,
                        & JavaScript.</p>
                </div>
            </footer>
        </div> <!-- Akhir #main-area-wrapper -->
    </div> <!-- Akhir #app-shell -->

    <!-- Loader Awal Aplikasi (Full Screen) -->
    <div class="initial-loader" id="initial-app-loader" aria-hidden="false" aria-label="Memuat aplikasi">
        <div class="loader" role="status" aria-live="assertive">
            <span class="sr-only">Memuat...</span>
        </div>
        <p class="mt-4 text-muted fs-lg">Memuat Aplikasi ApartemenOS...</p>
    </div>

    <!-- Template untuk Item Notifikasi (Digunakan oleh JavaScript untuk Render Dinamis) -->
    <template id="notification-item-template">
        <div class="notification-item" role="listitem">
            <div class="icon-wrapper" aria-hidden="true">
                <i class=""></i> <!-- Kelas ikon dan warna diisi JS -->
            </div>
            <div class="content">
                <h5 class="card-title"></h5>
                <p class="card-text-message"></p>
                <div class="meta">
                    <span class="timestamp"></span> | <span class="category"></span>
                </div>
            </div>
            <div class="actions">
                <button class="btn btn-sm btn-icon-only btn-outline-primary mark-as-read"
                    title="Tandai sebagai sudah dibaca">
                    <i class="fas fa-check"></i>
                    <span class="sr-only">Tandai sebagai sudah dibaca</span>
                </button>
                <button class="btn btn-sm btn-icon-only btn-danger delete-notification" title="Hapus notifikasi">
                    <i class="fas fa-trash-alt"></i>
                    <span class="sr-only">Hapus notifikasi</span>
                </button>
            </div>
        </div>
    </template>


    <script>
        // Melakukan scope untuk menghindari polusi global dan mengaktifkan strict mode.
        (function () {
            'use strict';

            //=============================================
            //========= STATE APLIKASI & KONFIGURASI ======
            //=============================================
            const AppState = {
                currentTheme: localStorage.getItem('apartemenOSTheme') || 'light',
                activeRoute: '',
                isSidebarOpenMobile: false, // Untuk state sidebar di mobile
                isSidebarCollapsedDesktop: window.innerWidth < 1024, // Default collapsed di tablet
                userProfile: {
                    name: 'Jane Doe',
                    role: 'Penyewa Premium',
                    photoUrl: 'https://via.placeholder.com/48/4f46e5/FFFFFF?text=JD' // Ganti dengan URL gambar profil asli
                },
                dashboardStats: {
                    activeBookings: 2,
                    pendingPayments: 1,
                    maintenanceRequests: 0,
                    savedProperties: 5,
                },
                apartments: [
                    { id: 1, name: 'Apartemen Mewah Pusat Kota', imageUrl: 'https://via.placeholder.com/300x200/E0E7FF/4338CA?text=Apartemen+1', bedrooms: 2, bathrooms: 1, area: 75, price: 12000000, city: 'Jakarta', description: 'Apartemen modern dengan fasilitas lengkap di jantung kota.' },
                    { id: 2, name: 'Studio Nyaman Dekat Kampus', imageUrl: 'https://via.placeholder.com/300x200/D1FAE5/059669?text=Apartemen+2', bedrooms: 1, bathrooms: 1, area: 35, price: 5000000, city: 'Bandung', description: 'Studio ideal untuk mahasiswa, lokasi strategis dekat universitas.' },
                    { id: 3, name: 'Apartemen Keluarga View Laut', imageUrl: 'https://via.placeholder.com/300x200/FEF3C7/D97706?text=Apartemen+3', bedrooms: 3, bathrooms: 2, area: 120, price: 25000000, city: 'Surabaya', description: 'Pemandangan laut menakjubkan, cocok untuk keluarga besar.' },
                    { id: 4, name: 'Penthouse Eksklusif Rooftop Pool', imageUrl: 'https://via.placeholder.com/300x200/DBEAFE/2563EB?text=Apartemen+4', bedrooms: 4, bathrooms: 3, area: 250, price: 75000000, city: 'Jakarta', description: 'Kemewahan tertinggi dengan kolam renang pribadi di rooftop.' },
                    { id: 5, name: 'Apartemen Minimalis Green Living', imageUrl: 'https://via.placeholder.com/300x200/DCFCE7/16A34A?text=Apartemen+5', bedrooms: 2, bathrooms: 1, area: 60, price: 9000000, city: 'Tangerang', description: 'Konsep hunian hijau dengan taman vertikal dan hemat energi.' }
                ],
                currentApartmentSearchTerm: '',
                notifications: [ // Data notifikasi dari kode asli
                    { id: 1, title: 'Pembaruan Kebijakan Privasi', message: 'Kami telah memperbarui kebijakan privasi kami...', type: 'info', icon: 'fas fa-info-circle', timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000), category: 'Umum', unread: true },
                    { id: 2, title: 'Pembayaran Tagihan Berhasil', message: 'Pembayaran tagihan bulan Juli Anda...', type: 'success', icon: 'fas fa-check-circle', timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000), category: 'Keuangan', unread: false },
                    { id: 3, title: 'Perbaikan Lift Terjadwal', message: 'Lift di lobi utama akan dalam perbaikan...', type: 'warning', icon: 'fas fa-triangle-exclamation', timestamp: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000), category: 'Pemeliharaan', unread: true },
                ],
                nextNotificationId: 4,
                currentNotificationFilter: 'all',
                currentNotificationCategory: 'all',
                unreadMessagesCount: 2, // Contoh jumlah pesan belum dibaca
            };

            //=============================================
            //========= ELEMEN DOM YANG SERING DIGUNAKAN ==
            //=============================================
            const DOM = {
                html: document.documentElement,
                body: document.body,
                appShell: document.getElementById('app-shell'),
                appSidebar: document.getElementById('app-sidebar'),
                sidebarToggleBtn: document.getElementById('sidebar-toggle-btn'),
                sidebarOverlay: document.getElementById('sidebar-overlay'),
                sidebarProfileImg: document.getElementById('sidebar-profile-img-el'),
                sidebarProfileName: document.getElementById('sidebar-profile-name-el'),
                sidebarProfileRole: document.getElementById('sidebar-profile-role-el'),
                mainAreaWrapper: document.getElementById('main-area-wrapper'),
                header: document.querySelector('.app-header'),
                mainContent: document.getElementById('main-content'),
                themeToggleButton: document.getElementById('theme-toggle-btn'),
                allNavLinks: null, // Akan diisi di init
                currentYearSpan: document.getElementById('current-year'),
                initialAppLoader: document.getElementById('initial-app-loader'),
                notifBadgeCountHeader: document.getElementById('notif-badge-count-header'),
                notifBadgeCountSidebar: document.getElementById('notif-badge-count-sidebar'),
                messagesBadgeCount: document.getElementById('messages-badge-count'),
                notificationItemTemplate: document.getElementById('notification-item-template'),
            };
            DOM.allNavLinks = document.querySelectorAll('.app-sidebar .nav-link'); // Ambil link dari sidebar

            //=============================================
            //========= FUNGSI UTILITAS ===================
            //=============================================
            const Utils = {
                debounce: function (func, delay) {
                    let timeout;
                    return function (...args) {
                        clearTimeout(timeout);
                        timeout = setTimeout(() => func.apply(this, args), delay);
                    };
                },
                escapeHTML: function (str) {
                    if (str === null || typeof str === 'undefined') return '';
                    return String(str).replace(/[&<>"']/g, function (match) {
                        return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[match];
                    });
                },
                timeAgo: function (date) {
                    const now = new Date();
                    const seconds = Math.round((now - date) / 1000);
                    const minutes = Math.round(seconds / 60);
                    const hours = Math.round(minutes / 60);
                    const days = Math.round(hours / 24);
                    if (seconds < 5) return 'baru saja';
                    if (seconds < 60) return `${seconds} detik lalu`;
                    if (minutes < 60) return `${minutes} menit lalu`;
                    if (hours < 24) return `${hours} jam lalu`;
                    return `${days} hari lalu`;
                },
                formatCurrency: function (amount, currency = 'IDR') {
                    return new Intl.NumberFormat('id-ID', { style: 'currency', currency: currency, minimumFractionDigits: 0 }).format(amount);
                }
            };

            //=============================================
            //========= MANAJEMEN TEMA ====================
            //=============================================
            const ThemeManager = {
                init: function () {
                    this.applyTheme(AppState.currentTheme);
                    DOM.themeToggleButton.addEventListener('click', () => this.toggleTheme());
                    this._updateThemeButtonIcon(AppState.currentTheme);
                },
                applyTheme: function (theme) {
                    DOM.html.setAttribute('data-theme', theme);
                    AppState.currentTheme = theme;
                    localStorage.setItem('apartemenOSTheme', theme);
                    this._updateThemeButtonIcon(theme);
                },
                toggleTheme: function () {
                    const newTheme = AppState.currentTheme === 'light' ? 'dark' : 'light';
                    this.applyTheme(newTheme);
                },
                _updateThemeButtonIcon: function (theme) {
                    const iconElement = DOM.themeToggleButton.querySelector('i');
                    if (iconElement) {
                        iconElement.className = theme === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
                        DOM.themeToggleButton.setAttribute('aria-label', theme === 'dark' ? 'Ganti ke Tema Terang' : 'Ganti ke Tema Gelap');
                        DOM.themeToggleButton.title = theme === 'dark' ? 'Ganti ke Tema Terang' : 'Ganti ke Tema Gelap';
                    }
                }
            };

            //=============================================
            //========= MANAJEMEN SIDEBAR ===============
            //=============================================
            const SidebarManager = {
                init: function () {
                    this.renderUserProfile();
                    DOM.sidebarToggleBtn.addEventListener('click', () => this.toggleSidebar());
                    DOM.sidebarOverlay.addEventListener('click', () => this.closeSidebarMobile());

                    // Event listener untuk menutup sidebar mobile saat link di klik
                    DOM.allNavLinks.forEach(link => {
                        link.addEventListener('click', () => {
                            if (window.innerWidth < 768 && AppState.isSidebarOpenMobile) {
                                this.closeSidebarMobile();
                            }
                        });
                    });

                    // Inisialisasi state sidebar berdasarkan lebar layar
                    this.updateSidebarStateForWindowSize();
                    window.addEventListener('resize', Utils.debounce(() => this.updateSidebarStateForWindowSize(), 200));
                },

                renderUserProfile: function () {
                    DOM.sidebarProfileImg.src = Utils.escapeHTML(AppState.userProfile.photoUrl);
                    DOM.sidebarProfileImg.alt = `Foto profil ${Utils.escapeHTML(AppState.userProfile.name)}`;
                    DOM.sidebarProfileName.textContent = Utils.escapeHTML(AppState.userProfile.name);
                    DOM.sidebarProfileRole.textContent = Utils.escapeHTML(AppState.userProfile.role);
                },

                toggleSidebar: function () {
                    if (window.innerWidth < 768) { // Mode Mobile
                        AppState.isSidebarOpenMobile = !AppState.isSidebarOpenMobile;
                        if (AppState.isSidebarOpenMobile) {
                            DOM.appSidebar.classList.add('open');
                            DOM.sidebarOverlay.classList.add('active');
                            DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'true');
                        } else {
                            this.closeSidebarMobile();
                        }
                    } else { // Mode Tablet/Desktop
                        AppState.isSidebarCollapsedDesktop = !AppState.isSidebarCollapsedDesktop;
                        if (AppState.isSidebarCollapsedDesktop) {
                            DOM.appSidebar.classList.remove('open'); // Hapus 'open' untuk collapsed
                            DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'false');
                        } else {
                            DOM.appSidebar.classList.add('open'); // Tambah 'open' untuk full
                            DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'true');
                        }
                    }
                    this._updateSidebarToggleIcon();
                },

                closeSidebarMobile: function () {
                    AppState.isSidebarOpenMobile = false;
                    DOM.appSidebar.classList.remove('open');
                    DOM.sidebarOverlay.classList.remove('active');
                    DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'false');
                    this._updateSidebarToggleIcon();
                },

                updateSidebarStateForWindowSize: function () {
                    const isMobile = window.innerWidth < 768;
                    const isTablet = window.innerWidth >= 768 && window.innerWidth < 1024;

                    if (isMobile) {
                        // Jika sebelumnya sidebar desktop/tablet terbuka (full), tutup untuk mobile
                        if (!AppState.isSidebarCollapsedDesktop) {
                            // AppState.isSidebarCollapsedDesktop = true; // Anggap collapsed di mobile
                            // DOM.appSidebar.classList.remove('open');
                        }
                        // Pastikan sidebar mobile tertutup saat resize kecuali memang sengaja dibuka
                        if (!AppState.isSidebarOpenMobile) {
                            this.closeSidebarMobile();
                        }
                        DOM.appSidebar.classList.remove('open'); // Pastikan class 'open' tidak ada by default di mobile
                        DOM.mainAreaWrapper.style.marginLeft = '0';
                        DOM.mainAreaWrapper.style.width = '100%';

                    } else { // Tablet atau Desktop
                        // Tutup overlay jika ada
                        DOM.sidebarOverlay.classList.remove('active');
                        AppState.isSidebarOpenMobile = false; // Pastikan state mobile false

                        if (AppState.isSidebarCollapsedDesktop) {
                            DOM.appSidebar.classList.remove('open');
                            DOM.mainAreaWrapper.style.marginLeft = 'var(--sidebar-width-collapsed)';
                            DOM.mainAreaWrapper.style.width = 'calc(100% - var(--sidebar-width-collapsed))';
                            DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'false');
                        } else { // Sidebar full di desktop/tablet
                            DOM.appSidebar.classList.add('open');
                            DOM.mainAreaWrapper.style.marginLeft = 'var(--sidebar-width-desktop)';
                            DOM.mainAreaWrapper.style.width = 'calc(100% - var(--sidebar-width-desktop))';
                            DOM.sidebarToggleBtn.setAttribute('aria-expanded', 'true');
                        }
                    }
                    this._updateSidebarToggleIcon();
                },

                _updateSidebarToggleIcon: function () {
                    const iconElement = DOM.sidebarToggleBtn.querySelector('i');
                    let sidebarEffectivelyOpen = false;
                    if (window.innerWidth < 768) {
                        sidebarEffectivelyOpen = AppState.isSidebarOpenMobile;
                    } else {
                        sidebarEffectivelyOpen = !AppState.isSidebarCollapsedDesktop;
                    }

                    if (sidebarEffectivelyOpen) {
                        iconElement.classList.remove('fa-bars');
                        iconElement.classList.add('fa-times');
                        DOM.sidebarToggleBtn.setAttribute('aria-label', 'Tutup navigasi sidebar');
                    } else {
                        iconElement.classList.remove('fa-times');
                        iconElement.classList.add('fa-bars');
                        DOM.sidebarToggleBtn.setAttribute('aria-label', 'Buka navigasi sidebar');
                    }
                }
            };

            //=============================================
            //========= MANAJEMEN NOTIFIKASI ==============
            //=============================================
            const NotificationManager = {
                init: function () {
                    this.updateUnreadCountBadges();
                    this.updateUnreadMessageCountBadge(); // Untuk badge pesan
                },

                updateUnreadCountBadges: function () {
                    const unreadCount = AppState.notifications.filter(n => n.unread).length;
                    const badges = [DOM.notifBadgeCountHeader, DOM.notifBadgeCountSidebar];

                    badges.forEach(badge => {
                        if (badge) {
                            if (unreadCount > 0) {
                                badge.textContent = unreadCount > 99 ? '99+' : unreadCount.toString();
                                badge.classList.remove('d-none');
                            } else {
                                badge.classList.add('d-none');
                            }
                        }
                    });
                },

                updateUnreadMessageCountBadge: function () {
                    const unreadMessages = AppState.unreadMessagesCount; // Ambil dari state
                    if (DOM.messagesBadgeCount) {
                        if (unreadMessages > 0) {
                            DOM.messagesBadgeCount.textContent = unreadMessages > 99 ? '99+' : unreadMessages.toString();
                            DOM.messagesBadgeCount.classList.remove('d-none');
                        } else {
                            DOM.messagesBadgeCount.classList.add('d-none');
                        }
                    }
                },

                markAsRead: function (notificationId) {
                    const notification = AppState.notifications.find(n => n.id === notificationId);
                    if (notification && notification.unread) {
                        notification.unread = false;
                        this.updateUnreadCountBadges();
                        if (AppState.activeRoute === 'notifications') {
                            PageRenderer.notifications();
                        }
                    }
                },

                deleteNotification: function (notificationId) {
                    AppState.notifications = AppState.notifications.filter(n => n.id !== notificationId);
                    this.updateUnreadCountBadges();
                    if (AppState.activeRoute === 'notifications') {
                        PageRenderer.notifications();
                    }
                },

                addSampleNotification: function () {
                    const newNotif = {
                        id: AppState.nextNotificationId++,
                        title: "Contoh Notifikasi Baru",
                        message: "Ini adalah pesan notifikasi contoh yang ditambahkan secara dinamis untuk keperluan demo.",
                        type: ['info', 'success', 'warning', 'danger'][Math.floor(Math.random() * 4)],
                        icon: ['fas fa-info-circle', 'fas fa-check-circle', 'fas fa-triangle-exclamation', 'fas fa-shield-alt'][Math.floor(Math.random() * 4)],
                        timestamp: new Date(),
                        category: ['Umum', 'Penting', 'Update'][Math.floor(Math.random() * 3)],
                        unread: true
                    };
                    AppState.notifications.unshift(newNotif);
                    this.updateUnreadCountBadges();
                    if (AppState.activeRoute === 'notifications') {
                        PageRenderer.notifications();
                    }
                },

                getFilteredNotifications: function () {
                    return AppState.notifications.filter(n => {
                        const filterMatch = (AppState.currentNotificationFilter === 'all') ||
                            (AppState.currentNotificationFilter === 'unread' && n.unread) ||
                            (AppState.currentNotificationFilter === 'read' && !n.unread);
                        const categoryMatch = (AppState.currentNotificationCategory === 'all') ||
                            (n.category === AppState.currentNotificationCategory);
                        return filterMatch && categoryMatch;
                    }).sort((a, b) => b.timestamp - a.timestamp);
                }
            };

            //=============================================
            //========= RENDERER HALAMAN ==================
            //=============================================
            const PageRenderer = {
                _showLoader: function () {
                    DOM.mainContent.innerHTML = `
                    <div class="loader-container" role="status" aria-live="polite">
                        <div class="loader"><span class="sr-only">Memuat konten...</span></div>
                        <p class="mt-2 text-muted">Memuat konten halaman...</p>
                    </div>`;
                    DOM.mainContent.style.opacity = '0.5';
                },

                _hideLoader: function () {
                    DOM.mainContent.style.opacity = '1';
                },

                _renderPageStructure: function (pageTitle, contentHTML, pageSpecificId = '') {
                    document.title = `${pageTitle} | ApartemenOS`;
                    const pageContainerId = pageSpecificId ? ` id="${Utils.escapeHTML(pageSpecificId)}"` : '';
                    // Konten sekarang langsung masuk ke mainContent, tanpa .container tambahan di sini
                    DOM.mainContent.innerHTML = `<div class="page-container"${pageContainerId}>${contentHTML}</div>`;
                    this._hideLoader();
                    window.scrollTo(0, 0);
                    // DOM.mainContent.setAttribute('aria-label', `Konten halaman ${pageTitle} dimuat`);
                },

                dashboard: function () {
                    const stats = AppState.dashboardStats;
                    const content = `
                        <h1 class="mb-6">Dashboard</h1>
                        <div class="grid grid-cols-1 sm-grid-cols-2 md-grid-cols-4 gap-6">
                            <div class="card stat-card">
                                <i class="fas fa-calendar-check stat-icon text-primary"></i>
                                <span class="stat-value">${Utils.escapeHTML(stats.activeBookings)}</span>
                                <span class="stat-label">Booking Aktif</span>
                            </div>
                            <div class="card stat-card">
                                <i class="fas fa-file-invoice-dollar stat-icon text-danger"></i>
                                <span class="stat-value">${Utils.escapeHTML(stats.pendingPayments)}</span>
                                <span class="stat-label">Pembayaran Tertunda</span>
                            </div>
                            <div class="card stat-card">
                                <i class="fas fa-tools stat-icon text-warning"></i>
                                <span class="stat-value">${Utils.escapeHTML(stats.maintenanceRequests)}</span>
                                <span class="stat-label">Permintaan Maintenance</span>
                            </div>
                            <div class="card stat-card">
                                <i class="fas fa-heart stat-icon text-secondary"></i>
                                <span class="stat-value">${Utils.escapeHTML(stats.savedProperties)}</span>
                                <span class="stat-label">Properti Disimpan</span>
                            </div>
                        </div>
                        <div class="card mt-8">
                            <div class="card-header"><h3 class="card-title">Selamat Datang Kembali!</h3></div>
                            <div class="card-body">
                                <p>Ini adalah ringkasan aktivitas terbaru Anda. Gunakan menu di samping untuk navigasi lebih lanjut.</p>
                                <button id="addSampleNotificationHomeBtn" class="btn btn-outline-primary mt-4">Tambah Notifikasi Contoh</button>
                            </div>
                        </div>
                    `;
                    this._renderPageStructure('Dashboard', content, 'page-dashboard');
                    document.getElementById('addSampleNotificationHomeBtn')?.addEventListener('click', () => NotificationManager.addSampleNotification());
                },

                profile: function () {
                    const user = AppState.userProfile;
                    const content = `
                        <h1 class="mb-6">Profil Pengguna</h1>
                        <div class="card">
                            <div class="card-body d-flex flex-column align-center text-center">
                                <img src="${Utils.escapeHTML(user.photoUrl)}" alt="Foto ${Utils.escapeHTML(user.name)}" class="rounded-full shadow-md mb-4" style="width: 120px; height: 120px; border: 4px solid var(--primary-color-light);">
                                <h2>${Utils.escapeHTML(user.name)}</h2>
                                <p class="text-muted fs-lg mb-4">${Utils.escapeHTML(user.role)}</p>
                                <button class="btn btn-primary"><i class="fas fa-edit mr-2"></i> Edit Profil</button>
                            </div>
                        </div>
                        <div class="card mt-6">
                            <div class="card-header"><h3 class="card-title">Detail Informasi</h3></div>
                            <div class="card-body">
                                <p><strong>Email:</strong> ${Utils.escapeHTML(user.name.toLowerCase().replace(' ', '.'))}@example.com</p>
                                <p><strong>Telepon:</strong> +62 812 3456 7890</p>
                                <p><strong>Alamat Terdaftar:</strong> Jl. Apartemen Indah No. 1, Kota Metropolis</p>
                                <p>Fitur profil lengkap akan tersedia di versi mendatang.</p>
                            </div>
                        </div>
                    `;
                    this._renderPageStructure('Profil Pengguna', content, 'page-profile');
                },

                apartments: function () {
                    const searchTerm = AppState.currentApartmentSearchTerm.toLowerCase();
                    const filteredApartments = AppState.apartments.filter(apt =>
                        apt.name.toLowerCase().includes(searchTerm) ||
                        apt.city.toLowerCase().includes(searchTerm)
                    );

                    let apartmentsHTML = `
                        <div class="d-flex justify-between align-center mb-6 flex-wrap gap-4">
                            <h1>Daftar Apartemen</h1>
                            <div class="apartment-search-filter">
                                <input type="search" id="apartment-search-input" class="form-control" placeholder="Cari apartemen (nama/kota)..." value="${Utils.escapeHTML(AppState.currentApartmentSearchTerm)}">
                            </div>
                        </div>
                    `;

                    if (filteredApartments.length === 0) {
                        apartmentsHTML += `
                        <div class="card text-center py-6">
                            <i class="fas fa-search-minus fa-3x text-muted mb-4"></i>
                            <h3 class="text-muted">Apartemen Tidak Ditemukan</h3>
                            <p class="text-subtle">Tidak ada apartemen yang cocok dengan kriteria pencarian Anda.</p>
                        </div>`;
                    } else {
                        apartmentsHTML += '<div class="grid grid-cols-1 sm-grid-cols-2 md-grid-cols-3 gap-6">';
                        filteredApartments.forEach(apt => {
                            apartmentsHTML += `
                                <div class="card apartment-card">
                                    <img src="${Utils.escapeHTML(apt.imageUrl)}" alt="${Utils.escapeHTML(apt.name)}" class="card-img-top">
                                    <div class="card-body">
                                        <h3 class="card-title">${Utils.escapeHTML(apt.name)}</h3>
                                        <p class="text-muted fs-sm mb-2"><i class="fas fa-map-marker-alt mr-1"></i> ${Utils.escapeHTML(apt.city)}</p>
                                        <p class="fs-sm mb-3 text-subtle">${Utils.escapeHTML(apt.description.substring(0, 70))}...</p>
                                        <div class="details">
                                            <span><i class="fas fa-bed"></i> ${Utils.escapeHTML(apt.bedrooms)} KT</span>
                                            <span><i class="fas fa-bath"></i> ${Utils.escapeHTML(apt.bathrooms)} KM</span>
                                            <span><i class="fas fa-ruler-combined"></i> ${Utils.escapeHTML(apt.area)} m¬≤</span>
                                        </div>
                                        <p class="price">${Utils.formatCurrency(apt.price)}<span class="fs-sm text-muted fw-normal"> / bulan</span></p>
                                        <button class="btn btn-primary btn-block mt-auto" onclick="alert('Detail untuk ${Utils.escapeHTML(apt.name)} akan ditampilkan di sini.')"><i class="fas fa-info-circle mr-2"></i> Lihat Detail</button>
                                    </div>
                                </div>
                            `;
                        });
                        apartmentsHTML += '</div>';
                    }
                    this._renderPageStructure('Daftar Apartemen', apartmentsHTML, 'page-apartments');

                    const searchInput = document.getElementById('apartment-search-input');
                    if (searchInput) {
                        searchInput.addEventListener('input', Utils.debounce((e) => {
                            AppState.currentApartmentSearchTerm = e.target.value;
                            PageRenderer.apartments(); // Render ulang dengan filter
                        }, 300));
                    }
                },

                // Placeholder untuk halaman lain
                _renderPlaceholderPage: function (title, iconClass, message) {
                    const content = `
                        <div class="text-center py-8">
                            <i class="${iconClass} fa-5x text-muted mb-4"></i>
                            <h1>${Utils.escapeHTML(title)}</h1>
                            <p class="text-muted fs-lg mb-6">${Utils.escapeHTML(message)}</p>
                            <p class="text-subtle">Fitur ini sedang dalam pengembangan dan akan segera tersedia.</p>
                            <a href="#/dashboard" class="btn btn-primary mt-4"><i class="fas fa-arrow-left mr-2"></i> Kembali ke Dashboard</a>
                        </div>`;
                    this._renderPageStructure(title, content, `page-${title.toLowerCase().replace(' ', '-')}`);
                },

                bookings: function () { this._renderPlaceholderPage('Manajemen Booking', 'fas fa-calendar-alt', 'Kelola semua jadwal booking apartemen Anda.'); },
                favorites: function () { this._renderPlaceholderPage('Apartemen Favorit', 'fas fa-heart', 'Lihat daftar apartemen yang telah Anda simpan sebagai favorit.'); },
                payments: function () { this._renderPlaceholderPage('Riwayat Pembayaran', 'fas fa-history', 'Lacak semua transaksi dan riwayat pembayaran sewa Anda.'); },
                maintenance: function () { this._renderPlaceholderPage('Permintaan Maintenance', 'fas fa-tools', 'Ajukan dan pantau status permintaan perbaikan untuk unit Anda.'); },
                messages: function () { this._renderPlaceholderPage('Pusat Pesan', 'fas fa-comments', 'Komunikasi langsung dengan pemilik atau manajer properti.'); },


                notifications: function () { // Dari kode asli, sedikit modifikasi
                    this._showLoader();
                    const filteredNotifications = NotificationManager.getFilteredNotifications();
                    let notificationsHTML = `
                    <div class="d-flex justify-between align-center mb-4">
                        <div>
                            <h1 class="mb-1">Notifikasi</h1>
                            <p class="text-muted fs-sm">Semua pemberitahuan penting Anda.</p>
                        </div>
                        <button id="addSampleNotificationPageBtn" class="btn btn-sm btn-primary"><i class="fas fa-plus mr-1"></i> Tambah Contoh</button>
                    </div>
                    
                    <div class="card mb-6">
                        <div class="card-body notification-filters">
                            <div class="form-group mb-0 mr-3">
                                <label for="filter-type" class="form-label fs-xs fw-medium">Filter Status:</label>
                                <div class="select-wrapper">
                                    <select id="filter-type" class="form-control form-control-sm" style="width: auto; min-width: 150px;">
                                        <option value="all" ${AppState.currentNotificationFilter === 'all' ? 'selected' : ''}>Semua</option>
                                        <option value="unread" ${AppState.currentNotificationFilter === 'unread' ? 'selected' : ''}>Belum Dibaca</option>
                                        <option value="read" ${AppState.currentNotificationFilter === 'read' ? 'selected' : ''}>Sudah Dibaca</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group mb-0">
                                <label for="filter-category" class="form-label fs-xs fw-medium">Filter Kategori:</label>
                                 <div class="select-wrapper">
                                    <select id="filter-category" class="form-control form-control-sm" style="width: auto; min-width: 150px;">
                                        <option value="all" ${AppState.currentNotificationCategory === 'all' ? 'selected' : ''}>Semua Kategori</option>
                                        <option value="Umum" ${AppState.currentNotificationCategory === 'Umum' ? 'selected' : ''}>Umum</option>
                                        <option value="Keuangan" ${AppState.currentNotificationCategory === 'Keuangan' ? 'selected' : ''}>Keuangan</option>
                                        <option value="Pemeliharaan" ${AppState.currentNotificationCategory === 'Pemeliharaan' ? 'selected' : ''}>Pemeliharaan</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    `;

                    if (filteredNotifications.length === 0) {
                        notificationsHTML += `<div class="card text-center py-6"><i class="fas fa-bell-slash fa-3x text-muted mb-4"></i><h3 class="text-muted">Tidak ada notifikasi</h3><p class="text-subtle">Tidak ada notifikasi yang sesuai filter.</p></div>`;
                    } else {
                        notificationsHTML += '<div id="notification-list-container" role="list" class="card"><div class="card-body p-0">'; // Bungkus dalam card untuk konsistensi
                        filteredNotifications.forEach(notif => {
                            const templateNode = DOM.notificationItemTemplate.content.cloneNode(true);
                            const notifElement = templateNode.querySelector('.notification-item');
                            notifElement.dataset.id = notif.id;
                            if (notif.unread) notifElement.classList.add('unread');
                            else {
                                notifElement.classList.remove('unread');
                                const markReadBtn = notifElement.querySelector('.mark-as-read');
                                markReadBtn.innerHTML = '<i class="fas fa-envelope-open"></i><span class="sr-only">Tandai belum dibaca</span>';
                                markReadBtn.title = "Tandai sebagai belum dibaca";
                            }
                            const iconWrapper = notifElement.querySelector('.icon-wrapper');
                            iconWrapper.classList.add(`type-${notif.type}`);
                            iconWrapper.querySelector('i').className = Utils.escapeHTML(notif.icon);
                            notifElement.querySelector('.card-title').textContent = Utils.escapeHTML(notif.title);
                            notifElement.querySelector('.card-text-message').textContent = Utils.escapeHTML(notif.message);
                            notifElement.querySelector('.timestamp').textContent = Utils.timeAgo(notif.timestamp);
                            notifElement.querySelector('.category').textContent = Utils.escapeHTML(notif.category);
                            const srSummary = `${notif.title}, kategori ${notif.category}, ${Utils.timeAgo(notif.timestamp)}. ${notif.unread ? 'Belum dibaca.' : 'Sudah dibaca.'}`;
                            notifElement.setAttribute('aria-label', srSummary);
                            notificationsHTML += notifElement.outerHTML;
                        });
                        notificationsHTML += '</div></div>';
                    }
                    this._renderPageStructure('Notifikasi', notificationsHTML, 'page-notifications');
                    this._attachNotificationPageListeners();
                },

                _attachNotificationPageListeners: function () { // Dari kode asli
                    const container = document.getElementById('notification-list-container');
                    if (container) {
                        container.addEventListener('click', (event) => {
                            const targetButton = event.target.closest('button');
                            if (!targetButton) return;
                            const item = targetButton.closest('.notification-item');
                            if (!item) return;
                            const id = parseInt(item.dataset.id, 10);
                            if (targetButton.classList.contains('mark-as-read')) NotificationManager.markAsRead(id);
                            else if (targetButton.classList.contains('delete-notification') && confirm('Hapus notifikasi ini?')) NotificationManager.deleteNotification(id);
                        });
                    }
                    document.getElementById('filter-type')?.addEventListener('change', (e) => { AppState.currentNotificationFilter = e.target.value; PageRenderer.notifications(); });
                    document.getElementById('filter-category')?.addEventListener('change', (e) => { AppState.currentNotificationCategory = e.target.value; PageRenderer.notifications(); });
                    document.getElementById('addSampleNotificationPageBtn')?.addEventListener('click', () => NotificationManager.addSampleNotification());
                },

                notFound: function () {
                    const content = `
                    <div class="text-center py-8">
                        <i class="fas fa-exclamation-triangle fa-5x text-warning mb-4"></i>
                        <h1 class="text-danger mb-2">404 - Halaman Tidak Ditemukan</h1>
                        <p class="text-muted fs-lg mb-6">Maaf, halaman yang Anda minta tidak dapat ditemukan.</p>
                        <a href="#/dashboard" class="btn btn-primary btn-lg">Kembali ke Dashboard</a>
                    </div>`;
                    this._renderPageStructure('Halaman Tidak Ditemukan', content, 'page-notfound');
                }
            };

            //=============================================
            //========= ROUTER APLIKASI (SPA) =============
            //=============================================
            const AppRouter = {
                routes: {
                    '/': PageRenderer.dashboard.bind(PageRenderer), // Default ke dashboard
                    '/dashboard': PageRenderer.dashboard.bind(PageRenderer),
                    '/profile': PageRenderer.profile.bind(PageRenderer),
                    '/apartments': PageRenderer.apartments.bind(PageRenderer),
                    '/bookings': PageRenderer.bookings.bind(PageRenderer),
                    '/favorites': PageRenderer.favorites.bind(PageRenderer),
                    '/payments': PageRenderer.payments.bind(PageRenderer),
                    '/maintenance': PageRenderer.maintenance.bind(PageRenderer),
                    '/messages': PageRenderer.messages.bind(PageRenderer),
                    '/notifications': PageRenderer.notifications.bind(PageRenderer)
                },

                init: function () {
                    window.addEventListener('hashchange', () => this.handleRouteChange());
                    window.addEventListener('DOMContentLoaded', () => {
                        this.handleRouteChange();
                        if (DOM.initialAppLoader) {
                            DOM.initialAppLoader.style.opacity = '0';
                            DOM.initialAppLoader.addEventListener('transitionend', () => DOM.initialAppLoader.remove(), { once: true });
                        }
                    });
                },

                handleRouteChange: function () {
                    const rawPath = window.location.hash.slice(1) || '/';
                    // Bersihkan path dari parameter query jika ada (misal #/apartments?id=1)
                    const path = rawPath.split('?')[0];

                    AppState.activeRoute = path.split('/')[1] || 'dashboard';
                    if (AppState.activeRoute === '') AppState.activeRoute = 'dashboard';

                    PageRenderer._showLoader();
                    setTimeout(() => {
                        if (this.routes[path]) {
                            this.routes[path]();
                        } else {
                            PageRenderer.notFound();
                            AppState.activeRoute = 'notFound';
                        }
                        this.updateActiveNavLink();
                    }, 150); // Sedikit delay untuk UX
                },

                updateActiveNavLink: function () {
                    DOM.allNavLinks.forEach(link => {
                        link.classList.remove('active');
                        link.removeAttribute('aria-current');
                        const linkRoute = link.dataset.route;
                        if (linkRoute === AppState.activeRoute) {
                            link.classList.add('active');
                            link.setAttribute('aria-current', 'page');
                        }
                    });
                }
            };

            //=============================================
            //========= INISIALISASI APLIKASI =============
            //=============================================
            function initializeApp() {
                if (DOM.currentYearSpan) {
                    DOM.currentYearSpan.textContent = new Date().getFullYear().toString();
                }
                ThemeManager.init();
                SidebarManager.init(); // Harus sebelum AppRouter untuk state awal sidebar
                NotificationManager.init();
                AppRouter.init();

                console.info('Aplikasi ApartemenOS v1.0.0 berhasil dimuat.');
                console.log('Tema:', AppState.currentTheme, 'Sidebar Collapsed:', AppState.isSidebarCollapsedDesktop);
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initializeApp);
            } else {
                initializeApp();
            }

        })();
    </script>
</body>

</html>