<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <!-- [SOLUSI] Meta Tag Viewport: Ini adalah langkah pertama dan paling krusial untuk desain responsif.
    Ini memberitahu browser untuk mengatur lebar halaman sesuai dengan lebar layar perangkat dan mengatur skala awal ke 1.0. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Green Valley - Temukan Apartemen Sempurna Anda</title>
    <meta name="description"
        content="Telusuri ribuan daftar sewa terverifikasi dengan fasilitas lengkap, tur virtual, dan ulasan tepercaya." />
    <meta name="author" content="Green Valley" />
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè†</text></svg>">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* ==========================================================================
           1. SETTINGS - Variabel Global, Reset & Konfigurasi Dasar
        ========================================================================== */
        :root {
            --primary: #4361EE;
            --primary-dark: #3A56D4;
            --primary-light: #E9EFFE;
            --secondary: #F0F4FE;
            --foreground: #1E293B;
            --background: #FFFFFF;
            --muted: #F1F5F9;
            --muted-foreground: #64748B;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --border: #E2E8F0;
            --input: #E2E8F0;
            --radius: 0.5rem;
            --font-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            --shadow-focus: 0 0 0 3px var(--primary-light);
            --navbar-height: 65px;
            --container-max-width: 1280px;
        }

        /* [SOLUSI] Reset Universal & Box Sizing: Mengatur ulang margin/padding dan menerapkan box-sizing: border-box
        secara global. Ini mencegah padding dan border mempengaruhi ukuran total elemen, menyederhanakan kalkulasi layout. */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            color: var(--foreground);
            background-color: var(--background);
            /* [PENERAPAN] Meningkatkan line-height (tinggi baris) secara global untuk readability (keterbacaan) yang lebih baik, terutama pada perangkat mobile. */
            line-height: 1.7;
            /* [SOLUSI] Ukuran Font Dasar Relatif: Menggunakan 16px sebagai dasar (1rem) memungkinkan semua unit 'rem' di seluruh aplikasi
            untuk skala secara proporsional jika pengguna mengubah pengaturan font browser mereka. */
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body.no-scroll {
            overflow: hidden;
        }

        a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        a:hover,
        a:focus-visible {
            color: var(--primary-dark);
        }

        ul {
            list-style: none;
        }

        /* [SOLUSI] Gambar Responsif: max-width: 100% adalah aturan kunci untuk gambar.
        Ini memastikan gambar tidak pernah lebih lebar dari container induknya, mencegah overflow horizontal. */
        img {
            max-width: 100%;
            display: block;
        }

        button,
        input,
        select,
        textarea {
            font: inherit;
            color: inherit;
        }

        textarea {
            resize: vertical;
        }

        button {
            cursor: pointer;
            border: none;
            background-color: transparent;
            transition: background-color 0.2s ease, transform 0.1s ease, border-color 0.2s ease, opacity 0.2s ease, color 0.2s ease;
        }

        button:active:not(:disabled) {
            transform: scale(0.98);
        }

        button:disabled,
        input:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        :focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
            border-radius: var(--radius);
        }

        .page-wrapper {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ==========================================================================
           2. UTILITIES - Kelas Bantuan
        ========================================================================== */
        .container {
            width: 100%;
            max-width: var(--container-max-width);
            margin-left: auto;
            margin-right: auto;
            /* [SOLUSI] Padding Horizontal Relatif: Menggunakan 'rem' untuk padding memastikan ruang tepi
            konsisten di berbagai ukuran layar dan skala font. */
            padding: 0 1.5rem;
        }

        .d-none {
            display: none !important;
        }

        /* [SOLUSI] Utility Class untuk Tampilan Responsif: Kelas-kelas ini adalah cara deklaratif untuk menampilkan atau
        menyembunyikan elemen pada breakpoint tertentu, sebuah pola umum dalam framework seperti Bootstrap. */
        .d-lg-none {
            display: block;
        }

        .d-lg-block {
            display: none;
        }

        @media (min-width: 992px) {
            .d-lg-none {
                display: none !important;
            }

            .d-lg-block {
                display: block !important;
            }
        }

        .text-primary {
            color: var(--primary);
        }

        .font-semibold {
            font-weight: 600;
        }

        .text-center {
            text-align: center;
        }

        .text-warning {
            color: #FFCA28;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* ==========================================================================
           3. COMPONENTS - Blok UI yang Dapat Digunakan Kembali
        ========================================================================== */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            font-weight: 500;
            /* [PENERAPAN] Menambah padding (ruang internal) untuk 'breathing room' di dalam tombol, membuatnya lebih mudah diklik
            di layar sentuh dan terlihat lebih seimbang. */
            padding: 0.75rem 1.5rem;
            border: 1px solid transparent;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: var(--primary-dark);
        }

        .btn-outline {
            border-color: var(--border);
            background-color: var(--background);
            color: var(--foreground);
        }

        .btn-outline:hover:not(:disabled) {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        .btn-outline.active {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
            font-weight: 600;
        }

        .btn-ghost {
            background-color: transparent;
            color: var(--muted-foreground);
        }

        .btn-ghost:hover:not(:disabled) {
            background-color: var(--primary-light);
            color: var(--primary-dark);
        }

        .btn-lg {
            /* [PENERAPAN] Padding yang lebih besar untuk tombol varian 'lg' (large), memberikan 'breathing room' ekstra untuk tombol aksi utama. */
            padding: 1rem 2.5rem;
            font-size: 1.05rem;
        }

        .btn-small {
            padding: 0.25rem 0.75rem;
            font-size: 0.875rem;
        }

        /* [SOLUSI] Tombol Blok: Menggunakan `display: flex` dan `width: 100%` membuat tombol mengisi
        lebar kontainernya, sangat berguna di layout mobile. */
        .btn-block {
            display: flex;
            width: 100%;
        }

        .toast-container {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toast {
            width: 350px;
            /* [SOLUSI] Lebar Maksimum Relatif: `max-width: 90vw` memastikan toast tidak pernah keluar dari layar pada perangkat yang sangat sempit. */
            max-width: 90vw;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            color: white;
            box-shadow: var(--shadow-xl);
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(120%);
            animation: slideIn 0.5s forwards, slideOut 0.5s 4.5s forwards;
        }

        .toast.toast-success {
            background-color: var(--success);
        }

        .toast.toast-danger {
            background-color: var(--danger);
        }

        .toast.toast-warning {
            background-color: var(--warning);
        }

        .toast-icon {
            font-size: 1.5rem;
        }

        @keyframes slideIn {
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(120%);
                opacity: 0;
            }
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(4px);
            z-index: 5000;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: var(--background);
            border-radius: var(--radius);
            /* [PENERAPAN] Padding yang besar di dalam modal memberikan 'breathing room' yang cukup, memisahkan konten dari tepi dan membuatnya lebih fokus. */
            padding: 2.5rem;
            box-shadow: var(--shadow-xl);
            max-width: 500px;
            width: 100%;
            transform: scale(0.95);
            transition: transform 0.3s;
        }

        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            /* [PENERAPAN] Margin bawah yang signifikan menciptakan 'vertical rhythm', memberikan jeda visual yang jelas antara header dan body modal. */
            margin-bottom: 2rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close-btn {
            font-size: 1.5rem;
        }

        .modal-close-btn:hover {
            color: var(--foreground);
        }

        .navbar {
            position: sticky;
            top: 0;
            z-index: 1000;
            background-color: var(--background);
            border-bottom: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            height: var(--navbar-height);
        }

        .navbar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .navbar-logo {
            display: flex;
            align-items: center;
            font-weight: 700;
            font-size: 1.25rem;
            gap: 0.5rem;
            color: var(--primary);
        }

        /* [SOLUSI] Mobile-First Navigation: Menu navigasi disembunyikan secara default dan hanya akan muncul di layar besar (lihat media query di bawah). */
        .navbar-links {
            display: none;
        }

        .navbar-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* [SOLUSI] Navigasi Mobile (Hamburger Menu): Didesain untuk layar kecil. */
        .mobile-nav-toggle {
            font-size: 1.25rem;
        }

        .mobile-nav-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 41, 59, 0.5);
            z-index: 6000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .mobile-nav-sidebar.is-open {
            opacity: 1;
            visibility: visible;
        }

        .mobile-nav-container {
            position: absolute;
            top: 0;
            right: 0;
            width: 85%;
            max-width: 300px;
            height: 100%;
            background-color: white;
            box-shadow: var(--shadow-lg);
            transform: translateX(100%);
            transition: transform 0.3s ease-out;
            display: flex;
            flex-direction: column;
        }

        .mobile-nav-sidebar.is-open .mobile-nav-container {
            transform: translateX(0);
        }

        .mobile-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }

        .mobile-nav-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .mobile-nav-body {
            padding: 2rem 1.5rem;
            overflow-y: auto;
            flex-grow: 1;
        }

        .mobile-nav-body ul {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .mobile-nav-body a {
            font-weight: 500;
            font-size: 1.1rem;
            color: var(--foreground);
            display: block;
        }

        .mobile-nav-body a.active {
            color: var(--primary);
            font-weight: 600;
        }

        .mobile-nav-auth {
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        /* [SOLUSI] Struktur Kartu Fleksibel: Menggunakan `display: flex` dengan `flex-direction: column`
        memungkinkan konten di dalam kartu untuk tumbuh (`flex-grow: 1`) dan bagian footer kartu (`.property-details`)
        untuk selalu menempel di bagian bawah, menciptakan layout yang konsisten bahkan dengan tinggi konten yang berbeda. */
        .property-card {
            background-color: white;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .property-card:hover,
        .property-card:focus-within {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .property-image-container {
            position: relative;
            height: 12rem;
            background-color: var(--muted);
        }

        .property-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .property-tags {
            position: absolute;
            top: 0.75rem;
            left: 0.75rem;
            display: flex;
            gap: 0.5rem;
        }

        .property-tag {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            backdrop-filter: blur(4px);
            -webkit-backdrop-filter: blur(4px);
            padding: 0.25rem 0.625rem;
            border-radius: 999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .property-content {
            /* [PENERAPAN] Padding yang konsisten memberikan 'breathing room' di sekitar konten kartu. */
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .property-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            /* [PENERAPAN] Margin bawah yang pas menciptakan 'vertical rhythm'. */
            margin-bottom: 0.75rem;
        }

        .property-title {
            font-size: 1.125rem;
            font-weight: 600;
            line-height: 1.4;
        }

        .property-rating {
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            flex-shrink: 0;
            gap: 0.25rem;
        }

        .property-rating .fa-star {
            color: #FFCA28;
        }

        .property-rating .rating-count {
            color: var(--muted-foreground);
        }

        .property-location {
            display: flex;
            align-items: center;
            gap: 0.35rem;
            color: var(--muted-foreground);
            font-size: 0.875rem;
            /* [PENERAPAN] Margin bawah yang lebih besar menciptakan hierarki yang jelas. */
            margin-bottom: 1.5rem;
        }

        .property-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            /* [PENERAPAN] Padding atas dan border memberikan pemisahan visual yang tegas. `margin-top: auto` adalah kunci untuk mendorongnya ke bawah. */
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
            margin-top: auto;
        }

        .property-amenities {
            display: flex;
            gap: 1rem;
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        .property-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .property-price .price-period {
            font-size: 0.875rem;
            font-weight: 400;
            color: var(--muted-foreground);
        }

        .form-group {
            /* [PENERAPAN] Margin bawah yang konsisten antar grup form menciptakan 'vertical rhythm' yang teratur. */
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }

        /* [SOLUSI] Form Input Responsif: `width: 100%` membuat input mengisi kontainernya.
        Padding dengan unit 'rem' memastikan ukuran target sentuh yang baik di mobile. */
        .form-input,
        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-textarea {
            min-height: 120px;
        }

        .form-input:focus,
        .form-textarea:focus {
            border-color: var(--primary);
            box-shadow: var(--shadow-focus);
            outline: none;
        }

        .form-input.is-invalid,
        .form-textarea.is-invalid {
            border-color: var(--danger);
        }

        .form-input.is-invalid:focus,
        .form-textarea.is-invalid:focus {
            box-shadow: 0 0 0 3px color-mix(in srgb, var(--danger) 30%, transparent);
        }

        .error-message {
            color: var(--danger);
            font-size: 0.8rem;
            margin-top: 0.25rem;
            display: block;
            min-height: 1.2em;
        }

        .footer {
            background-color: var(--muted);
            border-top: 1px solid var(--border);
            /* [PENERAPAN] Margin atas yang besar memberikan jeda ('breathing room'). */
            margin-top: 5rem;
            /* [PENERAPAN] Padding vertikal yang luas memberikan banyak ruang di dalam footer. */
            padding: 4rem 0;
        }

        /* [SOLUSI] Footer Grid Responsif: Dimulai dengan 1 kolom di mobile, dan bertambah kolom di layar lebih besar (lihat media query). `gap` memastikan spasi yang konsisten. */
        .footer-grid {
            display: grid;
            grid-template-columns: 1fr;
            /* [PENERAPAN] Gap yang besar antar kolom footer membantu memisahkan setiap bagian informasi secara visual. */
            gap: 3rem;
        }

        .footer-section>* {
            margin-bottom: 0.75rem;
        }

        .footer-title {
            font-size: 1.25rem;
            /* [PENERAPAN] Margin bawah pada judul footer menciptakan 'vertical rhythm' dan hierarki. */
            margin-bottom: 1.5rem;
        }

        .footer-subtitle {
            margin-bottom: 1rem;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: var(--muted-foreground);
        }

        .footer-links a:hover {
            color: var(--primary);
        }

        /* [SOLUSI] Form Newsletter Responsif: `flex-direction: column` di mobile agar input dan tombol tersusun vertikal. */
        .newsletter-form {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .newsletter-form input {
            border-radius: var(--radius) !important;
            border-right: 1px solid var(--input) !important;
        }

        .newsletter-form button {
            border-radius: var(--radius) !important;
        }

        /* [SOLUSI] Flexbox untuk Alignment: Menggunakan flexbox untuk menyusun layout bottom footer, yang akan diubah menjadi `flex-direction: row` di layar besar. */
        .footer-bottom {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            /* [PENERAPAN] Margin atas dan padding atas memisahkan bagian copyright dari konten utama footer. */
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border);
            gap: 1rem;
        }

        .copyright {
            color: var(--muted-foreground);
            font-size: 0.875rem;
        }

        .footer-legal {
            display: flex;
            gap: 1.5rem;
            font-size: 0.875rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .testimonial-card {
            background-color: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            /* [PENERAPAN] Padding yang luas memberikan 'breathing room' sehingga kutipan terasa lebih penting dan mudah dibaca. */
            padding: 2rem;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .testimonial-text {
            color: var(--muted-foreground);
            margin-bottom: 1.5rem;
            flex-grow: 1;
            font-style: italic;
        }

        .testimonial-author {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: auto;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border);
        }

        .testimonial-author-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            object-fit: cover;
            background-color: var(--muted);
        }

        .testimonial-author-name {
            font-weight: 600;
        }

        .testimonial-author-title {
            font-size: 0.875rem;
            color: var(--muted-foreground);
        }

        .review-card {
            display: flex;
            gap: 1rem;
            padding: 1.5rem 0;
            border-bottom: 1px solid var(--border);
        }

        .review-card:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }

        .review-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-light);
            color: var(--primary);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            flex-shrink: 0;
        }

        .review-content {
            flex-grow: 1;
        }

        .review-header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.25rem;
            gap: 0.5rem;
        }

        .review-author {
            font-weight: 600;
        }

        .review-date {
            font-size: 0.8rem;
            color: var(--muted-foreground);
        }

        .star-rating {
            display: inline-flex;
            gap: 0.1rem;
        }

        .review-comment {
            color: var(--muted-foreground);
            margin-top: 0.5rem;
        }

        /* ==========================================================================
           4. PAGES & LAYOUT - Gaya Spesifik Halaman (MOBILE-FIRST)
        ========================================================================== */
        .main-content {
            min-height: calc(100vh - var(--navbar-height) - 250px);
        }

        .page-header {
            background-color: var(--muted);
            /* [PENERAPAN] Padding vertikal yang sangat besar menciptakan 'whitespace' yang luas. */
            padding: 4rem 0;
            text-align: center;
            border-bottom: 1px solid var(--border);
            /* [PENERAPAN] Margin bawah memastikan ada jeda yang cukup. */
            margin-bottom: 4rem;
        }

        /* [SOLUSI] Tipografi Responsif dengan `clamp()`: Ukuran font akan beradaptasi secara mulus di antara nilai minimum, ideal, dan maksimum,
        mencegah teks menjadi terlalu besar di layar besar atau terlalu kecil di layar mobile. */
        .page-title {
            font-size: clamp(2rem, 5vw, 3rem);
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        .page-subtitle {
            font-size: 1.1rem;
            max-width: 650px;
            margin: 0.75rem auto 0;
            color: var(--muted-foreground);
        }

        .hero {
            /* [PENERAPAN] Padding vertikal yang signifikan pada hero section menjadikannya fokus utama. */
            padding: 5rem 0;
            text-align: center;
        }

        .hero-title {
            font-size: clamp(2.25rem, 6vw, 3.5rem);
            line-height: 1.2;
        }

        .hero-description {
            font-size: 1.1rem;
            max-width: 650px;
            /* [PENERAPAN] Margin atas dan bawah yang tidak sama menciptakan 'vertical rhythm' yang dinamis. */
            margin: 1.5rem auto 3rem;
            color: var(--muted-foreground);
        }

        /* [SOLUSI] Form Pencarian Responsif: Dimulai sebagai `flex-direction: column` untuk mobile,
        sehingga setiap item pencarian menumpuk secara vertikal. */
        .search-form-container {
            background-color: var(--background);
            border-radius: var(--radius);
            box-shadow: var(--shadow-md);
            /* [PENERAPAN] Padding internal memberikan 'breathing room'. */
            padding: 1rem;
            display: flex;
            align-items: stretch;
            gap: 0.75rem;
            flex-direction: column;
        }

        .search-item {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid transparent;
            border-radius: var(--radius);
            transition: border-color 0.2s, box-shadow 0.2s, background-color 0.2s;
            background: var(--muted);
        }

        .search-item:focus-within,
        .search-item:hover {
            border-color: var(--primary);
            box-shadow: var(--shadow-focus);
            background-color: var(--background);
        }

        .search-item i.fa-solid {
            color: var(--primary);
            font-size: 1.1rem;
            flex-shrink: 0;
            width: 1.25rem;
            text-align: center;
        }

        .search-input-wrapper {
            flex: 1;
            min-width: 0;
        }

        .search-label {
            font-size: 0.75rem;
            color: var(--muted-foreground);
            font-weight: 500;
            margin-bottom: 0.1rem;
            display: block;
        }

        .search-input {
            width: 100%;
            background-color: transparent;
            border: none;
            outline: none;
            font-size: 0.95rem;
            font-weight: 500;
            padding: 0;
            color: var(--foreground);
            cursor: pointer;
        }

        input[type="date"].search-input {
            min-width: 130px;
        }

        .search-button {
            flex-shrink: 0;
            min-width: 120px;
            padding: 0 1.5rem;
            font-weight: 600;
        }

        .listings-section {
            /* [PENERAPAN] Padding vertikal yang besar memisahkan seksi ini dari elemen lain. */
            padding: 5rem 0;
        }

        .listings-header {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            align-items: flex-start;
            /* [PENERAPAN] Margin bawah memberikan jarak vertikal yang cukup. */
            margin-bottom: 2.5rem;
        }

        .section-title {
            font-size: 1.75rem;
            font-weight: 600;
        }

        .sort-select {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background-color: white;
            width: 100%;
        }

        .listings-container {
            display: grid;
            /* [PENERAPAN] Properti 'gap' adalah cara modern untuk menerapkan whitespace yang konsisten. */
            gap: 2rem;
        }

        /* [SOLUSI] Grid Layout Mobile-First: Dimulai dengan 1 kolom untuk kartu-kartu. */
        .property-grid,
        .testimonial-grid {
            display: grid;
            grid-template-columns: 1fr;
            /* [PENERAPAN] Gap antar kartu memastikan setiap kartu memiliki 'breathing room'. */
            gap: 2rem;
        }

        .load-more {
            text-align: center;
            /* [PENERAPAN] Margin atas memberikan jeda setelah grid properti. */
            margin-top: 3rem;
        }

        .no-results {
            padding: 4rem 1rem;
            text-align: center;
            color: var(--muted-foreground);
            border: 2px dashed var(--border);
            border-radius: var(--radius);
        }

        .no-results i {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        /* [SOLUSI] Sidebar Filter Mobile: Didesain sebagai overlay yang muncul dari samping di layar kecil. */
        .filter-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 41, 59, 0.5);
            z-index: 6000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .filter-sidebar.is-open {
            opacity: 1;
            visibility: visible;
        }

        .filter-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 85%;
            max-width: 320px;
            height: 100%;
            background-color: white;
            box-shadow: var(--shadow-lg);
            transform: translateX(-100%);
            transition: transform 0.3s ease-out;
            display: flex;
            flex-direction: column;
        }

        .filter-sidebar.is-open .filter-container {
            transform: translateX(0);
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .filter-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 0;
        }

        .filter-body {
            padding: 2rem 1.5rem;
            overflow-y: auto;
            flex-grow: 1;
        }

        .filter-group {
            margin-bottom: 2rem;
        }

        .filter-group-title {
            font-weight: 600;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--muted-foreground);
        }

        .filter-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
            padding: 1.5rem;
            border-top: 1px solid var(--border);
            background-color: var(--muted);
            flex-shrink: 0;
        }

        .range-slider-container {
            position: relative;
            height: 20px;
            margin-top: 1.5rem;
        }

        .range-slider {
            position: absolute;
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            pointer-events: none;
            margin: 0;
            top: 50%;
            transform: translateY(-50%);
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            pointer-events: auto;
            z-index: 2;
            position: relative;
        }

        .range-slider::-moz-range-thumb {
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            pointer-events: auto;
            border: none;
            z-index: 2;
            position: relative;
        }

        .slider-track-bg {
            position: absolute;
            width: 100%;
            height: 4px;
            background-color: var(--border);
            top: 50%;
            transform: translateY(-50%);
            border-radius: 2px;
        }

        .slider-track {
            position: absolute;
            height: 4px;
            background-color: var(--primary);
            top: 50%;
            transform: translateY(-50%);
            border-radius: 2px;
            z-index: 1;
        }

        .range-inputs {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.75rem;
        }

        .range-input {
            width: 48%;
            padding: 0.25rem 0.5rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            text-align: center;
            font-size: 0.9rem;
            background-color: var(--background);
            -moz-appearance: textfield;
        }

        .range-input::-webkit-outer-spin-button,
        .range-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .checkbox-group,
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            font-size: 0.9rem;
            padding: 0.5rem;
            border-radius: var(--radius);
            transition: background-color 0.2s;
            user-select: none;
        }

        .checkbox-label:has(input:checked) {
            background-color: var(--primary-light);
        }

        .checkbox-label:hover {
            background-color: var(--primary-light);
        }

        .checkbox-label input {
            accent-color: var(--primary);
        }

        .property-detail-page-wrapper {
            /* [PENERAPAN] Padding vertikal memastikan konten tidak menempel pada navbar atau footer. */
            padding: 3rem 0;
        }

        .property-detail-grid {
            display: grid;
            grid-template-columns: 1fr;
            /* [PENERAPAN] Gap yang besar menciptakan pemisahan yang jelas. */
            gap: 3rem;
        }

        .property-detail-header {
            margin-bottom: 2rem;
        }

        .property-detail-title {
            font-size: 2rem;
            line-height: 1.3;
            margin-bottom: 0.75rem;
        }

        .property-detail-location {
            color: var(--muted-foreground);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .property-detail-gallery {
            margin-bottom: 2rem;
        }

        .property-detail-image {
            border-radius: var(--radius);
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 10;
            object-fit: cover;
            background-color: var(--muted);
        }

        .property-detail-section {
            /* [PENERAPAN] Margin atas yang konsisten menciptakan 'vertical rhythm' yang teratur. */
            margin-top: 3rem;
        }

        .property-detail-section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }

        /* [SOLUSI] Grid Adaptif dengan `auto-fit` dan `minmax`: Ini membuat grid item (fitur) secara otomatis
        membungkus ke baris baru ketika tidak ada cukup ruang, menciptakan layout yang sangat fleksibel tanpa perlu media query eksplisit. */
        .property-detail-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

        .feature {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            background: var(--muted);
            padding: 1rem;
            border-radius: var(--radius);
        }

        .feature i {
            font-size: 1.25rem;
            color: var(--primary);
            width: 24px;
            text-align: center;
        }

        .feature-value {
            font-weight: 600;
            display: block;
        }

        .feature-label {
            font-size: 0.8rem;
            color: var(--muted-foreground);
        }

        .amenities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 1rem;
        }

        .amenity-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        #map-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            border-radius: var(--radius);
            overflow: hidden;
            border: 1px solid var(--border);
            margin-bottom: 1rem;
            background-color: var(--muted);
        }

        #map-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }

        #reviews-section-container {
            margin-top: 3rem;
        }

        .add-review-form {
            background-color: var(--muted);
            padding: 2rem;
            border-radius: var(--radius);
            margin-top: 2rem;
        }

        .add-review-form .form-group:last-of-type {
            margin-bottom: 0;
        }

        /* [SOLUSI] Menyembunyikan elemen desktop di mobile. */
        .booking-card {
            display: none;
        }

        /* [SOLUSI] Mobile Booking Bar: Elemen `position: fixed` yang hanya muncul di layar kecil (`d-lg-none`).
        Ini memberikan akses cepat ke aksi utama tanpa harus menggulir. */
        .mobile-booking-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: var(--background);
            padding: 1rem;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 900;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }

        .mobile-booking-bar-price .price-period {
            font-size: 0.8rem;
            font-weight: 400;
            color: var(--muted-foreground);
        }

        .mobile-booking-bar-price .price-value {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
        }

        .mobile-booking-actions {
            display: flex;
            gap: 0.75rem;
        }

        .mobile-booking-actions .btn {
            padding: 0.75rem 1rem;
            font-size: 0.9rem;
        }

        /* [SOLUSI] Mencegah Tumpang Tindih: Menambahkan padding-bottom pada wrapper halaman detail.
        Ini menciptakan ruang kosong di bagian bawah halaman sehingga konten terakhir tidak akan tertutup oleh `mobile-booking-bar`. */
        .property-detail-page-wrapper {
            padding-bottom: 100px;
        }

        .agent-card {
            background: var(--muted);
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-top: 1.5rem;
            text-align: center;
        }

        .auth-page-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - var(--navbar-height));
            padding: 3rem 1rem;
            background-color: var(--muted);
        }

        .auth-card {
            background-color: var(--background);
            border-radius: var(--radius);
            /* [PENERAPAN] Padding yang luas memberikan 'breathing room' pada form. */
            padding: 2.5rem;
            box-shadow: var(--shadow-md);
            max-width: 450px;
            width: 100%;
            border: 1px solid var(--border);
        }

        .auth-header {
            text-align: center;
            /* [PENERAPAN] Margin bawah memisahkan header dari field form. */
            margin-bottom: 2.5rem;
        }

        .auth-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .auth-subtitle {
            color: var(--muted-foreground);
        }

        .payment-page-wrapper {
            padding: 3rem 0;
        }

        .payment-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2.5rem;
        }

        .payment-summary {
            padding: 2rem;
            background-color: var(--muted);
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .payment-methods {
            padding: 2rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
        }

        .tabs {
            display: flex;
            background: var(--muted);
            border-radius: var(--radius);
            padding: 4px;
        }

        .tabs .tab-btn {
            flex: 1;
            text-align: center;
            padding: 0.5rem;
            border-radius: var(--radius);
            font-weight: 500;
            font-size: 0.9rem;
        }

        .tabs .tab-btn.active {
            background: var(--background);
            box-shadow: var(--shadow-sm);
            color: var(--primary);
        }

        .tab-panel {
            display: none;
            padding: 2rem 0 0 0;
            animation: fadeIn 0.3s;
        }

        .tab-panel.active {
            display: block;
        }

        .ewallet-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .ewallet-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            transition: all 0.2s ease;
            gap: 0.5rem;
        }

        .ewallet-btn:hover {
            border-color: var(--primary);
            background-color: var(--primary-light);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .ewallet-btn img {
            height: 24px;
            max-width: 80px;
        }

        #payment-status-message {
            margin-top: 1.5rem;
            font-weight: 500;
            color: var(--muted-foreground);
            text-align: center;
        }

        .payment-method-icon {
            max-width: 180px;
            margin: 1.5rem auto;
            display: block;
        }

        .confirmation-page-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - var(--navbar-height));
            background-color: var(--muted);
        }

        .confirmation-card {
            text-align: center;
            max-width: 500px;
            padding: 2rem;
        }

        .confirmation-icon {
            font-size: 4rem;
            color: var(--success);
            margin-bottom: 1.5rem;
        }

        .confirmation-title {
            font-size: 2rem;
        }

        /* ==========================================================================
           5. RESPONSIVE - (MOBILE-FIRST APPROACH)
           Gaya di bawah ini hanya berlaku pada layar yang lebih besar dari breakpoint.
        ========================================================================== */
        @media (min-width: 480px) {
            .ewallet-options {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (min-width: 640px) {

            .property-grid,
            .testimonial-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .footer-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .listings-header {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .sort-select {
                width: auto;
            }

            .newsletter-form {
                flex-direction: row;
                gap: 0;
            }

            .newsletter-form input {
                border-radius: var(--radius) 0 0 var(--radius) !important;
                border-right: none !important;
            }

            .newsletter-form button {
                border-radius: 0 var(--radius) var(--radius) 0 !important;
            }
        }

        @media (min-width: 768px) {
            .search-form-container {
                flex-direction: row;
            }

            .footer-bottom {
                flex-direction: row;
                justify-content: space-between;
                text-align: left;
            }

            .payment-grid {
                grid-template-columns: 40% 1fr;
            }

            .payment-summary {
                position: sticky;
                top: calc(var(--navbar-height) + 1.5rem);
                height: fit-content;
            }

            .listings-container,
            .property-grid,
            .testimonial-grid {
                gap: 2.5rem;
            }
        }

        @media (min-width: 992px) {
            .container {
                padding: 0 2rem;
            }

            .navbar-links {
                display: block;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
            }

            .navbar-links ul {
                display: flex;
                gap: 2rem;
            }

            .navbar-links a {
                color: var(--muted-foreground);
                font-weight: 500;
                padding: 0.5rem 0;
                position: relative;
            }

            .navbar-links a:hover,
            .navbar-links a.active {
                color: var(--primary);
            }

            .navbar-links a::after {
                content: '';
                position: absolute;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 2px;
                background-color: var(--primary);
                transform: scaleX(0);
                transition: transform 0.3s ease;
            }

            .navbar-links a.active::after {
                transform: scaleX(1);
            }

            .mobile-nav-toggle {
                display: none;
            }

            .listings-container {
                grid-template-columns: 280px 1fr;
            }

            .filter-sidebar {
                display: block;
                position: static;
                width: auto;
                height: auto;
                background-color: transparent;
                opacity: 1;
                visibility: visible;
                z-index: auto;
            }

            .filter-container {
                position: sticky;
                top: calc(var(--navbar-height) + 1.5rem);
                transform: translateX(0);
                width: 100%;
                max-width: none;
                height: auto;
                max-height: calc(100vh - var(--navbar-height) - 3rem);
                border: 1px solid var(--border);
                border-radius: var(--radius);
                box-shadow: none;
            }

            .filter-header,
            #toggle-filter-btn {
                display: none;
            }

            .filter-actions {
                background-color: transparent;
                padding: 1.5rem 1.5rem 0.5rem;
                border-top: none;
            }

            .property-detail-grid {
                grid-template-columns: 2fr 1fr;
                gap: 3.5rem;
            }

            .property-detail-page-wrapper {
                padding-bottom: 3rem;
                /* Menghapus padding ekstra karena mobile bar disembunyikan */
            }

            .mobile-booking-bar {
                display: none;
            }

            .booking-card {
                display: block;
                position: sticky;
                top: calc(var(--navbar-height) + 1.5rem);
                background: var(--background);
                border-radius: var(--radius);
                border: 1px solid var(--border);
                padding: 2rem;
            }

            .footer-grid {
                grid-template-columns: 2fr 1fr 1fr 1.5fr;
                gap: 3rem;
            }
        }

        @media (min-width: 1280px) {

            .property-grid,
            .testimonial-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
</head>

<body>
    <!-- Sisa HTML dan JavaScript tidak diubah sesuai scope, karena solusi berfokus pada perbaikan CSS. -->
    <div id="app">
        <header id="navbar-container" class="navbar"></header>
        <main id="main-content" class="main-content"></main>
        <footer id="footer-container" class="footer"></footer>
    </div>
    <div id="toast-container" class="toast-container"></div>
    <div id="modal-container"></div>
    <div id="mobile-nav-sidebar-container"></div>
    <template id="navbar-template">
        <div class="container">
            <a href="#/" class="navbar-logo" aria-label="Beranda Green Valley">
                <i class="fa-solid fa-house-chimney-window"></i>
                <span>Green Valley</span>
            </a>
            <nav class="navbar-links">
                <ul>
                    <li><a href="#/search">Properti</a></li>
                    <li><a href="#/testimonials">Testimoni</a></li>
                    <li><a href="#/help">Bantuan</a></li>
                </ul>
            </nav>
            <div class="navbar-actions">
                <button id="mobile-nav-toggle" class="btn btn-ghost mobile-nav-toggle d-lg-none" aria-label="Buka Menu">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </div>
    </template>
    <template id="mobile-nav-template">
        <aside class="mobile-nav-sidebar" id="mobile-nav-sidebar" aria-labelledby="mobile-nav-title">
            <div class="mobile-nav-container">
                <div class="mobile-nav-header">
                    <h3 id="mobile-nav-title" class="mobile-nav-title">Menu</h3>
                    <button class="btn btn-ghost" id="close-mobile-nav-btn" aria-label="Tutup Menu"><i
                            class="fas fa-times"></i></button>
                </div>
                <div class="mobile-nav-body">
                    <nav>
                        <ul>
                            <li><a href="#/search">Properti</a></li>
                            <li><a href="#/testimonials">Testimoni</a></li>
                            <li><a href="#/help">Bantuan</a></li>
                        </ul>
                    </nav>
                    <div class="mobile-nav-auth"></div>
                </div>
            </div>
        </aside>
    </template>
    <template id="navbar-guest-template">
        <a href="#/login" class="btn btn-outline btn-small d-none d-lg-inline-flex">Masuk</a>
        <a href="#/register" class="btn btn-primary btn-small d-none d-lg-inline-flex">Daftar</a>
    </template>
    <template id="mobile-nav-guest-template">
        <a href="#/login" class="btn btn-outline btn-block">Masuk</a>
        <a href="#/register" class="btn btn-primary btn-block">Daftar</a>
    </template>
    <template id="navbar-user-template">
        <span class="d-none d-lg-block" style="color: var(--muted-foreground);">Halo, <strong data-field="name"
                class="font-semibold text-primary"></strong>!</span>
        <button id="logout-btn" class="btn btn-outline btn-small d-none d-lg-inline-flex" title="Keluar"><i
                class="fa-solid fa-right-from-bracket"></i> <span
                class="d-none d-lg-block sr-only">Keluar</span></button>
    </template>
    <template id="mobile-nav-user-template">
        <p style="text-align: center; color: var(--muted-foreground); margin-bottom: 0.5rem;">Selamat datang, <strong
                data-field="name" class="font-semibold text-primary"></strong>!</p>
        <button id="logout-btn-mobile" class="btn btn-outline btn-block">Keluar</button>
    </template>
    <template id="home-page-template">
        <div class="page-wrapper">
            <section class="hero">
                <div class="container">
                    <h1 class="hero-title">Temukan <span class="text-primary">Apartemen</span> Sempurna Anda</h1>
                    <p class="hero-description">Telusuri ribuan daftar sewa terverifikasi dengan fasilitas lengkap, tur
                        virtual, dan ulasan tepercaya.</p>
                    <form class="search-form-container" id="main-search-form">
                        <div class="search-item">
                            <i class="fa-solid fa-calendar-day"></i>
                            <div class="search-input-wrapper">
                                <label for="search-checkin" class="search-label">Tanggal</label>
                                <input type="date" id="search-checkin" class="search-input">
                            </div>
                        </div>
                        <div class="search-item">
                            <i class="fa-solid fa-clock"></i>
                            <div class="search-input-wrapper">
                                <label for="search-clock" class="search-label">Durasi</label>
                                <select id="search-clock" class="search-input">
                                    <option value="1">1 Bulan</option>
                                    <option value="2" selected>3 Bulan</option>
                                    <option value="3">6 Bulan</option>
                                    <option value="4">1 Tahun</option>
                                </select>
                            </div>
                        </div>
                        <div class="search-item">
                            <i class="fa-solid fa-users"></i>
                            <div class="search-input-wrapper">
                                <label for="search-guests" class="search-label">Tamu</label>
                                <select id="search-guests" class="search-input">
                                    <option value="1">1 orang</option>
                                    <option value="2" selected>2 orang</option>
                                    <option value="3">3 orang</option>
                                    <option value="4">4+ orang</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary search-button">
                            <i class="fa-solid fa-search"></i>
                            <span class="button-text">Cari</span>
                        </button>
                    </form>
                </div>
            </section>
            <section class="listings-section">
                <div class="container">
                    <div class="listings-container">
                        <aside class="filter-sidebar" id="filter-sidebar-listings" aria-labelledby="filter-title-label">
                        </aside>
                        <div class="property-list-container">
                            <header class="listings-header">
                                <h2 class="section-title">Properti Tersedia (<span class="results-count">0</span>)</h2>
                                <div style="display: flex; gap: 1rem; align-items: center;">
                                    <button id="toggle-filter-btn" class="btn btn-outline d-lg-none">
                                        <i class="fas fa-filter"></i>
                                        <span>Filter</span>
                                    </button>
                                    <select class="sort-select" id="sort-properties" aria-label="Urutkan properti">
                                        <option value="recommended">Urutkan: Rekomendasi</option>
                                        <option value="priceLowToHigh">Harga: Rendah ke Tinggi</option>
                                        <option value="priceHighToLow">Harga: Tinggi ke Rendah</option>
                                        <option value="highestRated">Rating Tertinggi</option>
                                        <option value="newest">Terbaru</option>
                                    </select>
                                </div>
                            </header>
                            <div class="property-grid" id="properties-container"></div>
                            <div id="no-results-message" class="no-results d-none">
                                <i class="fas fa-search-plus"></i>
                                <h3>Tidak Ada Hasil Ditemukan</h3>
                                <p>Coba ubah atau hapus beberapa filter Anda.</p>
                            </div>
                            <div class="load-more">
                                <button class="btn btn-outline btn-lg d-none" id="load-more-properties">Muat Lebih
                                    Banyak</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </template>
    <template id="filter-sidebar-template">
        <aside class="filter-sidebar" id="filter-sidebar">
            <div class="filter-container">
                <div class="filter-header">
                    <h3 class="filter-title" id="filter-title-label">Filter</h3>
                    <button class="btn btn-ghost" id="close-filter-btn" aria-label="Tutup Filter"><i
                            class="fas fa-times"></i></button>
                </div>
                <div class="filter-body">
                    <form id="filter-form">
                        <div class="filter-group">
                            <h4 class="filter-group-title">Rentang Harga (per bulan)</h4>
                            <div class="range-inputs">
                                <input type="text" class="range-input" id="min-price-input" readonly>
                                <span style="color: var(--muted-foreground);">-</span>
                                <input type="text" class="range-input" id="max-price-input" readonly>
                            </div>
                            <div class="range-slider-container">
                                <div class="slider-track-bg"></div>
                                <div class="slider-track"></div>
                                <input type="range" min="500000" max="10000000" value="500000" step="100000"
                                    class="range-slider" id="filter-min-price" aria-label="Harga Minimum">
                                <input type="range" min="500000" max="10000000" value="10000000" step="100000"
                                    class="range-slider" id="filter-max-price" aria-label="Harga Maksimum">
                            </div>
                        </div>
                        <div class="filter-group">
                            <h4 class="filter-group-title">Tipe Properti</h4>
                            <div class="checkbox-group" id="filter-property-type">
                                <label class="checkbox-label"><input type="checkbox" name="property-type"
                                        value="apartment">
                                    Apartemen</label>
                                <label class="checkbox-label"><input type="checkbox" name="property-type"
                                        value="studio">
                                    Studio</label>
                                <label class="checkbox-label"><input type="checkbox" name="property-type" value="house">
                                    Rumah</label>
                            </div>
                        </div>
                        <div class="filter-group">
                            <h4 class="filter-group-title">Kamar Tidur</h4>
                            <div class="button-group" id="filter-bedrooms">
                                <button type="button" class="btn btn-small btn-outline active"
                                    data-value="any">Semua</button>
                                <button type="button" class="btn btn-small btn-outline" data-value="0">Studio</button>
                                <button type="button" class="btn btn-small btn-outline" data-value="1">1</button>
                                <button type="button" class="btn btn-small btn-outline" data-value="2">2</button>
                                <button type="button" class="btn btn-small btn-outline" data-value="3+">3+</button>
                            </div>
                        </div>
                        <div class="filter-group">
                            <h4 class="filter-group-title">Fasilitas</h4>
                            <div class="checkbox-group" id="filter-amenities">
                                <label class="checkbox-label"><input type="checkbox" name="amenity"
                                        value="air-conditioning"> AC</label>
                                <label class="checkbox-label"><input type="checkbox" name="amenity" value="parking">
                                    Parkir</label>
                                <label class="checkbox-label"><input type="checkbox" name="amenity" value="pool"> Kolam
                                    Renang</label>
                                <label class="checkbox-label"><input type="checkbox" name="amenity"
                                        value="pets-allowed">
                                    Boleh Bawa Hewan</label>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="filter-actions">
                    <button type="reset" form="filter-form" class="btn btn-outline btn-block">Reset</button>
                    <button type="submit" form="filter-form" class="btn btn-primary btn-block">Terapkan</button>
                </div>
            </div>
        </aside>
    </template>
    <template id="property-card-template">
        <article class="property-card" tabindex="0" role="link">
            <div class="property-image-container">
                <img class="property-image" src="" alt="Gambar Properti" loading="lazy">
                <div class="property-tags"></div>
            </div>
            <div class="property-content">
                <div class="property-header">
                    <h3 class="property-title" data-field="title"></h3>
                    <div class="property-rating">
                        <i class="fas fa-star"></i>
                        <span data-field="rating"></span>
                        <span class="rating-count" data-field="reviewCount"></span>
                    </div>
                </div>
                <div class="property-location">
                    <i class="fas fa-map-marker-alt"></i>
                    <span class="location-text" data-field="location"></span>
                </div>
                <div class="property-details">
                    <div class="property-amenities">
                        <span><i class="fa-solid fa-bed"></i> <span data-field="beds"></span></span>
                        <span><i class="fa-solid fa-bath"></i> <span data-field="baths"></span></span>
                        <span><i class="fa-solid fa-ruler-combined"></i> <span data-field="sqft"></span> m¬≤</span>
                    </div>
                    <div class="property-price"><span data-field="price"></span><span class="price-period">/bulan</span>
                    </div>
                </div>
            </div>
        </article>
    </template>
    <template id="property-detail-page-template">
        <div class="page-wrapper property-detail-page-wrapper">
            <div class="container">
                <a href="#/search" class="btn btn-outline" id="back-to-listings-btn"><i class="fas fa-arrow-left"></i>
                    Kembali ke Daftar</a>
                <div class="property-detail-grid" style="margin-top: 2.5rem;">
                    <main class="property-detail-main">
                        <header class="property-detail-header">
                            <h1 class="property-detail-title" data-field="title"></h1>
                            <p class="property-detail-location"><i class="fas fa-map-marker-alt"></i> <span
                                    data-field="location"></span></p>
                        </header>
                        <section class="property-detail-gallery">
                            <img src="" alt="" class="property-detail-image" data-field="mainImage">
                        </section>
                        <section class="property-detail-section">
                            <h2 class="property-detail-section-title">Fitur Utama</h2>
                            <div class="property-detail-features">
                                <div class="feature"><i class="fas fa-bed"></i>
                                    <div><span class="feature-value" data-field="beds"></span><span
                                            class="feature-label">Kamar Tidur</span></div>
                                </div>
                                <div class="feature"><i class="fas fa-bath"></i>
                                    <div><span class="feature-value" data-field="baths"></span><span
                                            class="feature-label">Kamar Mandi</span></div>
                                </div>
                                <div class="feature"><i class="fas fa-ruler-combined"></i>
                                    <div><span class="feature-value" data-field="sqft"></span><span
                                            class="feature-label">Luas (m¬≤)</span></div>
                                </div>
                                <div class="feature"><i class="fas fa-star"></i>
                                    <div><span class="feature-value" data-field="rating"></span><span
                                            class="feature-label">Rating</span></div>
                                </div>
                            </div>
                        </section>
                        <section class="property-detail-section property-detail-description">
                            <h2 class="property-detail-section-title">Deskripsi</h2>
                            <p data-field="description" style="white-space: pre-wrap; color: var(--muted-foreground);">
                            </p>
                        </section>
                        <section class="property-detail-section property-detail-amenities">
                            <h2 class="property-detail-section-title">Fasilitas</h2>
                            <ul class="amenities-grid" data-field="amenitiesList"></ul>
                        </section>
                        <section class="property-detail-section property-detail-location">
                            <h2 class="property-detail-section-title">Lokasi Properti</h2>
                            <div id="map-container">
                                <iframe
                                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3988.830635545231!2d116.84733837496567!3d-1.272183998708171!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2df147321e111d4d%3A0x6b437f26feb3541c!2sGreen%20Valley!5e0!3m2!1sid!2sid!4v1716538965706!5m2!1sid!2sid"
                                    allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade">
                                </iframe>
                            </div>
                            <a href="https://www.google.com/maps/dir/?api=1&destination=-1.254521,116.8499133"
                                target="_blank" rel="noopener noreferrer" class="btn btn-primary"
                                style="display: inline-flex;">
                                <i class="fas fa-directions"></i> Dapatkan Arah
                            </a>
                        </section>
                        <div id="reviews-section-container"></div>
                    </main>
                    <aside class="property-detail-sidebar">
                        <div class="booking-card">
                            <div class="property-detail-price" style="margin-bottom: 1.5rem; font-size: 1.75rem;"><span
                                    data-field="price"></span>/bulan</div>
                            <button class="btn btn-primary btn-lg btn-block" id="rent-now-btn-desktop">Sewa
                                Sekarang</button>
                            <div class="agent-card">
                                <p style="font-size: 0.9rem; margin: 0 0 1rem 0; color: var(--muted-foreground);">Butuh
                                    Bantuan?</p>
                                <button class="btn btn-outline btn-block" id="contact-agent-btn-desktop"><i
                                        class="fas fa-comment-alt"></i> Hubungi Agen</button>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
            <div class="mobile-booking-bar d-lg-none">
                <div class="mobile-booking-bar-price">
                    <div class="price-value" data-field="price"></div>
                    <div class="price-period">/bulan</div>
                </div>
                <div class="mobile-booking-actions">
                    <button class="btn btn-outline" id="contact-agent-btn-mobile"><i class="fas fa-comment-alt"></i>
                        Hubungi Agen</button>
                    <button class="btn btn-primary" id="rent-now-btn-mobile">Sewa Sekarang</button>
                </div>
            </div>
        </div>
    </template>
    <template id="review-section-template">
        <section class="property-detail-section">
            <h2 class="property-detail-section-title">Ulasan (<span data-field="reviewCount">0</span>)</h2>
            <div id="review-list"></div>
            <div id="add-review-container"></div>
        </section>
    </template>
    <template id="add-review-form-template">
        <div class="add-review-form">
            <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">Tulis Ulasan Anda</h3>
            <form id="add-review-form" novalidate>
                <div class="form-group">
                    <label for="review-rating">Rating Anda</label>
                    <select id="review-rating" class="form-input" required>
                        <option value="">Pilih rating</option>
                        <option value="5">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ (Luar Biasa)</option>
                        <option value="4">‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ (Bagus)</option>
                        <option value="3">‚òÖ‚òÖ‚òÖ‚òÜ‚òÜ (Cukup)</option>
                        <option value="2">‚òÖ‚òÖ‚òÜ‚òÜ‚òÜ (Kurang)</option>
                        <option value="1">‚òÖ‚òÜ‚òÜ‚òÜ‚òÜ (Buruk)</option>
                    </select>
                    <div class="error-message"></div>
                </div>
                <div class="form-group">
                    <label for="review-comment">Ulasan Anda</label>
                    <textarea id="review-comment" class="form-textarea" placeholder="Bagikan pengalaman Anda..."
                        required minlength="10"></textarea>
                    <div class="error-message"></div>
                </div>
                <button type="submit" class="btn btn-primary">Kirim Ulasan</button>
            </form>
        </div>
    </template>
    <template id="review-card-template">
        <div class="review-card">
            <div class="review-avatar" data-field="initials"></div>
            <div class="review-content">
                <div class="review-header">
                    <span class="review-author" data-field="author"></span>
                    <span class="review-date" data-field="date"></span>
                </div>
                <div class="star-rating text-warning" data-field="rating"></div>
                <p class="review-comment" data-field="comment"></p>
            </div>
        </div>
    </template>
    <template id="testimonials-page-template">
        <div class="page-wrapper">
            <header class="page-header">
                <div class="container">
                    <h1 class="page-title">Apa Kata Mereka?</h1>
                    <p class="page-subtitle">Dengarkan pengalaman dari para penyewa yang telah menemukan hunian impian
                        mereka melalui Green Valley.</p>
                </div>
            </header>
            <div class="container" style="padding-bottom: 5rem;">
                <div class="testimonial-grid" id="testimonials-container"></div>
            </div>
        </div>
    </template>
    <template id="testimonial-card-template">
        <div class="testimonial-card">
            <p class="testimonial-text" data-field="text"></p>
            <div class="testimonial-author">
                <img src="" alt="Avatar" class="testimonial-author-avatar" data-field="avatar">
                <div>
                    <div class="testimonial-author-name" data-field="name"></div>
                    <div class="testimonial-author-title" data-field="title"></div>
                </div>
            </div>
        </div>
    </template>
    <template id="login-page-template">
        <div class="page-wrapper auth-page-wrapper">
            <div class="auth-card">
                <header class="auth-header">
                    <h1 class="auth-title">Selamat Datang Kembali</h1>
                    <p class="auth-subtitle">Belum punya akun? <a href="#/register">Daftar di sini</a></p>
                </header>
                <form id="login-form" novalidate>
                    <div class="form-group">
                        <label for="login-email">Email</label>
                        <input type="email" id="login-email" class="form-input" placeholder="contoh@email.com" required
                            autocomplete="email">
                        <div class="error-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Password</label>
                        <input type="password" id="login-password" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required
                            autocomplete="current-password">
                        <div class="error-message"></div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg btn-block"
                        style="margin-top: 2.5rem;">Masuk</button>
                </form>
            </div>
        </div>
    </template>
    <template id="register-page-template">
        <div class="page-wrapper auth-page-wrapper">
            <div class="auth-card">
                <header class="auth-header">
                    <h1 class="auth-title">Buat Akun Baru</h1>
                    <p class="auth-subtitle">Sudah punya akun? <a href="#/login">Masuk di sini</a></p>
                </header>
                <form id="register-form" novalidate>
                    <div class="form-group">
                        <label for="register-name">Nama Lengkap</label>
                        <input type="text" id="register-name" class="form-input" placeholder="Nama Anda" required
                            autocomplete="name">
                        <div class="error-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="register-email">Email</label>
                        <input type="email" id="register-email" class="form-input" placeholder="contoh@email.com"
                            required autocomplete="email">
                        <div class="error-message"></div>
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password</label>
                        <input type="password" id="register-password" class="form-input"
                            placeholder="Minimal 8 karakter" required minlength="8" autocomplete="new-password">
                        <div class="error-message"></div>
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg btn-block"
                        style="margin-top: 2.5rem;">Daftar</button>
                </form>
            </div>
        </div>
    </template>
    <template id="payment-page-template">
        <div class="page-wrapper payment-page-wrapper">
            <div class="container">
                <div class="payment-grid">
                    <aside class="payment-summary">
                        <h2 class="section-title">Ringkasan Pesanan</h2>
                        <article class="property-card"
                            style="margin-top: 1.5rem; box-shadow: none; border: none; background: transparent; cursor: default; padding:0; height: auto;">
                            <div class="property-image-container" style="height: 10rem;"><img class="property-image"
                                    src="" data-field="image" alt="Gambar Properti"></div>
                            <div class="property-content" style="padding: 1.5rem 0 0 0;">
                                <h3 class="property-title" data-field="title"></h3>
                                <div class="property-location" style="margin-bottom: 0;"><i
                                        class="fas fa-map-marker-alt"></i><span class="location-text"
                                        data-field="location"></span></div>
                            </div>
                        </article>
                        <div style="margin-top: 1.5rem; border-top: 1px solid var(--border); padding-top: 1.5rem;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <p>Sewa 1 Bulan</p>
                                <p class="font-semibold" data-field="price"></p>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; margin-bottom: 1rem; color: var(--muted-foreground);">
                                <p>Biaya Layanan</p>
                                <p class="font-semibold">GRATIS</p>
                            </div>
                            <div
                                style="display: flex; justify-content: space-between; font-size: 1.2rem; font-weight: 700; border-top: 1px solid var(--border); padding-top: 1rem;">
                                <p>Total Pembayaran</p>
                                <p class="text-primary" data-field="price"></p>
                            </div>
                        </div>
                    </aside>
                    <main class="payment-methods">
                        <h2 class="section-title">Pilih Metode Pembayaran</h2>
                        <div class="tabs" style="margin-top: 1.5rem;">
                            <button class="tab-btn active" data-tab="ewallet">E-Wallet</button>
                            <button class="tab-btn" data-tab="qris">QRIS</button>
                            <button class="tab-btn" data-tab="bank">Transfer Bank</button>
                        </div>
                        <div class="tabs-content">
                            <div class="tab-panel active" id="ewallet-panel">
                                <p style="text-align: center; color: var(--muted-foreground);">Bayar dengan E-Wallet
                                    favorit Anda. (Simulasi)</p>
                                <div class="ewallet-options">
                                    <button class="ewallet-btn" data-wallet="GoPay"><img
                                            src="https://upload.wikimedia.org/wikipedia/commons/8/86/Gopay_logo.svg"
                                            alt="GoPay"><b>GoPay</b></button>
                                    <button class="ewallet-btn" data-wallet="OVO"><img
                                            src="https://www.kindpng.com/picc/m/755-7556747_logo-ovo-transparent-hd-png-download.png"
                                            alt="OVO"><b> </b></button>
                                    <button class="ewallet-btn" data-wallet="DANA"><img
                                            src="https://upload.wikimedia.org/wikipedia/commons/7/72/Logo_dana_blue.svg"
                                            alt="DANA"><b>Dana</b></button>
                                    <button class="ewallet-btn" data-wallet="ShopeePay"><img
                                            src="https://upload.wikimedia.org/wikipedia/commons/0/0e/Shopee_logo.svg"
                                            alt="ShopeePay"><b>ShopeePay</b></button>
                                </div>
                                <p id="payment-status-message"></p>
                            </div>
                            <div class="tab-panel" id="qris-panel">
                                <div
                                    style="display: flex; flex-direction: column; justify-content: center; align-items: center;">
                                    <p style=" text-align: center; color: var(--muted-foreground);">Scan kode QRIS di
                                        bawah
                                        ini untuk membayar. </p>
                                    <span><img
                                            src="https://logowik.com/content/uploads/images/qris-qris-quick-response-code-indonesian-standard8461.logowik.com.webp"
                                            alt="QRIS_Logo BCA" width="200"></span>
                                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=https://greenvalley.example.com/pay"
                                        alt="QRIS Code" class="payment-method-icon">
                                </div>
                            </div>
                            <div class="tab-panel" id="bank-panel">
                                <p style="text-align: center; color: var(--muted-foreground);">Transfer ke rekening
                                    virtual account berikut. (Simulasi)</p>
                                <div
                                    style="margin-top: 1rem; font-weight: 600; text-align: center; background: var(--muted); padding: 0.75rem; border-radius: var(--radius); display:flex; align-items:center; justify-content:center; flex-direction:column; gap:0.5rem;">
                                    <img src="https://www.kindpng.com/picc/m/621-6218933_bank-central-asia-logo-bank-central-asia-bca.png"
                                        alt="Logo Bank BCA" width="100">
                                    <span>BCA Virtual Account: <strong>1234 5678 9012 3456</strong></span>
                                </div>
                            </div>
                            <button class="btn btn-primary btn-lg btn-block" style="margin-top: 2rem;"
                                id="confirm-payment-btn">Konfirmasi Pembayaran</button>
                        </div>
                    </main>
                </div>
            </div>
        </div>
    </template>
    <template id="confirmation-page-template">
        <div class="page-wrapper confirmation-page-wrapper">
            <div class="confirmation-card">
                <i class="fas fa-check-circle confirmation-icon"></i>
                <h1 class="confirmation-title">Pembayaran Berhasil!</h1>
                <p class="auth-subtitle">Terima kasih. Properti <strong data-field="title"></strong> telah berhasil Anda
                    sewa. Tim kami akan segera menghubungi Anda untuk proses selanjutnya.</p>
                <a href="#/search" class="btn btn-primary" style="margin-top: 2rem;">Cari Properti Lain</a>
            </div>
        </div>
    </template>
    <template id="footer-template">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-section">
                    <h3 class="footer-title"><i class="fa-solid fa-house-chimney-window"></i> Green Valley</h3>
                    <p class="footer-text" style="color: var(--muted-foreground);">Platform terpercaya untuk menemukan
                        apartemen sewaan impian Anda dengan mudah dan aman.</p>
                </div>
                <div class="footer-section">
                    <h4 class="footer-subtitle font-semibold">Tautan Cepat</h4>
                    <ul class="footer-links">
                        <li><a href="#/">Beranda</a></li>
                        <li><a href="#/search">Pencarian</a></li>
                        <li><a href="#/testimonials">Testimoni</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-subtitle font-semibold">Dukungan</h4>
                    <ul class="footer-links">
                        <li><a href="#/help">Pusat Bantuan</a></li>
                        <li><a href="#/contact">Hubungi Kami</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-subtitle font-semibold">Berlangganan Buletin</h4>
                    <form class="newsletter-form" id="newsletter-form">
                        <input type="email" placeholder="Email Anda" class="form-input" required><button type="submit"
                            class="btn btn-primary btn-block">Kirim</button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p class="copyright">¬© 2024 Green Valley. Hak Cipta Dilindungi.</p>
                <div class="footer-legal"><a href="#/privacy">Kebijakan Privasi</a><a href="#/terms">Ketentuan
                        Layanan</a></div>
            </div>
        </div>
    </template>
    <template id="toast-template">
        <div class="toast"><i class="toast-icon"></i><span class="toast-message"></span></div>
    </template>
    <template id="modal-template">
        <div class="modal-overlay" role="dialog" aria-modal="true">
            <div class="modal-content">
                <header class="modal-header">
                    <h3 class="modal-title" id="modal-title-placeholder"></h3>
                    <button class="modal-close-btn btn btn-ghost" aria-label="Tutup"><i
                            class="fas fa-times"></i></button>
                </header>
                <div class="modal-body" id="modal-body-placeholder"></div>
            </div>
        </div>
    </template>

    <script>
        // Logika JavaScript tidak diubah sesuai dengan batasan scope.
        // Script ini bertanggung jawab untuk merender template HTML ke dalam DOM.
        // Perbaikan CSS di atas akan diterapkan pada elemen-elemen yang dirender oleh script ini.
        document.addEventListener('DOMContentLoaded', () => {
            const DB = {
                properties: [
                    { id: "prop1", title: "Apartemen Modern Pusat Kota", location: "Jakarta Selatan, DKI Jakarta", price: 6800000, rating: 4.8, reviewCount: 2, imageUrl: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=500&auto=format&fit=crop", beds: 2, baths: 2, sqft: 95, tags: ["Mewah", "Baru"], type: "apartment", amenities: ["air-conditioning", "parking", "pool"], dateAdded: "2024-07-15", reviews: [{ author: 'Rina S.', date: '2024-07-20', rating: 5, comment: 'Sangat suka dengan apartemennya! Bersih, modern, dan lokasinya strategis banget.' }, { author: 'Adi P.', date: '2024-07-18', rating: 4, comment: 'Fasilitas kolam renangnya juara. Sedikit bising di malam hari, tapi masih oke.' }] },
                    { id: "prop2", title: "Studio Nyaman Dekat Stasiun", location: "Bandung, Jawa Barat", price: 3600000, rating: 4.5, reviewCount: 1, imageUrl: "https://images.unsplash.com/photo-1598928636135-d146006ff4be?w=500&auto=format&fit=crop", beds: 0, baths: 1, sqft: 45, tags: ["Studio"], type: "studio", amenities: ["air-conditioning", "pets-allowed"], dateAdded: "2024-07-10", reviews: [{ author: 'Sari N.', date: '2024-07-15', rating: 5, comment: 'Cocok untuk solo traveler, dekat kemana-mana.' }] },
                    { id: "prop3", title: "Rumah Keluarga Asri di Surabaya", location: "Surabaya, Jawa Timur", price: 8500000, rating: 4.9, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1570129477492-45c003edd2be?w=500&auto=format&fit=crop", beds: 3, baths: 2, sqft: 120, tags: ["Keluarga", "Luas"], type: "house", amenities: ["air-conditioning", "parking", "pets-allowed"], dateAdded: "2024-06-20", reviews: [] },
                    { id: "prop4", title: "Apartemen Klasik di Menteng", location: "Jakarta Pusat, DKI Jakarta", price: 4200000, rating: 4.7, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1493809842364-78817add7ffb?w=500&auto=format&fit=crop", beds: 1, baths: 1, sqft: 70, tags: ["Klasik"], type: "apartment", amenities: ["pets-allowed"], dateAdded: "2024-07-01", reviews: [] },
                    { id: "prop5", title: "Studio Modern Dekat Kampus", location: "Yogyakarta, DI Yogyakarta", price: 2800000, rating: 4.9, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1536376072261-38c75010e6c9?w=500&auto=format&fit=crop", beds: 0, baths: 1, sqft: 50, tags: ["Modern"], type: "studio", amenities: ["air-conditioning", "parking", "pool"], dateAdded: "2024-05-15", reviews: [] },
                    { id: "prop6", title: "Apartemen 1 Kamar Direnovasi", location: "Jakarta Barat, DKI Jakarta", price: 5600000, rating: 4.6, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1574362848149-11496d93a7c7?w=500&auto=format&fit=crop", beds: 1, baths: 1, sqft: 65, tags: ["Direnovasi"], type: "apartment", amenities: ["air-conditioning"], dateAdded: "2024-06-01", reviews: [] },
                    { id: "prop7", title: "Apartemen Mewah Pemandangan Laut", location: "Denpasar, Bali", price: 9500000, rating: 5.0, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1613553423758-d7ac6c5be257?w=500&auto=format&fit=crop", beds: 3, baths: 3, sqft: 150, tags: ["Pemandangan Laut"], type: "apartment", amenities: ["air-conditioning", "parking", "pool"], dateAdded: "2024-07-22", reviews: [] },
                    { id: "prop8", title: "Rumah Tenang di Pinggir Kota Medan", location: "Medan, Sumatera Utara", price: 7000000, rating: 4.7, reviewCount: 0, imageUrl: "https://images.unsplash.com/photo-1567767292278-a4f21aa2d36e?w=500&auto=format&fit=crop", beds: 4, baths: 2, sqft: 140, tags: ["Keluarga", "Tenang"], type: "house", amenities: ["parking", "pets-allowed"], dateAdded: "2024-05-25", reviews: [] },
                ],
                users: [{ id: 'user1', name: 'Budi Santoso', email: 'budi@example.com', password: 'password123' }],
                testimonials: [
                    { name: 'Diana R.', title: 'Mahasiswi, Bandung', avatar: 'https://i.pravatar.cc/150?img=1', text: 'Prosesnya cepat dan mudah! Saya menemukan studio dekat kampus hanya dalam beberapa jam. Tim Green Valley sangat membantu.' },
                    { name: 'Fajar H.', title: 'Software Engineer, Jakarta', avatar: 'https://i.pravatar.cc/150?img=3', text: 'Aplikasi ini memiliki pilihan apartemen terbaik di Jakarta. Filter pencariannya sangat detail dan akurat, membuat pencarian jadi efisien.' },
                    { name: 'Keluarga Wijaya', title: 'Penyewa Jangka Panjang, Surabaya', avatar: 'https://i.pravatar.cc/150?img=5', text: 'Kami menyewa rumah melalui Green Valley dan sangat puas. Deskripsi dan foto sesuai dengan kondisi aslinya. Sangat direkomendasikan!' }
                ]
            };
            const State = { currentUser: null, displayedProperties: [], propertiesPerPage: 6, currentPageNum: 1, filters: { priceMin: 500000, priceMax: 10000000, propertyTypes: [], bedrooms: "any", amenities: [] }, sortBy: "recommended", currentRoute: { path: '/', params: new URLSearchParams() }, };
            const Utils = { $: (selector, parent = document) => parent.querySelector(selector), $$: (selector, parent = document) => Array.from(parent.querySelectorAll(selector)), formatCurrency: (amount) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount), formatNumber: (num) => new Intl.NumberFormat('id-ID').format(num), getTemplate: (templateId) => { const t = Utils.$(`#${templateId}`); if (!t) { console.error(`Template ID "${templateId}" tidak ditemukan.`); return document.createDocumentFragment(); } return t.content.cloneNode(true); }, showToast: (message, type = 'success') => { const c = Utils.$('#toast-container'); if (!c) return; const t = Utils.getTemplate('toast-template'); const e = Utils.$('.toast', t); const i = { success: 'fa-check-circle', danger: 'fa-times-circle', warning: 'fa-exclamation-triangle' }; e.classList.add(`toast-${type}`); Utils.$('.toast-icon', e).className = `toast-icon fas ${i[type] || 'fa-info-circle'}`; Utils.$('.toast-message', e).textContent = message; c.appendChild(t); const child = c.lastElementChild; setTimeout(() => { if (child) child.remove() }, 5000); }, showModal: (title, contentHTML) => { const c = Utils.$('#modal-container'); if (!c) return; c.innerHTML = ''; const m = Utils.getTemplate('modal-template'); const o = Utils.$('.modal-overlay', m); Utils.$('#modal-title-placeholder', m).textContent = title; Utils.$('#modal-body-placeholder', m).innerHTML = contentHTML; c.appendChild(m); const close = () => { o.classList.remove('visible'); document.body.classList.remove('no-scroll'); setTimeout(() => c.innerHTML = '', 300); }; setTimeout(() => { o.classList.add('visible'); document.body.classList.add('no-scroll'); }, 10); Utils.$('.modal-close-btn', c).addEventListener('click', close); o.addEventListener('click', e => { if (e.target === o) close(); }); }, isValidEmail: (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(email).toLowerCase()), sanitize: (str) => { const temp = document.createElement('div'); temp.textContent = str; return temp.innerHTML; }, generateStars: (rating) => { let stars = ''; for (let i = 1; i <= 5; i++) { stars += `<i class="fa-${i <= rating ? 'solid' : 'regular'} fa-star"></i>`; } return stars; }, getInitials: (name) => (name || '').split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase(), };
            const LogicLayer = {
                applyFiltersAndSort: () => {
                    let filtered = [...DB.properties]; const { priceMin, priceMax, propertyTypes, bedrooms, amenities } = State.filters;
                    filtered = filtered.filter(p => p.price >= priceMin && p.price <= priceMax);
                    if (propertyTypes.length > 0) filtered = filtered.filter(p => propertyTypes.includes(p.type));
                    if (bedrooms !== "any") { const bedCount = parseInt(bedrooms); if (bedrooms.endsWith("+")) { filtered = filtered.filter(p => p.beds >= bedCount); } else { filtered = filtered.filter(p => p.beds == bedCount); } }
                    if (amenities.length > 0) filtered = filtered.filter(p => amenities.every(am => p.amenities.includes(am)));
                    switch (State.sortBy) { case 'priceLowToHigh': filtered.sort((a, b) => a.price - b.price); break; case 'priceHighToLow': filtered.sort((a, b) => b.price - a.price); break; case 'highestRated': filtered.sort((a, b) => b.rating - a.rating || b.reviewCount - a.reviewCount); break; case 'newest': filtered.sort((a, b) => new Date(b.dateAdded) - new Date(a.dateAdded)); break; }
                    State.displayedProperties = filtered; State.currentPageNum = 1;
                }, loadMoreProperties: () => { State.currentPageNum++; UILayer.renderPropertyCards(false); }, login: (email, password) => { const user = DB.users.find(u => u.email === email && u.password === password); if (user) { State.currentUser = { id: user.id, name: user.name, email: user.email }; localStorage.setItem('currentUser', JSON.stringify(State.currentUser)); return { success: true, user }; } return { success: false, message: 'Email atau password salah.' }; }, register: (name, email, password) => { if (DB.users.some(u => u.email === email)) return { success: false, message: 'Email ini sudah terdaftar.' }; const newUser = { id: `user${DB.users.length + 1}`, name, email, password }; DB.users.push(newUser); return LogicLayer.login(email, password); }, logout: () => { State.currentUser = null; localStorage.removeItem('currentUser'); }, addReview: (propertyId, reviewData) => { if (!State.currentUser) return { success: false, message: 'Harap masuk untuk memberi ulasan.' }; const property = DB.properties.find(p => p.id === propertyId); if (!property) return { success: false, message: 'Properti tidak ditemukan.' }; const newReview = { author: State.currentUser.name, date: new Date().toISOString().split('T')[0], rating: parseInt(reviewData.rating), comment: Utils.sanitize(reviewData.comment) }; property.reviews.unshift(newReview); property.reviewCount++; const totalRating = property.reviews.reduce((sum, r) => sum + r.rating, 0); property.rating = parseFloat((totalRating / property.reviewCount).toFixed(1)); return { success: true, newReview }; }, initStateFromSession: () => { try { const user = localStorage.getItem('currentUser'); if (user) State.currentUser = JSON.parse(user); } catch (e) { console.error("Gagal mem-parse data pengguna:", e); localStorage.removeItem('currentUser'); } }
            };
            const UILayer = {
                mainContent: Utils.$('#main-content'), renderPage: (pageTemplateId, setupFunction) => { if (!UILayer.mainContent) return; UILayer.mainContent.innerHTML = ''; UILayer.mainContent.appendChild(Utils.getTemplate(pageTemplateId)); if (setupFunction) setupFunction(); }, renderNavbar: () => {
                    const container = Utils.$('#navbar-container'); if (!container) return; container.innerHTML = ''; const navbar = Utils.getTemplate('navbar-template');
                    Utils.$$('a', navbar).forEach(link => { const linkPath = new URL(link.href).hash.substring(1); const currentPath = State.currentRoute.path; if (linkPath === currentPath || (linkPath === '/search' && (currentPath === '/' || currentPath === '/search'))) { link.classList.add('active'); } });
                    const actions = Utils.$('.navbar-actions', navbar); if (State.currentUser) { const userContent = Utils.getTemplate('navbar-user-template'); Utils.$('[data-field="name"]', userContent).textContent = State.currentUser.name.split(' ')[0]; actions.prepend(userContent); } else { const guestContent = Utils.getTemplate('navbar-guest-template'); actions.prepend(guestContent); }
                    container.appendChild(navbar); UILayer.renderMobileNav();
                }, renderMobileNav: () => {
                    const mobileNavContainer = Utils.$('#mobile-nav-sidebar-container'); if (!mobileNavContainer) return; mobileNavContainer.innerHTML = ''; const mobileNav = Utils.getTemplate('mobile-nav-template');
                    Utils.$$('a', mobileNav).forEach(link => { const linkPath = new URL(link.href).hash.substring(1); const currentPath = State.currentRoute.path; if (linkPath === currentPath || (linkPath === '/search' && (currentPath === '/' || currentPath === '/search'))) link.classList.add('active'); });
                    const authContainer = Utils.$('.mobile-nav-auth', mobileNav); if (State.currentUser) { const userContent = Utils.getTemplate('mobile-nav-user-template'); Utils.$('[data-field="name"]', userContent).textContent = State.currentUser.name.split(' ')[0]; authContainer.appendChild(userContent); } else { const guestContent = Utils.getTemplate('mobile-nav-guest-template'); authContainer.appendChild(guestContent); }
                    mobileNavContainer.appendChild(mobileNav);
                }, renderFooter: () => { const footer = Utils.$('#footer-container'); if (footer && footer.children.length === 0) footer.appendChild(Utils.getTemplate('footer-template')); }, renderHomePage: () => { UILayer.renderPage('home-page-template', () => { UILayer.renderFilterSidebar(); LogicLayer.applyFiltersAndSort(); UILayer.renderPropertyCards(true); UIEvents.setupHomePageEvents(); const checkin = Utils.$('#search-checkin'); if (checkin) checkin.min = new Date().toISOString().split("T")[0]; }); }, renderFilterSidebar: () => { const sidebarContainer = Utils.$('#filter-sidebar-listings'); if (!sidebarContainer) return; sidebarContainer.innerHTML = ''; const filterTemplate = Utils.getTemplate('filter-sidebar-template'); const { priceMin, priceMax, propertyTypes, bedrooms, amenities } = State.filters; Utils.$('#filter-min-price', filterTemplate).value = priceMin; Utils.$('#filter-max-price', filterTemplate).value = priceMax; Utils.$$('input[name="property-type"]', filterTemplate).forEach(cb => cb.checked = propertyTypes.includes(cb.value)); Utils.$$('#filter-bedrooms button', filterTemplate).forEach(btn => btn.classList.toggle('active', btn.dataset.value === bedrooms)); Utils.$$('input[name="amenity"]', filterTemplate).forEach(cb => cb.checked = amenities.includes(cb.value)); sidebarContainer.appendChild(filterTemplate); UILayer.updateSliderUI(sidebarContainer); }, renderPropertyCards: (clearContainer = true) => { const container = Utils.$('#properties-container'), loadMoreBtn = Utils.$('#load-more-properties'); if (!container || !loadMoreBtn) return; if (clearContainer) container.innerHTML = ''; const startIndex = (State.currentPageNum - 1) * State.propertiesPerPage; const endIndex = startIndex + State.propertiesPerPage; const propertiesToRender = State.displayedProperties.slice(startIndex, endIndex); propertiesToRender.forEach(prop => { const card = Utils.getTemplate('property-card-template'); const cardEl = Utils.$('.property-card', card); cardEl.dataset.id = prop.id; Utils.$('.property-image', card).src = prop.imageUrl; Utils.$('.property-image', card).alt = prop.title; Utils.$('[data-field="title"]', card).textContent = prop.title; Utils.$('[data-field="rating"]', card).textContent = prop.rating.toFixed(1); Utils.$('[data-field="reviewCount"]', card).textContent = `(${prop.reviewCount})`; Utils.$('[data-field="location"]', card).textContent = prop.location; Utils.$('[data-field="beds"]', card).textContent = prop.beds === 0 ? 'Studio' : prop.beds; Utils.$('[data-field="baths"]', card).textContent = prop.baths; Utils.$('[data-field="sqft"]', card).textContent = prop.sqft; Utils.$('[data-field="price"]', card).textContent = Utils.formatCurrency(prop.price); const tagsContainer = Utils.$('.property-tags', card); prop.tags.slice(0, 2).forEach(tagText => { const tagEl = document.createElement('span'); tagEl.className = 'property-tag'; tagEl.textContent = tagText; tagsContainer.appendChild(tagEl); }); container.appendChild(card); }); if (Utils.$('.results-count')) Utils.$('.results-count').textContent = State.displayedProperties.length; loadMoreBtn.classList.toggle('d-none', endIndex >= State.displayedProperties.length); Utils.$('#no-results-message').classList.toggle('d-none', State.displayedProperties.length > 0); }, renderPropertyDetailPage: (id) => { const property = DB.properties.find(p => p.id === id); if (!property) { UILayer.renderNotFound(); return; } UILayer.renderPage('property-detail-page-template', () => { const page = UILayer.mainContent; Utils.$('[data-field="title"]', page).textContent = property.title; Utils.$('[data-field="location"]', page).textContent = ` ${property.location}`; Utils.$('[data-field="mainImage"]', page).src = property.imageUrl; Utils.$('[data-field="mainImage"]', page).alt = `Gambar ${property.title}`; Utils.$('[data-field="beds"]', page).textContent = property.beds === 0 ? 'Studio' : property.beds; Utils.$('[data-field="baths"]', page).textContent = property.baths; Utils.$('[data-field="sqft"]', page).textContent = property.sqft; Utils.$('[data-field="rating"]', page).textContent = `${property.rating.toFixed(1)} (${property.reviewCount} ulasan)`; Utils.$('[data-field="description"]', page).textContent = `Nikmati kenyamanan di ${property.title}, sebuah properti menawan yang terletak di jantung ${property.location}.\n\nMenawarkan ${property.beds === 0 ? 'ruang studio yang efisien' : `${property.beds} kamar tidur`} dan ${property.baths} kamar mandi, unit seluas ${property.sqft} m¬≤ ini adalah pilihan ideal untuk gaya hidup modern dan praktis.`; Utils.$$('[data-field="price"]', page).forEach(el => el.textContent = Utils.formatCurrency(property.price)); const amenitiesContainer = Utils.$('[data-field="amenitiesList"]', page); amenitiesContainer.innerHTML = ''; const amenityMap = { "air-conditioning": { name: "AC", icon: "fa-snowflake" }, "parking": { name: "Parkir", icon: "fa-parking" }, "pool": { name: "Kolam Renang", icon: "fa-water-ladder" }, "pets-allowed": { name: "Boleh Bawa Hewan", icon: "fa-paw" } }; property.amenities.forEach(key => { if (amenityMap[key]) { const item = document.createElement('li'); item.className = 'amenity-item'; item.innerHTML = `<i class="fas ${amenityMap[key].icon} text-primary" style="width: 20px; text-align: center;"></i> <span>${amenityMap[key].name}</span>`; amenitiesContainer.appendChild(item); } }); UILayer.renderReviewsSection(property.id); UIEvents.setupDetailPageEvents(property); }); }, renderReviewsSection: (propertyId) => { const property = DB.properties.find(p => p.id === propertyId); if (!property) return; const container = Utils.$('#reviews-section-container'); if (!container) return; container.innerHTML = ''; const section = Utils.getTemplate('review-section-template'); Utils.$('[data-field="reviewCount"]', section).textContent = property.reviewCount; const reviewList = Utils.$('#review-list', section); if (property.reviews.length > 0) { property.reviews.forEach(review => { const card = Utils.getTemplate('review-card-template'); Utils.$('[data-field="initials"]', card).textContent = Utils.getInitials(review.author); Utils.$('[data-field="author"]', card).textContent = review.author; Utils.$('[data-field="date"]', card).textContent = new Date(review.date).toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' }); Utils.$('[data-field="rating"]', card).innerHTML = Utils.generateStars(review.rating); Utils.$('[data-field="comment"]', card).textContent = review.comment; reviewList.appendChild(card); }); } else { reviewList.innerHTML = `<p style="padding: 1rem 0; color: var(--muted-foreground);">Belum ada ulasan untuk properti ini.</p>`; } const addReviewContainer = Utils.$('#add-review-container', section); if (State.currentUser) { addReviewContainer.appendChild(Utils.getTemplate('add-review-form-template')); UIEvents.setupReviewFormEvents(propertyId); } else { addReviewContainer.innerHTML = `<p style="margin-top: 1.5rem; text-align: center; background: var(--muted); padding: 1rem; border-radius: var(--radius);"><a href="#/login?redirect=/property/${propertyId}">Masuk</a> untuk menulis ulasan.</p>`; } container.appendChild(section); }, renderTestimonialsPage: () => { UILayer.renderPage('testimonials-page-template', () => { const container = Utils.$('#testimonials-container'); if (!container) return; DB.testimonials.forEach(testimonial => { const card = Utils.getTemplate('testimonial-card-template'); Utils.$('[data-field="text"]', card).textContent = `‚Äú${testimonial.text}‚Äù`; Utils.$('[data-field="avatar"]', card).src = testimonial.avatar; Utils.$('[data-field="name"]', card).textContent = testimonial.name; Utils.$('[data-field="title"]', card).textContent = testimonial.title; container.appendChild(card); }); }); }, renderLoginPage: () => UILayer.renderPage('login-page-template', UIEvents.setupLoginPageEvents), renderRegisterPage: () => UILayer.renderPage('register-page-template', UIEvents.setupRegisterPageEvents), renderPaymentPage: (id) => { const property = DB.properties.find(p => p.id === id); if (!property) { UILayer.renderNotFound(); return; } UILayer.renderPage('payment-page-template', () => { const page = UILayer.mainContent; Utils.$('[data-field="title"]', page).textContent = property.title; Utils.$('[data-field="location"]', page).textContent = property.location; Utils.$('[data-field="image"]', page).src = property.imageUrl; Utils.$$('[data-field="price"]', page).forEach(el => el.textContent = Utils.formatCurrency(property.price)); UIEvents.setupPaymentPageEvents(property); }); }, renderConfirmationPage: () => { const lastRentedId = sessionStorage.getItem('lastRentedProperty'); if (!lastRentedId) { RoutingLayer.navigate('/search'); return; } const property = DB.properties.find(p => p.id === lastRentedId); if (!property) { RoutingLayer.navigate('/search'); return; } UILayer.renderPage('confirmation-page-template', () => { Utils.$('[data-field="title"]', UILayer.mainContent).textContent = property.title; sessionStorage.removeItem('lastRentedProperty'); }); }, renderNotFound: (path) => { const knownStaticRoutes = ['/help', '/contact', '/privacy', '/terms']; const message = knownStaticRoutes.includes(path) ? `<h1 style="font-size: 2rem; margin-bottom: 1rem;">Segera Hadir</h1><p style="color: var(--muted-foreground);">Halaman yang Anda tuju sedang dalam pengembangan.</p>` : `<h1 style="font-size: 3rem; margin-bottom: 1rem;">404</h1><p style="color: var(--muted-foreground);">Halaman Tidak Ditemukan</p>`; if (UILayer.mainContent) UILayer.mainContent.innerHTML = `<div class="container page-wrapper text-center" style="padding: 5rem 1rem;">${message}<a href="#/" class="btn btn-primary" style="margin-top: 2rem;">Kembali ke Beranda</a></div>`; }, updateSliderUI: (container) => { const minSlider = Utils.$('#filter-min-price', container), maxSlider = Utils.$('#filter-max-price', container); if (!minSlider || !maxSlider) return; const minInput = Utils.$('#min-price-input', container), maxInput = Utils.$('#max-price-input', container), track = Utils.$('.slider-track', container); let minVal = parseInt(minSlider.value), maxVal = parseInt(maxSlider.value); if (maxVal < minVal + parseInt(minSlider.step)) { event.target === minSlider ? minSlider.value = maxVal - parseInt(minSlider.step) : maxSlider.value = minVal + parseInt(minSlider.step); } minVal = parseInt(minSlider.value); maxVal = parseInt(maxSlider.value); minInput.value = `Rp${Utils.formatNumber(minVal)}`; maxInput.value = `Rp${Utils.formatNumber(maxVal)}`; const range = minSlider.max - minSlider.min, minPercent = ((minVal - minSlider.min) / range) * 100, maxPercent = ((maxVal - minSlider.min) / range) * 100; track.style.left = `${minPercent}%`; track.style.width = `${maxPercent - minPercent}%`; }, setInvalid: (input, message) => { input.classList.add('is-invalid'); const e = input.nextElementSibling; if (e && e.classList.contains('error-message')) e.textContent = message; }, setValid: (input) => { input.classList.remove('is-invalid'); const e = input.nextElementSibling; if (e && e.classList.contains('error-message')) e.textContent = ''; }
            };
            const UIEvents = {
                setupGlobalEvents: () => {
                    document.body.addEventListener('click', e => {
                        if (e.target.matches('#logout-btn, #logout-btn *, #logout-btn-mobile, #logout-btn-mobile *')) { e.preventDefault(); LogicLayer.logout(); Utils.showToast('Anda telah keluar.', 'success'); RoutingLayer.navigate('/'); }
                        const mobileNavSidebar = Utils.$('#mobile-nav-sidebar');
                        if (e.target.closest('#mobile-nav-toggle')) { mobileNavSidebar?.classList.add('is-open'); document.body.classList.add('no-scroll'); }
                        if (e.target.closest('#close-mobile-nav-btn') || e.target === mobileNavSidebar || e.target.closest('.mobile-nav-body a')) { mobileNavSidebar?.classList.remove('is-open'); document.body.classList.remove('no-scroll'); }
                    });
                    document.body.addEventListener('submit', e => { if (e.target.matches('#newsletter-form')) { e.preventDefault(); const i = Utils.$('input[type="email"]', e.target); if (i.value && Utils.isValidEmail(i.value)) { Utils.showToast('Terima kasih telah berlangganan!', 'success'); e.target.reset(); } else { Utils.showToast('Harap masukkan email yang valid.', 'warning'); } } else if (e.target.matches('#main-search-form')) { e.preventDefault(); Utils.showToast('Pencarian lanjutan tersedia di filter.', 'warning'); } });
                }, setupHomePageEvents: () => { Utils.$('#sort-properties')?.addEventListener('change', e => { State.sortBy = e.target.value; LogicLayer.applyFiltersAndSort(); UILayer.renderPropertyCards(true); }); Utils.$('#load-more-properties')?.addEventListener('click', LogicLayer.loadMoreProperties); Utils.$('#properties-container')?.addEventListener('click', e => { const card = e.target.closest('.property-card[data-id]'); if (card) RoutingLayer.navigate(`/property/${card.dataset.id}`); }); Utils.$('#properties-container')?.addEventListener('keydown', e => { const card = e.target.closest('.property-card[data-id]'); if (card && (e.key === 'Enter' || e.key === ' ')) { e.preventDefault(); RoutingLayer.navigate(`/property/${card.dataset.id}`); } }); const filterForm = Utils.$('#filter-form'); if (filterForm) { const applyFilters = () => { State.filters.priceMin = parseInt(Utils.$('#filter-min-price', filterForm).value); State.filters.priceMax = parseInt(Utils.$('#filter-max-price', filterForm).value); State.filters.propertyTypes = Utils.$$('input[name="property-type"]:checked', filterForm).map(cb => cb.value); State.filters.bedrooms = Utils.$('#filter-bedrooms .active', filterForm)?.dataset.value || 'any'; State.filters.amenities = Utils.$$('input[name="amenity"]:checked', filterForm).map(cb => cb.value); LogicLayer.applyFiltersAndSort(); UILayer.renderPropertyCards(true); const sidebar = Utils.$('#filter-sidebar-listings'); if (sidebar?.classList.contains('is-open')) { sidebar.classList.remove('is-open'); document.body.classList.remove('no-scroll'); } }; filterForm.addEventListener('submit', e => { e.preventDefault(); applyFilters(); }); filterForm.addEventListener('reset', () => { State.filters = { priceMin: 500000, priceMax: 10000000, propertyTypes: [], bedrooms: "any", amenities: [] }; setTimeout(() => { UILayer.renderFilterSidebar(); LogicLayer.applyFiltersAndSort(); UILayer.renderPropertyCards(true); }, 0); }); Utils.$$('.range-slider', filterForm).forEach(slider => slider.addEventListener('input', () => UILayer.updateSliderUI(filterForm))); Utils.$('#filter-bedrooms', filterForm)?.addEventListener('click', e => { if (e.target.tagName === 'BUTTON') { Utils.$$('button', e.currentTarget).forEach(b => b.classList.remove('active')); e.target.classList.add('active'); } }); } const toggleBtn = Utils.$('#toggle-filter-btn'), sidebar = Utils.$('#filter-sidebar-listings'); if (toggleBtn && sidebar) { const closeBtn = Utils.$('#close-filter-btn', sidebar); const toggle = (open) => { sidebar.classList.toggle('is-open', open); document.body.classList.toggle('no-scroll', open); }; toggleBtn.addEventListener('click', () => toggle(true)); if (closeBtn) closeBtn.addEventListener('click', () => toggle(false)); sidebar.addEventListener('click', e => { if (e.target === sidebar) toggle(false); }); } }, setupDetailPageEvents: (property) => {
                    const rentNowAction = () => { if (State.currentUser) { RoutingLayer.navigate(`/payment/${property.id}`); } else { Utils.showToast('Harap masuk untuk melanjutkan.', 'warning'); RoutingLayer.navigate(`/login?redirect=/property/${property.id}`); } };
                    const contactAgentAction = () => Utils.showModal('Hubungi Agen', `<p>Fitur ini sedang dalam pengembangan. Untuk saat ini, Anda dapat menghubungi kami di <li> <a href="https://wa.me/62816333612" target="_blank"> <strong>CS GreenValley</strong> </a> </li> <li> <a href="mailto:valley.staycation@gmail.com?subject=Pertanyaan&body=Halo%20admin,%20saya%20ingin%20bertanya%20tentang..." target="_blank"> <strong>Hubungi Kami melalui Email</strong> </a> </li> <li> <a href="https://wa.me/c/62816333612" target="_blank"> <strong>Catalog</strong> </a> </li> </p>`);
                    Utils.$('#rent-now-btn-desktop')?.addEventListener('click', rentNowAction); Utils.$('#rent-now-btn-mobile')?.addEventListener('click', rentNowAction); Utils.$('#contact-agent-btn-desktop')?.addEventListener('click', contactAgentAction); Utils.$('#contact-agent-btn-mobile')?.addEventListener('click', contactAgentAction);
                }, setupReviewFormEvents: (propertyId) => { const form = Utils.$('#add-review-form'); if (!form) return; form.addEventListener('submit', e => { e.preventDefault(); const ratingInput = Utils.$('#review-rating', form), commentInput = Utils.$('#review-comment', form); const rating = ratingInput.value, comment = commentInput.value.trim(); let isValid = true; UILayer.setValid(ratingInput); UILayer.setValid(commentInput); if (!rating) { UILayer.setInvalid(ratingInput, 'Rating harus dipilih.'); isValid = false; } if (comment.length < 10) { UILayer.setInvalid(commentInput, 'Ulasan minimal 10 karakter.'); isValid = false; } if (isValid) { const result = LogicLayer.addReview(propertyId, { rating, comment }); if (result.success) { Utils.showToast('Ulasan Anda telah ditambahkan!', 'success'); UILayer.renderReviewsSection(propertyId); } else { Utils.showToast(result.message, 'danger'); } } }); }, setupFormValidation: (form, fields) => { form.addEventListener('submit', e => { e.preventDefault(); let allValid = true; fields.forEach(field => { UILayer.setValid(field.input); if (!field.validator(field.input.value.trim())) { allValid = false; UILayer.setInvalid(field.input, field.message); } }); if (allValid) form.dispatchEvent(new CustomEvent('form-valid')); }); }, setupLoginPageEvents: () => { const form = Utils.$('#login-form'); if (!form) return; const emailInput = Utils.$('#login-email'), passwordInput = Utils.$('#login-password'); UIEvents.setupFormValidation(form, [{ input: emailInput, validator: Utils.isValidEmail, message: 'Email tidak valid.' }, { input: passwordInput, validator: val => val.length > 0, message: 'Password tidak boleh kosong.' }]); form.addEventListener('form-valid', () => { const result = LogicLayer.login(Utils.sanitize(emailInput.value), passwordInput.value); if (result.success) { Utils.showToast(`Selamat datang, ${result.user.name.split(' ')[0]}!`, 'success'); const redirectUrl = State.currentRoute.params.get('redirect'); RoutingLayer.navigate(redirectUrl || '/search'); } else { UILayer.setInvalid(emailInput, result.message); UILayer.setInvalid(passwordInput, ' '); } }); }, setupRegisterPageEvents: () => { const form = Utils.$('#register-form'); if (!form) return; const nameInput = Utils.$('#register-name'), emailInput = Utils.$('#register-email'), passwordInput = Utils.$('#register-password'); UIEvents.setupFormValidation(form, [{ input: nameInput, validator: val => val.length > 0, message: 'Nama tidak boleh kosong.' }, { input: emailInput, validator: Utils.isValidEmail, message: 'Email tidak valid.' }, { input: passwordInput, validator: val => val.length >= 8, message: 'Password minimal 8 karakter.' }]); form.addEventListener('form-valid', () => { const result = LogicLayer.register(Utils.sanitize(nameInput.value), Utils.sanitize(emailInput.value), passwordInput.value); if (result.success) { Utils.showToast(`Registrasi berhasil! Selamat datang!`, 'success'); RoutingLayer.navigate('/search'); } else { UILayer.setInvalid(emailInput, result.message); } }); }, setupPaymentPageEvents: (property) => { const statusMessage = Utils.$('#payment-status-message'); Utils.$$('.payment-methods .tab-btn').forEach(button => { button.addEventListener('click', () => { Utils.$$('.payment-methods .tab-btn').forEach(btn => btn.classList.remove('active')); button.classList.add('active'); Utils.$$('.payment-methods .tab-panel').forEach(panel => panel.classList.remove('active')); Utils.$(`#${button.dataset.tab}-panel`).classList.add('active'); if (statusMessage) statusMessage.textContent = ''; }); }); Utils.$$('.ewallet-btn').forEach(button => { button.addEventListener('click', e => { const wallet = e.currentTarget.dataset.wallet; if (statusMessage) statusMessage.textContent = `Silakan konfirmasi pembayaran di aplikasi ${wallet} Anda.`; }); }); Utils.$('#confirm-payment-btn')?.addEventListener('click', e => { const btn = e.currentTarget; btn.disabled = true; btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Memproses...'; setTimeout(() => { sessionStorage.setItem('lastRentedProperty', property.id); RoutingLayer.navigate('/confirmation'); }, 1500); }); }
            };
            const RoutingLayer = {
                routes: { '/': UILayer.renderHomePage, '/search': UILayer.renderHomePage, '/property/:id': (id) => UILayer.renderPropertyDetailPage(id), '/testimonials': UILayer.renderTestimonialsPage, '/login': UILayer.renderLoginPage, '/register': UILayer.renderRegisterPage, '/payment/:id': (id) => { if (State.currentUser) UILayer.renderPaymentPage(id); else { Utils.showToast('Sesi Anda berakhir, harap masuk kembali.', 'warning'); RoutingLayer.navigate(`/login?redirect=/payment/${id}`); } }, '/confirmation': UILayer.renderConfirmationPage, },
                handleRoute: () => { const hash = window.location.hash || '#/'; const [path, queryString] = hash.substring(1).split('?'); State.currentRoute = { path, params: new URLSearchParams(queryString || '') }; let matchFound = null; for (const routePath in RoutingLayer.routes) { const paramNames = []; const regexPath = routePath.replace(/:(\w+)/g, (_, paramName) => { paramNames.push(paramName); return '([^/]+)'; }); const regex = new RegExp(`^${regexPath}$`); const match = path.match(regex); if (match) { matchFound = { route: RoutingLayer.routes[routePath], params: match.slice(1) }; break; } } if (matchFound) { matchFound.route(...matchFound.params); } else { UILayer.renderNotFound(path); } UILayer.renderNavbar(); window.scrollTo(0, 0); }, navigate: (path) => { window.location.hash = path; }, init: () => { window.addEventListener('hashchange', RoutingLayer.handleRoute); RoutingLayer.handleRoute(); }
            };
            const initApp = () => { LogicLayer.initStateFromSession(); UILayer.renderFooter(); UIEvents.setupGlobalEvents(); RoutingLayer.init(); };
            initApp();
        });
    </script>
</body>

</html>