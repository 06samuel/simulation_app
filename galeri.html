<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0">
  <title>Product Category Carousel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    :root {
      /* Color System */
      --primary: #0070f3;
      --primary-light: #3291ff;
      --primary-dark: #0366d6;
      --primary-foreground: #ffffff;

      --secondary: #f5f5f5;
      --secondary-light: #fafafa;
      --secondary-dark: #e5e5e5;
      --secondary-foreground: #111111;

      --accent: #007aff;
      --accent-foreground: #ffffff;

      --background: #ffffff;
      --foreground: #111111;
      --card: #ffffff;
      --card-foreground: #111111;
      --border: #e5e5e5;
      --input: #ffffff;
      --ring: #0070f3;

      --success: #22c55e;
      --error: #ef4444;
      --warning: #f59e0b;
      --info: #3b82f6;

      /* Spacing Scale */
      --space-0: 0;
      --space-1: 0.25rem;
      --space-2: 0.5rem;
      --space-3: 0.75rem;
      --space-4: 1rem;
      --space-5: 1.25rem;
      --space-6: 1.5rem;
      --space-8: 2rem;
      --space-10: 2.5rem;
      --space-12: 3rem;
      --space-16: 4rem;
      --space-20: 5rem;
      --space-24: 6rem;
      --space-32: 8rem;

      /* Typography */
      --text-xs: 0.75rem;
      --text-sm: 0.875rem;
      --text-base: 1rem;
      --text-lg: 1.125rem;
      --text-xl: 1.25rem;
      --text-2xl: 1.5rem;
      --text-3xl: 1.875rem;
      --text-4xl: 2.25rem;
      --text-5xl: 3rem;
      --text-6xl: 3.75rem;

      --font-sans: system-ui, -apple-system, sans-serif;
      --font-mono: ui-monospace, monospace;

      /* Shadows */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);

      /* Border */
      --radius-sm: 0.125rem;
      --radius: 0.25rem;
      --radius-md: 0.375rem;
      --radius-lg: 0.5rem;
      --radius-xl: 0.75rem;
      --radius-2xl: 1rem;
      --radius-full: 9999px;

      /* Transition */
      --transition-fast: all 0.15s ease;
      --transition: all 0.3s ease;
      --transition-slow: all 0.5s ease;

      /* Dark Mode Variables */
      --dark-primary: #3291ff;
      --dark-primary-foreground: #ffffff;
      --dark-secondary: #1e1e1e;
      --dark-secondary-foreground: #f5f5f5;
      --dark-background: #121212;
      --dark-foreground: #ffffff;
      --dark-card: #1e1e1e;
      --dark-card-foreground: #ffffff;
      --dark-border: #333333;
    }

    /* Dark Mode */
    [data-theme="dark"] {
      --primary: var(--dark-primary);
      --primary-foreground: var(--dark-primary-foreground);
      --secondary: var(--dark-secondary);
      --secondary-foreground: var(--dark-secondary-foreground);
      --background: var(--dark-background);
      --foreground: var(--dark-foreground);
      --card: var(--dark-card);
      --card-foreground: var(--dark-card-foreground);
      --border: var(--dark-border);
    }

    body {
      font-family: var(--font-sans);
      background-color: var(--background);
      color: var(--foreground);
      transition: var(--transition);
    }

    /* Utility Classes */
    .text-primary {
      color: var(--primary);
    }

    .bg-primary {
      background-color: var(--primary);
    }

    .border-primary {
      border-color: var(--primary);
    }

    .text-secondary {
      color: var(--secondary-foreground);
    }

    .bg-secondary {
      background-color: var(--secondary);
    }

    .border-secondary {
      border-color: var(--secondary);
    }

    .text-accent {
      color: var(--accent);
    }

    .bg-accent {
      background-color: var(--accent);
    }

    .border-accent {
      border-color: var(--accent);
    }

    .shadow-sm {
      box-shadow: var(--shadow-sm);
    }

    .shadow {
      box-shadow: var(--shadow);
    }

    .shadow-md {
      box-shadow: var(--shadow-md);
    }

    .shadow-lg {
      box-shadow: var(--shadow-lg);
    }

    .shadow-xl {
      box-shadow: var(--shadow-xl);
    }

    .rounded-sm {
      border-radius: var(--radius-sm);
    }

    .rounded {
      border-radius: var(--radius);
    }

    .rounded-md {
      border-radius: var(--radius-md);
    }

    .rounded-lg {
      border-radius: var(--radius-lg);
    }

    .rounded-xl {
      border-radius: var(--radius-xl);
    }

    .rounded-2xl {
      border-radius: var(--radius-2xl);
    }

    .rounded-full {
      border-radius: var(--radius-full);
    }

    .transition-fast {
      transition: var(--transition-fast);
    }

    .transition {
      transition: var(--transition);
    }

    .transition-slow {
      transition: var(--transition-slow);
    }

    /* Category Grid */
    .category-container {
      padding: var(--space-6);
    }

    .category-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: var(--space-4);
    }

    .category-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--space-4);
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: var(--radius-lg);
      transition: var(--transition);
      cursor: pointer;
      box-shadow: var(--shadow);
      text-align: center;
      min-height: 120px;
    }

    .category-card i {
      font-size: var(--text-3xl);
      margin-bottom: var(--space-2);
      transition: var(--transition);
    }

    .category-card.active {
      background: var(--primary);
      color: var(--primary-foreground);
      transform: scale(1.05);
      border-color: var(--primary);
      box-shadow: var(--shadow-md);
    }

    .category-card:hover:not(.active) {
      background: var(--secondary);
      transform: translateY(-5px);
      box-shadow: var(--shadow-md);
    }

    /* Product Cards */
    .product-card {
      background: var(--card);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .product-card img {
      height: 300px;
      object-fit: cover;
      width: 100%;
      transition: var(--transition);
    }

    .product-card:hover img {
      transform: scale(1.02);
    }

    .product-info {
      padding: var(--space-4);
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .price {
      color: var(--primary);
      font-size: var(--text-2xl);
      font-weight: bold;
      margin: var(--space-2) 0;
    }

    /* Carousel Controls */
    .carousel-control-prev,
    .carousel-control-next {
      width: 50px;
      height: 50px;
      background: var(--primary);
      border-radius: 50%;
      top: 50%;
      transform: translateY(-50%);
      opacity: 0.9;
      transition: var(--transition);
    }

    .carousel-control-prev:hover,
    .carousel-control-next:hover {
      opacity: 1;
      transform: translateY(-50%) scale(1.1);
    }

    .carousel-control-prev {
      left: -25px;
    }

    .carousel-control-next {
      right: -25px;
    }

    /* Modal */
    .modal-content {
      border-radius: var(--radius-lg);
      border: none;
      background: var(--card);
      color: var(--foreground);
    }

    .modal-header {
      border-bottom: 1px solid var(--border);
    }

    .modal-footer {
      border-top: 1px solid var(--border);
    }

    /* Connection Status */
    .connection-status {
      position: fixed;
      bottom: -60px;
      left: 0;
      right: 0;
      padding: var(--space-3);
      text-align: center;
      transition: var(--transition);
      z-index: 9999;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
      font-weight: 500;
    }

    .connection-status.active {
      bottom: 0;
    }

    .connection-status.online {
      background: transparent;
      /* color: var(--secondary-foreground); */
      color: var(--success);

      /* background: var(--success); */
    }

    .connection-status.offline {
      background: var(--error);
    }

    .connection-status.reconnecting {
      background: var(--warning);
    }

    /* Sync Indicators */
    .sync-indicator {
      position: absolute;
      top: 12px;
      right: 12px;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      transition: var(--transition);
      z-index: 1;
    }

    [data-sync-state="syncing"] .sync-indicator {
      background: var(--warning);
      animation: pulse 1.5s infinite;
    }

    [data-sync-state="synced"] .sync-indicator {
      background: var(--success);
    }

    [data-sync-state="error"] .sync-indicator {
      background: var(--error);
      animation: none;
    }

    /* Animations */
    @keyframes pulse {
      0% {
        transform: scale(0.8);
        opacity: 0.8;
      }

      50% {
        transform: scale(1.1);
        opacity: 1;
      }

      100% {
        transform: scale(0.8);
        opacity: 0.8;
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideIn {
      from {
        transform: translateY(20px);
        opacity: 0;
      }

      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Theme Toggle */
    .theme-toggle {
      position: fixed;
      bottom: var(--space-4);
      right: var(--space-4);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: var(--shadow-md);
      z-index: 100;
      border: none;
      transition: var(--transition);
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    /* Responsive Breakpoints */
    @media (max-width: 1400px) {
      .category-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      }
    }

    @media (max-width: 1200px) {
      .category-grid {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
      }

      .product-card img {
        height: 250px;
      }
    }

    @media (max-width: 992px) {
      .category-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .carousel-control-prev,
      .carousel-control-next {
        display: none;
      }
    }

    @media (max-width: 768px) {
      .category-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .product-card img {
        height: 220px;
      }
    }

    @media (max-width: 576px) {
      .category-grid {
        grid-template-columns: 1fr;
      }

      .product-card img {
        height: 200px;
      }
    }

    @media (max-width: 400px) {
      .category-container {
        padding: var(--space-4);
      }

      .product-card img {
        height: 180px;
      }
    }
  </style>
</head>

<body>
  <!-- Connection Status -->
  <div class="connection-status" id="connectionStatus">
    <i class="bi bi-circle-fill status-icon"></i>
    <span class="status-text" id="statusText">Checking connection...</span>
  </div>

  <!-- Theme Toggle -->
  <button class="theme-toggle" id="themeToggle">
    <i class="bi bi-moon-fill" id="themeIcon"></i>
  </button>

  <div class="container-fluid py-5">
    <div class="row">
      <div class="col-md-3">
        <div class="category-container">
          <h4 class="mb-4">Categories</h4>
          <div class="category-grid" role="tablist">
            <button class="category-card active" data-bs-toggle="pill" data-bs-target="#electronics"
              data-sync-state="synced">
              <div class="sync-indicator"></div>
              <i class="bi bi-laptop"></i>
              <span>Electronics</span>
            </button>
            <button class="category-card" data-bs-toggle="pill" data-bs-target="#clothing" data-sync-state="synced">
              <div class="sync-indicator"></div>
              <i class="bi bi-scissors"></i>
              <span>Clothing</span>
            </button>
            <button class="category-card" data-bs-toggle="pill" data-bs-target="#home-decor" data-sync-state="synced">
              <div class="sync-indicator"></div>
              <i class="bi bi-house-heart"></i>
              <span>Home Decor</span>
            </button>
            <button class="category-card" data-bs-toggle="pill" data-bs-target="#accessories" data-sync-state="synced">
              <div class="sync-indicator"></div>
              <i class="bi bi-watch"></i>
              <span>Accessories</span>
            </button>
            <button class="category-card" data-bs-toggle="pill" data-bs-target="#furniture" data-sync-state="synced">
              <div class="sync-indicator"></div>
              <i class="bi bi-lamp"></i>
              <span>Furniture</span>
            </button>
          </div>
        </div>
      </div>
      <div class="col-md-9">
        <div class="tab-content">
          <div class="tab-pane fade show active" id="electronics">
            <div id="electronicsCarousel" class="carousel slide" data-bs-ride="carousel" data-sync-state="synced">
              <div class="sync-indicator"></div>
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e" class="d-block w-100"
                      alt="Headphones" loading="lazy">
                    <div class="product-info p-4">
                      <h3>Premium Headphones</h3>
                      <p>High-quality wireless headphones with noise cancellation</p>
                      <div class="price mb-3">$299.99</div>
                      <div class="d-flex gap-2">
                        <button class="btn btn-primary">Add to Cart</button>
                        <button class="btn btn-outline-secondary" data-bs-toggle="modal"
                          data-bs-target="#productModal">Quick View</button>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="carousel-item">
                  <div class="product-card">
                    <img src="https://images.unsplash.com/photo-1593642632823-8f785ba67e45" class="d-block w-100"
                      alt="Laptop" loading="lazy">
                    <div class="product-info p-4">
                      <h3>Ultra Slim Laptop</h3>
                      <p>Powerful performance in a sleek design</p>
                      <div class="price mb-3">$1299.99</div>
                      <div class="d-flex gap-2">
                        <button class="btn btn-primary">Add to Cart</button>
                        <button class="btn btn-outline-secondary" data-bs-toggle="modal"
                          data-bs-target="#productModal">Quick View</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#electronicsCarousel"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon"></span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#electronicsCarousel"
                data-bs-slide="next">
                <span class="carousel-control-next-icon"></span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Product Modal -->
  <div class="modal fade" id="productModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Product Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6">
              <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e" class="img-fluid rounded"
                alt="Product" loading="lazy">
            </div>
            <div class="col-md-6">
              <h3>Premium Headphones</h3>
              <p class="text-muted">High-quality wireless headphones with noise cancellation</p>
              <div class="price h4 mb-3">$299.99</div>
              <p>Experience crystal-clear sound with our premium wireless headphones. Features include active noise
                cancellation, 30-hour battery life, and premium comfort.</p>
              <div class="mt-4">
                <button class="btn btn-primary">Add to Cart</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    class ProductCarouselApp {
      constructor() {
        this.init();
      }

      init() {
        this.setupEventListeners();
        this.setupConnectivity();
        this.setupThemeToggle();
        this.setupSyncSimulation();
        this.initializeCarousels();
        this.setupIntersectionObserver();
        this.updateConnectionUI();
      }

      setupEventListeners() {
        window.addEventListener('online', () => this.handleConnectivityChange(true));
        window.addEventListener('offline', () => this.handleConnectivityChange(false));
        window.addEventListener('resize', this.debounce(this.handleResize, 200));
      }

      setupConnectivity() {
        this.connectionState = {
          online: navigator.onLine,
          retries: 0,
          maxRetries: 5,
          retryInterval: 5000
        };
      }

      handleConnectivityChange(online) {
        this.connectionState.online = online;

        if (!online) {
          this.scheduleReconnection();
        } else {
          this.connectionState.retries = 0;
          this.syncAllComponents();
        }

        this.updateConnectionUI();
      }

      scheduleReconnection() {
        if (this.connectionState.retries < this.connectionState.maxRetries) {
          setTimeout(() => {
            if (!navigator.onLine) {
              this.connectionState.retries++;
              this.updateConnectionUI();
              this.scheduleReconnection();
            }
          }, this.connectionState.retryInterval);
        }
      }

      updateConnectionUI() {
        const status = document.getElementById('connectionStatus');
        const statusText = document.getElementById('statusText');

        status.className = 'connection-status active';
        statusText.textContent = 'Online';

        if (!this.connectionState.online) {
          status.classList.add('offline');
          statusText.textContent = this.connectionState.retries > 0
            ? `Offline - Reconnecting (${this.connectionState.retries}/${this.connectionState.maxRetries})...`
            : 'Offline - Connection lost';
        } else {
          status.classList.add('online');
          if (this.connectionState.retries > 0) {
            statusText.textContent = 'Connection restored!';
            setTimeout(() => {
              if (statusText.textContent === 'Connection restored!') {
                statusText.textContent = 'Online';
              }
            }, 3000);
          }
        }
      }

      setupThemeToggle() {
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        // Set initial theme
        if (localStorage.getItem('theme') === 'dark' || (!localStorage.getItem('theme') && prefersDark)) {
          document.documentElement.setAttribute('data-theme', 'dark');
          themeIcon.classList.replace('bi-moon-fill', 'bi-sun-fill');
        }

        themeToggle.addEventListener('click', () => {
          const isDark = document.documentElement.getAttribute('data-theme') === 'dark';

          if (isDark) {
            document.documentElement.removeAttribute('data-theme');
            themeIcon.classList.replace('bi-sun-fill', 'bi-moon-fill');
            localStorage.setItem('theme', 'light');
          } else {
            document.documentElement.setAttribute('data-theme', 'dark');
            themeIcon.classList.replace('bi-moon-fill', 'bi-sun-fill');
            localStorage.setItem('theme', 'dark');
          }
        });
      }

      initializeCarousels() {
        this.carousels = {
          electronics: new bootstrap.Carousel('#electronicsCarousel', {
            interval: 5000,
            wrap: true,
            touch: true
          })
        };
      }

      setupIntersectionObserver() {
        this.observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('visible');
            }
          });
        }, { threshold: 0.1 });

        document.querySelectorAll('.category-card, .product-card').forEach(card => {
          this.observer.observe(card);
        });
      }

      setupSyncSimulation() {
        // Initial sync
        setTimeout(() => this.syncAllComponents(), 2000);

        // Periodic sync every 30 seconds
        setInterval(() => {
          if (this.connectionState.online) {
            this.syncAllComponents();
          }
        }, 30000);
      }

      syncAllComponents() {
        document.querySelectorAll('[data-sync-state]').forEach(el => {
          this.simulateSync(el);
        });
      }

      simulateSync(element) {
        // Set to syncing state
        element.setAttribute('data-sync-state', 'syncing');

        // Simulate sync delay
        const delay = 1000 + Math.random() * 2000;

        setTimeout(() => {
          // Randomly choose success or error (mostly success)
          const success = Math.random() > 0.1;
          element.setAttribute('data-sync-state', success ? 'synced' : 'error');

          // If error, retry after delay
          if (!success) {
            setTimeout(() => this.simulateSync(element), 3000);
          }
        }, delay);
      }

      handleResize() {
        // Handle responsive adjustments
        const isMobile = window.matchMedia('(max-width: 768px)').matches;
        document.body.classList.toggle('mobile-view', isMobile);
      }

      debounce(func, wait) {
        let timeout;
        return (...args) => {
          clearTimeout(timeout);
          timeout = setTimeout(() => func.apply(this, args), wait);
        };
      }
    }

    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      window.productApp = new ProductCarouselApp();
    });
  </script>
</body>

</html>