<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <title>RentEase - Platform Sewa Apartemen</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="icon"
        href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAACQ0lEQVQ4Eb1STUjVQBCd2VaBXGxlL3rRSwjRoEIsxERXgm5ERUXdlEWLIr1KxCLgRhQhLgVdKAIiKIO5iCAIAnGxBwfBxQ09B60zT29yvT0yM8/3fe8783tGSABfwt9BtuZ8p/EPEE5LgI/Z9k9K63fC90H+ExXpI0T83fL9Mh0wW4qE8WIdv2kSdITsAGzFpgFkKPkvzO6wVz0QOdAHQCeA4qGkaY0yQVtR2gG0E0L9R9QhK2MhrAtN0tJ3s1pAAMB9Qz9n5fP0s852n0M0AcAtyB4X2Nf8I+sI5n0M0AcAtyB4X2Nf8I+sI5d6G7xW32S+5e+jBF6F+kR4CiAADe8vNn9q1D0fW3i3fIu/yU17mQ2UnqB+2uXP29LcgZ/fhm0J9fX2P1uCmlR92uV3z09cUNm1pcAALYfT8G/uTz8XJ4Yj531P+o0EsCBnJIt0QY1vRynXgKkS81YkP4gUAXtgKscMQ6sZJV48R3AZqGwAdYDReUqNlXBIwf6m114mG+xO0EMB79J2t97xY9iTjHj5YjJkM6YpVwBQJUnXQ12xK5RTxZ2tPZ2aCBP/gDkK7L5vLpW2bV0L5vP+q9k3jM+8VjEouOOpZ8YdK/kL9nLrZJ0/Q57gKkK9zE8Y0e2T3iS3h+g2h5nC3z2Q7Y0ySWD32+71yqBf3L3Hn8NfH173J0WDIjG048zosgzsIWsLgE4AG0M6h+AdP1I83dKTvwP7+R0+uEAAAAASUVORK5CYII="
        type="image/png">


    <style>
        /* --- Design Tokens (Variabel CSS Global) --- */
        :root {
            /* Skala Tipografi Responsif */
            --font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
            --font-size-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem);
            --font-size-base: clamp(1rem, 0.9rem + 0.5vw, 1.125rem);
            --font-size-lg: clamp(1.125rem, 1rem + 0.625vw, 1.25rem);
            --font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.5rem);
            --font-size-2xl: clamp(1.5rem, 1.4rem + 0.5vw, 2rem);
            --font-size-3xl: clamp(2rem, 1.8rem + 1vw, 3rem);

            /* Skala Spasi Responsif */
            --spacing-1: clamp(0.25rem, 0.2rem + 0.25vw, 0.5rem);
            --spacing-2: clamp(0.5rem, 0.4rem + 0.25vw, 0.75rem);
            --spacing-3: clamp(0.75rem, 0.65rem + 0.5vw, 1rem);
            --spacing-4: clamp(1rem, 0.85rem + 0.75vw, 1.5rem);
            --spacing-5: clamp(1.5rem, 1.25rem + 1.25vw, 2rem);
            --spacing-6: clamp(2rem, 1.75rem + 1.25vw, 3rem);

            /* Palet Warna - Tema Terang (Light Mode) */
            --background: #f8fafc;
            /* slate-50 */
            --foreground: #0f172a;
            /* slate-900 */
            --card: #ffffff;
            --card-foreground: #0f172a;
            --popover: #ffffff;
            --popover-foreground: #0f172a;
            --primary: #3b82f6;
            /* blue-500 */
            --primary-foreground: #ffffff;
            --secondary: #f1f5f9;
            /* slate-100 */
            --secondary-foreground: #1e293b;
            /* slate-800 */
            --muted: #f1f5f9;
            /* slate-100 */
            --muted-foreground: #64748b;
            /* slate-500 */
            --accent: #e2e8f0;
            /* slate-200 */
            --accent-foreground: #1e293b;
            /* slate-800 */
            --destructive: #ef4444;
            /* red-500 */
            --destructive-foreground: #ffffff;
            --border: #e2e8f0;
            /* slate-200 */
            --input: #e2e8f0;
            /* slate-200 */
            --ring: #3b82f6;
            /* blue-500 */
            --success: #10b981;
            /* emerald-500 */
            --success-foreground: #ffffff;
            --warning: #f59e0b;
            /* amber-500 */
            --warning-foreground: #ffffff;


            /* Tata Letak */
            --radius: 0.75rem;
            --sidebar-width: clamp(17rem, 15rem + 10vw, 22rem);
            /* Sedikit lebih lebar untuk item baru */
            --sidebar-width-collapsed: 4.5rem;
            /* 72px */
            --header-height: 4.5rem;
            /* 72px */

            /* Tipografi */
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --line-height-normal: 1.5;
            --line-height-tight: 1.25;
            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;

            /* Efek Bayangan */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

            /* Transisi */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-normal: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 350ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Palet Warna - Tema Gelap (Dark Mode) */
        .dark {
            --background: #0f172a;
            /* slate-900 */
            --foreground: #f8fafc;
            /* slate-50 */
            --card: #1e293b;
            /* slate-800 */
            --card-foreground: #f8fafc;
            /* slate-50 */
            --popover: #1e293b;
            /* slate-800 */
            --popover-foreground: #f8fafc;
            /* slate-50 */
            --primary: #60a5fa;
            /* blue-400 */
            --primary-foreground: #0f172a;
            /* slate-900 */
            --secondary: #334155;
            /* slate-700 */
            --secondary-foreground: #f1f5f9;
            /* slate-100 */
            --muted: #334155;
            /* slate-700 */
            --muted-foreground: #94a3b8;
            /* slate-400 */
            --accent: #475569;
            /* slate-600 */
            --accent-foreground: #f1f5f9;
            /* slate-100 */
            --destructive: #f87171;
            /* red-400 */
            --destructive-foreground: #0f172a;
            /* slate-900 */
            --border: #334155;
            /* slate-700 */
            --input: #334155;
            /* slate-700 */
            --ring: #60a5fa;
            /* blue-400 */
            --success: #34d399;
            /* emerald-400 */
            --success-foreground: #0f172a;
            /* slate-900 */
            --warning: #fbbf24;
            /* amber-400 */
            --warning-foreground: #0f172a;
        }

        /* --- Reset & Gaya Dasar --- */
        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            height: 100%;
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-sans);
            font-size: var(--font-size-base);
            line-height: var(--line-height-normal);
            color: var(--foreground);
            background-color: var(--background);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            transition: background-color var(--transition-normal), color var(--transition-normal);
        }

        /* --- Overlay untuk Sidebar Mobile --- */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 35;
            /* Di bawah sidebar, di atas konten */
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-normal), visibility var(--transition-normal);
        }

        .mobile-overlay.active {
            opacity: 1;
            visibility: visible;
        }


        /* --- Splash Screen --- */
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--background);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 1;
            visibility: visible;
            transition: opacity var(--transition-slow), visibility var(--transition-slow);
        }

        .splash-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .splash-logo {
            font-size: 4rem;
            color: var(--primary);
            margin-bottom: var(--spacing-4);
        }

        .splash-title {
            font-size: var(--font-size-3xl);
            color: var(--primary);
            font-weight: var(--font-weight-bold);
            margin-bottom: var(--spacing-2);
        }

        .splash-subtitle {
            font-size: var(--font-size-lg);
            color: var(--muted-foreground);
        }

        /* --- Tipografi yang Ditingkatkan --- */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            line-height: var(--line-height-tight);
            font-weight: var(--font-weight-bold);
            letter-spacing: -0.025em;
            color: var(--card-foreground);
        }

        h1 {
            font-size: var(--font-size-3xl);
        }

        h2 {
            font-size: var(--font-size-2xl);
        }

        h3 {
            font-size: var(--font-size-xl);
        }

        h4 {
            font-size: var(--font-size-lg);
        }

        p {
            margin-bottom: var(--spacing-3);
        }

        p:last-child {
            margin-bottom: 0;
        }

        /* --- Elemen Interaktif --- */
        a {
            color: var(--primary);
            text-decoration: none;
            transition: color var(--transition-fast);
        }

        a:hover {
            color: color-mix(in srgb, var(--primary) 80%, black);
        }

        .dark a:hover {
            color: color-mix(in srgb, var(--primary) 80%, white);
        }

        button,
        .button {
            font-family: inherit;
            font-size: var(--font-size-base);
            line-height: inherit;
            cursor: pointer;
            border-radius: var(--radius);
            padding: var(--spacing-2) var(--spacing-4);
            font-weight: var(--font-weight-medium);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-2);
            border: 1px solid transparent;
            transition: background-color var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), box-shadow var(--transition-fast);
        }

        button:disabled,
        .button.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .button-primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }

        .button-primary:hover {
            background-color: color-mix(in srgb, var(--primary) 85%, black);
        }

        .dark .button-primary:hover {
            background-color: color-mix(in srgb, var(--primary) 85%, white);
        }

        .button-outline {
            background-color: transparent;
            color: var(--primary);
            border-color: var(--primary);
        }

        .button-outline:hover {
            background-color: var(--accent);
        }

        .button-secondary {
            background-color: var(--secondary);
            color: var(--secondary-foreground);
            border-color: var(--secondary);
        }

        .button-secondary:hover {
            background-color: color-mix(in srgb, var(--secondary) 85%, black);
        }

        .dark .button-secondary:hover {
            background-color: color-mix(in srgb, var(--secondary) 85%, white);
        }

        .button-ghost {
            background-color: transparent;
            color: var(--primary);
            border-color: transparent;
        }

        .button-ghost:hover {
            background-color: var(--accent);
        }

        .button-destructive {
            background-color: var(--destructive);
            color: var(--destructive-foreground);
            border-color: var(--destructive);
        }

        .button-destructive:hover {
            background-color: color-mix(in srgb, var(--destructive) 85%, black);
        }

        .dark .button-destructive:hover {
            background-color: color-mix(in srgb, var(--destructive) 85%, white);
        }

        .button-block {
            width: 100%;
            display: flex;
        }

        .button-sm {
            padding: var(--spacing-1) var(--spacing-3);
            font-size: var(--font-size-sm);
        }

        .button-xs {
            padding: calc(var(--spacing-1) * 0.5) var(--spacing-2);
            font-size: var(--font-size-xs);
        }

        .button-icon {
            padding: var(--spacing-2);
        }

        /* Untuk tombol yang hanya berisi ikon */


        /* Status Fokus yang Jelas */
        :focus-visible {
            outline: 2px solid var(--ring);
            outline-offset: 2px;
            border-radius: var(--radius);
        }

        input:focus-visible,
        textarea:focus-visible,
        select:focus-visible {
            border-color: var(--ring);
            box-shadow: 0 0 0 1px var(--ring);
        }

        /* Input Fields */
        .input-group {
            margin-bottom: var(--spacing-4);
        }

        .input-group label {
            display: block;
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--spacing-2);
            color: var(--card-foreground);
        }

        .input-field,
        .select-field {
            width: 100%;
            padding: var(--spacing-2) var(--spacing-3);
            font-size: var(--font-size-base);
            background-color: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            color: var(--foreground);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
        }

        .input-field:focus,
        .select-field:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 1px var(--primary);
            outline: none;
        }

        .dark .input-field,
        .dark .select-field {
            background-color: var(--card);
            /* Lebih gelap dari background utama di dark mode */
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon .input-field {
            padding-left: calc(var(--spacing-3) + 1.5rem + var(--spacing-2));
            /* Ruang untuk ikon */
        }

        .input-with-icon .input-icon {
            position: absolute;
            left: var(--spacing-3);
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted-foreground);
            font-size: 1.25rem;
        }


        /* --- Tata Letak Utama Aplikasi --- */
        .app-container {
            display: none;
            grid-template-columns: var(--sidebar-width) 1fr;
            min-height: 100vh;
            transition: grid-template-columns var(--transition-normal);
        }

        .app-container.sidebar-collapsed {
            grid-template-columns: var(--sidebar-width-collapsed) 1fr;
        }

        /* --- Sidebar --- */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--card);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: width var(--transition-normal), transform var(--transition-normal);
            z-index: 40;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--muted-foreground) transparent;
        }

        .sidebar.collapsed {
            width: var(--sidebar-width-collapsed);
        }

        .sidebar.collapsed .sidebar-logo-text,
        .sidebar.collapsed .sidebar-item-text,
        .sidebar.collapsed .sidebar-group-label,
        .sidebar.collapsed .sidebar-footer-text {
            opacity: 0;
            visibility: hidden;
            width: 0;
            overflow: hidden;
            white-space: nowrap;
        }

        .sidebar.collapsed .sidebar-logo {
            justify-content: center;
        }

        .sidebar.collapsed .sidebar-item a {
            justify-content: center;
        }

        .sidebar.collapsed .sidebar-footer-actions .button {
            justify-content: center;
        }

        .sidebar.collapsed .sidebar-item-icon {
            margin-right: 0;
        }

        .sidebar-header {
            padding: var(--spacing-4);
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--primary);
        }

        .sidebar-logo-icon {
            font-size: 1.5rem;
            transition: transform var(--transition-normal);
        }

        .sidebar-logo:hover .sidebar-logo-icon {
            transform: rotate(15deg);
        }

        .sidebar-logo-text {
            transition: opacity var(--transition-fast), width var(--transition-normal);
        }

        .sidebar-content {
            padding: var(--spacing-4) var(--spacing-2);
            flex-grow: 1;
            overflow-y: auto;
        }

        .sidebar-group {
            margin-bottom: var(--spacing-4);
        }

        .sidebar-group-label {
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            color: var(--muted-foreground);
            padding: 0 var(--spacing-2) var(--spacing-2) var(--spacing-2);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: opacity var(--transition-fast);
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-item {
            margin-bottom: var(--spacing-1);
        }

        .sidebar-item a {
            display: flex;
            align-items: center;
            padding: var(--spacing-2) var(--spacing-3);
            border-radius: var(--radius);
            color: var(--muted-foreground);
            font-weight: var(--font-weight-medium);
            transition: background-color var(--transition-fast), color var(--transition-fast);
            white-space: nowrap;
        }

        .sidebar-item a:hover {
            background-color: var(--accent);
            color: var(--accent-foreground);
        }

        .sidebar-item.active a {
            background-color: var(--primary);
            color: var(--primary-foreground);
            font-weight: var(--font-weight-semibold);
        }

        .sidebar-item.active a .sidebar-item-icon {
            color: var(--primary-foreground);
        }

        .sidebar-item-icon {
            font-size: 1.25rem;
            margin-right: var(--spacing-3);
            min-width: 1.25rem;
            transition: margin-right var(--transition-normal);
            color: var(--muted-foreground);
        }

        .sidebar-item-text {
            transition: opacity var(--transition-fast), width var(--transition-normal);
        }

        .sidebar-footer {
            padding: var(--spacing-4);
            border-top: 1px solid var(--border);
            flex-shrink: 0;
        }

        .sidebar-footer-actions .button .bi {
            font-size: 1.25rem;
        }

        /* --- Kontainer Utama & Header --- */
        .main-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            margin-left: var(--sidebar-width);
            transition: margin-left var(--transition-normal);
        }

        .app-container.sidebar-collapsed .main-container {
            margin-left: var(--sidebar-width-collapsed);
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 var(--spacing-4);
            height: var(--header-height);
            background-color: var(--card);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 30;
        }

        .sidebar-toggle {
            display: none;
            /* Default, tampil di mobile */
            background: none;
            border: none;
            color: var(--foreground);
            padding: var(--spacing-2);
            border-radius: var(--radius);
        }

        .sidebar-toggle .bi {
            font-size: 1.5rem;
        }

        .sidebar-toggle:hover {
            background-color: var(--accent);
        }

        .header-search {
            display: none;
            /* Sembunyikan di mobile, tampil di desktop */
            position: relative;
            flex-grow: 1;
            max-width: 400px;
            margin: 0 var(--spacing-4);
        }

        .header-search .input-field {
            padding-left: calc(var(--spacing-3) + 1.5rem + var(--spacing-2));
            /* Ruang untuk ikon */
            background-color: var(--secondary);
            /* Warna berbeda untuk search bar header */
        }

        .dark .header-search .input-field {
            background-color: var(--muted);
        }

        .header-search .input-icon {
            position: absolute;
            left: var(--spacing-3);
            top: 50%;
            transform: translateY(-50%);
            color: var(--muted-foreground);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
        }

        /* Navigasi Pengguna */
        .user-nav {
            position: relative;
        }

        .user-nav-trigger {
            background-color: var(--primary);
            color: var(--primary-foreground);
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-size-sm);
            border: none;
        }

        .user-nav-menu {
            position: absolute;
            top: calc(100% + var(--spacing-2));
            right: 0;
            background-color: var(--popover);
            color: var(--popover-foreground);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            min-width: 240px;
            box-shadow: var(--shadow-lg);
            z-index: 50;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px);
            transition: opacity var(--transition-fast), visibility var(--transition-fast), transform var(--transition-fast);
        }

        .user-nav-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .user-nav-header {
            padding: var(--spacing-3) var(--spacing-4);
            border-bottom: 1px solid var(--border);
        }

        .user-nav-header .avatar {
            width: 2.5rem;
            height: 2.5rem;
            background-color: var(--secondary);
            color: var(--secondary-foreground);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-weight-medium);
        }

        .user-nav-name {
            font-weight: var(--font-weight-semibold);
        }

        .user-nav-email {
            font-size: var(--font-size-sm);
            color: var(--muted-foreground);
        }

        .user-nav-items {
            list-style: none;
            padding: var(--spacing-2) 0;
        }

        .user-nav-item {
            display: flex;
            align-items: center;
            gap: var(--spacing-3);
            padding: var(--spacing-2) var(--spacing-4);
            font-size: var(--font-size-sm);
            cursor: pointer;
        }

        .user-nav-item:hover {
            background-color: var(--accent);
        }

        .user-nav-item .bi {
            font-size: 1.125rem;
            color: var(--muted-foreground);
        }

        .user-nav-separator {
            height: 1px;
            background-color: var(--border);
            margin: var(--spacing-2) 0;
        }

        /* --- Konten Utama --- */
        .main-content {
            flex-grow: 1;
            padding: var(--spacing-5);
            overflow-y: auto;
        }

        .page {
            display: none;
            animation: fadeIn var(--transition-normal) ease-out;
        }

        .page.active {
            display: block;
        }

        .page-header {
            margin-bottom: var(--spacing-5);
        }

        .page-title {
            font-size: var(--font-size-2xl);
            margin-bottom: var(--spacing-1);
            color: var(--foreground);
        }

        .page-description {
            font-size: var(--font-size-lg);
            color: var(--muted-foreground);
            max-width: 60ch;
        }

        /* --- Komponen UI Umum --- */
        /* Kartu (Card) */
        .card {
            background-color: var(--card);
            color: var(--card-foreground);
            border-radius: var(--radius);
            border: 1px solid var(--border);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .card-header {
            padding: var(--spacing-4);
            border-bottom: 1px solid var(--border);
        }

        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-1);
        }

        .card-description {
            font-size: var(--font-size-sm);
            color: var(--muted-foreground);
            margin-bottom: 0;
        }

        .card-content {
            padding: var(--spacing-4);
            flex-grow: 1;
        }

        .card-footer {
            padding: var(--spacing-4);
            border-top: 1px solid var(--border);
            background-color: var(--secondary);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-3);
        }

        .dark .card-footer {
            background-color: var(--muted);
        }

        /* Lencana (Badge) */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-1);
            padding: var(--spacing-1) var(--spacing-2);
            font-size: var(--font-size-xs);
            font-weight: var(--font-weight-semibold);
            border-radius: calc(var(--radius) / 1.5);
            /* Sedikit lebih bulat */
            border: 1px solid transparent;
        }

        .badge-primary {
            background-color: var(--primary);
            color: var(--primary-foreground);
            border-color: var(--primary);
        }

        .badge-secondary {
            background-color: var(--secondary);
            color: var(--secondary-foreground);
            border-color: var(--secondary);
        }

        .badge-success {
            background-color: var(--success);
            color: var(--success-foreground);
            border-color: var(--success);
        }

        .badge-destructive {
            background-color: var(--destructive);
            color: var(--destructive-foreground);
            border-color: var(--destructive);
        }

        .badge-warning {
            background-color: var(--warning);
            color: var(--warning-foreground);
            border-color: var(--warning);
        }

        .badge-outline {
            background-color: transparent;
            color: var(--primary);
            border-color: var(--primary);
        }

        .badge-muted {
            background-color: var(--muted);
            color: var(--muted-foreground);
            border-color: var(--border);
        }

        /* Kartu Statistik */
        .stats-card .card-header {
            padding-bottom: var(--spacing-2);
            border-bottom: none;
        }

        .stats-card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .stats-card-title {
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            color: var(--muted-foreground);
            margin-bottom: 0;
        }

        .stats-card-icon {
            font-size: 1.5rem;
            color: var(--muted-foreground);
        }

        .stats-card-value {
            font-size: var(--font-size-2xl);
            font-weight: var(--font-weight-bold);
            line-height: 1.2;
            margin-bottom: var(--spacing-1);
        }

        .stats-card-description {
            font-size: var(--font-size-sm);
            color: var(--muted-foreground);
            margin-bottom: 0;
        }

        .stats-card-change {
            font-size: var(--font-size-xs);
            display: flex;
            align-items: center;
        }

        .stats-card-change.positive {
            color: var(--success);
        }

        .stats-card-change.negative {
            color: var(--destructive);
        }


        /* Tab */
        .tabs {
            margin-bottom: var(--spacing-5);
        }

        .tabs-list {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin-bottom: var(--spacing-4);
            gap: var(--spacing-1);
            overflow-x: auto;
        }

        .tab-trigger {
            padding: var(--spacing-2) var(--spacing-4);
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            color: var(--muted-foreground);
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: color var(--transition-fast), border-color var(--transition-fast);
            white-space: nowrap;
            /* Mencegah tab wrap */
        }

        .tab-trigger:hover {
            color: var(--primary);
        }

        .tab-trigger.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            font-weight: var(--font-weight-semibold);
        }

        .tab-content {
            display: none;
            animation: fadeIn var(--transition-normal) ease-out;
        }

        .tab-content.active {
            display: block;
        }

        /* Grafik (Chart) Sederhana */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            background-color: var(--secondary);
            border-radius: var(--radius);
            padding: var(--spacing-4);
            display: flex;
        }

        .dark .chart-container {
            background-color: var(--muted);
        }

        .chart-y-axis {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding-right: var(--spacing-3);
            border-right: 1px solid var(--border);
            height: 100%;
            font-size: var(--font-size-xs);
            color: var(--muted-foreground);
        }

        .chart-y-label {
            text-align: right;
        }

        .chart-bars-area {
            flex-grow: 1;
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            padding-left: var(--spacing-3);
            height: 100%;
        }

        .chart-bar-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100%;
            justify-content: flex-end;
        }

        .chart-bar {
            background-color: var(--primary);
            width: clamp(20px, 4vw, 35px);
            /* Sedikit lebih ramping */
            border-radius: calc(var(--radius) / 2) calc(var(--radius) / 2) 0 0;
            transition: height var(--transition-slow) ease-in-out, background-color var(--transition-fast);
            position: relative;
        }

        .chart-bar:hover {
            background-color: color-mix(in srgb, var(--primary) 80%, black);
        }

        .dark .chart-bar:hover {
            background-color: color-mix(in srgb, var(--primary) 80%, white);
        }

        .chart-label {
            font-size: var(--font-size-xs);
            color: var(--muted-foreground);
            margin-top: var(--spacing-2);
        }

        /* Tabel */
        .table-container {
            overflow-x: auto;
            /* Memungkinkan scroll horizontal pada tabel jika terlalu lebar */
            border: 1px solid var(--border);
            border-radius: var(--radius);
            background-color: var(--card);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-size-sm);
        }

        .table th,
        .table td {
            padding: var(--spacing-3) var(--spacing-4);
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .table th {
            background-color: var(--secondary);
            color: var(--secondary-foreground);
            font-weight: var(--font-weight-semibold);
            white-space: nowrap;
            /* Mencegah header wrap */
        }

        .dark .table th {
            background-color: var(--muted);
        }

        .table tbody tr:last-child td {
            border-bottom: none;
        }

        .table tbody tr:hover {
            background-color: var(--accent);
        }

        .table .action-buttons button {
            margin-right: var(--spacing-1);
        }

        .table .action-buttons button:last-child {
            margin-right: 0;
        }

        /* Loading State Placeholder */
        .loading-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--spacing-6);
            text-align: center;
            color: var(--muted-foreground);
        }

        .loading-spinner {
            width: 2rem;
            height: 2rem;
            border: 3px solid var(--accent);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: var(--spacing-3);
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }


        /* Utility Classes (Mirip Tailwind) */
        .w-full {
            width: 100%;
        }

        .h-auto {
            height: auto;
        }

        .h-48 {
            height: 12rem;
        }

        /* 192px */
        .object-cover {
            object-fit: cover;
        }

        .mb-6 {
            margin-bottom: var(--spacing-6);
        }

        .mt-6 {
            margin-top: var(--spacing-6);
        }

        .mt-4 {
            margin-top: var(--spacing-4);
        }

        .mt-2 {
            margin-top: var(--spacing-2);
        }

        .mt-1 {
            margin-top: var(--spacing-1);
        }

        .py-12 {
            padding-top: var(--spacing-6);
            padding-bottom: var(--spacing-6);
        }

        .py-8 {
            padding-top: calc(var(--spacing-6) * 0.66);
            padding-bottom: calc(var(--spacing-6) * 0.66);
        }

        .mb-4 {
            margin-bottom: var(--spacing-4);
        }

        .mb-2 {
            margin-bottom: var(--spacing-2);
        }

        .p-6 {
            padding: var(--spacing-5);
        }

        .p-4 {
            padding: var(--spacing-4);
        }

        .p-2 {
            padding: var(--spacing-2);
        }

        /* Grid System */
        .grid {
            display: grid;
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, minmax(0, 1fr));
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }

        .grid-cols-fill-250 {
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        }

        /* Untuk card apartemen */
        .col-span-full {
            grid-column: 1 / -1;
        }

        /* Flexbox Utilities */
        .flex {
            display: flex;
        }

        .flex-col {
            flex-direction: column;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .items-center {
            align-items: center;
        }

        .items-start {
            align-items: flex-start;
        }

        .items-end {
            align-items: flex-end;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .justify-start {
            justify-content: flex-start;
        }

        .gap-1 {
            gap: var(--spacing-1);
        }

        .gap-2 {
            gap: var(--spacing-2);
        }

        .gap-3 {
            gap: var(--spacing-3);
        }

        .gap-4 {
            gap: var(--spacing-4);
        }

        .gap-6 {
            gap: var(--spacing-6);
        }

        .space-y-4> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-4);
        }

        /* Rounded & Sizing Utilities */
        .rounded-md {
            border-radius: calc(var(--radius) / 1.5);
        }

        .rounded-lg {
            border-radius: var(--radius);
        }

        .rounded-full {
            border-radius: 9999px;
        }

        .w-5 {
            width: 1.25rem;
        }

        .h-5 {
            height: 1.25rem;
        }

        .w-10 {
            width: 2.5rem;
        }

        .h-10 {
            height: 2.5rem;
        }

        .mr-2 {
            margin-right: var(--spacing-2);
        }

        .ml-auto {
            margin-left: auto;
        }

        /* Text Utilities */
        .text-xs {
            font-size: var(--font-size-xs);
        }

        .text-sm {
            font-size: var(--font-size-sm);
        }

        .text-lg {
            font-size: var(--font-size-lg);
        }

        .text-xl {
            font-size: var(--font-size-xl);
        }

        .font-semibold {
            font-weight: var(--font-weight-semibold);
        }

        .font-medium {
            font-weight: var(--font-weight-medium);
        }

        .text-muted-foreground {
            color: var(--muted-foreground);
        }

        .text-primary {
            color: var(--primary);
        }

        .text-success {
            color: var(--success);
        }

        .text-destructive {
            color: var(--destructive);
        }

        .text-warning {
            color: var(--warning);
        }

        .text-right {
            text-align: right;
        }

        .text-center {
            text-align: center;
        }

        .max-w-md {
            max-width: 28rem;
        }

        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        /* Background Colors */
        .bg-blue-100 {
            background-color: #DBEAFE;
        }

        .dark .bg-blue-100 {
            background-color: #1e40af;
        }

        .text-blue-600 {
            color: #2563EB;
        }

        .dark .text-blue-600 {
            color: #93c5fd;
        }

        .bg-green-100 {
            background-color: #D1FAE5;
        }

        .dark .bg-green-100 {
            background-color: #065f46;
        }

        .text-green-600 {
            color: #059669;
        }

        .dark .text-green-600 {
            color: #6ee7b7;
        }

        .bg-yellow-100 {
            background-color: #FEF9C3;
        }

        /* amber-100 */
        .dark .bg-yellow-100 {
            background-color: #78350f;
        }

        /* amber-900 */
        .text-yellow-600 {
            color: #D97706;
        }

        /* amber-600 */
        .dark .text-yellow-600 {
            color: #FCD34D;
        }

        /* amber-300 */
        .bg-red-100 {
            background-color: #FEE2E2;
        }

        /* red-100 */
        .dark .bg-red-100 {
            background-color: #7f1d1d;
        }

        /* red-900 */
        .text-red-600 {
            color: #DC2626;
        }

        /* red-600 */
        .dark .text-red-600 {
            color: #F87171;
        }

        /* red-400 */
        .bg-muted {
            background-color: var(--muted);
        }


        /* --- Animasi --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInFromLeft {
            from {
                transform: translateX(-20px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .fade-in {
            animation: fadeIn var(--transition-normal) ease-out;
        }

        .slide-in-left {
            animation: slideInFromLeft var(--transition-normal) ease-out;
        }

        /* --- Aksesibilitas --- */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* --- Desain Responsif --- */
        @media (min-width: 769px) {

            /* Desktop dan tablet besar */
            .header-search {
                display: block;
                /* Tampilkan search bar di header */
            }
        }

        @media (max-width: 1024px) {

            /* Tablet */
            :root {
                --sidebar-width: 16rem;
            }

            #dashboardPage .grid-cols-4,
            #dashboardPage .lg\:grid-cols-4 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .page .grid-cols-2,
            .page .lg\:grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .page-title {
                font-size: var(--font-size-xl);
            }

            .header-search {
                max-width: 300px;
            }
        }

        @media (max-width: 768px) {

            /* Mobile */
            .app-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                transform: translateX(-100%);
                box-shadow: var(--shadow-lg);
                width: 80vw;
                max-width: 280px;
            }

            .sidebar.mobile-active {
                transform: translateX(0);
            }

            .app-container.sidebar-collapsed .main-container,
            .main-container {
                margin-left: 0;
            }

            .sidebar-toggle {
                display: block;
            }

            .header-search {
                display: none;
            }

            /* Sembunyikan search di header mobile */
            .header {
                padding: 0 var(--spacing-3);
            }

            /* Kurangi padding header di mobile */


            .stats-card-icon {
                display: none;
            }

            .card-footer {
                flex-direction: column;
                gap: var(--spacing-2);
            }

            .card-footer .button {
                width: 100%;
            }

            #dashboardPage .grid-cols-4,
            #dashboardPage .grid-cols-2,
            #dashboardPage .lg\:grid-cols-4,
            /* Pastikan ini juga direset */
            #apartemenPage .grid,
            /* Grid langsung di tab content */
            #pengaturanPage .md\:grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .tabs-list {
                padding-bottom: var(--spacing-1);
            }

            /* Agar scrollbar tidak terlalu mepet */
        }

        @media (max-width: 640px) {

            /* Smartphone */
            :root {
                --spacing-4: 0.875rem;
                --spacing-5: 1.25rem;
            }

            .page-header {
                margin-bottom: var(--spacing-4);
            }

            .main-content {
                padding: var(--spacing-4);
            }

            .page-title {
                font-size: var(--font-size-lg);
            }

            .page-description {
                font-size: var(--font-size-base);
            }

            .user-nav-menu {
                min-width: 200px;
            }

            .button {
                padding: var(--spacing-2) var(--spacing-3);
            }

            /* Kurangi padding tombol sedikit */
            .button-sm {
                padding: var(--spacing-1) var(--spacing-2);
            }
        }

        /* --- Gaya Cetak (Print) --- */
        @media print {

            .sidebar,
            .header,
            .splash-screen,
            .sidebar-footer,
            .card-footer button,
            .page-header .button,
            .tabs-list,
            .user-nav,
            .sidebar-toggle,
            #themeToggle,
            #pengaturanThemeToggle,
            .mobile-overlay,
            .header-search,
            .action-buttons {
                display: none !important;
            }

            body {
                background-color: #fff !important;
                color: #000 !important;
                font-size: 10pt;
            }

            html {
                font-size: 10pt;
            }

            .app-container,
            .main-container,
            .main-content,
            .page,
            .page.active {
                display: block !important;
                margin: 0 !important;
                padding: 0 !important;
                width: auto !important;
                grid-template-columns: 1fr !important;
            }

            .card {
                box-shadow: none !important;
                border: 1px solid #ccc !important;
                page-break-inside: avoid;
            }

            a {
                text-decoration: none;
                color: #000 !important;
            }

            a[href^="http"]:after {
                content: " (" attr(href) ")";
                font-size: 0.8em;
            }

            .page-title {
                font-size: 16pt;
            }

            .page-description {
                font-size: 10pt;
                color: #333 !important;
            }

            .card-title {
                font-size: 12pt;
            }

            .grid {
                display: block !important;
            }

            .grid>* {
                margin-bottom: 1rem;
            }

            .table-container {
                overflow: visible;
            }

            .table th,
            .table td {
                font-size: 9pt;
                padding: var(--spacing-2);
            }

            .badge {
                border: 1px solid #666 !important;
                background-color: #eee !important;
                color: #000 !important;
            }
        }
    </style>
</head>

<body>
    <!-- Splash Screen -->
    <div class="splash-screen" id="splashScreen">
        <div class="splash-logo"><i class="bi bi-buildings-fill"></i></div>
        <h1 class="splash-title">RentEase</h1>
        <p class="splash-subtitle">Platform Sewa Apartemen Terpercaya</p>
    </div>

    <!-- Mobile Overlay for Sidebar -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Kontainer Utama Aplikasi -->
    <div class="app-container" id="appContainer">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar" role="navigation" aria-label="Navigasi Utama">
            <div class="sidebar-header">
                <a href="#dashboard" class="sidebar-logo" aria-label="Beranda RentEase">
                    <i class="bi bi-buildings-fill sidebar-logo-icon"></i>
                    <span class="sidebar-logo-text">RentEase</span>
                </a>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-group">
                    <div class="sidebar-group-label">Menu Utama</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item active" data-page="dashboard">
                            <a href="#dashboard" aria-current="page">
                                <i class="bi bi-house-door-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Beranda</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="apartemen">
                            <a href="#apartemen">
                                <i class="bi bi-building-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Apartemen</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="booking">
                            <a href="#booking">
                                <i class="bi bi-calendar-check-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Booking Saya</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="favorit">
                            <a href="#favorit">
                                <i class="bi bi-heart-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Favorit</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-group">
                    <div class="sidebar-group-label">Manajemen</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-page="pembayaran">
                            <a href="#pembayaran">
                                <i class="bi bi-credit-card-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Pembayaran</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="maintenance">
                            <a href="#maintenance">
                                <i class="bi bi-tools sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Maintenance</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="riwayat">
                            <a href="#riwayat">
                                <i class="bi bi-journal-text sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Riwayat</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="sidebar-group">
                    <div class="sidebar-group-label">Akun</div>
                    <ul class="sidebar-menu">
                        <li class="sidebar-item" data-page="pesan">
                            <a href="#pesan">
                                <i class="bi bi-chat-left-dots-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Pesan</span>
                                <span class="badge badge-primary ml-auto"
                                    style="padding: 2px 6px; font-size: 0.7rem; display:none;" id="pesanBadge">1</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="notifikasi">
                            <a href="#notifikasi">
                                <i class="bi bi-bell-fill sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Notifikasi</span>
                                <span class="badge badge-primary ml-auto"
                                    style="padding: 2px 6px; font-size: 0.7rem; display:none;" id="notifBadge">3</span>
                            </a>
                        </li>
                        <li class="sidebar-item" data-page="profil">
                            <a href="#profil">
                                <i class="bi bi-person-circle sidebar-item-icon" aria-hidden="true"></i>
                                <span class="sidebar-item-text">Profil & Pengaturan</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="sidebar-footer">
                <div class="sidebar-footer-actions">
                    <button class="button button-outline button-block" id="themeToggle" aria-label="Ganti Tema">
                        <i class="bi bi-moon-stars-fill" aria-hidden="true"></i>
                        <span class="sidebar-footer-text">Mode Gelap</span>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Kontainer Konten Utama -->
        <div class="main-container">
            <header class="header" role="banner">
                <button class="sidebar-toggle" id="sidebarToggle" aria-label="Alihkan navigasi samping"
                    aria-expanded="false">
                    <i class="bi bi-list"></i>
                </button>
                <div class="header-search">
                    <i class="bi bi-search input-icon"></i>
                    <input type="search" class="input-field" placeholder="Cari apartemen, lokasi..."
                        id="headerSearchInput" aria-label="Pencarian Global">
                </div>
                <div class="header-actions">
                    <div class="user-nav">
                        <button class="user-nav-trigger" id="userNavTrigger" aria-label="Menu Pengguna"
                            aria-haspopup="true" aria-expanded="false">
                            JD
                        </button>
                        <div class="user-nav-menu" id="userNavMenu" role="menu" aria-labelledby="userNavTrigger">
                            <div class="user-nav-header">
                                <div class="flex items-center gap-3">
                                    <div class="avatar" id="userNavAvatar">JD</div>
                                    <div>
                                        <div class="user-nav-name" id="userNavName">John Doe</div>
                                        <div class="user-nav-email" id="userNavEmail">john.doe@example.com</div>
                                    </div>
                                </div>
                            </div>
                            <ul class="user-nav-items" role="none">
                                <li class="user-nav-item" role="menuitem" data-action="profil">
                                    <i class="bi bi-person-circle" aria-hidden="true"></i> Profil Saya
                                </li>
                                <li class="user-nav-item" role="menuitem" data-action="pengaturan">
                                    <i class="bi bi-gear-fill" aria-hidden="true"></i> Pengaturan Akun
                                </li>
                                <li class="user-nav-item" role="menuitem" data-action="bantuan">
                                    <i class="bi bi-question-circle-fill" aria-hidden="true"></i> Bantuan
                                </li>
                                <div class="user-nav-separator" role="separator"></div>
                                <li class="user-nav-item" role="menuitem" data-action="logout">
                                    <i class="bi bi-box-arrow-right" aria-hidden="true"></i> Keluar
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </header>

            <main class="main-content" id="mainContent">
                <!-- Halaman Beranda (Dashboard) -->
                <section id="dashboardPage" class="page active">
                    <div class="page-header">
                        <h1 class="page-title">Beranda</h1>
                        <p class="page-description">Selamat datang kembali, <span
                                id="dashboardUserName">Pengguna</span>! Kelola penyewaan apartemen Anda.</p>
                    </div>

                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="card stats-card">
                            <div class="card-header">
                                <div class="stats-card-header">
                                    <h3 class="stats-card-title">Booking Aktif</h3><i
                                        class="bi bi-building-check stats-card-icon"></i>
                                </div>
                            </div>
                            <div class="card-content">
                                <div class="stats-card-value" id="statsBookingAktif">0</div>
                                <p class="stats-card-description">Unit sedang disewa</p>
                            </div>
                        </div>
                        <div class="card stats-card">
                            <div class="card-header">
                                <div class="stats-card-header">
                                    <h3 class="stats-card-title">Pembayaran Tertunda</h3><i
                                        class="bi bi-credit-card-2-back stats-card-icon"></i>
                                </div>
                            </div>
                            <div class="card-content">
                                <div class="stats-card-value" id="statsPembayaranTertunda">0</div>
                                <p class="stats-card-description">Tagihan belum lunas</p>
                            </div>
                        </div>
                        <div class="card stats-card">
                            <div class="card-header">
                                <div class="stats-card-header">
                                    <h3 class="stats-card-title">Permintaan Maintenance</h3><i
                                        class="bi bi-tools stats-card-icon"></i>
                                </div>
                            </div>
                            <div class="card-content">
                                <div class="stats-card-value" id="statsMaintenanceRequests">0</div>
                                <p class="stats-card-description">Perlu tindakan</p>
                            </div>
                        </div>
                        <div class="card stats-card">
                            <div class="card-header">
                                <div class="stats-card-header">
                                    <h3 class="stats-card-title">Properti Disimpan</h3><i
                                        class="bi bi-heart stats-card-icon"></i>
                                </div>
                            </div>
                            <div class="card-content">
                                <div class="stats-card-value" id="statsPropertiDisimpan">0</div>
                                <p class="stats-card-description">Dalam daftar favorit</p>
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="card lg:col-span-2">
                            <div class="card-header">
                                <h2 class="card-title">Aktivitas Terbaru</h2>
                                <p class="card-description">Ringkasan aktivitas terkait akun Anda.</p>
                            </div>
                            <div class="card-content p-0"> <!-- p-0 untuk table-container mengambil full width card -->
                                <div class="table-container">
                                    <table class="table" id="dashboardAktivitasTable">
                                        <thead>
                                            <tr>
                                                <th>Tanggal</th>
                                                <th>Deskripsi</th>
                                                <th>Status</th>
                                                <th>Aksi</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Diisi oleh JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Jatuh Tempo Penting</h2>
                                <p class="card-description">Tanggal-tanggal penting yang akan datang.</p>
                            </div>
                            <div class="card-content space-y-4" id="dashboardJatuhTempoList">
                                <!-- Diisi oleh JavaScript -->
                            </div>
                        </div>
                    </div>


                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Grafik Pengeluaran Sewa (6 Bulan Terakhir)</h2>
                            <p class="card-description">Visualisasi pengeluaran sewa bulanan Anda.</p>
                        </div>
                        <div class="card-content">
                            <div class="chart-container">
                                <div class="chart-y-axis" id="dashboardChartYAxis">
                                    <!-- Diisi oleh JS -->
                                </div>
                                <div class="chart-bars-area" id="dashboardChartArea">
                                    <!-- Diisi oleh JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Halaman Apartemen -->
                <section id="apartemenPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Daftar Apartemen</h1>
                        <p class="page-description">Temukan apartemen impian Anda di sini.</p>
                    </div>

                    <div class="card mb-6">
                        <div class="card-header">
                            <h2 class="card-title">Filter Pencarian</h2>
                        </div>
                        <div class="card-content">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                <div class="input-group">
                                    <label for="filterHarga">Rentang Harga (per bulan)</label>
                                    <select id="filterHarga" class="select-field">
                                        <option value="">Semua Harga</option>
                                        <option value="0-2000000">Rp 0 - Rp 2.000.000</option>
                                        <option value="2000001-4000000">Rp 2.000.001 - Rp 4.000.000</option>
                                        <option value="4000001-6000000">Rp 4.000.001 - Rp 6.000.000</option>
                                        <option value="6000001-100000000">Diatas Rp 6.000.000</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label for="filterKamar">Jumlah Kamar Tidur</label>
                                    <select id="filterKamar" class="select-field">
                                        <option value="">Semua</option>
                                        <option value="Studio">Studio</option>
                                        <option value="1">1 Kamar Tidur</option>
                                        <option value="2">2 Kamar Tidur</option>
                                        <option value="3">3+ Kamar Tidur</option>
                                    </select>
                                </div>
                                <div class="input-group">
                                    <label for="filterAmenitas">Amenitas</label>
                                    <select id="filterAmenitas" class="select-field">
                                        <option value="">Semua</option>
                                        <option value="Parkir">Parkir</option>
                                        <option value="Gym">Gym</option>
                                        <option value="Kolam Renang">Kolam Renang</option>
                                        <option value="Furnished">Furnished</option>
                                    </select>
                                </div>
                                <div class="input-group md:col-start-2 lg:col-start-4">
                                    <label class="invisible">Aksi Filter</label> <!-- Untuk alignment -->
                                    <button class="button button-primary button-block" id="terapkanFilterBtn">
                                        <i class="bi bi-funnel-fill"></i> Terapkan Filter
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="apartemenListContainer" class="grid grid-cols-fill-250 gap-4">
                        <!-- Kartu apartemen diisi oleh JavaScript -->
                    </div>
                    <div id="apartemenEmptyState" class="col-span-full" style="display:none;">
                        <!-- Pesan state kosong diisi JS -->
                    </div>

                    <div class="card mt-6">
                        <div class="card-header">
                            <h2 class="card-title">Baru Dilihat</h2>
                        </div>
                        <div class="card-content">
                            <div id="recentlyViewedApartments" class="grid grid-cols-fill-250 gap-4">
                                <!-- Diisi oleh JS -->
                                <p class="text-muted-foreground col-span-full">Anda belum melihat apartemen apa pun
                                    baru-baru ini.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Halaman Booking Saya -->
                <section id="bookingPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Booking Saya</h1>
                        <p class="page-description">Kelola semua booking apartemen Anda.</p>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Daftar Booking</h2>
                        </div>
                        <div class="card-content p-0">
                            <div class="table-container">
                                <table class="table" id="bookingTable">
                                    <thead>
                                        <tr>
                                            <th>Apartemen</th>
                                            <th>Periode Sewa</th>
                                            <th>Total Biaya</th>
                                            <th>Status Booking</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="bookingEmptyState" class="p-4" style="display:none;">
                                <!-- Pesan state kosong diisi JS -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Halaman Favorit -->
                <section id="favoritPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Apartemen Favorit</h1>
                        <p class="page-description">Daftar apartemen yang telah Anda simpan.</p>
                    </div>
                    <div id="favoritListContainer" class="grid grid-cols-fill-250 gap-4">
                        <!-- Kartu apartemen favorit diisi oleh JavaScript -->
                    </div>
                    <div id="favoritEmptyState" class="col-span-full" style="display:none;">
                        <!-- Pesan state kosong diisi JS -->
                    </div>
                </section>

                <!-- Halaman Riwayat -->
                <section id="riwayatPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Riwayat Aktivitas</h1>
                        <p class="page-description">Semua riwayat transaksi dan aktivitas Anda.</p>
                    </div>
                    <div class="tabs" id="riwayatTabs">
                        <div class="tabs-list" role="tablist" aria-label="Filter Riwayat">
                            <button class="tab-trigger active" data-tab-target="#riwayat-sewa-tab" aria-selected="true"
                                role="tab">Sewa</button>
                            <button class="tab-trigger" data-tab-target="#riwayat-pembayaran-tab" aria-selected="false"
                                role="tab">Pembayaran</button>
                            <button class="tab-trigger" data-tab-target="#riwayat-maintenance-tab" aria-selected="false"
                                role="tab">Maintenance</button>
                        </div>

                        <div class="tab-content active" id="riwayat-sewa-tab" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Riwayat Sewa</h2>
                                </div>
                                <div class="card-content space-y-4" id="riwayatSewaList">
                                    <!-- Diisi JS -->
                                </div>
                            </div>
                        </div>
                        <div class="tab-content" id="riwayat-pembayaran-tab" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Riwayat Pembayaran</h2>
                                </div>
                                <div class="card-content space-y-4" id="riwayatPembayaranList">
                                    <!-- Diisi JS -->
                                </div>
                            </div>
                        </div>
                        <div class="tab-content" id="riwayat-maintenance-tab" role="tabpanel">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="card-title">Riwayat Maintenance</h2>
                                </div>
                                <div class="card-content space-y-4" id="riwayatMaintenanceList">
                                    <!-- Diisi JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Halaman Pembayaran -->
                <section id="pembayaranPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Pembayaran</h1>
                        <p class="page-description">Kelola tagihan dan riwayat pembayaran Anda.</p>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Tagihan Saat Ini</h2>
                        </div>
                        <div class="card-content p-0">
                            <div class="table-container">
                                <table class="table" id="tagihanTable">
                                    <thead>
                                        <tr>
                                            <th>Deskripsi</th>
                                            <th>Jatuh Tempo</th>
                                            <th>Jumlah</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Diisi oleh JS -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="tagihanEmptyState" class="p-4" style="display:none;">
                                <!-- Pesan state kosong diisi JS -->
                            </div>
                        </div>
                    </div>
                    <div class="card mt-6">
                        <div class="card-header">
                            <h2 class="card-title">Metode Pembayaran Tersimpan</h2>
                        </div>
                        <div class="card-content">
                            <div id="metodePembayaranList" class="space-y-3">
                                <!-- Diisi oleh JS -->
                            </div>
                            <button class="button button-outline mt-4"><i class="bi bi-plus-circle"></i> Tambah
                                Metode</button>
                        </div>
                    </div>
                </section>

                <!-- Halaman Maintenance -->
                <section id="maintenancePage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Permintaan Maintenance</h1>
                        <p class="page-description">Ajukan dan lacak permintaan perbaikan untuk apartemen Anda.</p>
                    </div>
                    <div class="flex justify-end mb-4">
                        <button class="button button-primary" id="buatPermintaanMaintenanceBtn">
                            <i class="bi bi-plus-lg"></i> Buat Permintaan Baru
                        </button>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Daftar Permintaan Maintenance</h2>
                        </div>
                        <div class="card-content p-0">
                            <div class="table-container">
                                <table class="table" id="maintenanceTable">
                                    <thead>
                                        <tr>
                                            <th>ID Tiket</th>
                                            <th>Apartemen</th>
                                            <th>Masalah</th>
                                            <th>Tanggal Diajukan</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- Diisi oleh JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="maintenanceEmptyState" class="p-4" style="display:none;">
                                <!-- Pesan state kosong diisi JS -->
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Halaman Pesan -->
                <section id="pesanPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Pesan</h1>
                        <p class="page-description">Komunikasi dengan pemilik atau customer service.</p>
                    </div>
                    <div class="card">
                        <div class="card-content text-center py-12">
                            <i class="bi bi-chat-quote text-primary" style="font-size: 3rem;"></i>
                            <h2 class="text-xl font-semibold mt-4 mb-2">Segera Hadir</h2>
                            <p class="text-muted-foreground max-w-md mx-auto">
                                Fitur perpesanan akan segera tersedia. Anda dapat berkomunikasi langsung terkait
                                penyewaan apartemen Anda di sini.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Halaman Notifikasi -->
                <section id="notifikasiPage" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Notifikasi</h1>
                        <p class="page-description">Semua pemberitahuan penting untuk Anda.</p>
                    </div>
                    <div class="card">
                        <div class="card-header flex justify-between items-center">
                            <div>
                                <h2 class="card-title">Daftar Notifikasi</h2>
                                <p class="card-description">Pemberitahuan terbaru ada di paling atas.</p>
                            </div>
                            <button class="button button-sm button-outline" id="markAllAsReadBtn">
                                <i class="bi bi-check2-all"></i> Tandai semua dibaca
                            </button>
                        </div>
                        <div class="card-content p-0" id="notifikasiListContainer">
                            <!-- p-0 untuk item notif full width -->
                            <!-- Notifikasi akan di-render di sini oleh JS -->
                        </div>
                        <div id="notifikasiEmptyState" class="p-4" style="display:none;">
                            <!-- Pesan state kosong diisi JS -->
                        </div>
                    </div>
                </section>

                <!-- Halaman Profil & Pengaturan -->
                <section id="profilPage" class="page"> <!-- ID diubah dari pengaturanPage menjadi profilPage -->
                    <div class="page-header">
                        <h1 class="page-title">Profil & Pengaturan</h1>
                        <p class="page-description">Kelola informasi profil dan preferensi aplikasi Anda.</p>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Informasi Pengguna</h2>
                            </div>
                            <div class="card-content space-y-3">
                                <p><strong>Nama:</strong> <span id="settingUserName">John Doe</span></p>
                                <p><strong>Email:</strong> <span id="settingUserEmail">john.doe@example.com</span></p>
                                <p><strong>Telepon:</strong> <span id="settingUserPhone">-</span></p>
                                <p><strong>Bergabung Sejak:</strong> <span id="settingUserJoined"></span></p>
                                <button class="button button-outline mt-4"><i class="bi bi-pencil-square"></i> Ubah
                                    Profil</button>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Preferensi Tampilan</h2>
                            </div>
                            <div class="card-content">
                                <div class="flex items-center justify-between">
                                    <span>Mode Gelap Aplikasi</span>
                                    <button class="button button-secondary" id="pengaturanThemeToggle">
                                        <i class="bi bi-moon-stars-fill" aria-hidden="true"></i>
                                        <span class="button-text">Aktifkan Mode Gelap</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Keamanan Akun</h2>
                            </div>
                            <div class="card-content">
                                <button class="button button-outline button-block mb-3"><i
                                        class="bi bi-shield-lock"></i> Ubah Kata Sandi</button>
                                <button class="button button-outline button-block"><i class="bi bi-shield-check"></i>
                                    Aktivitas Login</button>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <h2 class="card-title">Preferensi Notifikasi</h2>
                            </div>
                            <div class="card-content space-y-3">
                                <div class="flex items-center justify-between">
                                    <span>Notifikasi Email</span>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer" checked>
                                        <div
                                            class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary">
                                        </div>
                                    </label>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span>Notifikasi Push Aplikasi</span>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only peer">
                                        <div
                                            class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-primary">
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

            </main>
        </div>
    </div>

    <script>
        // --- State Aplikasi Sederhana ---
        const AppState = {
            currentPage: 'dashboard',
            theme: localStorage.getItem('rentease-theme') || 'light',
            isSidebarCollapsed: localStorage.getItem('rentease-sidebar-collapsed') === 'true',
            user: {
                name: "John Doe",
                email: "john.doe@example.com",
                initials: "JD",
                phone: "081234567890",
                joinedDate: "2023-01-15"
            },
            apartments: [
                { id: "apt001", name: "Apartemen Sky Garden", address: "Jl. Sudirman Kav. 10, Jakarta Pusat", type: "2 Kamar Tidur", price: 3500000, rentUntil: "2024-12-31", image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=400&q=60", paymentStatus: "Lunas", period: "1 Jan 2024 - 31 Des 2024", totalPayment: 42000000, nextDueDate: "2024-07-28", amenities: ["Parkir", "Gym", "Kolam Renang"], beds: 2, baths: 1, area: 75, isFavorite: true, statusBooking: "Aktif", bookingId: "BK001" },
                { id: "apt002", name: "Apartemen Green Valley", address: "Jl. TB Simatupang No. 18, Jakarta Selatan", type: "1 Kamar Tidur", price: 2800000, rentUntil: "2025-01-15", image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=400&q=60", paymentStatus: "Belum Lunas", period: "15 Jul 2024 - 15 Jan 2025", totalPayment: 16800000, nextDueDate: "2024-06-25", amenities: ["Parkir", "Furnished"], beds: 1, baths: 1, area: 50, isFavorite: false, statusBooking: "Aktif", bookingId: "BK002" },
                { id: "apt003", name: "Apartemen City Lights", address: "Jl. Casablanca Raya Kav. 9, Jakarta Selatan", type: "3 Kamar Tidur", price: 5500000, rentUntil: "2024-05-31", image: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=400&q=60", paymentStatus: "Lunas", period: "1 Jun 2023 - 31 Mei 2024", totalPayment: 66000000, nextDueDate: null, amenities: ["Gym", "Kolam Renang", "Furnished"], beds: 3, baths: 2, area: 120, isFavorite: true, statusBooking: "Selesai", bookingId: "BK003" },
                { id: "apt004", name: "Apartemen Urban Nest", address: "Jl. Basuki Rahmat No.1A, Jakarta Timur", type: "Studio", price: 1900000, rentUntil: "2024-04-30", image: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGFwYXJ0bWVudCUyMGludGVyaW9yfGVufDB8fHwwfHx8MA%3D%3D&auto=format&fit=crop&w=400&q=60", paymentStatus: "Lunas", period: "1 Mei 2023 - 30 Apr 2024", totalPayment: 22800000, nextDueDate: null, amenities: ["Parkir"], beds: 0, baths: 1, area: 30, isFavorite: false, statusBooking: "Selesai", bookingId: "BK004" },
                { id: "apt005", name: "Apartemen The Residence", address: "Jl. HR Rasuna Said, Jakarta Selatan", type: "2 Kamar Tidur", price: 4200000, rentUntil: null, image: "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fGFwYXJ0bWVudCUyMGludGVyaW9yfGVufDB8fHwwfHx8MA%3D%3D&auto=format&fit=crop&w=400&q=60", paymentStatus: null, period: null, totalPayment: null, nextDueDate: null, amenities: ["Kolam Renang", "Gym", "Furnished"], beds: 2, baths: 2, area: 85, isFavorite: false, statusBooking: "Tersedia" },
            ],
            notifications: [
                { id: 1, title: "Pembayaran Jatuh Tempo", message: "Tagihan sewa Apartemen Sky Garden sebesar Rp 3.500.000 jatuh tempo pada 28 Juli 2024.", date: "2024-07-23", read: false, type: "payment_due", icon: "bi-credit-card-2-front-fill", iconBg: "bg-red-100", iconColor: "text-red-600", actionLink: "#pembayaran" },
                { id: 2, title: "Pembayaran Berhasil", message: "Pembayaran sewa Apartemen Green Valley bulan Juni telah berhasil.", date: "2024-06-24", read: true, type: "payment_success", icon: "bi-check-circle-fill", iconBg: "bg-green-100", iconColor: "text-green-600" },
                { id: 3, title: "Permintaan Maintenance Diproses", message: "Permintaan maintenance #MNT001 untuk Apartemen Sky Garden sedang ditinjau.", date: "2024-07-22", read: false, type: "maintenance_update", icon: "bi-tools", iconBg: "bg-yellow-100", iconColor: "text-yellow-600", actionLink: "#maintenance" },
                { id: 4, title: "Update Kebijakan Privasi", message: "Kami telah memperbarui kebijakan privasi kami. Silakan tinjau.", date: "2024-07-10", read: true, type: "announcement", icon: "bi-shield-lock-fill", iconBg: "bg-blue-100", iconColor: "text-blue-600" },
            ],
            messages: [
                { id: 1, sender: "Admin RentEase", subject: "Selamat Datang di RentEase!", date: "2024-07-20", read: false },
            ],
            maintenanceRequests: [
                { id: "MNT001", apartmentId: "apt001", apartmentName: "Apartemen Sky Garden", issue: "Keran bocor di kamar mandi", dateSubmitted: "2024-07-22", status: "Sedang Ditinjau" },
                { id: "MNT002", apartmentId: "apt002", apartmentName: "Apartemen Green Valley", issue: "AC tidak dingin", dateSubmitted: "2024-07-15", status: "Selesai" },
            ],
            payments: [ // Untuk halaman pembayaran dan riwayat
                { id: "PAY001", apartmentName: "Apartemen Sky Garden", description: "Sewa Bulan Juli 2024", dueDate: "2024-07-28", amount: 3500000, status: "Belum Lunas" },
                { id: "PAY002", apartmentName: "Apartemen Green Valley", description: "Sewa Bulan Juni 2024", dueDate: "2024-06-25", amount: 2800000, status: "Lunas", paidDate: "2024-06-24" },
                { id: "PAY003", apartmentName: "Apartemen City Lights", description: "Sewa Bulan Mei 2024", dueDate: "2024-05-25", amount: 5500000, status: "Lunas", paidDate: "2024-05-23" },
            ],
            paymentMethods: [
                { id: "PM001", type: "Kartu Kredit", provider: "Visa", lastDigits: "4242", expiry: "12/25", isDefault: true },
                { id: "PM002", type: "Bank Transfer", provider: "BCA Virtual Account", lastDigits: "8808...", isDefault: false },
            ],
            chartData: [
                { month: "Feb", value: 3.5 }, { month: "Mar", value: 2.8 }, { month: "Apr", value: 5.5 },
                { month: "Mei", value: 2.8 }, { month: "Jun", value: 3.5 }, { month: "Jul", value: 0 } // Pengeluaran bulan ini (awal bulan)
            ],
            recentlyViewed: [], // Array of apartment IDs
        };

        // --- Elemen DOM Utama ---
        const splashScreen = document.getElementById('splashScreen');
        const appContainer = document.getElementById('appContainer');
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const mobileOverlay = document.getElementById('mobileOverlay');
        const themeToggleButtons = [document.getElementById('themeToggle'), document.getElementById('pengaturanThemeToggle')];
        const userNavTrigger = document.getElementById('userNavTrigger');
        const userNavMenu = document.getElementById('userNavMenu');
        const sidebarMenuItems = document.querySelectorAll('.sidebar-item');
        const pages = document.querySelectorAll('.page');
        const mainContent = document.getElementById('mainContent');

        const notifBadge = document.getElementById('notifBadge');
        const pesanBadge = document.getElementById('pesanBadge');
        const markAllAsReadBtn = document.getElementById('markAllAsReadBtn');
        const headerSearchInput = document.getElementById('headerSearchInput');


        // --- Fungsi Utilitas ---
        function formatCurrency(number) {
            if (typeof number !== 'number') return 'Rp -';
            return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(number);
        }

        function formatDate(dateString, options = { day: '2-digit', month: 'long', year: 'numeric' }) {
            if (!dateString) return '-';
            try {
                const date = new Date(dateString);
                if (isNaN(date.getTime())) return '-'; // Invalid date
                return date.toLocaleDateString('id-ID', options);
            } catch (e) {
                return '-';
            }
        }

        function createEmptyState(message, iconClass = 'bi-inbox', title = "Data Kosong") {
            return `
                <div class="col-span-full flex flex-col items-center justify-center py-12 text-center fade-in">
                    <div class="rounded-full bg-muted p-6 mb-4">
                        <i class="bi ${iconClass}" style="font-size: 2.5rem; color: var(--muted-foreground);"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">${title}</h3>
                    <p class="text-muted-foreground max-w-md">${message}</p>
                </div>
            `;
        }

        function showLoading(containerElement) {
            if (containerElement) {
                containerElement.innerHTML = `
                    <div class="loading-placeholder">
                        <div class="loading-spinner"></div>
                        <span>Memuat data...</span>
                    </div>`;
            }
        }

        function getApartmentById(id) {
            return AppState.apartments.find(apt => apt.id === id);
        }

        function navigateTo(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            const targetPage = document.getElementById(pageId + 'Page');

            if (targetPage) {
                targetPage.classList.add('active');
                AppState.currentPage = pageId;
                const pageTitleElement = targetPage.querySelector('.page-title');
                const pageTitleText = pageTitleElement ? pageTitleElement.textContent : pageId.charAt(0).toUpperCase() + pageId.slice(1);
                document.title = `RentEase - ${pageTitleText}`;

                sidebarMenuItems.forEach(item => {
                    item.classList.toggle('active', item.dataset.page === pageId);
                    const link = item.querySelector('a');
                    if (link) {
                        if (item.dataset.page === pageId) {
                            link.setAttribute('aria-current', 'page');
                        } else {
                            link.removeAttribute('aria-current');
                        }
                    }
                });
                window.location.hash = pageId;
                mainContent.scrollTop = 0;

                // Refresh data or specific page logic
                if (pageId === 'dashboard') renderDashboardPage();
                if (pageId === 'apartemen') renderApartemenPage();
                if (pageId === 'booking') renderBookingPage();
                if (pageId === 'favorit') renderFavoritPage();
                if (pageId === 'riwayat') renderRiwayatPage();
                if (pageId === 'pembayaran') renderPembayaranPage();
                if (pageId === 'maintenance') renderMaintenancePage();
                // Pesan page is static for now
                if (pageId === 'notifikasi') renderNotifikasiPage();
                if (pageId === 'profil') renderProfilPage();


            } else {
                console.warn(`Halaman "${pageId}" tidak ditemukan. Mengalihkan ke Beranda.`);
                navigateTo('dashboard');
            }
        }

        function setTheme(theme) {
            document.documentElement.classList.toggle('dark', theme === 'dark');
            AppState.theme = theme;
            localStorage.setItem('rentease-theme', theme);

            themeToggleButtons.forEach(button => {
                if (button) {
                    const icon = button.querySelector('i');
                    const textSpan = button.querySelector('span.sidebar-footer-text') || button.querySelector('span.button-text');
                    if (theme === 'dark') {
                        icon.className = 'bi bi-brightness-high-fill';
                        if (textSpan) textSpan.textContent = 'Mode Terang';
                    } else {
                        icon.className = 'bi bi-moon-stars-fill';
                        if (textSpan) textSpan.textContent = 'Mode Gelap';
                    }
                }
            });
        }

        function toggleSidebar() {
            AppState.isSidebarCollapsed = !AppState.isSidebarCollapsed;
            sidebar.classList.toggle('collapsed', AppState.isSidebarCollapsed);
            appContainer.classList.toggle('sidebar-collapsed', AppState.isSidebarCollapsed);
            localStorage.setItem('rentease-sidebar-collapsed', AppState.isSidebarCollapsed.toString());
            sidebarToggle.setAttribute('aria-expanded', String(!AppState.isSidebarCollapsed));
        }

        function toggleMobileSidebar(forceClose = false) {
            const isActive = sidebar.classList.contains('mobile-active');
            if (forceClose || isActive) {
                sidebar.classList.remove('mobile-active');
                mobileOverlay.classList.remove('active');
                sidebarToggle.setAttribute('aria-expanded', 'false');
            } else {
                sidebar.classList.add('mobile-active');
                mobileOverlay.classList.add('active');
                sidebarToggle.setAttribute('aria-expanded', 'true');
            }
        }

        // --- Inisialisasi Aplikasi ---
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                splashScreen.classList.add('hidden');
                appContainer.style.display = 'grid';
                appContainer.classList.add('fade-in');
            }, 1200);

            setTheme(AppState.theme);
            if (window.innerWidth > 768) { // Desktop
                sidebar.classList.toggle('collapsed', AppState.isSidebarCollapsed);
                appContainer.classList.toggle('sidebar-collapsed', AppState.isSidebarCollapsed);
                sidebarToggle.setAttribute('aria-expanded', String(!AppState.isSidebarCollapsed));
            } else { // Mobile
                sidebar.classList.remove('collapsed'); // Ensure not collapsed on mobile
                appContainer.classList.remove('sidebar-collapsed');
                sidebarToggle.setAttribute('aria-expanded', 'false');
            }

            const initialPageId = window.location.hash.substring(1) || 'dashboard';
            navigateTo(initialPageId);

            updateUserDisplay();
            updateBadges();

            // Event Listeners
            window.addEventListener('hashchange', () => {
                const pageId = window.location.hash.substring(1) || 'dashboard';
                navigateTo(pageId);
            });

            sidebarMenuItems.forEach(item => {
                const link = item.querySelector('a');
                if (link) {
                    link.addEventListener('click', (e) => {
                        // Default action (hash change) will trigger navigateTo
                        if (window.innerWidth <= 768 && sidebar.classList.contains('mobile-active')) {
                            toggleMobileSidebar(true); // Force close
                        }
                    });
                }
            });

            sidebarToggle.addEventListener('click', () => {
                if (window.innerWidth <= 768) {
                    toggleMobileSidebar();
                } else {
                    toggleSidebar();
                }
            });

            mobileOverlay.addEventListener('click', () => toggleMobileSidebar(true));


            themeToggleButtons.forEach(button => {
                if (button) {
                    button.addEventListener('click', () => {
                        setTheme(AppState.theme === 'light' ? 'dark' : 'light');
                    });
                }
            });

            userNavTrigger.addEventListener('click', () => {
                const expanded = userNavTrigger.getAttribute('aria-expanded') === 'true' || false;
                userNavTrigger.setAttribute('aria-expanded', String(!expanded));
                userNavMenu.classList.toggle('active');
            });
            document.addEventListener('click', (event) => {
                if (userNavMenu && !userNavTrigger.contains(event.target) && !userNavMenu.contains(event.target)) {
                    userNavMenu.classList.remove('active');
                    userNavTrigger.setAttribute('aria-expanded', 'false');
                }
            });
            userNavMenu.querySelectorAll('.user-nav-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    const action = e.currentTarget.dataset.action;
                    if (action === 'profil' || action === 'pengaturan') navigateTo('profil');
                    if (action === 'logout') alert('Fungsi Logout belum diimplementasikan.');
                    // Tambahkan aksi lain jika perlu
                    userNavMenu.classList.remove('active');
                    userNavTrigger.setAttribute('aria-expanded', 'false');
                });
            });


            if (markAllAsReadBtn) {
                markAllAsReadBtn.addEventListener('click', () => {
                    AppState.notifications.forEach(notif => notif.read = true);
                    renderNotifikasiPage(); // Re-render notifikasi page
                    updateBadges();
                });
            }

            if (headerSearchInput) {
                headerSearchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && headerSearchInput.value.trim() !== '') {
                        navigateTo('apartemen'); // Pindah ke halaman apartemen
                        // Idealnya, filter di halaman apartemen juga di-trigger di sini
                        // Untuk sekarang, hanya navigasi
                        console.log('Mencari:', headerSearchInput.value);
                        // Anda bisa menyimpan nilai pencarian di AppState dan menggunakannya di renderApartemenPage
                    }
                });
            }

            window.addEventListener('resize', () => {
                if (window.innerWidth > 768) {
                    sidebar.classList.toggle('collapsed', AppState.isSidebarCollapsed);
                    appContainer.classList.toggle('sidebar-collapsed', AppState.isSidebarCollapsed);
                    sidebar.classList.remove('mobile-active');
                    mobileOverlay.classList.remove('active');
                    sidebarToggle.setAttribute('aria-expanded', String(!AppState.isSidebarCollapsed));
                } else {
                    sidebar.classList.remove('collapsed');
                    appContainer.classList.remove('sidebar-collapsed');
                    // Jangan ubah mobile-active state di sini, biarkan toggleMobileSidebar yang mengaturnya
                    sidebarToggle.setAttribute('aria-expanded', sidebar.classList.contains('mobile-active').toString());

                }
            });

            // Inisialisasi tab Riwayat jika ada
            const riwayatTabsContainer = document.getElementById('riwayatTabs');
            if (riwayatTabsContainer) setupTabs(riwayatTabsContainer);

            // Setup filter apartemen
            const terapkanFilterBtn = document.getElementById('terapkanFilterBtn');
            if (terapkanFilterBtn) {
                terapkanFilterBtn.addEventListener('click', renderApartemenPage);
            }
        });

        // --- Fungsi Setup Tab Generic ---
        function setupTabs(tabsContainer) {
            const tabTriggers = tabsContainer.querySelectorAll('.tab-trigger');
            const tabContents = tabsContainer.querySelectorAll('.tab-content');

            tabTriggers.forEach(trigger => {
                trigger.addEventListener('click', () => {
                    tabTriggers.forEach(t => {
                        t.classList.remove('active');
                        t.setAttribute('aria-selected', 'false');
                    });
                    tabContents.forEach(c => c.classList.remove('active'));

                    trigger.classList.add('active');
                    trigger.setAttribute('aria-selected', 'true');
                    const targetContentId = trigger.dataset.tabTarget;
                    const targetContent = document.querySelector(targetContentId);
                    if (targetContent) targetContent.classList.add('active');
                });
            });
        }

        // --- Fungsi Render Konten Dinamis ---
        function updateUserDisplay() {
            const user = AppState.user;
            if (userNavTrigger) userNavTrigger.textContent = user.initials;
            if (document.getElementById('userNavAvatar')) document.getElementById('userNavAvatar').textContent = user.initials;
            if (document.getElementById('userNavName')) document.getElementById('userNavName').textContent = user.name;
            if (document.getElementById('userNavEmail')) document.getElementById('userNavEmail').textContent = user.email;
            if (document.getElementById('dashboardUserName')) document.getElementById('dashboardUserName').textContent = user.name.split(' ')[0]; // Nama depan

            // Untuk halaman profil/pengaturan
            if (document.getElementById('settingUserName')) document.getElementById('settingUserName').textContent = user.name;
            if (document.getElementById('settingUserEmail')) document.getElementById('settingUserEmail').textContent = user.email;
            if (document.getElementById('settingUserPhone')) document.getElementById('settingUserPhone').textContent = user.phone || '-';
            if (document.getElementById('settingUserJoined')) document.getElementById('settingUserJoined').textContent = formatDate(user.joinedDate);
        }

        function updateBadges() {
            const unreadNotifications = AppState.notifications.filter(notif => !notif.read).length;
            if (notifBadge) {
                notifBadge.textContent = unreadNotifications;
                notifBadge.style.display = unreadNotifications > 0 ? 'inline-block' : 'none';
            }
            const unreadMessages = AppState.messages.filter(msg => !msg.read).length;
            if (pesanBadge) {
                pesanBadge.textContent = unreadMessages;
                pesanBadge.style.display = unreadMessages > 0 ? 'inline-block' : 'none';
            }
        }

        // --- Render Halaman Dashboard ---
        function renderDashboardPage() {
            // Statistik
            document.getElementById('statsBookingAktif').textContent = AppState.apartments.filter(apt => apt.statusBooking === 'Aktif').length;
            document.getElementById('statsPembayaranTertunda').textContent = AppState.payments.filter(p => p.status === 'Belum Lunas' && new Date(p.dueDate) >= new Date()).length;
            document.getElementById('statsMaintenanceRequests').textContent = AppState.maintenanceRequests.filter(m => m.status === 'Sedang Ditinjau' || m.status === 'Diajukan').length;
            document.getElementById('statsPropertiDisimpan').textContent = AppState.apartments.filter(apt => apt.isFavorite).length;

            // Tabel Aktivitas Terbaru
            const aktivitasTableBody = document.querySelector('#dashboardAktivitasTable tbody');
            if (aktivitasTableBody) {
                const recentActivities = AppState.notifications.slice(0, 3).map(notif => { // Ambil dari notifikasi sebagai contoh
                    let statusBadge = '';
                    if (notif.type.includes('payment')) statusBadge = `<span class="badge ${notif.type === 'payment_success' ? 'badge-success' : 'badge-warning'}">${notif.type === 'payment_success' ? 'Berhasil' : 'Perhatian'}</span>`;
                    else if (notif.type.includes('maintenance')) statusBadge = `<span class="badge badge-info">Update</span>`;
                    else statusBadge = `<span class="badge badge-muted">Info</span>`;

                    return `
                        <tr>
                            <td>${formatDate(notif.date, { day: '2-digit', month: 'short', year: '2-digit' })}</td>
                            <td>${notif.title}</td>
                            <td>${statusBadge}</td>
                            <td><button class="button button-xs button-outline" onclick="navigateTo('${notif.actionLink ? notif.actionLink.substring(1) : 'notifikasi'}')">Detail</button></td>
                        </tr>
                    `;
                }).join('');
                aktivitasTableBody.innerHTML = recentActivities || `<tr><td colspan="4">${createEmptyState("Tidak ada aktivitas terbaru.", "bi-clock-history", "Belum Ada Aktivitas")}</td></tr>`;
            }

            // Jatuh Tempo Penting
            const jatuhTempoList = document.getElementById('dashboardJatuhTempoList');
            if (jatuhTempoList) {
                const upcomingPayments = AppState.payments
                    .filter(p => p.status === 'Belum Lunas' && new Date(p.dueDate) >= new Date())
                    .sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate))
                    .slice(0, 3)
                    .map(p => `
                        <div class="flex justify-between items-center p-3 bg-muted dark:bg-slate-700 rounded-md">
                            <div>
                                <p class="font-medium">${p.description}</p>
                                <p class="text-sm text-destructive">Jatuh Tempo: ${formatDate(p.dueDate)}</p>
                            </div>
                            <button class="button button-xs button-primary" onclick="navigateTo('pembayaran')">Bayar</button>
                        </div>
                    `).join('');
                jatuhTempoList.innerHTML = upcomingPayments || `<p class="text-muted-foreground text-center">Tidak ada jatuh tempo penting.</p>`;
            }

            // Grafik
            const chartArea = document.getElementById('dashboardChartArea');
            const chartYAxis = document.getElementById('dashboardChartYAxis');
            if (chartArea && chartYAxis) {
                const currentMonth = new Date().toLocaleString('default', { month: 'short' });
                // Pastikan pengeluaran bulan ini ada di chartData atau set 0
                let currentMonthExpenditure = AppState.payments
                    .filter(p => p.status === 'Lunas' && new Date(p.paidDate).toLocaleString('default', { month: 'short' }) === currentMonth)
                    .reduce((sum, p) => sum + p.amount, 0) / 1000000; // dalam jutaan

                // Update data chart untuk bulan ini
                const currentMonthData = AppState.chartData.find(d => d.month === currentMonth);
                if (currentMonthData) {
                    currentMonthData.value = currentMonthExpenditure;
                } else {
                    // Jika belum ada, tambahkan data bulan ini (misalnya untuk awal bulan)
                    // Ini asumsi chartData sudah ada 6 bulan terakhir
                }


                const maxChartValue = Math.max(...AppState.chartData.map(d => d.value), 1); // Minimal 1jt untuk skala
                chartYAxis.innerHTML = `
                    <div class="chart-y-label">${formatCurrency(maxChartValue * 1000000).replace(",00", "")}</div>
                    <div class="chart-y-label">${formatCurrency(maxChartValue * 0.66 * 1000000).replace(",00", "")}</div>
                    <div class="chart-y-label">${formatCurrency(maxChartValue * 0.33 * 1000000).replace(",00", "")}</div>
                    <div class="chart-y-label">Rp 0</div>
                `;
                chartArea.innerHTML = AppState.chartData.map(data => `
                    <div class="chart-bar-wrapper">
                        <div class="chart-bar" style="height: ${(data.value / maxChartValue) * 100}%;" title="${data.month}: ${formatCurrency(data.value * 1000000)}"></div>
                        <span class="chart-label">${data.month}</span>
                    </div>
                `).join('');
            }
        }

        // --- Render Halaman Apartemen ---
        function createApartmentCardHTML(apartment, isFavoritePage = false) {
            const priceFormatted = formatCurrency(apartment.price);
            let bedText = `${apartment.beds} Kamar Tidur`;
            if (apartment.type === "Studio") bedText = "Studio";

            return `
                <div class="card overflow-hidden apartment-card fade-in" data-id="${apartment.id}">
                    <div class="relative">
                        <img src="${apartment.image}" alt="Foto ${apartment.name}" class="w-full h-48 object-cover" loading="lazy">
                        <button class="absolute top-2 right-2 button button-icon button-secondary rounded-full favorite-btn ${apartment.isFavorite ? 'active' : ''}" 
                                aria-label="${apartment.isFavorite ? 'Hapus dari favorit' : 'Tambah ke favorit'}"
                                data-apartment-id="${apartment.id}"
                                style="background-color: rgba(255,255,255,0.8); color: ${apartment.isFavorite ? 'var(--destructive)' : 'var(--muted-foreground)'};">
                            <i class="bi ${apartment.isFavorite ? 'bi-heart-fill' : 'bi-heart'}"></i>
                        </button>
                    </div>
                    <div class="card-header">
                        <h3 class="card-title truncate" title="${apartment.name}">${apartment.name}</h3>
                        <p class="card-description text-sm truncate" title="${apartment.address}">${apartment.address}</p>
                    </div>
                    <div class="card-content">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-primary font-semibold text-lg">${priceFormatted}/bulan</span>
                            <span class="badge badge-muted">${apartment.type}</span>
                        </div>
                        <div class="flex justify-between text-sm text-muted-foreground mb-3">
                            <span><i class="bi bi-rulers mr-1"></i>${apartment.area} m²</span>
                            <span><i class="bi bi-door-open-fill mr-1"></i>${bedText}</span>
                            <span><i class="bi bi-droplet-fill mr-1"></i>${apartment.baths} Kamar Mandi</span>
                        </div>
                        <p class="text-xs text-muted-foreground truncate">Amenitas: ${apartment.amenities.join(', ')}</p>
                    </div>
                    <div class="card-footer">
                        <button class="button button-outline button-sm flex-1 apartment-detail-btn" data-apartment-id="${apartment.id}">Lihat Detail</button>
                        <button class="button button-primary button-sm flex-1 apartment-inquire-btn" data-apartment-id="${apartment.id}">Tanya Penyewa</button>
                    </div>
                </div>
            `;
        }

        function addApartmentToRecentlyViewed(apartmentId) {
            AppState.recentlyViewed = AppState.recentlyViewed.filter(id => id !== apartmentId); // Hapus jika sudah ada
            AppState.recentlyViewed.unshift(apartmentId); // Tambah ke depan
            if (AppState.recentlyViewed.length > 4) { // Batasi jumlah
                AppState.recentlyViewed.pop();
            }
            localStorage.setItem('rentease-recently-viewed', JSON.stringify(AppState.recentlyViewed));
            renderRecentlyViewed();
        }

        function loadRecentlyViewed() {
            const stored = localStorage.getItem('rentease-recently-viewed');
            if (stored) {
                AppState.recentlyViewed = JSON.parse(stored);
            }
            renderRecentlyViewed();
        }

        function renderRecentlyViewed() {
            const container = document.getElementById('recentlyViewedApartments');
            if (!container) return;

            if (AppState.recentlyViewed.length === 0) {
                container.innerHTML = `<p class="text-muted-foreground col-span-full text-center py-4">Anda belum melihat apartemen apa pun baru-baru ini.</p>`;
                return;
            }

            container.innerHTML = AppState.recentlyViewed
                .map(id => getApartmentById(id))
                .filter(apt => apt) // pastikan apartemen masih ada
                .map(apt => createApartmentCardHTML(apt)) // Gunakan card yang sama, mungkin versi lebih ringkas?
                .join('');

            // Add event listeners for newly rendered cards in recently viewed
            addApartmentCardEventListeners(container);
        }


        function renderApartmenPage() {
            const container = document.getElementById('apartemenListContainer');
            const emptyStateContainer = document.getElementById('apartemenEmptyState');
            if (!container || !emptyStateContainer) return;

            showLoading(container); // Tampilkan loading

            // Ambil nilai filter
            const hargaFilter = document.getElementById('filterHarga').value;
            const kamarFilter = document.getElementById('filterKamar').value;
            const amenitasFilter = document.getElementById('filterAmenitas').value;
            const searchQuery = headerSearchInput.value.toLowerCase();

            let filteredApartments = AppState.apartments.filter(apt => {
                let passes = true;
                // Filter harga
                if (hargaFilter) {
                    const [min, max] = hargaFilter.split('-').map(Number);
                    if (apt.price < min || apt.price > max) passes = false;
                }
                // Filter kamar
                if (kamarFilter) {
                    if (kamarFilter === "Studio" && apt.type !== "Studio") passes = false;
                    else if (kamarFilter === "3" && apt.beds < 3) passes = false;
                    else if (kamarFilter !== "Studio" && kamarFilter !== "3" && apt.beds !== parseInt(kamarFilter)) passes = false;
                }
                // Filter amenitas
                if (amenitasFilter && !apt.amenities.includes(amenitasFilter)) passes = false;

                // Filter pencarian (nama atau alamat)
                if (searchQuery) {
                    if (!apt.name.toLowerCase().includes(searchQuery) && !apt.address.toLowerCase().includes(searchQuery)) {
                        passes = false;
                    }
                }
                return passes;
            });

            // Tunda render sedikit untuk efek loading
            setTimeout(() => {
                if (filteredApartments.length > 0) {
                    container.innerHTML = filteredApartments.map(apt => createApartmentCardHTML(apt)).join('');
                    addApartmentCardEventListeners(container);
                    emptyStateContainer.style.display = 'none';
                    container.style.display = 'grid'; // atau 'flex' atau apa pun display aslinya
                } else {
                    container.innerHTML = ''; // Kosongkan container jika tidak ada hasil
                    container.style.display = 'none';
                    emptyStateContainer.innerHTML = createEmptyState("Tidak ada apartemen yang cocok dengan kriteria filter Anda.", "bi-search", "Pencarian Tidak Ditemukan");
                    emptyStateContainer.style.display = 'block';
                }
            }, 500); // simulasi loading

            loadRecentlyViewed(); // Muat juga yang baru dilihat
        }

        function addApartmentCardEventListeners(container) {
            container.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation(); // Hindari trigger event lain di card
                    const apartmentId = btn.dataset.apartmentId;
                    const apartment = getApartmentById(apartmentId);
                    if (apartment) {
                        apartment.isFavorite = !apartment.isFavorite;
                        btn.classList.toggle('active', apartment.isFavorite);
                        btn.querySelector('i').className = `bi ${apartment.isFavorite ? 'bi-heart-fill' : 'bi-heart'}`;
                        btn.style.color = apartment.isFavorite ? 'var(--destructive)' : 'var(--muted-foreground)';
                        // Jika di halaman favorit, re-render
                        if (AppState.currentPage === 'favorit') renderFavoritPage();
                        updateBadges(); // Update stats properti disimpan di dashboard
                        if (AppState.currentPage === 'dashboard') renderDashboardPage();
                    }
                });
            });

            container.querySelectorAll('.apartment-detail-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const apartmentId = e.currentTarget.dataset.apartmentId;
                    addApartmentToRecentlyViewed(apartmentId);
                    alert(`Menampilkan detail untuk apartemen ID: ${apartmentId}. Fitur ini belum diimplementasikan sepenuhnya.`);
                    // Di sini bisa navigasi ke halaman detail apartemen (jika ada) atau modal
                });
            });
            container.querySelectorAll('.apartment-inquire-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const apartmentId = e.currentTarget.dataset.apartmentId;
                    alert(`Fitur "Tanya Penyewa" untuk apartemen ID: ${apartmentId} belum diimplementasikan.`);
                    // Di sini bisa membuka modal chat atau form kontak
                });
            });
        }

        // --- Render Halaman Favorit ---
        function renderFavoritPage() {
            const container = document.getElementById('favoritListContainer');
            const emptyContainer = document.getElementById('favoritEmptyState');
            if (!container || !emptyContainer) return;

            const favoriteApartments = AppState.apartments.filter(apt => apt.isFavorite);

            if (favoriteApartments.length > 0) {
                container.innerHTML = favoriteApartments.map(apt => createApartmentCardHTML(apt, true)).join('');
                addApartmentCardEventListeners(container); // Tambahkan event listener lagi
                container.style.display = 'grid';
                emptyContainer.style.display = 'none';
            } else {
                container.innerHTML = '';
                container.style.display = 'none';
                emptyContainer.innerHTML = createEmptyState("Anda belum menambahkan apartemen ke daftar favorit.", "bi-heartbreak", "Favorit Kosong");
                emptyContainer.style.display = 'block';
            }
        }

        // --- Render Halaman Booking ---
        function renderBookingPage() {
            const tableBody = document.querySelector('#bookingTable tbody');
            const emptyStateContainer = document.getElementById('bookingEmptyState');
            if (!tableBody || !emptyStateContainer) return;

            const bookings = AppState.apartments.filter(apt => apt.bookingId && (apt.statusBooking === 'Aktif' || apt.statusBooking === 'Selesai'))
                .map(apt => ({
                    apartmentName: apt.name,
                    period: apt.period || 'N/A',
                    totalCost: apt.totalPayment,
                    status: apt.statusBooking,
                    id: apt.bookingId
                }));

            if (bookings.length > 0) {
                tableBody.innerHTML = bookings.map(book => `
                    <tr>
                        <td>${book.apartmentName}</td>
                        <td>${book.period}</td>
                        <td>${formatCurrency(book.totalCost)}</td>
                        <td><span class="badge ${book.status === 'Aktif' ? 'badge-success' : 'badge-muted'}">${book.status}</span></td>
                        <td>
                            <button class="button button-xs button-outline" onclick="alert('Detail booking ${book.id}')">Detail</button>
                            ${book.status === 'Aktif' ? '<button class="button button-xs button-destructive" onclick="alert(\'Batalkan booking ' + book.id + '\')">Batalkan</button>' : ''}
                        </td>
                    </tr>
                `).join('');
                tableBody.parentElement.parentElement.style.display = 'block'; // Tampilkan table container
                emptyStateContainer.style.display = 'none';
            } else {
                tableBody.innerHTML = '';
                tableBody.parentElement.parentElement.style.display = 'none'; // Sembunyikan table container
                emptyStateContainer.innerHTML = createEmptyState("Anda belum memiliki booking aktif atau riwayat booking.", "bi-calendar-x", "Booking Kosong");
                emptyStateContainer.style.display = 'block';
            }
        }

        // --- Render Halaman Riwayat ---
        function renderRiwayatPage() {
            // Riwayat Sewa (ambil dari apartemen yang status bookingnya 'Selesai')
            const riwayatSewaList = document.getElementById('riwayatSewaList');
            if (riwayatSewaList) {
                const finishedRentals = AppState.apartments.filter(apt => apt.statusBooking === 'Selesai');
                if (finishedRentals.length > 0) {
                    riwayatSewaList.innerHTML = finishedRentals.map(apt => `
                        <div class="border rounded-lg p-4 fade-in">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-semibold">${apt.name}</h3>
                                <span class="badge badge-muted">Selesai</span>
                            </div>
                            <p class="text-sm text-muted-foreground">Periode: ${apt.period}</p>
                            <p class="text-sm text-muted-foreground">Total Bayar: ${formatCurrency(apt.totalPayment)}</p>
                        </div>
                    `).join('');
                } else {
                    riwayatSewaList.innerHTML = createEmptyState("Tidak ada riwayat sewa.", "bi-journal-x", "Riwayat Sewa Kosong");
                }
            }

            // Riwayat Pembayaran
            const riwayatPembayaranList = document.getElementById('riwayatPembayaranList');
            if (riwayatPembayaranList) {
                const paidPayments = AppState.payments.filter(p => p.status === 'Lunas');
                if (paidPayments.length > 0) {
                    riwayatPembayaranList.innerHTML = paidPayments.map(p => `
                        <div class="border rounded-lg p-4 fade-in">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-semibold">${p.description} (${p.apartmentName})</h3>
                                <span class="badge badge-success">Lunas</span>
                            </div>
                            <p class="text-sm text-muted-foreground">Tanggal Bayar: ${formatDate(p.paidDate)}</p>
                            <p class="text-sm text-muted-foreground">Jumlah: ${formatCurrency(p.amount)}</p>
                        </div>
                    `).join('');
                } else {
                    riwayatPembayaranList.innerHTML = createEmptyState("Tidak ada riwayat pembayaran.", "bi-cash-stack", "Riwayat Pembayaran Kosong");
                }
            }

            // Riwayat Maintenance
            const riwayatMaintenanceList = document.getElementById('riwayatMaintenanceList');
            if (riwayatMaintenanceList) {
                const finishedMaintenance = AppState.maintenanceRequests.filter(m => m.status === 'Selesai' || m.status === 'Dibatalkan');
                if (finishedMaintenance.length > 0) {
                    riwayatMaintenanceList.innerHTML = finishedMaintenance.map(m => `
                        <div class="border rounded-lg p-4 fade-in">
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-semibold">Tiket #${m.id} (${m.apartmentName})</h3>
                                <span class="badge ${m.status === 'Selesai' ? 'badge-success' : 'badge-muted'}">${m.status}</span>
                            </div>
                            <p class="text-sm text-muted-foreground">Masalah: ${m.issue}</p>
                            <p class="text-sm text-muted-foreground">Tanggal Diajukan: ${formatDate(m.dateSubmitted)}</p>
                        </div>
                    `).join('');
                } else {
                    riwayatMaintenanceList.innerHTML = createEmptyState("Tidak ada riwayat permintaan maintenance.", "bi-wrench-adjustable-circle", "Riwayat Maintenance Kosong");
                }
            }
        }

        // --- Render Halaman Pembayaran ---
        function renderPembayaranPage() {
            const tagihanTableBody = document.querySelector('#tagihanTable tbody');
            const tagihanEmptyState = document.getElementById('tagihanEmptyState');

            const currentBills = AppState.payments.filter(p => p.status === 'Belum Lunas' && new Date(p.dueDate) >= new Date());
            if (tagihanTableBody && tagihanEmptyState) {
                if (currentBills.length > 0) {
                    tagihanTableBody.innerHTML = currentBills.map(bill => `
                        <tr>
                            <td>${bill.description} (${bill.apartmentName})</td>
                            <td>${formatDate(bill.dueDate)}</td>
                            <td>${formatCurrency(bill.amount)}</td>
                            <td><span class="badge badge-destructive">${bill.status}</span></td>
                            <td><button class="button button-xs button-primary" onclick="alert('Bayar tagihan ${bill.id}')">Bayar Sekarang</button></td>
                        </tr>
                    `).join('');
                    tagihanTableBody.parentElement.parentElement.style.display = 'block';
                    tagihanEmptyState.style.display = 'none';
                } else {
                    tagihanTableBody.innerHTML = '';
                    tagihanTableBody.parentElement.parentElement.style.display = 'none';
                    tagihanEmptyState.innerHTML = createEmptyState("Tidak ada tagihan saat ini.", "bi-patch-check", "Tagihan Kosong");
                    tagihanEmptyState.style.display = 'block';
                }
            }

            // Metode Pembayaran
            const metodeList = document.getElementById('metodePembayaranList');
            if (metodeList) {
                if (AppState.paymentMethods.length > 0) {
                    metodeList.innerHTML = AppState.paymentMethods.map(pm => `
                        <div class="flex justify-between items-center p-3 border rounded-md">
                            <div>
                                <p class="font-medium">${pm.provider} <span class="text-muted-foreground">(...${pm.lastDigits})</span></p>
                                <p class="text-sm text-muted-foreground">${pm.type} ${pm.expiry ? ' - Exp: ' + pm.expiry : ''}</p>
                            </div>
                            <div>
                                ${pm.isDefault ? '<span class="badge badge-primary">Default</span>' : '<button class="button button-xs button-outline">Jadikan Default</button>'}
                                <button class="button button-xs button-ghost text-destructive ml-2"><i class="bi bi-trash"></i></button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    metodeList.innerHTML = `<p class="text-muted-foreground text-center">Belum ada metode pembayaran tersimpan.</p>`;
                }
            }
        }

        // --- Render Halaman Maintenance ---
        function renderMaintenancePage() {
            const tableBody = document.querySelector('#maintenanceTable tbody');
            const emptyStateContainer = document.getElementById('maintenanceEmptyState');
            if (!tableBody || !emptyStateContainer) return;

            const requests = AppState.maintenanceRequests;
            if (requests.length > 0) {
                tableBody.innerHTML = requests.map(req => {
                    let statusBadgeClass = 'badge-muted';
                    if (req.status === 'Sedang Ditinjau') statusBadgeClass = 'badge-warning';
                    else if (req.status === 'Diajukan') statusBadgeClass = 'badge-info'; // Misal baru diajukan
                    else if (req.status === 'Selesai') statusBadgeClass = 'badge-success';
                    else if (req.status === 'Dibatalkan') statusBadgeClass = 'badge-destructive';

                    return `
                        <tr>
                            <td>${req.id}</td>
                            <td>${req.apartmentName}</td>
                            <td class="truncate" style="max-width: 200px;" title="${req.issue}">${req.issue}</td>
                            <td>${formatDate(req.dateSubmitted)}</td>
                            <td><span class="badge ${statusBadgeClass}">${req.status}</span></td>
                            <td>
                                <button class="button button-xs button-outline" onclick="alert('Detail maintenance ${req.id}')">Detail</button>
                                ${req.status === 'Diajukan' || req.status === 'Sedang Ditinjau' ? '<button class="button button-xs button-destructive" onclick="alert(\'Batalkan permintaan ' + req.id + '\')">Batalkan</button>' : ''}
                            </td>
                        </tr>
                    `;
                }).join('');
                tableBody.parentElement.parentElement.style.display = 'block';
                emptyStateContainer.style.display = 'none';
            } else {
                tableBody.innerHTML = '';
                tableBody.parentElement.parentElement.style.display = 'none';
                emptyStateContainer.innerHTML = createEmptyState("Belum ada permintaan maintenance.", "bi-tools", "Maintenance Kosong");
                emptyStateContainer.style.display = 'block';
            }

            const buatPermintaanBtn = document.getElementById('buatPermintaanMaintenanceBtn');
            if (buatPermintaanBtn && !buatPermintaanBtn.dataset.listenerAttached) {
                buatPermintaanBtn.addEventListener('click', () => {
                    alert('Fitur membuat permintaan maintenance baru belum diimplementasikan.');
                    // Di sini idealnya muncul modal form untuk membuat permintaan baru
                });
                buatPermintaanBtn.dataset.listenerAttached = 'true';
            }
        }

        // --- Render Halaman Notifikasi ---
        function renderNotifikasiPage() {
            const container = document.getElementById('notifikasiListContainer');
            const emptyContainer = document.getElementById('notifikasiEmptyState');
            if (!container || !emptyContainer) return;

            const sortedNotifications = [...AppState.notifications].sort((a, b) => new Date(b.date) - new Date(a.date));

            if (sortedNotifications.length === 0) {
                container.innerHTML = '';
                container.style.display = 'none';
                emptyContainer.innerHTML = createEmptyState("Tidak ada notifikasi baru.", "bi-bell-slash", "Notifikasi Kosong");
                emptyContainer.style.display = 'block';
                return;
            }

            container.style.display = 'block';
            emptyContainer.style.display = 'none';
            container.innerHTML = sortedNotifications.map(notif => `
                <div class="flex gap-3 items-start p-4 border-b border-[var(--border)] last:border-b-0 ${!notif.read ? 'bg-[var(--accent)] dark:bg-slate-700' : ''} hover:bg-[var(--accent)] dark:hover:bg-slate-700 transition-colors cursor-pointer notif-item" data-notif-id="${notif.id}" data-action-link="${notif.actionLink || ''}">
                    <div class="rounded-full p-3 ${notif.iconBg} ${notif.iconColor} mt-1 flex-shrink-0">
                        <i class="bi ${notif.icon}" style="font-size: 1.25rem;" aria-hidden="true"></i>
                    </div>
                    <div class="flex-grow">
                        <div class="flex justify-between items-center mb-1">
                            <h3 class="font-semibold">${notif.title}</h3>
                            <span class="text-xs text-muted-foreground">${formatDate(notif.date)}</span>
                        </div>
                        <p class="text-sm text-muted-foreground">${notif.message}</p>
                    </div>
                    ${!notif.read ? `<button class="button button-ghost button-xs p-1 mark-as-read-btn self-start" data-notif-id="${notif.id}" aria-label="Tandai sudah dibaca" onclick="event.stopPropagation();"><i class="bi bi-check-lg"></i></button>` : '<div class="w-6 self-start"></div>' /* Placeholder agar alignment sama */}
                </div>
            `).join('');

            container.querySelectorAll('.mark-as-read-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const notifId = parseInt(e.currentTarget.dataset.notifId);
                    const notification = AppState.notifications.find(n => n.id === notifId);
                    if (notification) {
                        notification.read = true;
                        renderNotifikasiPage();
                        updateBadges();
                    }
                });
            });

            container.querySelectorAll('.notif-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    if (e.target.closest('.mark-as-read-btn')) return; // Jangan proses jika tombol "mark as read" diklik

                    const notifId = parseInt(e.currentTarget.dataset.notifId);
                    const actionLink = e.currentTarget.dataset.actionLink;
                    const notification = AppState.notifications.find(n => n.id === notifId);

                    if (notification && !notification.read) {
                        notification.read = true;
                        // Re-render hanya item ini atau update classnya saja lebih efisien
                        e.currentTarget.classList.remove('bg-[var(--accent)]', 'dark:bg-slate-700');
                        const markButton = e.currentTarget.querySelector('.mark-as-read-btn');
                        if (markButton) markButton.remove();
                        updateBadges();
                    }

                    if (actionLink && actionLink !== 'undefined' && actionLink !== '') {
                        navigateTo(actionLink.substring(1));
                    } else {
                        // Jika tidak ada actionLink, mungkin tampilkan detail notifikasi di modal
                        alert(`Detail Notifikasi: ${notification.title}\n${notification.message}`);
                    }
                });
            });
        }

        // --- Render Halaman Profil (Pengaturan) ---
        function renderProfilPage() {
            // Sebagian besar data sudah di-handle oleh updateUserDisplay saat inisialisasi
            // Fungsi ini bisa digunakan jika ada data profil yang perlu di-load secara dinamis
            // Contoh:
            // const userActivityContainer = document.getElementById('userActivityContainer');
            // if(userActivityContainer) userActivityContainer.innerHTML = "Memuat aktivitas pengguna...";
            // setTimeout(() => {
            //     if(userActivityContainer) userActivityContainer.innerHTML = "<p>Tidak ada aktivitas terbaru.</p>";
            // }, 1000);
        }


    </script>
</body>

</html>