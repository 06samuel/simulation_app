<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Platform penyewaan properti Green Valley dengan pencarian lanjutan, pemesanan, dan manajemen pengguna.">
    <title>Green Valley Property Rentals</title>

    <!-- Google Fonts -->
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        :root {
            --warna-utama: #4CAF50;
            /* Green */
            --warna-sekunder: #2196F3;
            /* Blue */
            --warna-aksen: #C8E6C9;
            /* Light Green */
            --warna-teks: #333333;
            --warna-teks-terang: #FFFFFF;
            --abu-dasar: #f8f9fa;
            /* Bootstrap light grey */
            --abu-terang: #e9ecef;
            --abu-sedang: #ced4da;
            --abu-gelap: #6c757d;
            /* Bootstrap secondary text */
            --hijau-sukses: #28a745;
            /* Bootstrap success */
            --merah-peringatan: #dc3545;
            /* Bootstrap danger */

            --spasi-xs: 0.25rem;
            --spasi-kecil: 0.5rem;
            --spasi-sedang: 1rem;
            --spasi-besar: 1.5rem;
            --radius-standar: 0.375rem;
            /* Bootstrap default */
            --bayangan-standar: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            /* Bootstrap default */
        }

        /* Global Styles & Resets */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Poppins', sans-serif;
            background-color: var(--abu-dasar);
            color: var(--warna-teks);
            margin: 0;
            line-height: 1.6;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }

        /* Layout Structure */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .app-header {
            position: sticky;
            top: 0;
            z-index: 1030;
            /* Bootstrap sticky-top z-index */
            background-color: var(--warna-teks-terang);
            border-bottom: 1px solid var(--abu-terang);
            padding: var(--spasi-sedang);
            box-shadow: var(--bayangan-standar);
        }

        .app-main-content {
            display: flex;
            flex-grow: 1;
        }

        .app-sidebar {
            width: 250px;
            /* Fixed width for sidebar */
            background-color: var(--warna-teks-terang);
            border-right: 1px solid var(--abu-terang);
            padding: var(--spasi-sedang);
            height: calc(100vh - 70px);
            /* Adjust based on header height */
            position: sticky;
            top: 70px;
            /* Adjust based on header height */
            overflow-y: auto;
        }

        .app-page-content {
            flex-grow: 1;
            padding: var(--spasi-besar);
            overflow-y: auto;
        }

        .app-footer {
            background-color: var(--warna-teks-terang);
            border-top: 1px solid var(--abu-terang);
            padding: var(--spasi-sedang);
            text-align: center;
            color: var(--abu-gelap);
            font-size: 0.875rem;
        }

        /* Navigation */
        .app-sidebar .nav-link {
            color: var(--warna-teks);
            padding: var(--spasi-kecil) var(--spasi-sedang);
            border-radius: var(--radius-standar);
            transition: background-color 0.2s ease, color 0.2s ease;
            margin-bottom: var(--spasi-xs);
            display: flex;
            align-items: center;
        }

        .app-sidebar .nav-link .nav-icon {
            margin-right: var(--spasi-kecil);
            width: 20px;
            /* Fixed width for icons */
            text-align: center;
        }

        .app-sidebar .nav-link:hover,
        .app-sidebar .nav-link.active {
            background-color: var(--warna-aksen);
            color: var(--warna-utama);
        }

        /* Page Visibility */
        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Components */
        .card {
            /* Bootstrap card is fine, minor tweaks if needed */
            border: 1px solid var(--abu-terang);
            box-shadow: var(--bayangan-standar);
            transition: transform 0.2s ease-in-out;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, .15);
        }

        .btn-primary {
            background-color: var(--warna-utama);
            border-color: var(--warna-utama);
        }

        .btn-primary:hover {
            background-color: #388E3C;
            /* Darker Green */
            border-color: #388E3C;
        }

        .btn-secondary {
            background-color: var(--warna-sekunder);
            border-color: var(--warna-sekunder);
            color: var(--warna-teks-terang);
        }

        .btn-secondary:hover {
            background-color: #1976D2;
            /* Darker Blue */
            border-color: #1976D2;
        }

        .btn-outline-secondary {
            color: var(--warna-sekunder);
            border-color: var(--warna-sekunder);
        }

        .btn-outline-secondary:hover {
            background-color: var(--warna-sekunder);
            color: var(--warna-teks-terang);
        }


        .gallery-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: var(--radius-standar) var(--radius-standar) 0 0;
            transition: transform 0.3s ease;
        }

        .gallery-image:hover {
            transform: scale(1.03);
        }

        .detail-gallery-image {
            height: 380px;
            /* Taller for detail page */
            border-radius: var(--radius-standar);
        }

        .thumbnail {
            width: 100%;
            height: 80px;
            object-fit: cover;
            border-radius: var(--radius-standar);
            cursor: pointer;
            transition: opacity 0.3s ease;
            border: 2px solid transparent;
        }

        .thumbnail:hover,
        .thumbnail.active-thumb {
            opacity: 0.8;
            border-color: var(--warna-utama);
        }

        .map-placeholder {
            background: linear-gradient(135deg, var(--abu-terang), #d1d5db);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--warna-teks);
            font-weight: 500;
            min-height: 250px;
            border-radius: var(--radius-standar);
        }

        /* Modal - using Bootstrap modal classes primarily */
        .modal-content {
            border-radius: var(--radius-standar);
        }

        /* Stats Grid for Dashboard */
        .stats-grid .card {
            text-align: center;
        }

        .stats-grid .card-title {
            font-size: 1rem;
            color: var(--abu-gelap);
        }

        .stats-grid .card-text {
            font-size: 2rem;
            font-weight: 700;
            color: var(--warna-utama);
        }

        /* Chat */
        #pesan-chat {
            height: 200px;
            border: 1px solid var(--abu-sedang);
            padding: var(--spasi-sedang);
            border-radius: var(--radius-standar);
            margin-bottom: var(--spasi-sedang);
            background-color: var(--warna-teks-terang);
        }

        #pesan-chat p {
            margin-bottom: var(--spasi-kecil);
        }

        #pesan-chat .chat-bubble {
            padding: var(--spasi-kecil) var(--spasi-sedang);
            border-radius: 15px;
            max-width: 70%;
            word-wrap: break-word;
        }

        #pesan-chat .user-message .chat-bubble {
            background-color: var(--warna-utama);
            color: var(--warna-teks-terang);
            margin-left: auto;
            border-bottom-right-radius: 5px;
        }

        #pesan-chat .owner-message .chat-bubble {
            background-color: var(--abu-terang);
            color: var(--warna-teks);
            margin-right: auto;
            border-bottom-left-radius: 5px;
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            .app-sidebar {
                display: none;
                /* Hide sidebar on smaller screens, could be a toggleable off-canvas menu */
            }

            .app-page-content {
                padding: var(--spasi-sedang);
            }

            .app-header .navbar-brand {
                font-size: 1.1rem;
            }

            /* Stack columns on property detail page */
            #detail-properti .row>div {
                margin-bottom: var(--spasi-sedang);
            }

            .detail-gallery-image {
                height: 250px;
            }
        }

        @media (prefers-reduced-motion: reduce) {

            .card,
            .gallery-image,
            .btn-primary,
            .btn-secondary,
            .thumbnail {
                transition: none;
            }
        }
    </style>
</head>

<body>
    <div class="app-container">
        <header class="app-header d-flex justify-content-between align-items-center">
            <a href="#beranda" class="navbar-brand d-flex align-items-center" data-route="beranda">
                <i class="fas fa-mountain-sun fa-2x me-2" style="color: var(--warna-utama);"></i>
                <h1 class="h4 mb-0" style="color: var(--warna-teks);">Green Valley</h1>
            </a>
            <nav class="d-flex align-items-center">
                <button class="btn btn-link position-relative me-3" aria-label="Notifikasi">
                    <i class="fas fa-bell fa-lg" style="color: var(--abu-gelap);"></i>
                    <span
                        class="position-absolute top-0 start-100 translate-middle p-1 bg-danger border border-light rounded-circle"
                        style="font-size:0.5rem;">
                        <span class="visually-hidden">Notifikasi baru</span>
                    </span>
                </button>
                <img src="https://i.pravatar.cc/40?u=user" alt="Profil Pengguna" class="rounded-circle border"
                    style="width: 40px; height: 40px;">
            </nav>
        </header>

        <div class="app-main-content">
            <aside class="app-sidebar">
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#beranda" data-route="beranda"><i
                            class="fas fa-home nav-icon"></i>Beranda</a>
                    <a class="nav-link" href="#properti" data-route="properti"><i
                            class="fas fa-city nav-icon"></i>Properti</a>
                    <a class="nav-link" href="#penyewa" data-route="penyewa"><i
                            class="fas fa-users nav-icon"></i>Penyewa</a>
                    <a class="nav-link" href="#pemesanan" data-route="pemesanan"><i
                            class="fas fa-calendar-check nav-icon"></i>Pemesanan</a>
                    <a class="nav-link" href="#akun" data-route="akun"><i
                            class="fas fa-user-circle nav-icon"></i>Akun</a>
                    <a class="nav-link" href="#dukungan" data-route="dukungan"><i
                            class="fas fa-headset nav-icon"></i>Dukungan</a>
                </nav>
            </aside>

            <main class="app-page-content">
                <!-- Beranda Page -->
                <section id="beranda" class="page active">
                    <h2 class="mb-4">Selamat Datang di Green Valley</h2>
                    <div class="row row-cols-1 row-cols-md-3 g-4 mb-4 stats-grid">
                        <div class="col">
                            <article class="card h-100">
                                <div class="card-body">
                                    <h3 class="card-title">Total Properti</h3>
                                    <p class="card-text" id="stat-properti">0</p>
                                </div>
                            </article>
                        </div>
                        <div class="col">
                            <article class="card h-100">
                                <div class="card-body">
                                    <h3 class="card-title">Pemesanan Aktif</h3>
                                    <p class="card-text" id="stat-pemesanan">0</p>
                                </div>
                            </article>
                        </div>
                        <div class="col">
                            <article class="card h-100">
                                <div class="card-body">
                                    <h3 class="card-title">Penyewa Terdaftar</h3>
                                    <p class="card-text" id="stat-penyewa">0</p>
                                </div>
                            </article>
                        </div>
                    </div>

                    <form id="form-pencarian" class="card p-4 mb-4">
                        <h3 class="mb-3">Cari Properti Impian Anda</h3>
                        <div class="row g-3">
                            <div class="col-md-8">
                                <label for="lokasi" class="form-label">Lokasi</label>
                                <input type="text" class="form-control" id="lokasi"
                                    placeholder="Contoh: Puncak Pass, Ciwidey">
                                <div class="form-text">Masukkan nama area, kota, atau kode pos.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="radius" class="form-label">Radius (km)</label>
                                <select id="radius" class="form-select">
                                    <option value="5">5 km</option>
                                    <option value="10" selected>10 km</option>
                                    <option value="20">20 km</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label for="check-in" class="form-label">Tanggal Masuk</label>
                                <input type="date" class="form-control" id="check-in">
                            </div>
                            <div class="col-md-6">
                                <label for="check-out" class="form-label">Tanggal Keluar</label>
                                <input type="date" class="form-control" id="check-out">
                            </div>
                            <div class="col-md-4">
                                <label for="harga" class="form-label">Harga Maks (Rp/malam)</label>
                                <input type="number" class="form-control" id="harga" min="0" step="50000"
                                    placeholder="1500000">
                            </div>
                            <div class="col-md-4">
                                <label for="fasilitas" class="form-label">Fasilitas</label>
                                <select id="fasilitas" class="form-select" multiple style="height: 100px;">
                                    <option value="wifi">Wi-Fi</option>
                                    <option value="kolam">Kolam Renang</option>
                                    <option value="parkir">Parkir</option>
                                    <option value="dapur">Dapur Lengkap</option>
                                    <option value="ac">AC</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label for="tipe" class="form-label">Tipe Properti</label>
                                <select id="tipe" class="form-select">
                                    <option value="">Semua Tipe</option>
                                    <option value="villa">Villa</option>
                                    <option value="cottage">Cottage</option>
                                    <option value="apartemen">Apartemen</option>
                                    <option value="glamping">Glamping</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary mt-3 w-100">
                            <i class="fas fa-search me-2"></i>Cari Properti
                        </button>
                    </form>

                    <section id="peta-placeholder" class="map-placeholder mb-4 p-5 text-center">
                        Peta Lokasi akan muncul di sini (Simulasi: Green Valley Area, Radius: 10 km)
                    </section>

                    <h3 class="mb-3">Properti Unggulan</h3>
                    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="featured-properties">
                        <!-- Featured properties will be rendered here -->
                    </div>
                </section>

                <!-- Properti List Page -->
                <section id="properti" class="page">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2>Daftar Properti</h2>
                        <button class="btn btn-sm btn-outline-secondary" onclick="navigasiKe('beranda')"><i
                                class="fas fa-filter me-1"></i> Ubah Filter</button>
                    </div>
                    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="daftar-properti">
                        <!-- Property list will be rendered here -->
                    </div>
                </section>

                <!-- Detail Properti Page -->
                <section id="detail-properti" class="page">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2 id="detail-nama-properti">Detail Properti</h2>
                        <button class="btn btn-sm btn-light" onclick="navigasiKe('properti')"><i
                                class="fas fa-arrow-left me-2"></i>Kembali ke Daftar</button>
                    </div>

                    <div class="card mb-4">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-7 mb-3 mb-lg-0">
                                    <figure class="position-relative">
                                        <img src="https://via.placeholder.com/800x500/A9D18E/333333?text=Green+Valley+Vista"
                                            alt="Galeri utama properti"
                                            class="img-fluid rounded gallery-image detail-gallery-image"
                                            id="detail-gambar-utama" loading="lazy">
                                        <figcaption
                                            class="position-absolute bottom-0 start-0 bg-dark bg-opacity-50 text-white p-2 m-2 rounded">
                                            <i class="fas fa-vr-cardboard me-1"></i> Tur 360° Tersedia (Simulasi)
                                        </figcaption>
                                    </figure>
                                    <div class="row g-2 mt-2" id="detail-thumbnails">
                                        <!-- Thumbnails will be rendered here -->
                                    </div>
                                </div>
                                <div class="col-lg-5">
                                    <h3 id="detail-judul-properti" class="h4">Nama Properti Placeholder</h3>
                                    <p id="detail-lokasi-properti" class="text-muted mb-1"><i
                                            class="fas fa-map-marker-alt me-1 text-success"></i> Lokasi Placeholder</p>
                                    <p id="detail-pemilik-properti" class="text-muted mb-2">
                                        Pemilik Terverifikasi <i class="fas fa-check-circle text-success"></i>
                                    </p>
                                    <p id="detail-deskripsi-properti" class="mb-3">Deskripsi singkat properti.</p>
                                    <div class="mb-3">
                                        <strong>Fasilitas:</strong> <span id="detail-fasilitas-properti"
                                            class.text-muted>Fasilitas Placeholder</span>
                                    </div>
                                    <h4 id="detail-harga-properti" class="h5 text-success mb-3">Harga Placeholder</h4>

                                    <form id="form-pemesanan">
                                        <h5 class="mb-3">Pesan Sekarang</h5>
                                        <div class="row g-3 mb-3">
                                            <div class="col-md-6">
                                                <label for="booking-check-in" class="form-label">Tanggal Masuk</label>
                                                <input type="date" class="form-control" id="booking-check-in">
                                            </div>
                                            <div class="col-md-6">
                                                <label for="booking-check-out" class="form-label">Tanggal Keluar</label>
                                                <input type="date" class="form-control" id="booking-check-out">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="metode-pembayaran" class="form-label">Metode Pembayaran</label>
                                            <select id="metode-pembayaran" class="form-select">
                                                <option value="kartu-kredit">Kartu Kredit</option>
                                                <option value="transfer-bank">Transfer Bank</option>
                                                <option value="dompet-digital">Dompet Digital</option>
                                            </select>
                                        </div>
                                        <div class="form-check mb-3">
                                            <input class="form-check-input" type="checkbox" id="asuransi">
                                            <label class="form-check-label" for="asuransi">
                                                Tambah Asuransi Perjalanan (+10%)
                                            </label>
                                        </div>
                                        <div id="perincian-biaya" class="mb-3 p-3 bg-light rounded">
                                            <p class="mb-1">Harga Dasar: <span id="biaya-dasar">Rp0</span></p>
                                            <p class="mb-1">Pajak & Biaya Layanan: <span id="biaya-pajak">Rp0</span></p>
                                            <p class="mb-1">Asuransi: <span id="biaya-asuransi">Rp0</span></p>
                                            <hr class="my-1">
                                            <p class="fw-bold mb-0">Total: <span id="biaya-total">Rp0</span></p>
                                        </div>
                                        <p class="text-success small mb-3"><i class="fas fa-shield-alt me-1"></i>
                                            Pembayaran Anda aman bersama kami.</p>
                                        <button type="submit" class="btn btn-primary w-100 mb-2">
                                            <i class="fas fa-calendar-plus me-2"></i>Konfirmasi Pemesanan
                                        </button>
                                        <button type="button" class="btn btn-outline-danger w-100"
                                            data-bs-toggle="modal" data-bs-target="#modal-laporan">
                                            <i class="fas fa-flag me-2"></i>Laporkan Masalah
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <section id="ulasan" class="card h-100">
                                <div class="card-body">
                                    <h4 class="card-title mb-3">Ulasan Pelanggan</h4>
                                    <div id="daftar-ulasan">
                                        <blockquote class="border-start border-3 border-success ps-3 mb-3">
                                            <p class="fst-italic mb-1">"Tempatnya asri dan nyaman sekali, pemandangannya
                                                indah!"</p>
                                            <footer class="blockquote-footer mb-0">Andini Putri, <cite
                                                    title="Tanggal Ulasan">Okt 2023</cite></footer>
                                        </blockquote>
                                        <blockquote class="border-start border-3 border-success ps-3 mb-3">
                                            <p class="fst-italic mb-1">"Pelayanan sangat baik, fasilitas lengkap. Pasti
                                                kembali lagi!"</p>
                                            <footer class="blockquote-footer mb-0">Rizky Pratama, <cite
                                                    title="Tanggal Ulasan">Sep 2023</cite></footer>
                                        </blockquote>
                                    </div>
                                    <button class="btn btn-sm btn-outline-secondary mt-2"><i
                                            class="fas fa-plus me-1"></i> Tambah Ulasan</button>
                                </div>
                            </section>
                        </div>
                        <div class="col-md-6">
                            <section id="chatbox" class="card h-100">
                                <div class="card-body d-flex flex-column">
                                    <h4 class="card-title mb-3">Chat dengan Pemilik</h4>
                                    <div id="pesan-chat" class="flex-grow-1 overflow-auto mb-3">
                                        <!-- Chat messages will be rendered here -->
                                    </div>
                                    <form id="form-chat" class="d-flex gap-2">
                                        <input type="text" id="input-chat" class="form-control"
                                            placeholder="Ketik pesan Anda...">
                                        <button type="submit" class="btn btn-success"><i
                                                class="fas fa-paper-plane"></i></button>
                                    </form>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>

                <!-- Penyewa Page -->
                <section id="penyewa" class="page">
                    <h2 class="mb-4">Manajemen Penyewa</h2>
                    <button class="btn btn-primary mb-3" id="btn-tambah-penyewa"><i
                            class="fas fa-user-plus me-2"></i>Tambah Penyewa Baru</button>
                    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4" id="daftar-penyewa">
                        <!-- Tenant list will be rendered here -->
                    </div>
                </section>

                <!-- Pemesanan Page -->
                <section id="pemesanan" class="page">
                    <h2 class="mb-4">Riwayat Pemesanan</h2>
                    <div class="table-responsive">
                        <table class="table table-hover align-middle">
                            <thead>
                                <tr>
                                    <th>ID Pesanan</th>
                                    <th>Properti</th>
                                    <th>Tanggal</th>
                                    <th>Status</th>
                                    <th>Total Biaya</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="daftar-pemesanan">
                                <!-- Booking list will be rendered here -->
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- Akun Page -->
                <section id="akun" class="page">
                    <h2 class="mb-4">Pengaturan Akun</h2>
                    <div class="card">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 text-center mb-3 mb-md-0">
                                    <img src="https://i.pravatar.cc/150?u=user" alt="Foto Profil"
                                        class="img-thumbnail rounded-circle mb-2" style="width:120px; height:120px;">
                                    <h4 id="akun-nama-display">Nama Pengguna</h4>
                                    <p class="text-muted" id="akun-email-display">email@example.com</p>
                                    <button class="btn btn-sm btn-outline-secondary"><i class="fas fa-camera me-1"></i>
                                        Ganti Foto</button>
                                    <hr>
                                    <p class="mb-1"><strong>Poin Loyalitas:</strong> <span id="poin-loyalitas"
                                            class="badge bg-success">0</span></p>
                                </div>
                                <div class="col-md-8">
                                    <h3 class="h5 mb-3">Edit Profil</h3>
                                    <form id="form-profil">
                                        <div class="mb-3">
                                            <label for="nama-profil" class="form-label">Nama Lengkap</label>
                                            <input type="text" class="form-control" id="nama-profil"
                                                value="Nama Pengguna">
                                        </div>
                                        <div class="mb-3">
                                            <label for="email-profil" class="form-label">Alamat Email</label>
                                            <input type="email" class="form-control" id="email-profil"
                                                value="email@example.com">
                                        </div>
                                        <div class="mb-3">
                                            <label for="telepon-profil" class="form-label">Nomor Telepon</label>
                                            <input type="tel" class="form-control" id="telepon-profil"
                                                placeholder="081234567890">
                                        </div>
                                        <button type="submit" class="btn btn-primary"><i
                                                class="fas fa-save me-2"></i>Simpan Perubahan</button>
                                    </form>
                                    <hr>
                                    <h3 class="h5 mt-4 mb-3">Keamanan Akun</h3>
                                    <button class="btn btn-outline-secondary mb-2"><i class="fas fa-key me-2"></i>Ubah
                                        Kata Sandi</button>
                                    <button class="btn btn-outline-danger"><i
                                            class="fas fa-user-slash me-2"></i>Nonaktifkan Akun</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Dukungan Page -->
                <section id="dukungan" class="page">
                    <h2 class="mb-4">Pusat Bantuan</h2>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h3 class="card-title h5"><i
                                            class="fas fa-question-circle me-2 text-primary"></i>FAQ (Pertanyaan Umum)
                                    </h3>
                                    <div class="accordion" id="faqAccordion">
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="faqHeading1">
                                                <button class="accordion-button collapsed" type="button"
                                                    data-bs-toggle="collapse" data-bs-target="#faqCollapse1"
                                                    aria-expanded="false" aria-controls="faqCollapse1">
                                                    Bagaimana cara memesan properti?
                                                </button>
                                            </h2>
                                            <div id="faqCollapse1" class="accordion-collapse collapse"
                                                aria-labelledby="faqHeading1" data-bs-parent="#faqAccordion">
                                                <div class="accordion-body">
                                                    Anda dapat mencari properti melalui halaman Beranda atau Properti,
                                                    pilih tanggal, lalu klik tombol pesan dan ikuti langkah selanjutnya.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="accordion-item">
                                            <h2 class="accordion-header" id="faqHeading2">
                                                <button class="accordion-button collapsed" type="button"
                                                    data-bs-toggle="collapse" data-bs-target="#faqCollapse2"
                                                    aria-expanded="false" aria-controls="faqCollapse2">
                                                    Metode pembayaran apa saja yang diterima?
                                                </button>
                                            </h2>
                                            <div id="faqCollapse2" class="accordion-collapse collapse"
                                                aria-labelledby="faqHeading2" data-bs-parent="#faqAccordion">
                                                <div class="accordion-body">
                                                    Kami menerima kartu kredit, transfer bank, dan berbagai dompet
                                                    digital populer.
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h3 class="card-title h5"><i class="fas fa-headset me-2 text-success"></i>Hubungi
                                        Kami 24/7</h3>
                                    <p>Jika Anda memerlukan bantuan lebih lanjut, jangan ragu untuk menghubungi tim
                                        dukungan kami:</p>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-comments me-2 text-success"></i> <a href="#"
                                                class="text-decoration-none link-success">Chat Langsung (Online)</a>
                                        </li>
                                        <li class="mb-2"><i class="fas fa-envelope me-2 text-success"></i> <a
                                                href="mailto:support@greenvalley.com"
                                                class="text-decoration-none link-success">support@greenvalley.com</a>
                                        </li>
                                        <li class="mb-2"><i class="fas fa-phone me-2 text-success"></i> <a
                                                href="tel:+6281122334455" class="text-decoration-none link-success">+62
                                                811 2233 4455</a></li>
                                    </ul>
                                    <p class="small text-muted">Tim kami siap membantu Anda kapan saja.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Modal Laporan (Bootstrap Modal) -->
                <div class="modal fade" id="modal-laporan" tabindex="-1" aria-labelledby="modalLaporanLabel"
                    aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalLaporanLabel"><i class="fas fa-flag me-2"></i>Laporkan
                                    Masalah Properti</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                    aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form id="form-laporan">
                                    <div class="mb-3">
                                        <label for="kategori-laporan" class="form-label">Kategori Masalah</label>
                                        <select id="kategori-laporan" class="form-select">
                                            <option value="kebersihan">Kebersihan</option>
                                            <option value="fasilitas">Fasilitas Tidak Sesuai</option>
                                            <option value="keamanan">Keamanan</option>
                                            <option value="deskripsi">Deskripsi Tidak Akurat</option>
                                            <option value="lainnya">Lainnya</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="masalah-laporan" class="form-label">Jelaskan Masalah Secara
                                            Rinci</label>
                                        <textarea class="form-control" id="masalah-laporan" rows="4"
                                            placeholder="Contoh: AC di kamar utama tidak dingin."></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <label for="lampiran-laporan" class="form-label">Lampirkan Foto
                                            (Opsional)</label>
                                        <input class="form-control" type="file" id="lampiran-laporan">
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-secondary"
                                    data-bs-dismiss="modal">Batal</button>
                                <button type="submit" form="form-laporan" class="btn btn-danger"><i
                                        class="fas fa-paper-plane me-2"></i>Kirim Laporan</button>
                            </div>
                        </div>
                    </div>
                </div>

            </main>
        </div>

        <footer class="app-footer">
            © <span id="current-year"></span> Green Valley Property Rentals. Hak Cipta Dilindungi Undang-Undang.
        </footer>
    </div>

    <!-- Bootstrap JS Bundle (Popper.js included) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // --- Global State & Configuration ---
        const state = {
            currentPage: 'beranda',
            properties: [
                { id: 1, name: 'Villa Asri Puncak Cemara', location: 'Puncak Pass, Bogor', price: 1250000, rating: 4.8, images: ['https://via.placeholder.com/800x500/A9D18E/333333?text=Villa+Cemara+1', 'https://via.placeholder.com/800x500/C8E6C9/333333?text=Villa+Cemara+2', 'https://via.placeholder.com/800x500/81C784/333333?text=Villa+Cemara+3'], facilities: ['wifi', 'kolam', 'parkir', 'dapur'], type: 'villa', description: 'Villa menawan dengan pemandangan gunung yang spektakuler, cocok untuk liburan keluarga.' },
                { id: 2, name: 'Cottage Lembah Hijau', location: 'Ciwidey, Bandung', price: 850000, rating: 4.5, images: ['https://via.placeholder.com/800x500/C5E1A5/333333?text=Cottage+Lembah+1', 'https://via.placeholder.com/800x500/AED581/333333?text=Cottage+Lembah+2'], facilities: ['wifi', 'parkir', 'ac'], type: 'cottage', description: 'Cottage nyaman di tengah perkebunan teh, menawarkan ketenangan dan udara segar.' },
                { id: 3, name: 'Glamping Tepi Sungai', location: 'Sukabumi, Jawa Barat', price: 950000, rating: 4.7, images: ['https://via.placeholder.com/800x500/9CCC65/333333?text=Glamping+Sungai+1'], facilities: ['wifi', 'parkir'], type: 'glamping', description: 'Pengalaman berkemah mewah di tepi sungai dengan fasilitas modern.' },
                { id: 4, name: 'Apartemen Sky Garden', location: 'Sentul City, Bogor', price: 700000, rating: 4.3, images: ['https://via.placeholder.com/800x500/8BC34A/333333?text=Apartemen+Sky+1'], facilities: ['wifi', 'kolam', 'gym', 'ac'], type: 'apartemen', description: 'Apartemen modern dengan akses mudah ke berbagai fasilitas hiburan dan rekreasi.' }
            ],
            bookings: [
                { id: 'GV2024001', propertyId: 1, propertyName: 'Villa Asri Puncak Cemara', checkIn: '2024-07-10', checkOut: '2024-07-12', status: 'Dikonfirmasi', totalCost: 2500000 },
                { id: 'GV2024002', propertyId: 3, propertyName: 'Glamping Tepi Sungai', checkIn: '2024-08-01', checkOut: '2024-08-03', status: 'Menunggu Pembayaran', totalCost: 1900000 }
            ],
            tenants: [
                { id: 1, name: 'Budi Santoso', since: '2023-05-10', email: 'budi.s@example.com', phone: '081234567890', activeBookings: 1 },
                { id: 2, name: 'Citra Lestari', since: '2024-01-15', email: 'citra.l@example.com', phone: '087654321098', activeBookings: 0 }
            ],
            user: { name: 'Andi Pratama', email: 'andi.p@greenvalley.com', phone: '081122334455', loyaltyPoints: 250 },
            chatMessages: [
                { sender: 'Owner', text: 'Halo! Selamat datang di Green Valley. Ada yang bisa saya bantu?', time: new Date(Date.now() - 60000 * 5) },
                { sender: 'User', text: 'Saya tertarik dengan Villa Asri, apakah tersedia untuk akhir pekan ini?', time: new Date(Date.now() - 60000 * 3) },
            ],
            currentPropertyDetailId: null,
        };

        // --- Utilities ---
        const $ = selector => document.querySelector(selector);
        const $$ = selector => document.querySelectorAll(selector);
        const formatRupiah = number => `Rp${number.toLocaleString('id-ID')}`;
        const formatDate = dateString => new Date(dateString).toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' });

        // --- SPA Navigation ---
        function navigateTo(pageId, params = null) {
            $$('.page').forEach(p => p.classList.remove('active'));
            const targetPage = $(`#${pageId}`);
            if (targetPage) {
                targetPage.classList.add('active');
            }

            $$('.app-sidebar .nav-link').forEach(link => {
                link.classList.toggle('active', link.dataset.route === pageId);
            });
            state.currentPage = pageId;
            window.location.hash = pageId + (params ? `?id=${params.id}` : ''); // Update hash for SPA feel

            // Specific render functions for pages
            switch (pageId) {
                case 'beranda':
                    renderFeaturedProperties();
                    updateDashboardStats();
                    break;
                case 'properti':
                    renderPropertyList(state.properties);
                    break;
                case 'detail-properti':
                    if (params && params.id) {
                        state.currentPropertyDetailId = parseInt(params.id);
                        renderPropertyDetail(state.currentPropertyDetailId);
                        renderChatMessages(); // also render chat when viewing detail
                    } else {
                        console.warn("No property ID provided for detail page. Redirecting to property list.");
                        navigateTo('properti'); // Fallback
                    }
                    break;
                case 'pemesanan':
                    renderBookingList();
                    break;
                case 'penyewa':
                    renderTenantList();
                    break;
                case 'akun':
                    renderAccountPage();
                    break;
                case 'dukungan':
                    // static content, no specific render needed unless dynamic
                    break;
            }
            window.scrollTo(0, 0); // Scroll to top on page change
        }

        // --- Render Functions ---
        function renderPropertyList(propertiesToRender) {
            const container = $('#daftar-properti');
            if (!container) return;
            container.innerHTML = propertiesToRender.length ? propertiesToRender.map(p => `
                <div class="col">
                    <article class="card h-100 property-card" data-id="${p.id}">
                        <img src="${p.images[0]}" alt="${p.name}" class="card-img-top gallery-image" loading="lazy">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${p.name}</h5>
                            <p class="card-text small text-muted"><i class="fas fa-map-marker-alt me-1 text-success"></i>${p.location}</p>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="fw-bold text-success">${formatRupiah(p.price)}/malam</span>
                                <span class="small"><i class="fas fa-star text-warning me-1"></i>${p.rating}</span>
                            </div>
                            <p class="card-text small flex-grow-1">${p.description.substring(0, 70)}...</p>
                            <button class="btn btn-sm btn-primary w-100 mt-auto view-detail-btn" data-id="${p.id}">Lihat Detail</button>
                        </div>
                    </article>
                </div>
            `).join('') : '<div class="col"><p class="text-muted">Tidak ada properti yang cocok dengan kriteria Anda.</p></div>';

            $$('.view-detail-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const propertyId = e.currentTarget.dataset.id;
                    navigateTo('detail-properti', { id: propertyId });
                });
            });
        }

        function renderFeaturedProperties() {
            const container = $('#featured-properties');
            if (!container) return;
            // Show first 3 properties or less if not enough
            const featured = state.properties.slice(0, 3);
            renderPropertyList(featured); // Use the same render function
            // Adjust selector as renderPropertyList uses #daftar-properti
            container.innerHTML = $('#daftar-properti').innerHTML;
            $$('#featured-properties .view-detail-btn').forEach(btn => { // Re-attach listeners for featured
                btn.addEventListener('click', (e) => {
                    const propertyId = e.currentTarget.dataset.id;
                    navigateTo('detail-properti', { id: propertyId });
                });
            });
        }

        function renderPropertyDetail(propertyId) {
            const property = state.properties.find(p => p.id === propertyId);
            if (!property) {
                $('#detail-properti').innerHTML = '<p class="text-danger">Properti tidak ditemukan.</p>';
                return;
            }

            $('#detail-nama-properti').textContent = property.name;
            $('#detail-gambar-utama').src = property.images[0];
            $('#detail-gambar-utama').alt = property.name;

            const thumbnailsContainer = $('#detail-thumbnails');
            thumbnailsContainer.innerHTML = property.images.map((img, index) => `
                <div class="col-3">
                    <img src="${img}" alt="Thumbnail ${index + 1}" class="thumbnail ${index === 0 ? 'active-thumb' : ''}" data-index="${index}" loading="lazy">
                </div>
            `).join('');

            $$('#detail-thumbnails .thumbnail').forEach(thumb => {
                thumb.addEventListener('click', (e) => {
                    const mainImage = $('#detail-gambar-utama');
                    mainImage.src = e.target.src.replace('150', '800x500'); // Assuming placeholder pattern
                    mainImage.alt = e.target.alt.replace('Thumbnail', property.name);
                    $$('#detail-thumbnails .thumbnail').forEach(t => t.classList.remove('active-thumb'));
                    e.target.classList.add('active-thumb');
                });
            });

            $('#detail-judul-properti').textContent = property.name;
            $('#detail-lokasi-properti').innerHTML = `<i class="fas fa-map-marker-alt me-1 text-success"></i>${property.location}`;
            $('#detail-deskripsi-properti').textContent = property.description;
            $('#detail-fasilitas-properti').textContent = property.facilities.join(', ');
            $('#detail-harga-properti').textContent = `${formatRupiah(property.price)} / malam`;

            // Reset and prefill booking form (example dates)
            const today = new Date().toISOString().split('T')[0];
            const tomorrow = new Date(Date.now() + 86400000).toISOString().split('T')[0];
            $('#booking-check-in').value = today;
            $('#booking-check-out').value = tomorrow;
            $('#asuransi').checked = false;
            updateBookingCost(property.price); // Initial cost calculation
        }

        function updateBookingCost(basePrice) {
            const checkInDate = $('#booking-check-in').value;
            const checkOutDate = $('#booking-check-out').value;
            let nights = 1;
            if (checkInDate && checkOutDate) {
                const diffTime = Math.abs(new Date(checkOutDate) - new Date(checkInDate));
                nights = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                if (nights <= 0) nights = 1; // Minimum 1 night
            }

            const pricePerNight = basePrice;
            const subtotal = pricePerNight * nights;
            const taxAndService = subtotal * 0.11; // Example 11% tax/service
            const insurance = $('#asuransi').checked ? subtotal * 0.10 : 0;
            const total = subtotal + taxAndService + insurance;

            $('#biaya-dasar').textContent = `${formatRupiah(subtotal)} (${nights} malam)`;
            $('#biaya-pajak').textContent = formatRupiah(taxAndService);
            $('#biaya-asuransi').textContent = formatRupiah(insurance);
            $('#biaya-total').textContent = formatRupiah(total);
        }


        function renderTenantList() {
            const container = $('#daftar-penyewa');
            if (!container) return;
            container.innerHTML = state.tenants.map(t => `
                <div class="col">
                    <article class="card h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center mb-2">
                                <img src="https://i.pravatar.cc/50?u=${t.email}" alt="${t.name}" class="rounded-circle me-2">
                                <div>
                                    <h5 class="card-title mb-0">${t.name}</h5>
                                    <p class="card-text small text-muted mb-0">Penyewa sejak ${formatDate(t.since)}</p>
                                </div>
                            </div>
                            <p class="card-text small"><i class="fas fa-envelope me-1"></i> ${t.email}<br><i class="fas fa-phone me-1"></i> ${t.phone}</p>
                            <p class="card-text small">Pemesanan Aktif: <span class="badge bg-success">${t.activeBookings}</span></p>
                            <div class="mt-auto">
                                <button class="btn btn-sm btn-outline-primary me-1" onclick="editTenant(${t.id})"><i class="fas fa-edit"></i> Edit</button>
                                <button class="btn btn-sm btn-outline-danger" onclick="deleteTenant(${t.id})"><i class="fas fa-trash"></i> Hapus</button>
                            </div>
                        </div>
                    </article>
                </div>
            `).join('');
        }

        function renderBookingList() {
            const container = $('#daftar-pemesanan');
            if (!container) return;
            container.innerHTML = state.bookings.map(b => `
                <tr>
                    <td><strong>${b.id}</strong></td>
                    <td>${b.propertyName}</td>
                    <td>${formatDate(b.checkIn)} - ${formatDate(b.checkOut)}</td>
                    <td><span class="badge bg-${b.status === 'Dikonfirmasi' ? 'success' : (b.status === 'Menunggu Pembayaran' ? 'warning text-dark' : 'secondary')}">${b.status}</span></td>
                    <td>${formatRupiah(b.totalCost)}</td>
                    <td>
                        <button class="btn btn-sm btn-info me-1" title="Lihat Detail"><i class="fas fa-eye"></i></button>
                        ${b.status === 'Menunggu Pembayaran' ? `<button class="btn btn-sm btn-success" title="Konfirmasi Pembayaran"><i class="fas fa-check-circle"></i></button>` : ''}
                    </td>
                </tr>
            `).join('');
        }

        function renderAccountPage() {
            $('#akun-nama-display').textContent = state.user.name;
            $('#akun-email-display').textContent = state.user.email;
            $('#nama-profil').value = state.user.name;
            $('#email-profil').value = state.user.email;
            $('#telepon-profil').value = state.user.phone || '';
            $('#poin-loyalitas').textContent = state.user.loyaltyPoints;
        }

        function renderChatMessages() {
            const container = $('#pesan-chat');
            if (!container) return;
            container.innerHTML = state.chatMessages.map(msg => `
                <div class="d-flex ${msg.sender === 'User' ? 'justify-content-end user-message' : 'owner-message'} mb-2">
                    <div class="chat-bubble">
                        <small class="fw-bold">${msg.sender}</small><br>
                        ${msg.text}
                        <div class="text-end small opacity-75 mt-1">${new Date(msg.time).toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })}</div>
                    </div>
                </div>
            `).join('');
            container.scrollTop = container.scrollHeight;
        }

        function updateDashboardStats() {
            $('#stat-properti').textContent = state.properties.length;
            $('#stat-pemesanan').textContent = state.bookings.filter(b => b.status === 'Dikonfirmasi' || b.status === 'Menunggu Pembayaran').length;
            $('#stat-penyewa').textContent = state.tenants.length;
        }


        // --- Event Handlers & Logic ---
        function handleSearchForm(e) {
            e.preventDefault();
            const location = $('#lokasi').value.trim().toLowerCase();
            // const radius = $('#radius').value; // Radius logic would need geo-data/API
            const checkIn = $('#check-in').value;
            const checkOut = $('#check-out').value;
            const maxPrice = parseInt($('#harga').value) || Infinity;
            const facilities = Array.from($('#fasilitas').selectedOptions).map(opt => opt.value);
            const type = $('#tipe').value;

            if (checkIn && checkOut && new Date(checkIn) >= new Date(checkOut)) {
                alert('Tanggal keluar harus setelah tanggal masuk.');
                return;
            }

            const filteredProperties = state.properties.filter(p => {
                const matchesLocation = !location || p.location.toLowerCase().includes(location);
                const matchesPrice = p.price <= maxPrice;
                const matchesFacilities = facilities.length === 0 || facilities.every(f => p.facilities.includes(f));
                const matchesType = !type || p.type === type;
                // Add date availability check here if you have booking data per property
                return matchesLocation && matchesPrice && matchesFacilities && matchesType;
            });

            $('#peta-placeholder').textContent = `Menampilkan hasil untuk ${location || 'semua lokasi'}... (Simulasi)`;
            renderPropertyList(filteredProperties);
            navigateTo('properti');
        }

        function handleBookingForm(e) {
            e.preventDefault();
            if (!state.currentPropertyDetailId) {
                alert("Error: Properti tidak dipilih.");
                return;
            }
            const property = state.properties.find(p => p.id === state.currentPropertyDetailId);

            const checkIn = $('#booking-check-in').value;
            const checkOut = $('#booking-check-out').value;
            // ... (validation, conflict check logic from original) ...

            if (!checkIn || !checkOut) {
                alert('Harap masukkan tanggal masuk dan keluar.');
                return;
            }
            const dateIn = new Date(checkIn);
            const dateOut = new Date(checkOut);
            if (dateIn >= dateOut) {
                alert('Tanggal keluar harus setelah tanggal masuk.');
                return;
            }

            // Basic conflict check (simplified)
            const isConflict = state.bookings.some(b => {
                if (b.propertyId !== property.id) return false;
                const existingCheckIn = new Date(b.checkIn);
                const existingCheckOut = new Date(b.checkOut);
                // Check if new booking overlaps with an existing one
                return (dateIn < existingCheckOut && dateOut > existingCheckIn);
            });

            if (isConflict) {
                alert('Tanggal yang dipilih sudah dipesan atau tumpang tindih. Silakan pilih tanggal lain.');
                return;
            }

            const totalCost = parseFloat($('#biaya-total').textContent.replace(/[^0-9]/g, ''));
            const pointsEarned = Math.floor(totalCost / 100000); // 1 point per 100k

            const newBooking = {
                id: 'GV' + Date.now().toString().slice(-7),
                propertyId: property.id,
                propertyName: property.name,
                checkIn,
                checkOut,
                status: 'Menunggu Pembayaran', // Default status
                totalCost
            };
            state.bookings.push(newBooking);
            state.user.loyaltyPoints += pointsEarned;

            alert(`Pemesanan untuk ${property.name} sedang diproses! Anda mendapatkan ${pointsEarned} poin loyalitas.`);
            navigateTo('pemesanan');
            updateDashboardStats();
            renderAccountPage();
        }

        function handleChatForm(e) {
            e.preventDefault();
            const messageInput = $('#input-chat');
            const messageText = messageInput.value.trim();
            if (!messageText) return;

            state.chatMessages.push({ sender: 'User', text: messageText, time: new Date() });
            renderChatMessages();
            messageInput.value = '';

            // Simulate owner reply
            setTimeout(() => {
                state.chatMessages.push({ sender: 'Owner', text: 'Terima kasih atas pesan Anda. Kami akan segera merespons.', time: new Date() });
                renderChatMessages();
            }, 1500);
        }

        function handleProfileForm(e) {
            e.preventDefault();
            state.user.name = $('#nama-profil').value;
            state.user.email = $('#email-profil').value;
            state.user.phone = $('#telepon-profil').value;
            alert('Profil berhasil diperbarui!');
            renderAccountPage(); // Re-render to show changes
        }

        function handleReportForm(e) {
            e.preventDefault();
            const issueDescription = $('#masalah-laporan').value.trim();
            if (!issueDescription) {
                alert('Harap jelaskan masalah yang ingin dilaporkan.');
                return;
            }
            // Actual report submission logic would go here
            alert('Laporan Anda telah dikirim. Terima kasih atas masukannya.');

            // Close Bootstrap modal
            const reportModal = bootstrap.Modal.getInstance($('#modal-laporan'));
            if (reportModal) reportModal.hide();

            $('#form-laporan').reset();
        }

        // --- CRUD-like functions for Tenants (example) ---
        function editTenant(tenantId) {
            const tenant = state.tenants.find(t => t.id === tenantId);
            if (!tenant) return;
            const newName = prompt(`Edit nama untuk ${tenant.name}:`, tenant.name);
            if (newName && newName.trim() !== '') {
                tenant.name = newName.trim();
                renderTenantList();
            }
        }

        function deleteTenant(tenantId) {
            if (confirm('Apakah Anda yakin ingin menghapus penyewa ini?')) {
                state.tenants = state.tenants.filter(t => t.id !== tenantId);
                renderTenantList();
                updateDashboardStats();
            }
        }

        function handleAddTenant() {
            const name = prompt("Masukkan nama penyewa baru:");
            if (name && name.trim() !== "") {
                const email = prompt("Masukkan email penyewa:", name.trim().toLowerCase().replace(/\s/g, '.') + "@example.com");
                if (email && email.trim() !== "") {
                    const newTenant = {
                        id: Date.now(),
                        name: name.trim(),
                        since: new Date().toISOString().split('T')[0],
                        email: email.trim(),
                        phone: prompt("Masukkan nomor telepon:", "081xxxxxxxxx"),
                        activeBookings: 0
                    };
                    state.tenants.push(newTenant);
                    renderTenantList();
                    updateDashboardStats();
                }
            }
        }


        // --- Initialization ---
        function initializeApp() {
            // Set current year in footer
            $('#current-year').textContent = new Date().getFullYear();

            // Attach event listeners
            $$('.app-sidebar .nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(link.dataset.route);
                });
            });
            $$('.navbar-brand').forEach(link => { // For logo click
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigateTo(link.dataset.route);
                });
            });

            $('#form-pencarian').addEventListener('submit', handleSearchForm);
            $('#form-pemesanan').addEventListener('submit', handleBookingForm);
            $('#form-chat').addEventListener('submit', handleChatForm);
            $('#form-profil').addEventListener('submit', handleProfileForm);
            $('#form-laporan').addEventListener('submit', handleReportForm);

            // Listeners for booking cost update
            $('#booking-check-in').addEventListener('change', () => updateBookingCost(state.properties.find(p => p.id === state.currentPropertyDetailId)?.price || 0));
            $('#booking-check-out').addEventListener('change', () => updateBookingCost(state.properties.find(p => p.id === state.currentPropertyDetailId)?.price || 0));
            $('#asuransi').addEventListener('change', () => updateBookingCost(state.properties.find(p => p.id === state.currentPropertyDetailId)?.price || 0));

            $('#btn-tambah-penyewa')?.addEventListener('click', handleAddTenant);


            // Initial page load based on hash or default
            const initialHash = window.location.hash.substring(1);
            const [pageName, queryString] = initialHash.split('?');
            let params = null;
            if (queryString) {
                const urlParams = new URLSearchParams(queryString);
                if (urlParams.has('id')) {
                    params = { id: urlParams.get('id') };
                }
            }

            if (pageName && $(`#${pageName}`)) {
                navigateTo(pageName, params);
            } else {
                navigateTo('beranda'); // Default page
            }

            updateDashboardStats(); // Initial stat update
            renderFeaturedProperties(); // Render featured on load
            renderChatMessages(); // Initial render for chat
        }

        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>

</html>