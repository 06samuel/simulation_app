<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Green Valley Rentals - Aplikasi Monolith SPA</title>
    <style>
        /* === 0. Reset CSS Dasar & Variabel Global === */
        :root {
            --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-display: 'Poppins', var(--font-sans);

            /* Palet Warna Terang (Light Mode) */
            --color-primary-light-val: 34, 197, 94;
            /* #22c55e */
            --color-primary-default-val: 5, 150, 105;
            /* #059669 */
            --color-primary-dark-val: 4, 120, 87;
            /* #047857 */

            --color-secondary-light-val: 251, 191, 36;
            /* #fbb_f24 */
            --color-secondary-default-val: 217, 119, 6;
            /* #d97706 */
            --color-secondary-dark-val: 180, 83, 9;
            /* #b45309 */

            --color-background-light-val: 248, 250, 252;
            /* #f8fafc (slate-50) */
            --color-surface-light-val: 255, 255, 255;
            /* #ffffff */
            --color-text-light-val: 30, 41, 59;
            /* #1e293b (slate-800) */
            --color-border-light-val: 226, 232, 240;
            /* #e2e8f0 (slate-200) */
            --color-muted-light-val: 100, 116, 139;
            /* #64748b (slate-500) */

            /* Palet Warna Gelap (Dark Mode) - akan di-override di .dark */
            --color-primary-light: rgb(var(--color-primary-light-val));
            --color-primary-default: rgb(var(--color-primary-default-val));
            --color-primary-dark: rgb(var(--color-primary-dark-val));

            --color-secondary-light: rgb(var(--color-secondary-light-val));
            --color-secondary-default: rgb(var(--color-secondary-default-val));
            --color-secondary-dark: rgb(var(--color-secondary-dark-val));

            --color-background: rgb(var(--color-background-light-val));
            --color-surface: rgb(var(--color-surface-light-val));
            --color-text-default: rgb(var(--color-text-light-val));
            --color-text-muted: rgb(var(--color-muted-light-val));
            --color-border: rgb(var(--color-border-light-val));

            /* Ukuran & Spasi */
            --spacing-1: 0.25rem;
            /* 4px */
            --spacing-2: 0.5rem;
            /* 8px */
            --spacing-3: 0.75rem;
            /* 12px */
            --spacing-4: 1rem;
            /* 16px */
            --spacing-6: 1.5rem;
            /* 24px */
            --spacing-8: 2rem;
            /* 32px */
            --spacing-12: 3rem;
            /* 48px */

            --border-radius-sm: 0.25rem;
            --border-radius-md: 0.375rem;
            --border-radius-lg: 0.5rem;
            --border-radius-xl: 0.75rem;
            --border-radius-full: 9999px;

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);

            --transition-duration: 0.3s;
            --transition-timing: ease-in-out;
        }

        .dark {
            --color-background-dark-val: 15, 23, 42;
            /* #0f172a (slate-900) */
            --color-surface-dark-val: 30, 41, 59;
            /* #1e293b (slate-800) */
            --color-text-dark-val: 226, 232, 240;
            /* #e2e8f0 (slate-200) */
            --color-border-dark-val: 51, 65, 85;
            /* #334155 (slate-700) */
            --color-muted-dark-val: 148, 163, 184;
            /* #94a3b8 (slate-400) */

            --color-background: rgb(var(--color-background-dark-val));
            --color-surface: rgb(var(--color-surface-dark-val));
            --color-text-default: rgb(var(--color-text-dark-val));
            --color-text-muted: rgb(var(--color-muted-dark-val));
            --color-border: rgb(var(--color-border-dark-val));
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            -moz-tab-size: 4;
            tab-size: 4;
            font-family: var(--font-sans);
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--color-background);
            color: var(--color-text-default);
            transition: background-color var(--transition-duration) var(--transition-timing), color var(--transition-duration) var(--transition-timing);
            display: flex;
            /* untuk layout sticky footer */
            flex-direction: column;
            /* untuk layout sticky footer */
            min-height: 100vh;
            /* untuk layout sticky footer */
        }

        #app-root {
            flex-grow: 1;
            /* untuk layout sticky footer */
            display: flex;
            flex-direction: column;
        }

        /* === 1. Utilitas CSS (Pengganti kelas Tailwind) === */
        .hidden {
            display: none !important;
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Flex & Grid */
        .flex {
            display: flex;
        }

        .inline-flex {
            display: inline-flex;
        }

        .grid {
            display: grid;
        }

        .items-center {
            align-items: center;
        }

        .items-start {
            align-items: flex-start;
        }

        .items-end {
            align-items: flex-end;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .flex-col {
            flex-direction: column;
        }

        .flex-grow {
            flex-grow: 1;
        }

        .flex-shrink-0 {
            flex-shrink: 0;
        }

        .space-x-1> :not([hidden])~ :not([hidden]) {
            margin-left: var(--spacing-1);
        }

        .space-x-2> :not([hidden])~ :not([hidden]) {
            margin-left: var(--spacing-2);
        }

        .space-x-3> :not([hidden])~ :not([hidden]) {
            margin-left: var(--spacing-3);
        }

        .space-x-4> :not([hidden])~ :not([hidden]) {
            margin-left: var(--spacing-4);
        }

        .space-y-2> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-2);
        }

        .space-y-3> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-3);
        }

        .space-y-4> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-4);
        }

        .space-y-6> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-6);
        }

        .space-y-8> :not([hidden])~ :not([hidden]) {
            margin-top: var(--spacing-8);
        }

        .gap-4 {
            gap: var(--spacing-4);
        }

        .gap-6 {
            gap: var(--spacing-6);
        }

        /* Padding & Margin */
        .p-1 {
            padding: var(--spacing-1);
        }

        .p-2 {
            padding: var(--spacing-2);
        }

        .p-3 {
            padding: var(--spacing-3);
        }

        .p-4 {
            padding: var(--spacing-4);
        }

        .p-6 {
            padding: var(--spacing-6);
        }

        .py-1 {
            padding-top: var(--spacing-1);
            padding-bottom: var(--spacing-1);
        }

        .py-2 {
            padding-top: var(--spacing-2);
            padding-bottom: var(--spacing-2);
        }

        .py-3 {
            padding-top: var(--spacing-3);
            padding-bottom: var(--spacing-3);
        }

        .py-4 {
            padding-top: var(--spacing-4);
            padding-bottom: var(--spacing-4);
        }

        .py-8 {
            padding-top: var(--spacing-8);
            padding-bottom: var(--spacing-8);
        }

        .py-12 {
            padding-top: var(--spacing-12);
            padding-bottom: var(--spacing-12);
        }

        .px-2 {
            padding-left: var(--spacing-2);
            padding-right: var(--spacing-2);
        }

        .px-3 {
            padding-left: var(--spacing-3);
            padding-right: var(--spacing-3);
        }

        .px-4 {
            padding-left: var(--spacing-4);
            padding-right: var(--spacing-4);
        }

        .px-6 {
            padding-left: var(--spacing-6);
            padding-right: var(--spacing-6);
        }

        .pt-4 {
            padding-top: var(--spacing-4);
        }

        .mb-1 {
            margin-bottom: var(--spacing-1);
        }

        .mb-2 {
            margin-bottom: var(--spacing-2);
        }

        .mb-3 {
            margin-bottom: var(--spacing-3);
        }

        .mb-4 {
            margin-bottom: var(--spacing-4);
        }

        .mb-6 {
            margin-bottom: var(--spacing-6);
        }

        .mb-8 {
            margin-bottom: var(--spacing-8);
        }

        .mt-1 {
            margin-top: var(--spacing-1);
        }

        .mt-2 {
            margin-top: var(--spacing-2);
        }

        .mt-4 {
            margin-top: var(--spacing-4);
        }

        .mt-auto {
            margin-top: auto;
        }

        .mr-1 {
            margin-right: var(--spacing-1);
        }

        .mr-2 {
            margin-right: var(--spacing-2);
        }

        .mr-3 {
            margin-right: var(--spacing-3);
        }

        .ml-2 {
            margin-left: var(--spacing-2);
        }

        .ml-auto {
            margin-left: auto;
        }

        .mx-auto {
            margin-left: auto;
            margin-right: auto;
        }

        /* Text */
        .text-xs {
            font-size: 0.75rem;
            line-height: 1rem;
        }

        .text-sm {
            font-size: 0.875rem;
            line-height: 1.25rem;
        }

        .text-base {
            font-size: 1rem;
            line-height: 1.5rem;
        }

        .text-lg {
            font-size: 1.125rem;
            line-height: 1.75rem;
        }

        .text-xl {
            font-size: 1.25rem;
            line-height: 1.75rem;
        }

        .text-2xl {
            font-size: 1.5rem;
            line-height: 2rem;
        }

        .text-3xl {
            font-size: 1.875rem;
            line-height: 2.25rem;
        }

        .text-4xl {
            font-size: 2.25rem;
            line-height: 2.5rem;
        }

        .text-5xl {
            font-size: 3rem;
            line-height: 1;
        }

        .font-normal {
            font-weight: 400;
        }

        .font-medium {
            font-weight: 500;
        }

        .font-semibold {
            font-weight: 600;
        }

        .font-bold {
            font-weight: 700;
        }

        .font-extrabold {
            font-weight: 800;
        }

        .uppercase {
            text-transform: uppercase;
        }

        .text-center {
            text-align: center;
        }

        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .line-clamp-3 {
            overflow: hidden;
            display: -webkit-box;
            -webkit-box-orient: vertical;

        }

        /* Colors */
        .text-white {
            color: #fff;
        }

        .text-primary {
            color: var(--color-primary-default);
        }

        .dark .text-primary-light {
            color: var(--color-primary-light);
        }

        .text-secondary {
            color: var(--color-secondary-default);
        }

        .dark .text-secondary-light {
            color: var(--color-secondary-light);
        }

        .text-slate-300 {
            color: #cbd5e1;
        }

        .dark .text-slate-300 {
            color: #cbd5e1;
        }

        /* consistent */
        .text-slate-400 {
            color: #94a3b8;
        }

        .dark .text-slate-400 {
            color: #94a3b8;
        }

        /* consistent */
        .text-slate-500 {
            color: var(--color-muted-light-val);
        }

        .dark .text-slate-500 {
            color: var(--color-muted-dark-val);
        }

        .text-slate-600 {
            color: #475569;
        }

        .dark .text-slate-600 {
            color: #475569;
        }

        /* consistent */
        .text-slate-700 {
            color: #334155;
        }

        .dark .text-slate-700 {
            color: #334155;
        }

        /* consistent */

        .bg-transparent {
            background-color: transparent;
        }

        .bg-primary {
            background-color: var(--color-primary-default);
        }

        .dark .bg-primary-light {
            background-color: var(--color-primary-light);
        }

        .bg-secondary {
            background-color: var(--color-secondary-default);
        }

        .bg-surface-light {
            background-color: var(--color-surface);
        }

        .dark .bg-surface-dark {
            background-color: var(--color-surface);
        }

        .bg-slate-50 {
            background-color: #f8fafc;
        }

        .dark .bg-slate-700\/50 {
            background-color: rgba(51, 65, 85, 0.5);
        }

        /* slate-700 with opacity */
        .dark .bg-slate-700\/30 {
            background-color: rgba(51, 65, 85, 0.3);
        }

        .bg-black\/50 {
            background-color: rgba(0, 0, 0, 0.5);
        }

        .bg-green-500 {
            background-color: #22c55e;
        }

        .bg-yellow-500 {
            background-color: #eab308;
        }

        .bg-blue-500 {
            background-color: #3b82f6;
        }

        .bg-red-500 {
            background-color: #ef4444;
        }

        .hover\:bg-primary-dark:hover {
            background-color: var(--color-primary-dark);
        }

        .hover\:bg-secondary-dark:hover {
            background-color: var(--color-secondary-dark);
        }

        .hover\:bg-primary\/10:hover {
            background-color: rgba(var(--color-primary-default-val), 0.1);
        }

        .hover\:bg-slate-100:hover {
            background-color: #f1f5f9;
        }

        .dark .hover\:bg-slate-700:hover {
            background-color: #334155;
        }

        .hover\:bg-red-600:hover {
            background-color: #dc2626;
        }

        /* Borders */
        .border {
            border-width: 1px;
            border-style: solid;
            border-color: var(--color-border);
        }

        .border-t {
            border-top-width: 1px;
            border-style: solid;
            border-color: var(--color-border);
        }

        .border-l-4 {
            border-left-width: 4px;
            border-style: solid;
        }

        .border-blue-500 {
            border-color: #3b82f6 !important;
        }

        .border-green-500 {
            border-color: #22c55e !important;
        }

        .border-yellow-500 {
            border-color: #eab308 !important;
        }

        .border-red-500 {
            border-color: #ef4444 !important;
        }

        .rounded-sm {
            border-radius: var(--border-radius-sm);
        }

        .rounded-md {
            border-radius: var(--border-radius-md);
        }

        .rounded-lg {
            border-radius: var(--border-radius-lg);
        }

        .rounded-xl {
            border-radius: var(--border-radius-xl);
        }

        .rounded-full {
            border-radius: var(--border-radius-full);
        }

        .rounded-t-lg {
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
        }

        .rounded-r-md {
            border-top-right-radius: var(--border-radius-md);
            border-bottom-right-radius: var(--border-radius-md);
        }

        .rounded-t {
            border-top-left-radius: var(--border-radius-md);
            border-top-right-radius: var(--border-radius-md);
        }

        /* Sizing */
        .w-full {
            width: 100%;
        }

        .w-2 {
            width: var(--spacing-2);
        }

        .h-2 {
            height: var(--spacing-2);
        }

        .w-4 {
            width: var(--spacing-4);
        }

        .h-4 {
            height: var(--spacing-4);
        }

        .w-5 {
            width: calc(var(--spacing-4) * 1.25);
        }

        /* 20px */
        .h-5 {
            height: calc(var(--spacing-4) * 1.25);
        }

        .w-6 {
            width: var(--spacing-6);
        }

        .h-6 {
            height: var(--spacing-6);
        }

        .w-8 {
            width: var(--spacing-8);
        }

        .h-8 {
            height: var(--spacing-8);
        }

        .w-12 {
            width: var(--spacing-12);
        }

        .h-12 {
            height: var(--spacing-12);
        }

        .h-16 {
            height: calc(var(--spacing-4) * 4);
        }

        /* 64px */
        .h-40 {
            height: calc(var(--spacing-4) * 10);
        }

        /* 160px */
        .h-48 {
            height: calc(var(--spacing-4) * 12);
        }

        /* 192px */
        .h-64 {
            height: calc(var(--spacing-4) * 16);
        }

        /* 256px */
        .min-h-screen {
            min-height: 100vh;
        }

        /* Effects */
        .shadow-sm {
            box-shadow: var(--shadow-sm);
        }

        .shadow-md {
            box-shadow: var(--shadow-md);
        }

        .shadow-lg {
            box-shadow: var(--shadow-lg);
        }

        .shadow-xl {
            box-shadow: var(--shadow-xl);
        }

        .shadow-2xl {
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }

        .shadow-inner {
            box-shadow: var(--shadow-inner);
        }

        .opacity-70 {
            opacity: 0.7;
        }

        .overflow-hidden {
            overflow: hidden;
        }

        .overflow-x-auto {
            overflow-x: auto;
        }

        .object-cover {
            object-fit: cover;
        }

        .cursor-pointer {
            cursor: pointer;
        }

        .backdrop-blur-sm {
            backdrop-filter: blur(4px);
        }

        /* Perlu prefix vendor jika diperlukan */
        .backdrop-blur-md {
            backdrop-filter: blur(12px);
        }

        /* Transitions & Animations */
        .transition-all {
            transition-property: all;
            transition-duration: var(--transition-duration);
            transition-timing-function: var(--transition-timing);
        }

        .transition-colors {
            transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
            transition-timing-function: var(--transition-timing);
            transition-duration: var(--transition-duration);
        }

        .transition-shadow {
            transition-property: box-shadow;
            transition-timing-function: var(--transition-timing);
            transition-duration: var(--transition-duration);
        }

        .transition-transform {
            transition-property: transform;
            transition-timing-function: var(--transition-timing);
            transition-duration: var(--transition-duration);
        }

        .duration-200 {
            transition-duration: 0.2s;
        }

        .duration-300 {
            transition-duration: 0.3s;
        }

        .duration-500 {
            transition-duration: 0.5s;
        }

        .ease-in-out {
            transition-timing-function: ease-in-out;
        }

        .ease-out {
            transition-timing-function: ease-out;
        }

        .transform {
            /* diperlukan untuk beberapa properti transform */
        }

        .hover\:scale-105:hover {
            transform: scale(1.05);
        }

        .hover\:scale-110:hover {
            transform: scale(1.10);
        }

        .active\:scale-95:active {
            transform: scale(0.95);
        }

        /* Positioning */
        .sticky {
            position: sticky;
        }

        .fixed {
            position: fixed;
        }

        .absolute {
            position: absolute;
        }

        .relative {
            position: relative;
        }

        .top-0 {
            top: 0;
        }

        .top-2 {
            top: var(--spacing-2);
        }

        .right-2 {
            right: var(--spacing-2);
        }

        .inset-0 {
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .z-40 {
            z-index: 40;
        }

        .z-50 {
            z-index: 50;
        }

        /* Layout Specific */
        .container {
            width: 100%;
            margin-left: auto;
            margin-right: auto;
            padding-left: var(--spacing-4);
            padding-right: var(--spacing-4);
        }

        @media (min-width: 640px) {

            /* sm */
            .container {
                max-width: 640px;
                padding-left: var(--spacing-6);
                padding-right: var(--spacing-6);
            }

            .sm\:grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .sm\:inline {
                display: inline;
            }

            .sm\:text-5xl {
                font-size: 3rem;
                line-height: 1;
            }
        }

        @media (min-width: 768px) {

            /* md */
            .container {
                max-width: 768px;
            }

            .md\:grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .md\:grid-cols-3 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (min-width: 1024px) {

            /* lg */
            .container {
                max-width: 1024px;
                padding-left: var(--spacing-8);
                padding-right: var(--spacing-8);
            }

            .lg\:grid-cols-3 {
                grid-template-columns: repeat(3, minmax(0, 1fr));
            }
        }

        @media (min-width: 1280px) {

            /* xl */
            .container {
                max-width: 1280px;
            }
        }

        /* Focus States */
        .focus\:outline-none:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
        }

        .focus\:ring-2:focus {
            --ring-offset-shadow: var(--tw-ring-offset-width, 0px) 0 0 0 var(--tw-ring-offset-color, transparent);
            --ring-shadow: 0 0 0 calc(2px + var(--tw-ring-offset-width, 0px)) var(--tw-ring-color, transparent);
            box-shadow: var(--ring-offset-shadow), var(--ring-shadow), var(--shadow-md, 0 0 #0000) !important;
            /* Ensure ring is visible */
        }

        .focus\:ring-opacity-75:focus {
            --tw-ring-opacity: 0.75;
        }

        .focus\:ring-primary:focus {
            --tw-ring-color: var(--color-primary-default);
        }

        .focus\:ring-secondary:focus {
            --tw-ring-color: var(--color-secondary-default);
        }

        .focus\:ring-red-500:focus {
            --tw-ring-color: #ef4444;
        }

        .focus\:border-primary:focus {
            border-color: var(--color-primary-default);
        }


        /* === 2. Animasi & Spinner === */
        @keyframes fadeIn {
            0% {
                opacity: '0'
            }

            100% {
                opacity: '1'
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes slideUp {
            0% {
                transform: 'translateY(20px)';
                opacity: '0';
            }

            100% {
                transform: 'translateY(0)';
                opacity: '1';
            }
        }

        .animate-slide-up {
            animation: slideUp 0.5s ease-out;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Gaya Spinner (khusus) */
        .spinner-ring {
            border-radius: 50%;
            border-style: solid;
            border-top-color: transparent !important;
            /* Membuat efek berputar */
        }

        .spinner-sm {
            width: var(--spacing-4);
            height: var(--spacing-4);
            border-width: 2px;
        }

        .spinner-md {
            width: var(--spacing-8);
            height: var(--spacing-8);
            border-width: 4px;
        }

        .spinner-lg {
            width: var(--spacing-12);
            height: var(--spacing-12);
            border-width: 6px;
        }


        /* === 3. Komponen Spesifik (jika diperlukan gaya tambahan di luar utilitas) === */
        /* Tombol */
        .button-base {
            font-weight: 600;
            /* semibold */
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            outline: none;
            /* focus dihandle dengan ring */
            transition-property: all;
            transition-duration: 0.3s;
            /* lebih spesifik dari var(--transition-duration) jika perlu */
            transition-timing-function: ease-in-out;
            display: inline-flex;
            /* untuk ikon */
            align-items: center;
            justify-content: center;
            cursor: pointer;
            text-decoration: none;
        }

        .button-base:hover {
            transform: scale(1.05);
        }

        .button-base:active {
            transform: scale(0.95);
        }

        .button-base:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            /* Nonaktifkan hover/active transform */
        }

        .button-sz-sm {
            padding: var(--spacing-1) var(--spacing-3);
            font-size: var(--text-sm);
        }

        /* py-1.5 diganti */
        .button-sz-md {
            padding: var(--spacing-2) var(--spacing-4);
            font-size: var(--text-base);
        }

        .button-sz-lg {
            padding: var(--spacing-3) var(--spacing-6);
            font-size: var(--text-lg);
        }

        .button-primary {
            background-color: var(--color-primary-default);
            color: white;
        }

        .button-primary:hover:not(:disabled) {
            background-color: var(--color-primary-dark);
        }

        .button-primary.focus\:ring-primary:focus {
            --tw-ring-color: var(--color-primary-default);
        }

        .button-secondary {
            background-color: var(--color-secondary-default);
            color: white;
        }

        .button-secondary:hover:not(:disabled) {
            background-color: var(--color-secondary-dark);
        }

        .button-secondary.focus\:ring-secondary:focus {
            --tw-ring-color: var(--color-secondary-default);
        }

        .button-ghost {
            background-color: transparent;
            color: var(--color-primary-default);
            box-shadow: none !important;
        }

        .button-ghost:hover:not(:disabled) {
            background-color: rgba(var(--color-primary-default-val), 0.1);
        }

        .button-ghost.focus\:ring-primary:focus {
            --tw-ring-color: var(--color-primary-default);
        }

        .button-danger {
            background-color: #ef4444;
            color: white;
        }

        /* red-500 */
        .button-danger:hover:not(:disabled) {
            background-color: #dc2626;
        }

        /* red-600 */
        .button-danger.focus\:ring-red-500:focus {
            --tw-ring-color: #ef4444;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            z-index: 50;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            /* sm */
        }

        .modal-content {
            background-color: var(--color-surface);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-2xl);
            /* Lebih besar dari shadow-xl */
            padding: var(--spacing-6);
            width: 100%;
            margin: var(--spacing-4);
            transform: translateY(0);
            /* Awal untuk animasi slideUp */
            transition: transform var(--transition-duration) ease-out, opacity var(--transition-duration) ease-out;
        }

        .modal-content.size-sm {
            max-width: 24rem;
        }

        /* 384px, dikurangi dari Tailwind sm (30rem) */
        .modal-content.size-md {
            max-width: 28rem;
        }

        /* 448px, dikurangi dari Tailwind md (32rem) */
        .modal-content.size-lg {
            max-width: 32rem;
        }

        /* 512px, dikurangi dari Tailwind lg (36rem) */
        .modal-content.size-xl {
            max-width: 36rem;
        }

        /* 576px, dikurangi dari Tailwind xl (42rem) */

        /* Header & Footer */
        .app-header {
            background-color: rgba(var(--color-surface-light-val), 0.8);
            /* Transparansi manual */
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            z-index: 40;
            backdrop-filter: blur(12px);
            /* md */
        }

        .dark .app-header {
            background-color: rgba(var(--color-surface-dark-val), 0.8);
        }

        .app-footer {
            background-color: var(--color-surface);
            border-top: 1px solid var(--color-border);
            margin-top: auto;
            /* Mendorong footer ke bawah */
            padding: var(--spacing-8) 0;
            text-align: center;
        }

        /* Input Forms */
        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--spacing-2) var(--spacing-3);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            background-color: transparent;
            /* Agar theme background terlihat */
            color: var(--color-text-default);
            transition: border-color var(--transition-duration) var(--transition-timing), box-shadow var(--transition-duration) var(--transition-timing);
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--color-primary-default);
            --tw-ring-color: var(--color-primary-default);
            /* Untuk box-shadow focus */
            box-shadow: 0 0 0 1px var(--tw-ring-color);
        }

        .form-label {
            display: block;
            font-size: var(--text-sm);
            font-weight: 500;
            /* medium */
            color: var(--color-text-muted);
            /* Lebih lembut */
            margin-bottom: var(--spacing-1);
        }

        .dark .form-label {
            color: var(--color-text-muted);
        }

        /* Kartu Properti */
        .property-card {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: var(--color-surface);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }

        .property-card.clickable {
            cursor: pointer;
            transition: box-shadow var(--transition-duration) var(--transition-timing);
        }

        .property-card.clickable:hover {
            box-shadow: var(--shadow-xl);
        }

        .property-card-image-container {
            position: relative;
            height: 12rem;
            /* h-48 */
            width: 100%;
            overflow: hidden;
            border-top-left-radius: var(--border-radius-xl);
            /* Sesuaikan dengan card */
            border-top-right-radius: var(--border-radius-xl);
        }

        .property-card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease-in-out;
        }

        .property-card:hover .property-card-image {
            transform: scale(1.10);
        }

        .property-card-status-badge {
            position: absolute;
            top: var(--spacing-2);
            right: var(--spacing-2);
            padding: var(--spacing-1) var(--spacing-2);
            font-size: var(--text-xs);
            font-weight: 600;
            /* semibold */
            border-radius: var(--border-radius-md);
            color: white;
        }

        .property-card-status-badge.available {
            background-color: #22c55e;
        }

        /* green-500 */
        .property-card-status-badge.rented {
            background-color: #eab308;
        }

        /* yellow-500 */
        .property-card-content {
            padding: var(--spacing-4);
            /* p-4, bukan p-6 */
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }

        .property-card-description {
            flex-grow: 1;
            /* Agar tombol tetap di bawah */
        }

        /* Chart sederhana */
        .simple-chart-bar {
            transition: height 0.3s ease-in-out;
        }

        .simple-chart-bar:hover {
            opacity: 0.8;
        }
    </style>
</head>

<body class="/* Kelas tema akan ditambahkan oleh JS */">
    <div id="app-root">
        <!-- Konten aplikasi akan dirender di sini oleh JavaScript -->
        <!-- Ini adalah "Monolith" dimana semua HTML, CSS, JS ada di satu file. -->
        <!-- Namun, struktur internal JS akan mengikuti pola SPA dan Komponen. -->
    </div>

    <script type="module">
        // === PENJELASAN ARSITEKTUR ===
        // Aplikasi "Green Valley Rentals" ini adalah sebuah Single Page Application (SPA)
        // yang dibangun secara monolith (semua kode dalam satu file HTML).
        // Meskipun monolith, arsitektur internalnya mengikuti prinsip-prinsip modern:
        // 1. HTML5 Semantik: Penggunaan tag HTML yang tepat untuk struktur dan makna.
        // 2. JavaScript Vanilla Native: Tidak ada framework atau library eksternal (seperti React, Vue, Angular, jQuery).
        //    Semua manipulasi DOM, routing, dan state management dilakukan dengan JavaScript murni.
        // 3. CSS Kustom: Styling dilakukan dengan CSS vanilla, termasuk variabel CSS untuk tema (terang/gelap)
        //    dan kelas utilitas yang terinspirasi dari Tailwind CSS untuk kemudahan styling.
        // 4. Arsitektur Berbasis Komponen (Native Single File Component - SFC style):
        //    - Fungsi JavaScript (misalnya, `ButtonComponent`, `CardComponent`) bertindak sebagai "komponen".
        //    - Setiap fungsi komponen bertanggung jawab untuk membuat dan mengembalikan sebuah elemen DOM atau
        //      sekumpulan elemen yang merepresentasikan bagian dari UI.
        //    - Komponen ini reusable dan dapat disusun untuk membangun UI yang kompleks.
        // 5. State Management Sederhana:
        //    - Sebuah objek global `appState` menyimpan data aplikasi (halaman aktif, data properti, notifikasi, status modal).
        //    - Perubahan pada `appState` akan memicu pembaruan UI melalui fungsi `renderApp()`.
        // 6. Routing Sisi Klien (Client-Side Routing):
        //    - Menggunakan URL hash (`#`) untuk navigasi antar "halaman" tanpa reload penuh.
        //    - `window.addEventListener('hashchange', ...)` mendeteksi perubahan hash dan memperbarui konten.
        // 7. Render Dinamis:
        //    - Fungsi `renderApp()` bertanggung jawab untuk membersihkan konten lama (jika perlu) dan
        //      merender ulang bagian UI yang relevan berdasarkan state saat ini.
        // 8. Utilitas dan Layanan:
        //    - Fungsi utilitas (misalnya, `createSVGElement`, `timeAgo`) untuk tugas-tugas umum.
        //    - Layanan (misalnya, `GeminiService`) untuk interaksi dengan API eksternal (jika ada).
        // 9. Prinsip Desain:
        //    - Bersih, modular, dan mudah dipahami.
        //    - Responsif (Mobile-first approach dipertimbangkan dalam CSS).
        //    - Interaktif dan memanjakan pengguna dengan transisi dan feedback visual.
        //    - Tema terang dan gelap yang dapat diganti oleh pengguna.
        //
        // Alur Kerja Umum:
        // 1. Inisialisasi: Saat halaman dimuat, tema diterapkan, dan router menangani hash URL awal.
        // 2. Navigasi: Pengguna mengklik link navigasi. URL hash berubah.
        // 3. Routing: Event `hashchange` terpicu. `appState.currentPage` diperbarui.
        // 4. Render: `renderApp()` dipanggil. Fungsi ini:
        //    a. Membersihkan area konten utama.
        //    b. Memanggil fungsi komponen halaman yang sesuai (misalnya, `HomePageComponent`).
        //    c. Komponen halaman, pada gilirannya, memanggil komponen UI lainnya untuk membangun struktur DOM.
        //    d. Elemen DOM yang dihasilkan ditambahkan ke `app-root`.
        // 5. Interaksi: Pengguna berinteraksi dengan UI (misalnya, membuka modal, mengisi form).
        //    a. Event listener menangani aksi pengguna.
        //    b. `appState` mungkin diperbarui.
        //    c. `renderApp()` dipanggil lagi untuk merefleksikan perubahan state di UI.
        // ==============================

        // --- 0. Inisialisasi API Key & Polyfill Sederhana (jika diperlukan) ---
        // Polyfill sederhana untuk process.env jika tidak ada (untuk konsistensi dengan kode asli)
        if (typeof globalThis.process === 'undefined') {
            globalThis.process = { env: {} };
        }
        // Kunci API Gemini akan diambil dari variabel environment atau placeholder.
        // GANTI DENGAN KUNCI API ANDA JIKA INGIN MENGGUNAKAN FITUR AI.
        const GEMINI_API_KEY_PLACEHOLDER = "MASUKKAN_KUNCI_API_GEMINI_ANDA_DI_SINI";
        let geminiApiKey = globalThis.process.env.API_KEY || GEMINI_API_KEY_PLACEHOLDER;

        if (geminiApiKey === GEMINI_API_KEY_PLACEHOLDER) {
            console.warn("PERINGATAN: Kunci API Gemini tidak dikonfigurasi. Fitur AI tidak akan berfungsi. Silakan ganti placeholder di kode atau set variabel environment API_KEY.");
        }

        const GEMINI_MODEL_NAME = 'gemini-1.5-flash-latest'; // Model yang lebih umum dan mungkin lebih mudah diakses

        // --- 1. Konstanta & Utilitas Global ---
        const APP_NAME = "Green Valley Rentals";

        /**
         * Membuat elemen SVG dari string.
         * @param {string} svgString - String yang berisi markup SVG.
         * @returns {SVGElement | null} Elemen SVG atau null jika gagal.
         */
        const createSVGElement = (svgString) => {
            const template = document.createElement('template');
            template.innerHTML = svgString.trim();
            return template.content.firstChild;
        };

        // Definisi Ikon SVG (tetap sebagai string untuk portabilitas)
        const SunIcon = (className = "w-6 h-6") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-6.364-.386 1.591-1.591M3 12h2.25m.386-6.364 1.591 1.591" /></svg>`);
        const MoonIcon = (className = "w-6 h-6") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" /></svg>`);
        const HomeIcon = (className = "w-5 h-5") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" /></svg>`);
        const DashboardIcon = (className = "w-5 h-5") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 8.25 20.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25A2.25 2.25 0 0 1 13.5 8.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25h-2.25a2.25 2.25 0 0 1-2.25-2.25v-2.25Z" /></svg>`);
        const BellIcon = (className = "w-5 h-5") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0" /></svg>`);
        const PlusIcon = (className = "w-5 h-5") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>`);
        const SparklesIcon = (className = "w-4 h-4") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L1.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L24 5.25l-.813 2.846a4.5 4.5 0 0 0-3.09 3.09L18.25 12ZM12 15.75l-2.846.813a4.5 4.5 0 0 0-3.09 3.09L5.25 21l.813-2.846a4.5 4.5 0 0 0 3.09-3.09L12 15.75Z" /></svg>`);
        const CloseIcon = (className = "w-6 h-6") => createSVGElement(`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="${className}"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" /></svg>`);

        /**
         * Menghitung waktu relatif dari string tanggal.
         * @param {string} dateString - String tanggal ISO.
         * @returns {string} String waktu relatif (misal: "5 menit lalu").
         */
        const timeAgo = (dateString) => {
            const date = new Date(dateString);
            const seconds = Math.floor((new Date().getTime() - date.getTime()) / 1000);
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " tahun lalu";
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " bulan lalu";
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " hari lalu";
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " jam lalu";
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " menit lalu";
            return Math.floor(seconds) + " detik lalu";
        };

        // --- 2. Mock Data (Data Contoh) ---
        const mockProperties = [
            { id: '1', name: 'Apartemen Indah Pemandangan Lembah', address: '123 Jl. Pinus Hijau, Green Valley', type: 'Apartemen', bedrooms: 2, bathrooms: 2, rentPrice: 1500, imageUrl: 'https://picsum.photos/seed/gvh1/600/400', description: 'Apartemen indah dan tenang dengan pemandangan menakjubkan Lembah Hijau. Fasilitas modern dan kamar yang luas.', status: 'Tersedia', ownerId: 'owner1' },
            { id: '2', name: 'Rumah Keluarga Nyaman dengan Taman', address: '456 Jl. Ek, Green Valley', type: 'Rumah', bedrooms: 3, bathrooms: 2.5, rentPrice: 2200, imageUrl: 'https://picsum.photos/seed/gvh2/600/400', description: 'Rumah keluarga sempurna dengan taman yang rimbun, dekat sekolah dan taman. Dapur baru direnovasi.', status: 'Disewa', ownerId: 'owner1' },
            { id: '3', name: 'Kondominium Modern di Pusat Kota', address: '789 Jl. Pusat, Green Valley', type: 'Kondominium', bedrooms: 1, bathrooms: 1, rentPrice: 1200, imageUrl: 'https://picsum.photos/seed/gvh3/600/400', description: 'Kondominium bergaya di jantung pusat kota. Dekat dengan pertokoan, restoran, dan transportasi umum.', status: 'Tersedia', ownerId: 'owner2' },
            { id: '4', name: 'Villa Luas di Pinggiran Kota', address: '101 Jl. Pinggir Sungai, Green Valley', type: 'Rumah', bedrooms: 4, bathrooms: 3, rentPrice: 3000, imageUrl: 'https://picsum.photos/seed/gvh4/600/400', description: 'Villa besar dengan ruang yang cukup untuk keluarga besar, dilengkapi kolam renang pribadi dan garasi tiga mobil.', status: 'Tersedia', ownerId: 'owner1' },
        ];
        const mockNotifications = [
            { id: 'n1', message: 'Permintaan baru untuk "Apartemen Indah Pemandangan Lembah".', timestamp: '2024-07-28T10:30:00Z', read: false, type: 'info' },
            { id: 'n2', message: 'Pembayaran sewa $2200 diterima untuk "Rumah Keluarga Nyaman dengan Taman".', timestamp: '2024-07-27T15:45:00Z', read: true, type: 'success' },
            { id: 'n3', message: 'Permintaan pemeliharaan untuk "Kondominium Modern di Pusat Kota": Keran bocor.', timestamp: '2024-07-26T09:15:00Z', read: false, type: 'warning' },
        ];
        const mockIncomeData = [
            { month: 'Jan', amount: 2200 }, { month: 'Feb', amount: 1500 }, { month: 'Mar', amount: 3000 },
            { month: 'Apr', amount: 2000 }, { month: 'Mei', amount: 2780 }, { month: 'Jun', amount: 1890 },
            { month: 'Jul', amount: 3300 },
        ];

        // --- 3. Manajemen Tema ---
        const Theme = { LIGHT: 'light', DARK: 'dark' };
        let currentTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? Theme.DARK : Theme.LIGHT);

        /**
         * Menerapkan tema ke elemen root HTML dan menyimpan preferensi.
         * @param {string} theme - Tema yang akan diterapkan ('light' atau 'dark').
         */
        function applyTheme(theme) {
            document.documentElement.classList.remove(Theme.LIGHT, Theme.DARK);
            document.documentElement.classList.add(theme);
            document.body.className = ''; // Reset kelas body
            document.body.classList.add(`bg-background`, `text-text-default`); // Terapkan kelas dasar dari variabel CSS
            localStorage.setItem('theme', theme);
            currentTheme = theme;
        }

        /**
         * Mengganti tema saat ini dan memperbarui UI.
         */
        function toggleThemeAndUpdateUI() {
            const newTheme = currentTheme === Theme.LIGHT ? Theme.DARK : Theme.LIGHT;
            applyTheme(newTheme);
            renderApp(); // Render ulang untuk memperbarui ikon/gaya yang bergantung pada tema
        }

        // --- 4. Layanan Gemini AI (Disederhanakan) ---
        /**
         * Menghasilkan deskripsi properti menggunakan Gemini API (jika tersedia).
         * @param {object} propertyDetails - Detail properti (type, bedrooms, bathrooms).
         * @returns {Promise<string>} Deskripsi yang dihasilkan atau pesan kesalahan.
         */
        async function generatePropertyDescriptionWithGemini(propertyDetails) {
            if (geminiApiKey === GEMINI_API_KEY_PLACEHOLDER || !geminiApiKey) {
                return "Layanan AI tidak tersedia. Harap periksa konfigurasi Kunci API.";
            }

            const prompt = `Buat deskripsi properti real estat yang menarik dan persuasif untuk properti berikut. Soroti fitur utamanya dan tarik calon penyewa. Buatlah ringkas, sekitar 2-3 kalimat.
            Jenis Properti: ${propertyDetails.type || 'N/A'}
            Lokasi: Green Valley
            Kamar Tidur: ${propertyDetails.bedrooms || 'N/A'}
            Kamar Mandi: ${propertyDetails.bathrooms || 'N/A'}
            Nada yang Diinginkan: Profesional, mengundang, dan sedikit antusias.
            Contoh: "Temukan rumah baru Anda di Green Valley! ${propertyDetails.type || ''} menakjubkan ini memiliki ${propertyDetails.bedrooms || ''} kamar tidur, ${propertyDetails.bathrooms || ''} kamar mandi, dan desain modern yang indah. Sempurna bagi mereka yang mencari kenyamanan dan gaya."`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL_NAME}:generateContent?key=${geminiApiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        // Opsi safety settings & generationConfig bisa ditambahkan di sini jika perlu
                        // "safetySettings": [
                        //     { "category": "HARM_CATEGORY_HARASSMENT", "threshold": "BLOCK_NONE" },
                        //     { "category": "HARM_CATEGORY_HATE_SPEECH", "threshold": "BLOCK_NONE" },
                        //     { "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT", "threshold": "BLOCK_NONE" },
                        //     { "category": "HARM_CATEGORY_DANGEROUS_CONTENT", "threshold": "BLOCK_NONE" }
                        // ],
                        // "generationConfig": { "temperature": 0.7, "maxOutputTokens": 250 }
                    })
                });
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error("Error dari Gemini API:", errorData);
                    throw new Error(`Gemini API error: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
                }
                const data = await response.json();
                return data.candidates[0]?.content.parts[0]?.text || "Tidak ada deskripsi yang dihasilkan.";
            } catch (error) {
                console.error("Gagal menghasilkan deskripsi properti dengan Gemini:", error);
                return "Gagal menghasilkan deskripsi. Silakan coba lagi atau tulis secara manual.";
            }
        }

        // --- 5. State Aplikasi Global ---
        const appState = {
            currentPage: 'home', // Halaman default
            properties: JSON.parse(JSON.stringify(mockProperties)), // Salinan data untuk mutasi
            notifications: JSON.parse(JSON.stringify(mockNotifications)),
            selectedPropertyModal: { isOpen: false, propertyId: null },
            propertyFormModal: { isOpen: false, propertyToEditId: null, isGeneratingDesc: false },
            isLoading: false, // State untuk loading global (opsional)
        };

        /**
         * Memperbarui atau menambah properti di state global dan data mock (untuk persistensi demo).
         * @param {object} updatedProperty - Objek properti yang diperbarui atau baru.
         */
        function updateGlobalProperty(updatedProperty) {
            const index = appState.properties.findIndex(p => p.id === updatedProperty.id);
            if (index > -1) {
                appState.properties[index] = updatedProperty;
            } else {
                appState.properties.push(updatedProperty);
            }
            // Update juga mockProperties untuk demo ini agar perubahan "persisten" antar "halaman"
            const mockIndex = mockProperties.findIndex(p => p.id === updatedProperty.id);
            if (mockIndex > -1) mockProperties[mockIndex] = updatedProperty;
            else mockProperties.push(updatedProperty);
            renderApp(); // Panggil renderApp setelah state berubah
        }

        /**
         * Menghapus properti dari state global dan data mock.
         * @param {string} propertyId - ID properti yang akan dihapus.
         */
        function deleteGlobalProperty(propertyId) {
            appState.properties = appState.properties.filter(p => p.id !== propertyId);
            const mockIndex = mockProperties.findIndex(p => p.id === propertyId);
            if (mockIndex > -1) mockProperties.splice(mockIndex, 1);
            renderApp(); // Panggil renderApp setelah state berubah
        }

        // --- 6. Fungsi Komponen UI (SFC Native Style) ---

        /**
         * Komponen Tombol (Button).
         * @param {object} props - Properti tombol.
         * @param {string} props.textContent - Teks pada tombol.
         * @param {function} props.onClick - Fungsi callback saat tombol diklik.
         * @param {'primary'|'secondary'|'ghost'|'danger'} [props.variant='primary'] - Varian gaya tombol.
         * @param {'sm'|'md'|'lg'} [props.size='md'] - Ukuran tombol.
         * @param {Node} [props.leftIcon] - Ikon di sisi kiri teks.
         * @param {Node} [props.rightIcon] - Ikon di sisi kanan teks.
         * @param {string} [props.className=''] - Kelas CSS tambahan.
         * @param {'button'|'submit'|'reset'} [props.type='button'] - Tipe atribut tombol.
         * @param {boolean} [props.disabled=false] - Status disabled tombol.
         * @param {string} [props.ariaLabel=''] - Label ARIA untuk aksesibilitas.
         * @returns {HTMLButtonElement} Elemen tombol.
         */
        function ButtonComponent({ textContent, onClick, variant = 'primary', size = 'md', leftIcon, rightIcon, className = '', type = 'button', disabled = false, ariaLabel = '' }) {
            const el = document.createElement('button');
            el.type = type;
            el.disabled = disabled;
            if (ariaLabel) el.setAttribute('aria-label', ariaLabel);

            // Kelas dasar dan spesifik dari CSS
            el.classList.add('button-base', `button-${variant}`, `button-sz-${size}`);
            if (variant === 'primary') el.classList.add('focus:ring-primary');
            else if (variant === 'secondary') el.classList.add('focus:ring-secondary');
            else if (variant === 'ghost') el.classList.add('focus:ring-primary');
            else if (variant === 'danger') el.classList.add('focus:ring-red-500');

            el.classList.add('focus:ring-2', 'focus:ring-opacity-75'); // Tambahkan kelas focus global

            if (className) className.split(' ').forEach(cls => cls && el.classList.add(cls));


            if (leftIcon) {
                const iconSpan = document.createElement('span');
                iconSpan.className = textContent ? 'mr-2' : ''; // Tidak ada margin jika hanya ikon
                iconSpan.appendChild(leftIcon);
                el.appendChild(iconSpan);
            }
            if (textContent) {
                el.appendChild(document.createTextNode(textContent));
            }
            if (rightIcon) {
                const iconSpan = document.createElement('span');
                iconSpan.className = textContent ? 'ml-2' : '';
                iconSpan.appendChild(rightIcon);
                el.appendChild(iconSpan);
            }
            if (onClick) el.addEventListener('click', onClick);
            return el;
        }

        /**
         * Komponen Kartu (Card).
         * @param {object} props - Properti kartu.
         * @param {Node|Node[]|string} props.children - Konten di dalam kartu.
         * @param {string} [props.className=''] - Kelas CSS tambahan.
         * @param {function} [props.onClick] - Fungsi callback saat kartu diklik.
         * @returns {HTMLDivElement} Elemen kartu.
         */
        function CardComponent({ children, className = '', onClick }) {
            const el = document.createElement('div');
            // Kelas dasar dari CSS
            el.classList.add('bg-surface', 'rounded-xl', 'shadow-lg', 'overflow-hidden', 'p-6');
            if (onClick) {
                el.classList.add('cursor-pointer', 'hover:shadow-xl', 'transition-shadow', 'duration-300');
                el.addEventListener('click', onClick);
            }
            if (className) className.split(' ').forEach(cls => cls && el.classList.add(cls));

            if (typeof children === 'string') el.innerHTML = children;
            else if (children instanceof Node) el.appendChild(children);
            else if (Array.isArray(children)) children.forEach(child => child instanceof Node && el.appendChild(child));
            return el;
        }

        /**
         * Komponen Modal.
         * @param {object} props - Properti modal.
         * @param {boolean} props.isOpen - Status apakah modal terbuka.
         * @param {function} props.onClose - Fungsi callback untuk menutup modal.
         * @param {string} [props.title] - Judul modal.
         * @param {Node|Node[]|string} props.children - Konten modal.
         * @param {'sm'|'md'|'lg'|'xl'} [props.size='md'] - Ukuran modal.
         * @returns {HTMLDivElement | null} Elemen modal overlay atau null jika tidak terbuka.
         */
        function ModalComponent({ isOpen, onClose, title, children, size = 'md' }) {
            if (!isOpen) return null;

            const modalOverlay = document.createElement('div');
            modalOverlay.className = 'modal-overlay animate-fade-in';

            // Fungsi untuk menutup modal saat overlay diklik
            const closeOnOverlayClick = (e) => {
                if (e.target === modalOverlay) {
                    onClose();
                }
            };
            modalOverlay.addEventListener('click', closeOnOverlayClick);

            const modalContent = document.createElement('div');
            modalContent.className = `modal-content size-${size} animate-slide-up`;
            modalContent.addEventListener('click', (e) => e.stopPropagation()); // Mencegah penutupan saat klik di dalam modal

            const headerDiv = document.createElement('div');
            headerDiv.className = 'flex justify-between items-center mb-4';
            if (title) {
                const titleEl = document.createElement('h2');
                titleEl.className = 'text-xl font-semibold text-text-default';
                titleEl.textContent = title;
                headerDiv.appendChild(titleEl);
            }
            const closeButton = document.createElement('button');
            closeButton.className = 'text-slate-400 hover:text-slate-600 dark:text-slate-300 dark:hover:text-slate-100 transition-colors p-1 rounded-full -mr-1'; // Penyesuaian agar lebih mudah diklik
            closeButton.setAttribute('aria-label', 'Tutup modal');
            closeButton.appendChild(CloseIcon('w-5 h-5')); // Ukuran ikon disesuaikan
            closeButton.addEventListener('click', onClose);
            headerDiv.appendChild(closeButton);
            modalContent.appendChild(headerDiv);

            const contentDiv = document.createElement('div');
            if (typeof children === 'string') contentDiv.innerHTML = children;
            else if (children instanceof Node) contentDiv.appendChild(children);
            else if (Array.isArray(children)) children.forEach(child => child instanceof Node && contentDiv.appendChild(child));
            modalContent.appendChild(contentDiv);

            modalOverlay.appendChild(modalContent);

            // Penanganan Escape key dan overflow body
            const handleEsc = (event) => {
                if (event.key === 'Escape') {
                    onClose();
                }
            };
            document.addEventListener('keydown', handleEsc);
            document.body.style.overflow = 'hidden'; // Mencegah scroll body saat modal terbuka

            // Fungsi cleanup yang akan dipanggil saat modal ditutup/dihapus
            modalOverlay.cleanup = () => {
                document.removeEventListener('keydown', handleEsc);
                modalOverlay.removeEventListener('click', closeOnOverlayClick); // Hapus listener overlay
                document.body.style.overflow = 'unset';
                if (modalOverlay.parentElement) modalOverlay.parentElement.removeChild(modalOverlay);
            };

            return modalOverlay;
        }

        /**
         * Komponen Spinner (Indikator Loading).
         * @param {object} [props={}] - Properti spinner.
         * @param {'sm'|'md'|'lg'} [props.size='md'] - Ukuran spinner.
         * @param {string} [props.colorClass='text-primary'] - Kelas warna untuk spinner (misal: 'border-primary').
         * @returns {HTMLDivElement} Elemen spinner.
         */
        function SpinnerComponent({ size = 'md', colorClass = 'border-primary' } = {}) {
            const spinnerDiv = document.createElement('div');
            spinnerDiv.className = 'flex justify-center items-center';
            const ringDiv = document.createElement('div');
            ringDiv.className = `animate-spin spinner-ring spinner-${size}`;
            ringDiv.classList.add(colorClass); // Warna border utama
            // Warna border-top transparan sudah diatur di CSS global .spinner-ring
            spinnerDiv.appendChild(ringDiv);
            return spinnerDiv;
        }

        /**
         * Komponen Tombol Toggle Tema.
         * @returns {HTMLButtonElement} Tombol untuk mengganti tema.
         */
        function ThemeToggleComponent() {
            return ButtonComponent({
                onClick: toggleThemeAndUpdateUI,
                variant: 'ghost',
                ariaLabel: currentTheme === Theme.LIGHT ? 'Alihkan ke tema gelap' : 'Alihkan ke tema terang',
                className: 'p-2', // Padding untuk area klik yang lebih baik
                leftIcon: currentTheme === Theme.LIGHT ? MoonIcon('w-5 h-5 text-slate-600') : SunIcon('w-5 h-5 text-yellow-400')
            });
        }

        // --- 7. Fungsi Komponen Layout ---
        /**
         * Komponen Header Aplikasi.
         * @returns {HTMLElement} Elemen <header>.
         */
        function HeaderComponent() {
            const header = document.createElement('header');
            header.className = 'app-header'; // Menggunakan kelas CSS khusus

            const container = document.createElement('div');
            container.className = 'container mx-auto';
            header.appendChild(container);

            const flexContainer = document.createElement('div');
            flexContainer.className = 'flex items-center justify-between h-16';
            container.appendChild(flexContainer);

            const logoLink = document.createElement('a');
            logoLink.href = '#home';
            logoLink.className = 'text-2xl font-bold text-primary dark:text-primary-light hover:opacity-80 transition-opacity';
            logoLink.textContent = APP_NAME;
            logoLink.onclick = (e) => { e.preventDefault(); navigateTo('home'); };
            flexContainer.appendChild(logoLink);

            const nav = document.createElement('nav');
            nav.className = 'flex items-center space-x-1 sm:space-x-2'; // Mengurangi spasi antar item nav

            const navLink = (path, iconElement, text) => {
                const link = document.createElement('a');
                link.href = `#${path}`;
                const isActive = appState.currentPage === path;
                // Kelas dasar dan aktif dari CSS
                link.className = `flex items-center px-2 py-2 sm:px-3 rounded-md text-sm font-medium transition-colors duration-200 ${isActive ? 'bg-primary/20 text-primary dark:text-primary-light font-semibold' : 'text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700'}`;
                link.onclick = (e) => { e.preventDefault(); navigateTo(path); };

                const iconSpan = document.createElement('span');
                iconSpan.className = 'mr-0 sm:mr-1.5'; // Margin ikon disesuaikan
                iconSpan.appendChild(iconElement);
                link.appendChild(iconSpan);

                const textSpan = document.createElement('span');
                textSpan.className = 'hidden sm:inline'; // Teks hanya muncul di layar sm ke atas
                textSpan.textContent = text;
                link.appendChild(textSpan);
                return link;
            };

            nav.appendChild(navLink('home', HomeIcon(), 'Beranda'));
            nav.appendChild(navLink('dashboard', DashboardIcon(), 'Dasbor'));
            nav.appendChild(navLink('notifications', BellIcon(), 'Notifikasi'));
            nav.appendChild(ThemeToggleComponent());
            flexContainer.appendChild(nav);

            return header;
        }

        /**
         * Komponen Footer Aplikasi.
         * @returns {HTMLElement} Elemen <footer>.
         */
        function FooterComponent() {
            const footer = document.createElement('footer');
            footer.className = 'app-footer'; // Menggunakan kelas CSS khusus

            const container = document.createElement('div');
            container.className = 'container mx-auto px-4';

            const p1 = document.createElement('p');
            p1.className = 'text-sm text-text-muted'; // Menggunakan variabel warna text-muted
            p1.innerHTML = `&copy; ${new Date().getFullYear()} ${APP_NAME}. Hak Cipta Dilindungi.`;
            container.appendChild(p1);

            const p2 = document.createElement('p');
            p2.className = 'text-xs text-text-muted opacity-75 mt-1'; // Sedikit lebih pudar
            p2.textContent = 'Hunian Impian, Kini Nyata.';
            container.appendChild(p2);

            footer.appendChild(container);
            return footer;
        }

        // --- Komponen Properti ---
        /**
         * Komponen Kartu Properti Individual.
         * @param {object} property - Objek data properti.
         * @param {function} [onDetailsClick] - Callback saat tombol detail diklik.
         * @returns {HTMLElement} Elemen <article> untuk kartu properti.
         */
        function PropertyCardComponent(property, onDetailsClick) {
            const cardEl = document.createElement('article'); // Tag semantik
            cardEl.className = 'property-card animate-fade-in group'; // group untuk hover image
            if (onDetailsClick) cardEl.classList.add('clickable');

            const imgContainer = document.createElement('div');
            imgContainer.className = 'property-card-image-container';
            const img = document.createElement('img');
            img.src = property.imageUrl;
            img.alt = `Gambar ${property.name}`;
            img.className = 'property-card-image';
            imgContainer.appendChild(img);

            const statusBadge = document.createElement('div');
            statusBadge.className = `property-card-status-badge ${property.status === 'Tersedia' ? 'available' : 'rented'}`;
            statusBadge.textContent = property.status;
            imgContainer.appendChild(statusBadge);
            cardEl.appendChild(imgContainer);

            const contentDiv = document.createElement('div');
            contentDiv.className = 'property-card-content';

            const nameH3 = document.createElement('h3');
            nameH3.className = 'text-xl font-semibold text-text-default mb-2 truncate';
            nameH3.title = property.name; // Tooltip untuk nama panjang
            nameH3.textContent = property.name;
            contentDiv.appendChild(nameH3);

            const addressP = document.createElement('p');
            addressP.className = 'text-sm text-text-muted mb-1 truncate';
            addressP.textContent = property.address;
            contentDiv.appendChild(addressP);

            const detailsP = document.createElement('p');
            detailsP.className = 'text-sm text-text-muted mb-3';
            detailsP.textContent = `${property.bedrooms} KT · ${property.bathrooms} KM · ${property.type}`;
            contentDiv.appendChild(detailsP);

            const priceP = document.createElement('p');
            priceP.className = 'text-lg font-bold text-primary dark:text-primary-light mb-4';
            priceP.textContent = `$${property.rentPrice.toLocaleString()}/bulan`;
            contentDiv.appendChild(priceP);

            const descriptionP = document.createElement('p');
            descriptionP.className = 'text-sm text-text-default opacity-90 mb-4 line-clamp-3 property-card-description';
            descriptionP.textContent = property.description;
            contentDiv.appendChild(descriptionP);

            if (onDetailsClick) {
                const button = ButtonComponent({
                    textContent: 'Lihat Detail',
                    className: 'mt-auto w-full', // Tombol mengisi lebar & di bawah
                    onClick: (e) => {
                        e.stopPropagation(); // Mencegah card click jika tombol diklik
                        onDetailsClick(property.id);
                    }
                });
                contentDiv.appendChild(button);
            }
            cardEl.appendChild(contentDiv);
            return cardEl;
        }

        /**
         * Komponen Daftar Properti.
         * @param {object[]} properties - Array objek properti.
         * @param {function} onPropertyClick - Callback saat properti diklik.
         * @returns {HTMLDivElement} Kontainer daftar properti.
         */
        function PropertyListComponent(properties, onPropertyClick) {
            const listContainer = document.createElement('div');
            if (properties.length === 0) {
                listContainer.innerHTML = `<p class="text-center text-text-muted py-8">Tidak ada properti yang ditemukan.</p>`;
                return listContainer;
            }
            listContainer.className = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6';
            properties.forEach(prop => {
                const card = PropertyCardComponent(prop, onPropertyClick);
                // Jika onPropertyClick ada dan bukan hanya untuk tombol detail, tambahkan listener ke card
                if (onPropertyClick) {
                    card.addEventListener('click', () => onPropertyClick(prop.id));
                }
                listContainer.appendChild(card);
            });
            return listContainer;
        }

        // --- Komponen Notifikasi ---
        /**
         * Komponen Item Notifikasi Individual.
         * @param {object} notification - Objek data notifikasi.
         * @returns {HTMLDivElement} Elemen item notifikasi.
         */
        function NotificationItemComponent(notification) {
            const itemDiv = document.createElement('div');
            const typeClasses = {
                info: 'border-blue-500 bg-blue-500',
                success: 'border-green-500 bg-green-500',
                warning: 'border-yellow-500 bg-yellow-500',
                error: 'border-red-500 bg-red-500'
            };
            const baseClass = 'flex items-start p-4 border-l-4 rounded-r-md shadow-sm transition-colors duration-200 hover:bg-slate-100 dark:hover:bg-slate-700';
            itemDiv.className = `${baseClass} ${notification.read ? 'opacity-70' : ''} ${typeClasses[notification.type].split(' ')[0]} bg-surface`; // border-color dari type, bg dari surface

            const iconWrapper = document.createElement('div');
            // Ambil kelas bg dari typeClasses untuk ikon wrapper
            iconWrapper.className = `mr-3 p-2 rounded-full ${typeClasses[notification.type].split(' ')[1]} text-white flex-shrink-0`;
            iconWrapper.appendChild(BellIcon('w-5 h-5')); // Ukuran ikon konsisten
            itemDiv.appendChild(iconWrapper);

            const contentDiv = document.createElement('div');
            contentDiv.className = 'flex-1 min-w-0'; // min-w-0 untuk mencegah overflow teks
            const msgP = document.createElement('p');
            msgP.className = 'text-sm text-text-default';
            msgP.textContent = notification.message;
            contentDiv.appendChild(msgP);

            const timeP = document.createElement('p');
            timeP.className = 'text-xs text-text-muted mt-1';
            timeP.textContent = timeAgo(notification.timestamp);
            contentDiv.appendChild(timeP);
            itemDiv.appendChild(contentDiv);

            if (!notification.read) {
                const unreadDot = document.createElement('div');
                unreadDot.className = 'ml-auto w-2.5 h-2.5 bg-primary rounded-full self-center flex-shrink-0'; // Sedikit lebih besar
                unreadDot.title = 'Belum Dibaca';
                itemDiv.appendChild(unreadDot);
            }
            return itemDiv;
        }

        /**
         * Komponen Daftar Notifikasi.
         * @param {object[]} notifications - Array objek notifikasi.
         * @returns {HTMLDivElement} Kontainer daftar notifikasi.
         */
        function NotificationListComponent(notifications) {
            const listContainer = document.createElement('div');
            if (notifications.length === 0) {
                listContainer.innerHTML = `<p class="text-center text-text-muted py-8">Tidak ada notifikasi.</p>`;
                return listContainer;
            }
            listContainer.className = 'space-y-3';
            // Urutkan notifikasi, yang belum dibaca di atas, lalu berdasarkan waktu terbaru
            const sortedNotifications = [...notifications].sort((a, b) => {
                if (a.read !== b.read) return a.read ? 1 : -1;
                return new Date(b.timestamp) - new Date(a.timestamp);
            });
            sortedNotifications.forEach(notif => {
                listContainer.appendChild(NotificationItemComponent(notif));
            });
            return listContainer;
        }

        // --- Komponen Dasbor ---
        /**
         * Komponen Seksi Dasbor.
         * @param {object} props - Properti seksi.
         * @param {string} props.title - Judul seksi.
         * @param {Node|Node[]|string} props.children - Konten seksi.
         * @param {HTMLButtonElement} [props.actionButton] - Tombol aksi untuk seksi.
         * @param {string} [props.className=''] - Kelas CSS tambahan.
         * @returns {HTMLDivElement} Elemen kartu yang berisi seksi dasbor.
         */
        function DashboardSectionComponent({ title, children, actionButton, className = '' }) {
            const sectionContent = document.createElement('div');

            const headerDiv = document.createElement('div');
            headerDiv.className = 'flex justify-between items-center mb-6';
            const titleH2 = document.createElement('h2');
            titleH2.className = 'text-2xl font-semibold text-text-default';
            titleH2.textContent = title;
            headerDiv.appendChild(titleH2);
            if (actionButton) headerDiv.appendChild(actionButton);
            sectionContent.appendChild(headerDiv);

            const contentDiv = document.createElement('div');
            if (typeof children === 'string') contentDiv.innerHTML = children;
            else if (children instanceof Node) contentDiv.appendChild(children);
            else if (Array.isArray(children)) children.forEach(child => child instanceof Node && contentDiv.appendChild(child));
            sectionContent.appendChild(contentDiv);

            // Menggunakan CardComponent sebagai dasar
            return CardComponent({ children: sectionContent, className: `animate-slide-up ${className}` });
        }

        let currentPropertyFormModal = null; // Untuk manajemen cleanup event listener modal

        /**
         * Komponen Modal Form Properti (Tambah/Edit).
         * @returns {HTMLDivElement | null} Elemen modal form atau null jika tidak terbuka.
         */
        function PropertyFormModalComponent() {
            const { isOpen, propertyToEditId, isGeneratingDesc } = appState.propertyFormModal;
            if (!isOpen) {
                if (currentPropertyFormModal && currentPropertyFormModal.cleanup) currentPropertyFormModal.cleanup();
                currentPropertyFormModal = null;
                return null;
            }

            const propertyToEdit = propertyToEditId ? appState.properties.find(p => p.id === propertyToEditId) : null;
            const initialFormState = { name: '', address: '', type: 'Apartemen', bedrooms: 1, bathrooms: 1, rentPrice: 1000, description: '', status: 'Tersedia', imageUrl: `https://picsum.photos/seed/${Date.now()}/600/400` };
            let formData = propertyToEdit ? { ...propertyToEdit } : { ...initialFormState };

            const form = document.createElement('form');
            form.className = 'space-y-4'; // Spasi antar grup input

            // Fungsi helper untuk membuat input field
            const createFormField = (label, name, type = 'text', value, options = {}) => {
                const div = document.createElement('div');
                const labelEl = document.createElement('label');
                labelEl.htmlFor = `form-${name}`; // ID unik untuk label
                labelEl.className = 'form-label';
                labelEl.textContent = label;
                div.appendChild(labelEl);

                let inputEl;
                if (type === 'select') {
                    inputEl = document.createElement('select');
                    options.choices?.forEach(opt => {
                        const optionEl = document.createElement('option');
                        optionEl.value = opt.value;
                        optionEl.textContent = opt.label;
                        if (opt.value === value) optionEl.selected = true;
                        inputEl.appendChild(optionEl);
                    });
                } else if (type === 'textarea') {
                    inputEl = document.createElement('textarea');
                    inputEl.rows = options.rows || 3; // Default 3 baris
                } else {
                    inputEl = document.createElement('input');
                    inputEl.type = type;
                    if (options.min !== undefined) inputEl.min = options.min;
                    if (options.step !== undefined) inputEl.step = options.step;
                    if (options.placeholder) inputEl.placeholder = options.placeholder;
                }
                inputEl.name = name;
                inputEl.id = `form-${name}`;
                inputEl.className = type === 'select' ? 'form-select' : (type === 'textarea' ? 'form-textarea' : 'form-input');
                if (options.required) inputEl.required = true;

                // Set nilai awal, hati-hati dengan tipe number
                if (type === 'number') inputEl.value = Number(value) || 0;
                else inputEl.value = value || '';


                inputEl.addEventListener('input', (e) => {
                    const val = e.target.value;
                    formData[name] = (type === 'number' || name === 'rentPrice' || name === 'bedrooms' || name === 'bathrooms') ? Number(val) : val;
                });
                div.appendChild(inputEl);
                return div;
            };

            form.appendChild(createFormField('Nama Properti', 'name', 'text', formData.name, { required: true, placeholder: 'Mis: Apartemen Modern Pusat Kota' }));
            form.appendChild(createFormField('Alamat', 'address', 'text', formData.address, { required: true, placeholder: 'Mis: Jl. Sudirman No. 123' }));

            const gridDiv1 = document.createElement('div');
            gridDiv1.className = 'grid grid-cols-1 md:grid-cols-2 gap-4';
            gridDiv1.appendChild(createFormField('Tipe', 'type', 'select', formData.type, { choices: [{ value: 'Apartemen', label: 'Apartemen' }, { value: 'Rumah', label: 'Rumah' }, { value: 'Kondominium', label: 'Kondominium' }] }));
            gridDiv1.appendChild(createFormField('Status', 'status', 'select', formData.status, { choices: [{ value: 'Tersedia', label: 'Tersedia' }, { value: 'Disewa', label: 'Disewa' }] }));
            form.appendChild(gridDiv1);

            const gridDiv2 = document.createElement('div');
            gridDiv2.className = 'grid grid-cols-1 md:grid-cols-3 gap-4';
            gridDiv2.appendChild(createFormField('Kamar Tidur', 'bedrooms', 'number', formData.bedrooms, { min: 0, required: true }));
            gridDiv2.appendChild(createFormField('Kamar Mandi', 'bathrooms', 'number', formData.bathrooms, { min: 0, step: 0.5, required: true }));
            gridDiv2.appendChild(createFormField('Harga Sewa ($/bulan)', 'rentPrice', 'number', formData.rentPrice, { min: 0, required: true }));
            form.appendChild(gridDiv2);

            const descDiv = createFormField('Deskripsi', 'description', 'textarea', formData.description, { rows: 4, placeholder: 'Jelaskan fitur unik properti Anda...' });
            const descTextarea = descDiv.querySelector('textarea'); // Dapatkan textarea untuk update AI

            const aiButtonContainer = document.createElement('div');
            aiButtonContainer.className = 'mt-2 flex items-center'; // Kontainer untuk tombol AI dan spinner

            const aiButton = ButtonComponent({
                textContent: isGeneratingDesc ? '' : 'Buat dengan AI', // Kosongkan teks jika loading
                type: 'button', variant: 'ghost', size: 'sm', className: 'text-xs',
                leftIcon: isGeneratingDesc ? SpinnerComponent({ size: 'sm', colorClass: 'border-primary' }) : SparklesIcon('w-4 h-4'),
                disabled: isGeneratingDesc || geminiApiKey === GEMINI_API_KEY_PLACEHOLDER, // Disable jika API Key tidak ada
                onClick: async () => {
                    if (appState.propertyFormModal.isGeneratingDesc) return;
                    appState.propertyFormModal.isGeneratingDesc = true;
                    renderApp(); // Render ulang untuk menampilkan spinner & disable tombol

                    const desc = await generatePropertyDescriptionWithGemini({ type: formData.type, bedrooms: formData.bedrooms, bathrooms: formData.bathrooms });
                    formData.description = desc; // Update formData
                    // Cek apakah modal masih ada sebelum update DOM textarea
                    const currentTextarea = document.getElementById('form-description');
                    if (currentTextarea) currentTextarea.value = desc;

                    appState.propertyFormModal.isGeneratingDesc = false;
                    // Cek apakah modal masih ada sebelum renderApp
                    if (appState.propertyFormModal.isOpen) {
                        renderApp(); // Render ulang untuk menyembunyikan spinner & update tombol
                    }
                }
            });
            if (geminiApiKey === GEMINI_API_KEY_PLACEHOLDER) {
                aiButton.title = "Kunci API Gemini tidak dikonfigurasi.";
            }

            aiButtonContainer.appendChild(aiButton);
            if (isGeneratingDesc) {
                const generatingText = document.createElement('span');
                generatingText.className = 'ml-2 text-xs text-text-muted';
                generatingText.textContent = 'Menghasilkan...';
                aiButtonContainer.appendChild(generatingText);
            }
            descDiv.appendChild(aiButtonContainer);
            form.appendChild(descDiv);

            const buttonsDiv = document.createElement('div');
            buttonsDiv.className = 'flex justify-end space-x-3 pt-4 border-t border-border mt-4'; // Garis pemisah
            buttonsDiv.appendChild(ButtonComponent({ textContent: 'Batal', type: 'button', variant: 'ghost', onClick: closePropertyFormModal }));
            buttonsDiv.appendChild(ButtonComponent({ textContent: propertyToEdit ? 'Simpan Perubahan' : 'Tambah Properti', type: 'submit', variant: 'primary' }));
            form.appendChild(buttonsDiv);

            form.addEventListener('submit', (e) => {
                e.preventDefault();
                // Validasi sederhana (bisa diperluas)
                if (!formData.name || !formData.address || formData.rentPrice <= 0) {
                    alert('Harap isi semua kolom yang wajib diisi (Nama, Alamat, Harga Sewa > 0).');
                    return;
                }

                const propertyData = {
                    ...formData,
                    id: propertyToEdit?.id || `prop_${Date.now()}`, // ID unik
                    imageUrl: propertyToEdit?.imageUrl || `https://picsum.photos/seed/${Date.now()}/600/400`, // Gambar default jika baru
                    ownerId: propertyToEdit?.ownerId || 'owner_mock_current_user', // ID pemilik mock
                };
                updateGlobalProperty(propertyData); // Ini akan memanggil renderApp
                closePropertyFormModal();
            });

            const modal = ModalComponent({
                isOpen: true,
                onClose: closePropertyFormModal,
                title: propertyToEdit ? 'Edit Properti' : 'Tambah Properti Baru',
                size: 'lg', // Ukuran modal lebih besar untuk form
                children: form
            });
            currentPropertyFormModal = modal; // Simpan referensi modal
            return modal;
        }

        /**
         * Widget Manajemen Properti untuk Dasbor.
         * @returns {HTMLDivElement} Elemen seksi dasbor untuk manajemen properti.
         */
        function PropertyManagementWidgetComponent() {
            // Filter properti milik "pengguna saat ini" (mock)
            const ownerProperties = appState.properties.filter(p => p.ownerId === 'owner_mock_current_user' || p.ownerId === 'owner1');

            const content = document.createElement('div');
            if (ownerProperties.length === 0) {
                content.innerHTML = `<p class="text-text-muted">Anda belum menambahkan properti apa pun.</p>`;
            } else {
                const listDiv = document.createElement('div');
                listDiv.className = 'space-y-4';
                ownerProperties.forEach(prop => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'p-4 bg-slate-50 dark:bg-surface rounded-lg shadow flex flex-col sm:flex-row justify-between items-start sm:items-center hover:shadow-md transition-shadow duration-200';
                    // bg-slate-50 dark:bg-slate-700/50 diubah menjadi bg-surface turunan

                    const infoDiv = document.createElement('div');
                    infoDiv.className = 'mb-2 sm:mb-0';
                    const nameH4 = document.createElement('h4');
                    nameH4.className = 'font-semibold text-lg text-text-default';
                    nameH4.textContent = prop.name;
                    infoDiv.appendChild(nameH4);
                    const detailsP = document.createElement('p');
                    detailsP.className = 'text-sm text-text-muted';
                    detailsP.textContent = `${prop.address} - Status: ${prop.status}`;
                    infoDiv.appendChild(detailsP);
                    itemDiv.appendChild(infoDiv);

                    const actionsDiv = document.createElement('div');
                    actionsDiv.className = 'flex space-x-2 self-end sm:self-center'; // Tombol di kanan bawah pada mobile
                    actionsDiv.appendChild(ButtonComponent({ textContent: 'Edit', size: 'sm', variant: 'ghost', onClick: () => openPropertyFormModal(prop.id) }));
                    actionsDiv.appendChild(ButtonComponent({
                        textContent: 'Hapus', size: 'sm', variant: 'danger', onClick: () => {
                            if (confirm(`Apakah Anda yakin ingin menghapus properti "${prop.name}"? Tindakan ini tidak dapat diurungkan.`)) {
                                deleteGlobalProperty(prop.id); // Ini akan memanggil renderApp
                            }
                        }
                    }));
                    itemDiv.appendChild(actionsDiv);
                    listDiv.appendChild(itemDiv);
                });
                content.appendChild(listDiv);
            }

            return DashboardSectionComponent({
                title: 'Properti Saya',
                actionButton: ButtonComponent({ textContent: 'Tambah Properti', leftIcon: PlusIcon(), onClick: () => openPropertyFormModal(null) }),
                children: content
            });
        }

        /**
         * Widget Laporan Pendapatan untuk Dasbor.
         * @returns {HTMLDivElement} Elemen seksi dasbor untuk laporan pendapatan.
         */
        function IncomeReportWidgetComponent() {
            const totalIncome = mockIncomeData.reduce((sum, item) => sum + item.amount, 0);
            const currentMonthIncome = mockIncomeData.length > 0 ? mockIncomeData[mockIncomeData.length - 1].amount : 0;

            const container = document.createElement('div');

            const statsGrid = document.createElement('div');
            statsGrid.className = 'grid grid-cols-1 md:grid-cols-2 gap-6 mb-8';

            const createStatCard = (title, amount, variant = 'primary') => {
                const card = document.createElement('div');
                // Menggunakan warna dari variabel CSS
                let bgColorClass, textColorClass;
                if (variant === 'primary') {
                    bgColorClass = 'bg-primary/10 dark:bg-primary/20'; // Menggunakan /10 dan /20
                    textColorClass = 'text-primary dark:text-primary-light';
                } else { // secondary
                    bgColorClass = 'bg-secondary/10 dark:bg-secondary/20';
                    textColorClass = 'text-secondary dark:text-secondary-light';
                }
                card.className = `p-6 ${bgColorClass} rounded-lg shadow`;

                const titleH4 = document.createElement('h4');
                titleH4.className = `text-sm font-medium ${textColorClass} uppercase tracking-wider`; // tracking-wider untuk spasi huruf
                titleH4.textContent = title;
                card.appendChild(titleH4);

                const amountP = document.createElement('p');
                amountP.className = `text-3xl font-bold ${textColorClass} mt-1`;
                amountP.textContent = `$${amount.toLocaleString()}`;
                card.appendChild(amountP);
                return card;
            };
            statsGrid.appendChild(createStatCard('Pendapatan Bulan Ini', currentMonthIncome, 'primary'));
            statsGrid.appendChild(createStatCard('Total Pendapatan (YTD)', totalIncome, 'secondary'));
            container.appendChild(statsGrid);

            const trendTitle = document.createElement('h3');
            trendTitle.className = 'text-xl font-semibold mb-4 text-text-default';
            trendTitle.textContent = 'Tren Pendapatan Bulanan (Sederhana)';
            container.appendChild(trendTitle);

            // Grafik Batang Sederhana (Tanpa Recharts)
            const chartOuterContainer = document.createElement('div');
            chartOuterContainer.className = 'p-4 bg-slate-50 dark:bg-surface rounded-lg shadow-inner overflow-x-auto'; // bg-surface turunan & shadow-inner

            const chartDiv = document.createElement('div');
            chartDiv.className = 'flex space-x-2 items-end h-40 min-w-max'; // min-w-max agar bisa scroll jika banyak bar
            const maxAmount = Math.max(...mockIncomeData.map(d => d.amount), 1); // Hindari pembagian dengan nol

            mockIncomeData.forEach(item => {
                const barWrapper = document.createElement('div');
                barWrapper.className = 'flex flex-col items-center flex-shrink-0 w-10 text-center group'; // w-10 untuk lebar bar + label

                const bar = document.createElement('div');
                const barHeight = maxAmount > 0 ? (item.amount / maxAmount) * 100 : 0;
                bar.style.height = `${barHeight}%`;
                // bar.style.width = '30px'; // Lebar diatur oleh w-10 di wrapper
                bar.className = 'simple-chart-bar w-full bg-primary dark:bg-primary-light rounded-t cursor-pointer';
                bar.title = `${item.month}: $${item.amount.toLocaleString()}`; // Tooltip
                barWrapper.appendChild(bar);

                const label = document.createElement('div');
                label.className = 'text-xs mt-1 text-text-muted group-hover:font-semibold';
                label.textContent = item.month;
                barWrapper.appendChild(label);
                chartDiv.appendChild(barWrapper);
            });
            chartOuterContainer.appendChild(chartDiv);
            container.appendChild(chartOuterContainer);

            return DashboardSectionComponent({ title: 'Laporan Pendapatan', children: container });
        }

        // --- 8. Fungsi Komponen Halaman (Views) ---
        let currentPropertyDetailModal = null; // Untuk manajemen cleanup modal detail

        /**
         * Komponen Halaman Beranda (Home).
         * @returns {HTMLDivElement} Kontainer halaman beranda.
         */
        function HomePageComponent() {
            const pageContainer = document.createElement('div');
            pageContainer.className = 'space-y-12'; // Spasi antar seksi

            // Hero Section
            const heroSection = document.createElement('section');
            // Gradien dibuat dengan CSS (bisa lebih kompleks jika diinginkan)
            heroSection.className = 'text-center py-12 bg-gradient-to-r from-primary/10 to-secondary/10 dark:from-primary/5 dark:to-secondary/5 rounded-xl shadow-inner animate-fade-in';
            heroSection.style.background = `linear-gradient(to right, rgba(var(--color-primary-default-val), 0.1), rgba(var(--color-secondary-default-val), 0.1))`;
            if (currentTheme === Theme.DARK) {
                heroSection.style.background = `linear-gradient(to right, rgba(var(--color-primary-default-val), 0.05), rgba(var(--color-secondary-default-val), 0.05))`;
            }


            const heroTitle = document.createElement('h1');
            heroTitle.className = 'text-4xl sm:text-5xl font-extrabold text-primary dark:text-primary-light mb-4';
            heroTitle.textContent = 'Temukan Hunian Impian Anda';
            heroSection.appendChild(heroTitle);

            const heroSubtitle = document.createElement('p');
            heroSubtitle.className = 'text-lg text-text-muted max-w-2xl mx-auto px-4';
            heroSubtitle.textContent = 'Jelajahi berbagai pilihan properti terbaik di Green Valley. Apartemen modern, rumah keluarga yang nyaman, hingga kondominium mewah menanti Anda.';
            heroSection.appendChild(heroSubtitle);
            pageContainer.appendChild(heroSection);

            // Properties Section
            const propertiesSection = document.createElement('section');
            const sectionTitle = document.createElement('h2');
            sectionTitle.className = 'text-3xl font-semibold mb-8 text-text-default';
            sectionTitle.textContent = 'Properti Tersedia';
            propertiesSection.appendChild(sectionTitle);
            propertiesSection.appendChild(PropertyListComponent(appState.properties.filter(p => p.status === 'Tersedia'), openPropertyDetailModal));
            pageContainer.appendChild(propertiesSection);

            // Modal Detail Properti (akan ditambahkan ke pageContainer jika terbuka)
            if (appState.selectedPropertyModal.isOpen && appState.selectedPropertyModal.propertyId) {
                const property = appState.properties.find(p => p.id === appState.selectedPropertyModal.propertyId);
                if (property) {
                    const modalContent = document.createElement('div');
                    modalContent.className = 'space-y-3'; // Spasi antar item detail

                    const img = document.createElement('img');
                    img.src = property.imageUrl;
                    img.alt = `Gambar ${property.name}`;
                    img.className = 'w-full h-64 object-cover rounded-lg mb-4 shadow-md';
                    modalContent.appendChild(img);

                    const createDetailItem = (label, value) => {
                        const p = document.createElement('p');
                        const strong = document.createElement('strong');
                        strong.className = 'text-text-muted font-medium'; // Warna dan ketebalan label
                        strong.textContent = `${label}: `;
                        p.appendChild(strong);
                        p.appendChild(document.createTextNode(value));
                        return p;
                    };

                    modalContent.appendChild(createDetailItem('Alamat', property.address));
                    modalContent.appendChild(createDetailItem('Tipe', property.type));
                    modalContent.appendChild(createDetailItem('Kamar Tidur', property.bedrooms));
                    modalContent.appendChild(createDetailItem('Kamar Mandi', property.bathrooms));
                    modalContent.appendChild(createDetailItem('Harga Sewa', `$${property.rentPrice.toLocaleString()}/bulan`));

                    const descP = document.createElement('p');
                    descP.className = 'text-text-default mt-2 pt-3 border-t border-border'; // Garis pemisah
                    descP.textContent = property.description;
                    modalContent.appendChild(descP);

                    const modal = ModalComponent({
                        isOpen: true,
                        onClose: closePropertyDetailModal,
                        title: property.name,
                        size: 'lg',
                        children: modalContent
                    });
                    if (modal) {
                        // Daripada append ke pageContainer, append ke body agar selalu di atas segalanya
                        // document.body.appendChild(modal);
                        // Namun, untuk konsistensi dengan PropertyFormModalComponent, kita biarkan ia dirender oleh renderApp utama
                        // dan fungsi renderApp akan menghandle penambahannya.
                        // Jadi, cukup kembalikan modal ini agar bisa ditangani oleh renderApp.
                        // Atau, cara yang lebih baik adalah modal dirender terpisah di `renderApp`.
                        // Untuk saat ini, kita akan membuat `renderApp` bisa menangani modal global.
                        // Biarkan return null di sini, dan `renderApp` akan memanggil fungsi modal jika state-nya aktif.
                        // currentPropertyDetailModal = modal; // Ini akan dihandle di renderApp
                    }
                }
            }
            // Jika modal ditutup, pastikan cleanup dilakukan oleh `closePropertyDetailModal`
            // dan `renderApp` tidak mencoba merendernya.
            return pageContainer;
        }

        /**
         * Komponen Halaman Dasbor.
         * @returns {HTMLDivElement} Kontainer halaman dasbor.
         */
        function DashboardPageComponent() {
            const pageContainer = document.createElement('div');
            pageContainer.className = 'space-y-8 animate-fade-in';
            const titleH1 = document.createElement('h1');
            titleH1.className = 'text-3xl font-semibold text-text-default';
            titleH1.textContent = 'Dasbor Pemilik';
            pageContainer.appendChild(titleH1);

            pageContainer.appendChild(PropertyManagementWidgetComponent());
            pageContainer.appendChild(IncomeReportWidgetComponent());

            // Modal Form Properti (akan ditambahkan oleh renderApp jika state aktif)
            // Tidak perlu append di sini, renderApp akan menghandle
            return pageContainer;
        }

        /**
         * Komponen Halaman Notifikasi.
         * @returns {HTMLDivElement} Kontainer halaman notifikasi.
         */
        function NotificationsPageComponent() {
            const pageContainer = document.createElement('div');
            pageContainer.className = 'animate-fade-in';
            const titleH1 = document.createElement('h1');
            titleH1.className = 'text-3xl font-semibold mb-8 text-text-default';
            titleH1.textContent = 'Notifikasi';
            pageContainer.appendChild(titleH1);
            pageContainer.appendChild(NotificationListComponent(appState.notifications));
            return pageContainer;
        }

        // --- Helper State Modal ---
        function openPropertyDetailModal(propertyId) {
            appState.selectedPropertyModal.isOpen = true;
            appState.selectedPropertyModal.propertyId = propertyId;
            renderApp();
        }
        function closePropertyDetailModal() {
            if (currentPropertyDetailModal && currentPropertyDetailModal.cleanup) {
                currentPropertyDetailModal.cleanup();
            }
            currentPropertyDetailModal = null;
            appState.selectedPropertyModal.isOpen = false;
            appState.selectedPropertyModal.propertyId = null;
            renderApp();
        }
        function openPropertyFormModal(propertyIdToEdit) {
            appState.propertyFormModal.isOpen = true;
            appState.propertyFormModal.propertyToEditId = propertyIdToEdit;
            appState.propertyFormModal.isGeneratingDesc = false; // Reset status AI
            renderApp();
        }
        function closePropertyFormModal() {
            if (currentPropertyFormModal && currentPropertyFormModal.cleanup) {
                currentPropertyFormModal.cleanup();
            }
            currentPropertyFormModal = null;
            appState.propertyFormModal.isOpen = false;
            appState.propertyFormModal.propertyToEditId = null;
            renderApp();
        }

        // --- 9. Logika Router SPA ---
        /**
         * Navigasi ke path yang ditentukan menggunakan hash URL.
         * @param {string} path - Path tujuan (mis: 'home', 'dashboard').
         */
        function navigateTo(path) {
            // Hanya ubah hash jika berbeda untuk menghindari trigger hashchange yang tidak perlu
            if (window.location.hash !== `#${path}`) {
                window.location.hash = path;
            } else {
                // Jika hash sama, mungkin perlu force re-render jika ada sub-state yang berubah
                // tapi untuk kasus ini, renderApp akan dipanggil oleh aksi lain.
            }
        }

        /**
         * Menangani perubahan hash URL dan merender halaman yang sesuai.
         */
        function handleHashChange() {
            const path = window.location.hash.replace(/^#\/?/, '') || 'home'; // Default ke 'home'
            appState.currentPage = path.split('/')[0]; // Ambil path utama, abaikan sub-path untuk saat ini
            renderApp();
        }

        // --- 10. Fungsi Render Utama Aplikasi ---
        const appRoot = document.getElementById('app-root');
        let headerElement = null; // Cache elemen header
        let mainContentContainer = null; // Cache kontainer konten utama
        let footerElement = null; // Cache elemen footer

        /**
         * Merender seluruh aplikasi atau bagian yang berubah ke DOM.
         */
        function renderApp() {
            // Inisialisasi elemen layout utama jika belum ada (render pertama kali)
            if (!headerElement) {
                headerElement = HeaderComponent();
                appRoot.appendChild(headerElement);
            } else {
                // Update header jika ada (misalnya, status aktif link navigasi, ikon tema)
                const newHeader = HeaderComponent();
                headerElement.replaceWith(newHeader);
                headerElement = newHeader;
            }

            if (!mainContentContainer) {
                mainContentContainer = document.createElement('main');
                // Kelas untuk styling main content area
                mainContentContainer.className = 'flex-grow container mx-auto px-4 sm:px-6 lg:px-8 py-8';
                // Sisipkan setelah header
                if (headerElement && headerElement.nextSibling) {
                    appRoot.insertBefore(mainContentContainer, headerElement.nextSibling);
                } else if (headerElement) {
                    appRoot.appendChild(mainContentContainer); // Fallback jika header adalah child terakhir
                } else {
                    appRoot.prepend(mainContentContainer); // Jika header tidak ada (seharusnya tidak terjadi)
                }
            }
            mainContentContainer.innerHTML = ''; // Selalu bersihkan konten utama sebelum render ulang

            // Render Halaman berdasarkan currentPage
            let pageComponent;
            switch (appState.currentPage) {
                case 'home':
                    pageComponent = HomePageComponent();
                    break;
                case 'dashboard':
                    pageComponent = DashboardPageComponent();
                    break;
                case 'notifications':
                    pageComponent = NotificationsPageComponent();
                    break;
                default:
                    pageComponent = document.createElement('div');
                    pageComponent.className = 'text-center py-12 animate-fade-in';
                    pageComponent.innerHTML = `<h1 class="text-3xl font-semibold text-red-500">404 - Halaman Tidak Ditemukan</h1><p class="text-text-muted mt-2">Maaf, halaman yang Anda cari tidak ada.</p><a href="#home" class="mt-4 inline-block text-primary hover:underline">Kembali ke Beranda</a>`;
            }
            mainContentContainer.appendChild(pageComponent);

            if (!footerElement) {
                footerElement = FooterComponent();
                appRoot.appendChild(footerElement);
            } else {
                // Footer biasanya statis, tapi jika perlu diupdate (misal tahun), bisa dilakukan di sini
                // const newFooter = FooterComponent();
                // footerElement.replaceWith(newFooter);
                // footerElement = newFooter;
            }

            // --- Render Modals Global (jika ada yang aktif) ---
            // Hapus modal lama sebelum render yang baru (jika ada)
            if (currentPropertyDetailModal && currentPropertyDetailModal.parentElement) {
                currentPropertyDetailModal.cleanup(); // Panggil cleanup dari modal instance
            }
            currentPropertyDetailModal = null; // Reset

            if (appState.selectedPropertyModal.isOpen && appState.selectedPropertyModal.propertyId) {
                const property = appState.properties.find(p => p.id === appState.selectedPropertyModal.propertyId);
                if (property) {
                    // Konten modal detail properti dibuat di sini agar lebih terpusat
                    const modalContentEl = document.createElement('div');
                    modalContentEl.className = 'space-y-3';
                    const img = document.createElement('img');
                    img.src = property.imageUrl;
                    img.alt = `Gambar ${property.name}`;
                    img.className = 'w-full h-64 object-cover rounded-lg mb-4 shadow-md';
                    modalContentEl.appendChild(img);

                    const createDetailItem = (label, value) => {
                        const p = document.createElement('p');
                        const strong = document.createElement('strong');
                        strong.className = 'text-text-muted font-medium';
                        strong.textContent = `${label}: `;
                        p.appendChild(strong);
                        p.appendChild(document.createTextNode(value));
                        return p;
                    };
                    modalContentEl.appendChild(createDetailItem('Alamat', property.address));
                    modalContentEl.appendChild(createDetailItem('Tipe', property.type));
                    modalContentEl.appendChild(createDetailItem('Kamar Tidur', property.bedrooms));
                    modalContentEl.appendChild(createDetailItem('Kamar Mandi', property.bathrooms));
                    modalContentEl.appendChild(createDetailItem('Harga Sewa', `$${property.rentPrice.toLocaleString()}/bulan`));
                    const descP = document.createElement('p');
                    descP.className = 'text-text-default mt-2 pt-3 border-t border-border';
                    descP.textContent = property.description;
                    modalContentEl.appendChild(descP);

                    currentPropertyDetailModal = ModalComponent({
                        isOpen: true,
                        onClose: closePropertyDetailModal,
                        title: property.name,
                        size: 'lg',
                        children: modalContentEl
                    });
                    if (currentPropertyDetailModal) document.body.appendChild(currentPropertyDetailModal);
                }
            }

            // Hapus modal form lama
            if (currentPropertyFormModal && currentPropertyFormModal.parentElement) {
                currentPropertyFormModal.cleanup();
            }
            currentPropertyFormModal = null;

            if (appState.propertyFormModal.isOpen) {
                currentPropertyFormModal = PropertyFormModalComponent(); // Ini mengembalikan elemen modal
                if (currentPropertyFormModal) document.body.appendChild(currentPropertyFormModal);
            }

            // Pastikan tema diterapkan dengan benar pada body setelah render
            applyTheme(currentTheme);
        }

        // --- 11. Inisialisasi Aplikasi ---
        window.addEventListener('hashchange', handleHashChange);
        document.addEventListener('DOMContentLoaded', () => {
            // Tidak perlu panggil applyTheme di sini karena renderApp akan melakukannya.
            handleHashChange(); // Render halaman awal berdasarkan hash atau default
        });

    </script>
</body>

</html>