<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard - Manajemen Green Valley</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    /* ========== DESIGN SYSTEM ========== */
    :root {
      /* Color System */
      --color-primary-50: #f0f9ff;
      /* Biru Sangat Muda */
      --color-primary-100: #e0f2fe;
      /* Biru Muda */
      --color-primary-200: #bae6fd;
      /* Biru Langit Muda */
      --color-primary-300: #7dd3fc;
      /* Biru Langit */
      --color-primary-400: #38bdf8;
      /* Biru Cerah */
      --color-primary-500: #0ea5e9;
      /* Biru Utama */
      --color-primary-600: #0284c7;
      /* Biru Tua */
      --color-primary-700: #0369a1;
      /* Biru Lebih Tua */
      --color-primary-800: #075985;
      /* Biru Sangat Tua */
      --color-primary-900: #0c4a6e;
      /* Biru Hampir Hitam */

      --color-secondary-50: #f5f3ff;
      /* Ungu Sangat Muda */
      --color-secondary-100: #ede9fe;
      /* Ungu Muda */
      --color-secondary-200: #ddd6fe;
      /* Lavender Muda */
      --color-secondary-300: #c4b5fd;
      /* Lavender */
      --color-secondary-400: #a78bfa;
      /* Ungu Cerah */
      --color-secondary-500: #8b5cf6;
      /* Ungu Utama */
      --color-secondary-600: #7c3aed;
      /* Ungu Tua */
      --color-secondary-700: #6d28d9;
      /* Ungu Lebih Tua */
      --color-secondary-800: #5b21b6;
      /* Ungu Sangat Tua */
      --color-secondary-900: #4c1d95;
      /* Ungu Hampir Hitam */

      --color-success-50: #f0fdf4;
      /* Hijau Sangat Muda */
      --color-success-100: #dcfce7;
      /* Hijau Muda */
      --color-success-200: #bbf7d0;
      /* Hijau Mint */
      --color-success-300: #86efac;
      /* Hijau Cerah */
      --color-success-400: #4ade80;
      /* Hijau Limau */
      --color-success-500: #22c55e;
      /* Hijau Utama */
      --color-success-600: #16a34a;
      /* Hijau Tua */
      --color-success-700: #15803d;
      /* Hijau Lebih Tua */
      --color-success-800: #166534;
      /* Hijau Hutan */
      --color-success-900: #14532d;
      /* Hijau Sangat Tua */

      --color-warning-50: #fffbeb;
      /* Kuning Sangat Muda */
      --color-warning-100: #fef3c7;
      /* Kuning Muda */
      --color-warning-200: #fde68a;
      /* Kuning Pastel */
      --color-warning-300: #fcd34d;
      /* Kuning Cerah */
      --color-warning-400: #fbbf24;
      /* Kuning Emas */
      --color-warning-500: #f59e0b;
      /* Oranye Kuning */
      --color-warning-600: #d97706;
      /* Oranye Tua */
      --color-warning-700: #b45309;
      /* Coklat Oranye */
      --color-warning-800: #92400e;
      /* Coklat Tua */
      --color-warning-900: #78350f;
      /* Coklat Sangat Tua */

      --color-danger-50: #fef2f2;
      /* Merah Sangat Muda */
      --color-danger-100: #fee2e2;
      /* Merah Muda */
      --color-danger-200: #fecaca;
      /* Merah Jambu */
      --color-danger-300: #fca5a5;
      /* Merah Koral */
      --color-danger-400: #f87171;
      /* Merah Cerah */
      --color-danger-500: #ef4444;
      /* Merah Utama */
      --color-danger-600: #dc2626;
      /* Merah Tua */
      --color-danger-700: #b91c1c;
      /* Merah Marun */
      --color-danger-800: #991b1b;
      /* Merah Darah */
      --color-danger-900: #7f1d1d;
      /* Merah Sangat Tua */

      --color-gray-50: #f9fafb;
      /* Abu-abu Sangat Muda (Background Utama) */
      --color-gray-100: #f3f4f6;
      /* Abu-abu Muda */
      --color-gray-200: #e5e7eb;
      /* Abu-abu Garis Batas */
      --color-gray-300: #d1d5db;
      /* Abu-abu Netral */
      --color-gray-400: #9ca3af;
      /* Abu-abu Sedang */
      --color-gray-500: #6b7280;
      /* Abu-abu Teks Sekunder */
      --color-gray-600: #4b5563;
      /* Abu-abu Tua */
      --color-gray-700: #374151;
      /* Abu-abu Teks Utama */
      --color-gray-800: #1f2937;
      /* Abu-abu Gelap */
      --color-gray-900: #111827;
      /* Abu-abu Sangat Gelap */

      --color-white: #ffffff;
      --color-black: #000000;

      /* Font System */
      --font-sans: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
      --font-size-xs: 0.75rem;
      /* 12px */
      --font-size-sm: 0.875rem;
      /* 14px */
      --font-size-base: 1rem;
      /* 16px */
      --font-size-lg: 1.125rem;
      /* 18px */
      --font-size-xl: 1.25rem;
      /* 20px */
      --font-size-2xl: 1.5rem;
      /* 24px */
      --font-size-3xl: 1.875rem;
      /* 30px */
      --font-size-4xl: 2.25rem;
      /* 36px */

      --font-weight-light: 300;
      --font-weight-normal: 400;
      --font-weight-medium: 500;
      --font-weight-semibold: 600;
      --font-weight-bold: 700;

      --line-height-none: 1;
      --line-height-tight: 1.25;
      --line-height-normal: 1.5;
      --line-height-relaxed: 1.75;

      /* Spacing System */
      --space-0: 0;
      --space-px: 1px;
      --space-0_5: 0.125rem;
      /* 2px */
      --space-1: 0.25rem;
      /* 4px */
      --space-1_5: 0.375rem;
      /* 6px */
      --space-2: 0.5rem;
      /* 8px */
      --space-2_5: 0.625rem;
      /* 10px */
      --space-3: 0.75rem;
      /* 12px */
      --space-3_5: 0.875rem;
      /* 14px */
      --space-4: 1rem;
      /* 16px */
      --space-5: 1.25rem;
      /* 20px */
      --space-6: 1.5rem;
      /* 24px */
      --space-8: 2rem;
      /* 32px */
      --space-10: 2.5rem;
      /* 40px */
      --space-12: 3rem;
      /* 48px */

      /* Border Radius */
      --radius-none: 0;
      --radius-sm: 0.125rem;
      /* 2px */
      --radius-md: 0.375rem;
      /* 6px */
      --radius-lg: 0.5rem;
      /* 8px */
      --radius-xl: 0.75rem;
      /* 12px */
      --radius-full: 9999px;

      /* Shadows */
      --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
      --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);

      /* Transitions */
      --transition-duration: 0.2s;
      --transition-timing-function: ease-in-out;
      --transition-all: all var(--transition-duration) var(--transition-timing-function);
      --transition-colors: color var(--transition-duration) var(--transition-timing-function), background-color var(--transition-duration) var(--transition-timing-function), border-color var(--transition-duration) var(--transition-timing-function), fill var(--transition-duration) var(--transition-timing-function), stroke var(--transition-duration) var(--transition-timing-function);
      --transition-opacity: opacity var(--transition-duration) var(--transition-timing-function);
      --transition-shadow: box-shadow var(--transition-duration) var(--transition-timing-function);
      --transition-transform: transform var(--transition-duration) var(--transition-timing-function);

      /* Z-Index */
      --z-index-auto: auto;
      --z-index-0: 0;
      --z-index-10: 10;
      /* Elemen dasar */
      --z-index-20: 20;
      /* Elemen di atas dasar */
      --z-index-30: 30;
      /* Header, elemen sticky */
      --z-index-40: 40;
      /* Sidebar, dropdown */
      --z-index-50: 50;
      /* Modal, overlay */
      --z-index-100: 100;
      /* Notifikasi, tooltip di atas modal */
    }

    /* ========== BASE STYLES ========== */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    html {
      scroll-behavior: smooth;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      font-family: var(--font-sans);
      font-size: var(--font-size-base);
      line-height: var(--line-height-normal);
      color: var(--color-gray-700);
      background-color: var(--color-gray-50);
      overflow-x: hidden;
      /* Mencegah scroll horizontal karena transisi sidebar */
    }

    a {
      color: var(--color-primary-600);
      text-decoration: none;
      transition: color var(--transition-colors);
    }

    a:hover {
      color: var(--color-primary-700);
    }

    img,
    svg {
      max-width: 100%;
      height: auto;
      display: block;
      vertical-align: middle;
    }

    button,
    input,
    select,
    textarea {
      font: inherit;
      color: inherit;
      background: none;
      border: none;
      outline: none;
    }

    button {
      cursor: pointer;
    }

    :focus-visible {
      outline: 2px solid var(--color-primary-400);
      outline-offset: 2px;
      box-shadow: 0 0 0 2px var(--color-primary-100);
    }

    /* Hide scrollbar for Chrome, Safari and Opera */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    /* Hide scrollbar for IE, Edge and Firefox */
    .no-scrollbar {
      -ms-overflow-style: none;
      /* IE and Edge */
      scrollbar-width: none;
      /* Firefox */
    }


    /* ========== LAYOUT ========== */
    .app-container {
      display: flex;
      min-height: 100vh;
      position: relative;
      /* Untuk overlay sidebar mobile */
    }

    /* Sidebar */
    .sidebar {
      width: 280px;
      background-color: var(--color-white);
      border-right: 1px solid var(--color-gray-200);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      transition: transform var(--transition-transform), width var(--transition-transform);
      z-index: var(--z-index-40);
    }

    .sidebar-header {
      padding: var(--space-4);
      border-bottom: 1px solid var(--color-gray-200);
      display: flex;
      /* Ditambahkan untuk logo */
      align-items: center;
      /* Ditambahkan untuk logo */
      height: 65px;
      /* Samakan dengan header */
    }

    .sidebar-logo {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-bold);
      color: var(--color-primary-600);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .sidebar-logo .material-icons {
      font-size: var(--font-size-2xl);
    }

    .sidebar-nav {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-4) var(--space-2);
      /* Disesuaikan paddingnya */
    }

    .nav-group {
      margin-bottom: var(--space-4);
    }

    .nav-group-title {
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-semibold);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--color-gray-400);
      margin-bottom: var(--space-2);
      padding: 0 var(--space-3);
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      padding: var(--space-2_5) var(--space-3);
      /* Disesuaikan paddingnya */
      margin: 0 var(--space-1) var(--space-1) var(--space-1);
      /* Margin untuk spacing antar link */
      border-radius: var(--radius-lg);
      color: var(--color-gray-600);
      font-weight: var(--font-weight-medium);
      transition: var(--transition-all);
    }

    .nav-link:hover {
      background-color: var(--color-primary-50);
      color: var(--color-primary-600);
    }

    .nav-link.active {
      background-color: var(--color-primary-500);
      color: var(--color-white);
      box-shadow: var(--shadow-sm);
    }

    .nav-link.active:hover {
      background-color: var(--color-primary-600);
    }

    .nav-link.active .nav-link-icon {
      color: var(--color-white);
      /* Ikon jadi putih saat aktif */
    }

    .nav-link-icon {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-gray-500);
      transition: color var(--transition-colors);
    }

    .nav-link:hover .nav-link-icon {
      color: var(--color-primary-600);
    }


    .sidebar-footer {
      padding: var(--space-4);
      border-top: 1px solid var(--color-gray-200);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
      /* Mencegah konten membesar tak terkendali */
      background-color: var(--color-gray-50);
    }

    /* Header */
    .header {
      position: sticky;
      top: 0;
      z-index: var(--z-index-30);
      background-color: var(--color-white);
      border-bottom: 1px solid var(--color-gray-200);
      padding: 0 var(--space-4);
      /* Disesuaikan paddingnya */
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 65px;
      /* Tinggi header konsisten */
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      /* Disesuaikan gap */
    }

    .header-search {
      position: relative;
    }

    .search-input {
      width: 100%;
      min-width: 250px;
      /* Agar tidak terlalu kecil */
      padding: var(--space-2) var(--space-3) var(--space-2) var(--space-10);
      /* Disesuaikan paddingnya */
      background-color: var(--color-gray-100);
      border-radius: var(--radius-lg);
      transition: background-color var(--transition-colors), box-shadow var(--transition-shadow);
      font-size: var(--font-size-sm);
    }

    .search-input:focus {
      background-color: var(--color-white);
      border: 1px solid var(--color-primary-300);
      box-shadow: 0 0 0 2px var(--color-primary-100);
    }

    .search-icon {
      position: absolute;
      left: var(--space-3);
      top: 50%;
      transform: translateY(-50%);
      color: var(--color-gray-400);
      pointer-events: none;
      /* Agar icon tidak menghalangi focus ke input */
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      cursor: pointer;
      /* Menandakan bisa diklik */
      padding: var(--space-1_5);
      border-radius: var(--radius-md);
      transition: background-color var(--transition-colors);
    }

    .user-menu:hover {
      background-color: var(--color-gray-100);
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      background-color: var(--color-secondary-100);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-secondary-600);
      font-weight: var(--font-weight-medium);
      font-size: var(--font-size-sm);
    }

    .user-info .user-name {
      font-weight: var(--font-weight-medium);
      color: var(--color-gray-800);
    }

    .user-info .user-role {
      font-size: var(--font-size-xs);
      color: var(--color-gray-500);
    }


    /* Page Content Wrapper */
    .page-content-wrapper {
      flex: 1;
      padding: var(--space-6);
      overflow-y: auto;
      /* Scroll hanya pada konten utama */
    }

    /* Konten Halaman Aktual (yang akan di-render oleh JS) */
    .page {
      display: none;
      /* Semua halaman disembunyikan secara default */
    }

    .page.active {
      display: block;
      /* Hanya halaman aktif yang ditampilkan */
    }


    .page-header {
      display: flex;
      flex-wrap: wrap;
      /* Agar responsif */
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-6);
      gap: var(--space-3);
    }

    .page-title {
      font-size: var(--font-size-3xl);
      font-weight: var(--font-weight-bold);
      color: var(--color-gray-800);
    }

    .page-actions {
      display: flex;
      gap: var(--space-3);
    }

    /* Cards */
    .card {
      background-color: var(--color-white);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-md);
      margin-bottom: var(--space-6);
    }

    .card-padded {
      padding: var(--space-6);
    }

    .card-header {
      padding: var(--space-4) var(--space-6);
      border-bottom: 1px solid var(--color-gray-200);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-header.no-border {
      border-bottom: none;
    }

    .card-title {
      font-size: var(--font-size-lg);
      font-weight: var(--font-weight-semibold);
      color: var(--color-gray-800);
    }

    .card-body {
      padding: var(--space-6);
    }

    .card-footer {
      padding: var(--space-4) var(--space-6);
      border-top: 1px solid var(--color-gray-200);
      background-color: var(--color-gray-50);
      border-bottom-left-radius: var(--radius-xl);
      border-bottom-right-radius: var(--radius-xl);
    }


    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      /* Responsif otomatis */
      gap: var(--space-6);
      margin-bottom: var(--space-6);
    }

    .stat-card {
      background-color: var(--color-white);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-sm);
      padding: var(--space-5);
      display: flex;
      flex-direction: column;
      transition: var(--transition-all);
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .stat-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-3);
    }

    .stat-card-title {
      font-size: var(--font-size-sm);
      font-weight: var(--font-weight-medium);
      color: var(--color-gray-500);
    }

    .stat-card-icon {
      padding: var(--space-2);
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .stat-card-icon.primary {
      background-color: var(--color-primary-100);
      color: var(--color-primary-600);
    }

    .stat-card-icon.success {
      background-color: var(--color-success-100);
      color: var(--color-success-600);
    }

    .stat-card-icon.warning {
      background-color: var(--color-warning-100);
      color: var(--color-warning-600);
    }

    .stat-card-icon.danger {
      background-color: var(--color-danger-100);
      color: var(--color-danger-600);
    }


    .stat-card-value {
      font-size: var(--font-size-3xl);
      font-weight: var(--font-weight-bold);
      color: var(--color-gray-800);
      line-height: var(--line-height-tight);
      margin-bottom: var(--space-1);
    }

    .stat-card-change {
      font-size: var(--font-size-xs);
      display: flex;
      align-items: center;
      gap: var(--space-1);
    }

    .stat-card-change .material-icons {
      font-size: var(--font-size-base);
      /* Sesuaikan ukuran ikon */
    }

    .stat-card-change.positive {
      color: var(--color-success-600);
    }

    .stat-card-change.negative {
      color: var(--color-danger-600);
    }

    /* Tables */
    .table-container {
      overflow-x: auto;
      /* Scroll horizontal jika tabel terlalu lebar */
      width: 100%;
    }

    .table {
      width: 100%;
      border-collapse: collapse;
      font-size: var(--font-size-sm);
    }

    .table th,
    .table td {
      padding: var(--space-3) var(--space-4);
      text-align: left;
      vertical-align: middle;
      border-bottom: 1px solid var(--color-gray-200);
    }

    .table th {
      background-color: var(--color-gray-100);
      font-weight: var(--font-weight-semibold);
      color: var(--color-gray-600);
      white-space: nowrap;
      /* Mencegah header tabel wrap */
    }

    .table td {
      color: var(--color-gray-700);
    }

    .table tr:last-child td {
      border-bottom: none;
    }

    .table tr:hover td {
      background-color: var(--color-gray-50);
    }

    .table-actions button {
      margin-right: var(--space-1);
    }

    .table-actions button:last-child {
      margin-right: 0;
    }


    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: var(--space-1_5);
      padding: var(--space-0_5) var(--space-2);
      border-radius: var(--radius-full);
      font-size: var(--font-size-xs);
      font-weight: var(--font-weight-medium);
      text-transform: capitalize;
    }

    .status-badge .material-icons {
      font-size: var(--font-size-sm);
      /* Ukuran ikon dalam badge */
    }

    .status-badge.occupied {
      background-color: var(--color-danger-100);
      color: var(--color-danger-700);
    }

    .status-badge.vacant {
      background-color: var(--color-success-100);
      color: var(--color-success-700);
    }

    .status-badge.reserved {
      background-color: var(--color-warning-100);
      color: var(--color-warning-700);
    }

    .status-badge.maintenance {
      background-color: var(--color-gray-200);
      color: var(--color-gray-700);
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
      padding: var(--space-2_5) var(--space-4);
      /* Disesuaikan paddingnya */
      border-radius: var(--radius-lg);
      /* Disesuaikan radiusnya */
      font-weight: var(--font-weight-medium);
      transition: var(--transition-all);
      border: 1px solid transparent;
      cursor: pointer;
      white-space: nowrap;
      /* Mencegah teks tombol wrap */
    }

    .btn .material-icons {
      font-size: var(--font-size-lg);
      /* Ukuran ikon default pada tombol */
    }

    .btn-primary {
      background-color: var(--color-primary-500);
      color: var(--color-white);
      border-color: var(--color-primary-500);
    }

    .btn-primary:hover {
      background-color: var(--color-primary-600);
      border-color: var(--color-primary-600);
      box-shadow: var(--shadow-sm);
    }

    .btn-primary:focus-visible {
      box-shadow: 0 0 0 3px var(--color-primary-200);
    }


    .btn-outline {
      background-color: var(--color-white);
      border: 1px solid var(--color-gray-300);
      color: var(--color-gray-700);
    }

    .btn-outline:hover {
      background-color: var(--color-gray-50);
      border-color: var(--color-gray-400);
      color: var(--color-gray-800);
    }

    .btn-outline:focus-visible {
      box-shadow: 0 0 0 3px var(--color-gray-200);
    }

    .btn-danger {
      background-color: var(--color-danger-500);
      color: var(--color-white);
      border-color: var(--color-danger-500);
    }

    .btn-danger:hover {
      background-color: var(--color-danger-600);
      border-color: var(--color-danger-600);
    }

    .btn-icon {
      /* Tombol hanya ikon */
      padding: var(--space-2);
    }

    .btn-icon .material-icons {
      margin: 0;
      /* Hilangkan margin jika hanya ikon */
    }


    .btn-sm {
      padding: var(--space-1_5) var(--space-3);
      font-size: var(--font-size-sm);
    }

    .btn-sm .material-icons {
      font-size: var(--font-size-base);
      /* Ukuran ikon pada tombol kecil */
    }

    /* Forms */
    .form-group {
      margin-bottom: var(--space-4);
    }

    .form-group:last-child {
      margin-bottom: 0;
    }

    .form-label {
      display: block;
      margin-bottom: var(--space-2);
      font-weight: var(--font-weight-medium);
      color: var(--color-gray-700);
      font-size: var(--font-size-sm);
    }

    .form-control {
      width: 100%;
      padding: var(--space-2_5) var(--space-3);
      background-color: var(--color-white);
      border: 1px solid var(--color-gray-300);
      border-radius: var(--radius-md);
      transition: border-color var(--transition-colors), box-shadow var(--transition-shadow);
      font-size: var(--font-size-sm);
    }

    .form-control:focus {
      border-color: var(--color-primary-400);
      box-shadow: 0 0 0 2px var(--color-primary-100);
    }

    .form-control::placeholder {
      color: var(--color-gray-400);
      opacity: 1;
      /* Firefox */
    }

    input[type="number"] {
      -moz-appearance: textfield;
      /* Firefox */
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }


    .form-select {
      appearance: none;
      /* Hapus tampilan default browser */
      -webkit-appearance: none;
      -moz-appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
      background-position: right var(--space-3) center;
      background-repeat: no-repeat;
      background-size: 1.25em 1.25em;
      /* Disesuaikan ukuran ikon dropdown */
      padding-right: var(--space-10);
      /* Ruang untuk ikon dropdown */
    }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background-color: rgba(17, 24, 39, 0.6);
      /* --color-gray-900 with opacity */
      backdrop-filter: blur(4px);
      /* Efek blur pada background */
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: var(--z-index-50);
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-duration) var(--transition-timing-function);
      padding: var(--space-4);
      /* Padding agar modal tidak menempel di tepi layar kecil */
    }

    .modal-overlay.open {
      opacity: 1;
      pointer-events: auto;
    }

    .modal-dialog {
      background-color: var(--color-white);
      border-radius: var(--radius-xl);
      width: 100%;
      max-width: 560px;
      /* Disesuaikan lebar modal */
      max-height: 90vh;
      display: flex;
      /* Untuk layout header, body, footer */
      flex-direction: column;
      box-shadow: var(--shadow-2xl);
      transform: scale(0.95) translateY(10px);
      transition: transform var(--transition-duration) var(--transition-timing-function);
    }

    .modal-overlay.open .modal-dialog {
      transform: scale(1) translateY(0);
    }

    .modal-header {
      padding: var(--space-4) var(--space-6);
      border-bottom: 1px solid var(--color-gray-200);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
      /* Agar header tidak mengecil */
    }

    .modal-title {
      font-size: var(--font-size-xl);
      font-weight: var(--font-weight-semibold);
      color: var(--color-gray-800);
    }

    .modal-close-btn {
      background: none;
      border: none;
      color: var(--color-gray-400);
      cursor: pointer;
      padding: var(--space-1);
      /* Area klik lebih besar */
      border-radius: var(--radius-full);
      transition: background-color var(--transition-colors), color var(--transition-colors);
    }

    .modal-close-btn:hover {
      background-color: var(--color-gray-100);
      color: var(--color-gray-600);
    }

    .modal-close-btn .material-icons {
      font-size: var(--font-size-xl);
      /* Ukuran ikon close */
      display: block;
      /* Menghilangkan spasi bawah aneh */
    }

    .modal-body {
      padding: var(--space-6);
      overflow-y: auto;
      /* Scroll jika konten modal panjang */
      flex-grow: 1;
      /* Body mengisi sisa ruang */
    }

    .modal-footer {
      padding: var(--space-4) var(--space-6);
      border-top: 1px solid var(--color-gray-200);
      display: flex;
      justify-content: flex-end;
      gap: var(--space-3);
      background-color: var(--color-gray-50);
      border-bottom-left-radius: var(--radius-xl);
      /* Sudut membulat bawah */
      border-bottom-right-radius: var(--radius-xl);
      flex-shrink: 0;
      /* Agar footer tidak mengecil */
    }

    /* Notifikasi Sederhana */
    .toast-notification {
      position: fixed;
      bottom: var(--space-6);
      right: var(--space-6);
      background-color: var(--color-gray-800);
      color: var(--color-white);
      padding: var(--space-3) var(--space-4);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-xl);
      z-index: var(--z-index-100);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.3s ease, transform 0.3s ease;
      font-size: var(--font-size-sm);
    }

    .toast-notification.show {
      opacity: 1;
      transform: translateY(0);
    }

    .toast-notification.success {
      background-color: var(--color-success-500);
    }

    .toast-notification.error {
      background-color: var(--color-danger-500);
    }


    /* Responsive Design */
    @media (max-width: 1024px) {

      /* Tablet dan di bawahnya */
      .sidebar {
        position: fixed;
        left: 0;
        top: 0;
        bottom: 0;
        transform: translateX(-100%);
        border-right: 1px solid var(--color-gray-200);
        /* Tambahkan border kanan saat mobile */
      }

      .sidebar.open {
        transform: translateX(0);
        box-shadow: var(--shadow-2xl);
        /* Bayangan saat sidebar terbuka di mobile */
      }

      .main-content-overlay {
        /* Overlay untuk menutup sidebar saat diklik */
        position: fixed;
        inset: 0;
        background-color: rgba(0, 0, 0, 0.3);
        z-index: var(--z-index-30 + 5);
        /* Di bawah sidebar, di atas konten */
        display: none;
        /* Default tersembunyi */
      }

      .sidebar.open+.main-content .main-content-overlay {
        display: block;
      }

      .header-search .search-input {
        min-width: 200px;
      }

      .page-title {
        font-size: var(--font-size-2xl);
      }
    }

    @media (max-width: 768px) {

      /* Mobile */
      .sidebar {
        width: 260px;
        /* Sidebar lebih kecil di mobile */
      }

      .header {
        padding: 0 var(--space-3);
      }

      .header-search {
        display: none;
        /* Sembunyikan search bar default di mobile, bisa diganti ikon */
      }

      .page-content-wrapper {
        padding: var(--space-4);
      }

      .page-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .page-actions {
        width: 100%;
        justify-content: flex-start;
        /* Tombol aksi jadi full width atau justify start */
      }

      .stats-grid {
        grid-template-columns: 1fr;
        /* 1 kolom di mobile */
        gap: var(--space-4);
      }

      .modal-dialog {
        margin: var(--space-4);
        /* Margin agar tidak terlalu mepet */
        max-width: calc(100% - var(--space-8));
      }
    }

    /* Utility Classes */
    .hidden {
      display: none !important;
    }

    .sr-only {
      /* Screen-reader only */
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border-width: 0;
    }

    .flex {
      display: flex;
    }

    .items-center {
      align-items: center;
    }

    .justify-between {
      justify-content: space-between;
    }

    .text-center {
      text-align: center;
    }

    .w-full {
      width: 100%;
    }

    /* Tambahkan utility lain sesuai kebutuhan */
    .mt-1 {
      margin-top: var(--space-1);
    }

    .mt-2 {
      margin-top: var(--space-2);
    }

    .mt-4 {
      margin-top: var(--space-4);
    }

    .mb-1 {
      margin-bottom: var(--space-1);
    }

    .mb-2 {
      margin-bottom: var(--space-2);
    }

    .mb-4 {
      margin-bottom: var(--space-4);
    }

    .mb-6 {
      margin-bottom: var(--space-6);
    }

    .p-4 {
      padding: var(--space-4);
    }

    .placeholder-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: var(--space-8);
      color: var(--color-gray-400);
      border: 2px dashed var(--color-gray-300);
      border-radius: var(--radius-xl);
      min-height: 300px;
    }

    .placeholder-content .material-icons {
      font-size: 4rem;
      margin-bottom: var(--space-4);
    }

    .placeholder-content h3 {
      font-size: var(--font-size-xl);
      color: var(--color-gray-600);
      margin-bottom: var(--space-2);
    }
  </style>
</head>

<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar no-scrollbar" id="sidebar">
      <header class="sidebar-header">
        <a href="#" data-page="dashboard" class="sidebar-logo nav-internal">
          <span class="material-icons">apartment</span>
          <span>Green Valley</span>
        </a>
      </header>

      <nav class="sidebar-nav">
        <div class="nav-group">
          <h3 class="nav-group-title">Menu Utama</h3>
          <a href="#" data-page="dashboard" class="nav-link nav-internal active">
            <span class="nav-link-icon material-icons">dashboard</span>
            <span>Dashboard</span>
          </a>
          <a href="#" data-page="units" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">meeting_room</span>
            <span>Unit Apartemen</span>
          </a>
          <a href="#" data-page="residents" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">people</span>
            <span>Penghuni</span>
          </a>
          <a href="#" data-page="payments" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">receipt</span>
            <span>Pembayaran</span>
          </a>
        </div>

        <div class="nav-group">
          <h3 class="nav-group-title">Manajemen</h3>
          <a href="#" data-page="maintenance" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">construction</span>
            <span>Maintenance</span>
          </a>
          <a href="#" data-page="security" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">security</span>
            <span>Keamanan</span>
          </a>
          <a href="#" data-page="parking" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">local_parking</span>
            <span>Parkir</span>
          </a>
        </div>

        <div class="nav-group">
          <h3 class="nav-group-title">Laporan</h3>
          <a href="#" data-page="statistics" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">bar_chart</span>
            <span>Statistik</span>
          </a>
          <a href="#" data-page="reports" class="nav-link nav-internal">
            <span class="nav-link-icon material-icons">description</span>
            <span>Laporan Bulanan</span>
          </a>
        </div>
      </nav>

      <footer class="sidebar-footer">
        <div class="user-menu">
          <div class="user-avatar">AD</div>
          <div class="user-info">
            <div class="user-name">Admin Ganteng</div>
            <div class="user-role">Super Admin</div>
          </div>
        </div>
      </footer>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
      <div class="main-content-overlay" id="mainContentOverlay"></div>
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <button class="btn btn-icon btn-outline" id="sidebarToggle" aria-label="Toggle Sidebar">
            <span class="material-icons">menu</span>
          </button>
          <div class="header-search">
            <span class="search-icon material-icons">search</span>
            <input type="text" class="search-input" placeholder="Cari unit, penghuni...">
          </div>
        </div>

        <div class="header-actions">
          <button class="btn btn-icon btn-outline" aria-label="Notifikasi">
            <span class="material-icons">notifications</span>
          </button>
          <button class="btn btn-icon btn-outline" aria-label="Pengaturan">
            <span class="material-icons">settings</span>
          </button>
        </div>
      </header>

      <!-- Page Content Wrapper -->
      <div class="page-content-wrapper no-scrollbar" id="pageContentWrapper">
        <!-- Halaman Dashboard -->
        <section id="page-dashboard" class="page active">
          <header class="page-header">
            <h1 class="page-title" id="mainPageTitle">Dashboard</h1>
            <div class="page-actions">
              <button class="btn btn-outline btn-sm" id="refreshDataBtn">
                <span class="material-icons">refresh</span>
                <span>Refresh Data</span>
              </button>
              <button class="btn btn-primary btn-sm" id="openAddUnitModalBtn">
                <span class="material-icons">add_circle_outline</span>
                <span>Tambah Unit</span>
              </button>
            </div>
          </header>

          <div class="stats-grid" id="statsGridContainer">
            <!-- Statistik akan di-render oleh JavaScript -->
          </div>

          <article class="card">
            <header class="card-header">
              <h2 class="card-title">Unit Terbaru Ditambahkan</h2>
              <button class="btn btn-outline btn-sm nav-internal" data-page="units">
                <span>Lihat Semua Unit</span>
                <span class="material-icons">arrow_forward</span>
              </button>
            </header>
            <div class="card-body">
              <div class="table-container">
                <table class="table" id="recentUnitsTable">
                  <thead>
                    <tr>
                      <th>No. Unit</th>
                      <th>Tipe</th>
                      <th>Lantai</th>
                      <th>Status</th>
                      <th>Aksi</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Data unit terbaru akan di-render oleh JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </article>
        </section>

        <!-- Halaman Unit Apartemen -->
        <section id="page-units" class="page">
          <header class="page-header">
            <h1 class="page-title">Manajemen Unit Apartemen</h1>
            <div class="page-actions">
              <button class="btn btn-primary btn-sm" id="openAddUnitModalBtnPage">
                <span class="material-icons">add_circle_outline</span>
                <span>Tambah Unit Baru</span>
              </button>
            </div>
          </header>
          <article class="card">
            <header class="card-header no-border">
              <h2 class="card-title">Daftar Semua Unit</h2>
              <!-- Filter bisa ditambahkan di sini -->
            </header>
            <div class="card-body">
              <div class="table-container">
                <table class="table" id="allUnitsTable">
                  <thead>
                    <tr>
                      <th>No. Unit</th>
                      <th>Tipe</th>
                      <th>Lantai</th>
                      <th>Luas (m²)</th>
                      <th>Harga Sewa/Bulan</th>
                      <th>Status</th>
                      <th>Penghuni</th>
                      <th>Aksi</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Data semua unit akan di-render oleh JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </article>
        </section>

        <!-- Halaman Placeholder untuk Menu Lain -->
        <section id="page-residents" class="page">
          <div class="placeholder-content">
            <span class="material-icons">people_outline</span>
            <h3>Halaman Manajemen Penghuni</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-payments" class="page">
          <div class="placeholder-content">
            <span class="material-icons">receipt_long</span>
            <h3>Halaman Manajemen Pembayaran</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-maintenance" class="page">
          <div class="placeholder-content">
            <span class="material-icons">build_circle</span>
            <h3>Halaman Manajemen Maintenance</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-security" class="page">
          <div class="placeholder-content">
            <span class="material-icons">security</span>
            <h3>Halaman Manajemen Keamanan</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-parking" class="page">
          <div class="placeholder-content">
            <span class="material-icons">local_parking</span>
            <h3>Halaman Manajemen Parkir</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-statistics" class="page">
          <div class="placeholder-content">
            <span class="material-icons">analytics</span>
            <h3>Halaman Statistik</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
        <section id="page-reports" class="page">
          <div class="placeholder-content">
            <span class="material-icons">assessment</span>
            <h3>Halaman Laporan Bulanan</h3>
            <p>Fitur ini sedang dalam pengembangan. Silakan kembali lagi nanti.</p>
          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Modal Tambah/Edit Unit -->
  <div class="modal-overlay" id="unitModalOverlay">
    <div class="modal-dialog" id="unitModalDialog">
      <header class="modal-header">
        <h2 class="modal-title" id="unitModalTitle">Tambah Unit Baru</h2>
        <button class="modal-close-btn" id="closeUnitModalBtn" aria-label="Tutup Modal">
          <span class="material-icons">close</span>
        </button>
      </header>

      <main class="modal-body">
        <form id="unitForm">
          <input type="hidden" id="unitId" value=""> <!-- Untuk mode edit -->
          <div class="form-group">
            <label for="unitNumber" class="form-label">Nomor Unit</label>
            <input type="text" id="unitNumber" class="form-control" placeholder="Contoh: A-1201" required>
          </div>

          <div class="form-group">
            <label for="unitType" class="form-label">Tipe Unit</label>
            <select id="unitType" class="form-control form-select" required>
              <option value="">Pilih Tipe Unit</option>
              <option value="Studio">Studio</option>
              <option value="1BR">1 Bedroom (1BR)</option>
              <option value="2BR">2 Bedrooms (2BR)</option>
              <option value="3BR">3 Bedrooms (3BR)</option>
              <option value="Penthouse">Penthouse</option>
            </select>
          </div>

          <div class="form-group">
            <label for="unitFloor" class="form-label">Lantai</label>
            <input type="number" id="unitFloor" class="form-control" placeholder="Masukkan nomor lantai" min="1"
              max="99" required>
          </div>

          <div class="form-group">
            <label for="unitArea" class="form-label">Luas Unit (m²)</label>
            <input type="number" id="unitArea" class="form-control" placeholder="Masukkan luas unit" min="10" required>
          </div>

          <div class="form-group">
            <label for="unitPrice" class="form-label">Harga Sewa / Bulan (Rp)</label>
            <input type="number" id="unitPrice" class="form-control" placeholder="Contoh: 5000000" min="0" required>
          </div>

          <div class="form-group">
            <label for="unitStatus" class="form-label">Status</label>
            <select id="unitStatus" class="form-control form-select" required>
              <option value="">Pilih Status</option>
              <option value="vacant">Kosong (Vacant)</option>
              <option value="occupied">Terisi (Occupied)</option>
              <option value="reserved">Dipesan (Reserved)</option>
              <option value="maintenance">Perbaikan (Maintenance)</option>
            </select>
          </div>

          <div class="form-group">
            <label for="unitResident" class="form-label">Nama Penghuni (Jika Terisi)</label>
            <input type="text" id="unitResident" class="form-control" placeholder="Kosongkan jika belum terisi">
          </div>
        </form>
      </main>

      <footer class="modal-footer">
        <button type="button" class="btn btn-outline" id="cancelUnitFormBtn">Batal</button>
        <button type="submit" class="btn btn-primary" id="saveUnitFormBtn" form="unitForm">Simpan</button>
      </footer>
    </div>
  </div>

  <!-- Elemen untuk notifikasi toast -->
  <div id="toastContainer"></div>

  <script>
    (function () {
      "use strict";

      // UTILITIES
      const qs = (selector, parent = document) => parent.querySelector(selector);
      const qsa = (selector, parent = document) => parent.querySelectorAll(selector);

      // Fungsi untuk membuat elemen dengan atribut dan teks
      const createElement = (tag, attributes = {}, textContent = '') => {
        const element = document.createElement(tag);
        for (const key in attributes) {
          element.setAttribute(key, attributes[key]);
        }
        if (textContent) {
          element.textContent = textContent;
        }
        return element;
      };

      // Fungsi untuk format Rupiah
      const formatCurrency = (amount) => {
        return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);
      };

      // Fungsi untuk menampilkan notifikasi toast
      const showToast = (message, type = 'info', duration = 3000) => {
        const toastContainer = qs('#toastContainer');
        const toast = createElement('div', {
          class: `toast-notification ${type}`
        }, message);

        toastContainer.appendChild(toast);

        // Memicu transisi
        setTimeout(() => toast.classList.add('show'), 10);

        setTimeout(() => {
          toast.classList.remove('show');
          // Hapus elemen setelah transisi selesai
          toast.addEventListener('transitionend', () => toast.remove(), { once: true });
        }, duration);
      };


      // STATE MANAGEMENT (Hierarki State Aplikasi)
      const appState = {
        currentPage: 'dashboard',
        isSidebarOpen: window.innerWidth > 1024, // Default terbuka di desktop
        isModalOpen: false,
        editingUnitId: null, // null untuk mode tambah, id unit untuk mode edit
        units: [ // Data contoh, idealnya dari API
          { id: 'U001', number: 'A-1201', type: '2BR', floor: 12, area: 60, price: 7500000, status: 'occupied', resident: 'Budi Santoso', addedDate: '2023-05-15' },
          { id: 'U002', number: 'B-805', type: '1BR', floor: 8, area: 45, price: 5000000, status: 'vacant', resident: '-', addedDate: '2023-06-01' },
          { id: 'U003', number: 'C-1503', type: '3BR', floor: 15, area: 90, price: 12000000, status: 'reserved', resident: 'Siti Rahayu (Booked)', addedDate: '2023-06-10' },
          { id: 'U004', number: 'A-901', type: 'Studio', floor: 9, area: 30, price: 3500000, status: 'maintenance', resident: '-', addedDate: '2023-04-20' },
          { id: 'U005', number: 'B-1102', type: '1BR', floor: 11, area: 45, price: 5200000, status: 'occupied', resident: 'Andi Wijaya', addedDate: '2023-03-01' },
        ],
        pageTitles: {
          dashboard: 'Dashboard',
          units: 'Manajemen Unit Apartemen',
          residents: 'Manajemen Penghuni',
          payments: 'Manajemen Pembayaran',
          maintenance: 'Manajemen Maintenance',
          security: 'Manajemen Keamanan',
          parking: 'Manajemen Parkir',
          statistics: 'Statistik Aplikasi',
          reports: 'Laporan Bulanan'
        }
      };

      // DOM ELEMENTS CACHING
      const sidebar = qs('#sidebar');
      const sidebarToggleBtn = qs('#sidebarToggle');
      const mainContentOverlay = qs('#mainContentOverlay');
      const mainPageTitle = qs('#mainPageTitle');

      const unitModalOverlay = qs('#unitModalOverlay');
      const unitModalDialog = qs('#unitModalDialog');
      const unitModalTitle = qs('#unitModalTitle');
      const closeUnitModalBtn = qs('#closeUnitModalBtn');
      const cancelUnitFormBtn = qs('#cancelUnitFormBtn');
      const unitForm = qs('#unitForm');
      const saveUnitFormBtn = qs('#saveUnitFormBtn'); // Tombol submit form
      // Tombol "Tambah Unit" di berbagai tempat
      const openAddUnitModalBtns = qsa('#openAddUnitModalBtn, #openAddUnitModalBtnPage');


      // RENDER FUNCTIONS (Layer Tampilan/UI)

      // Fungsi untuk membuat status badge
      const createStatusBadge = (status) => {
        const badge = createElement('span', { class: `status-badge ${status.toLowerCase()}` });
        const icon = createElement('span', { class: 'material-icons' }, 'circle');
        const text = createElement('span', {}, status);
        badge.appendChild(icon);
        badge.appendChild(text);
        return badge;
      };

      // Render Statistik Dashboard
      const renderDashboardStats = () => {
        const statsGridContainer = qs('#statsGridContainer');
        if (!statsGridContainer) return;

        const totalUnits = appState.units.length;
        const occupiedUnits = appState.units.filter(unit => unit.status === 'occupied').length;
        // const vacantUnits = appState.units.filter(unit => unit.status === 'vacant').length;
        const totalRevenue = appState.units
          .filter(unit => unit.status === 'occupied' || unit.status === 'reserved')
          .reduce((sum, unit) => sum + unit.price, 0);

        // Contoh data pengeluaran (bisa dari state lain)
        const monthlyExpenses = 78000000;

        const statsData = [
          { title: 'Total Unit', value: totalUnits, change: { value: 12, type: 'positive' }, icon: 'business', color: 'primary' },
          { title: 'Unit Terisi', value: occupiedUnits, change: { value: 8, type: 'positive' }, icon: 'person_pin_circle', color: 'success' },
          { title: 'Estimasi Pendapatan', value: formatCurrency(totalRevenue), change: { value: 5, type: 'negative' }, icon: 'payments', color: 'warning' },
          { title: 'Pengeluaran Bulan Ini', value: formatCurrency(monthlyExpenses), change: { value: 15, type: 'positive' }, icon: 'receipt_long', color: 'danger' },
        ];

        statsGridContainer.innerHTML = ''; // Bersihkan dulu
        statsData.forEach(stat => {
          const card = createElement('div', { class: 'stat-card' });

          const header = createElement('div', { class: 'stat-card-header' });
          const titleEl = createElement('h3', { class: 'stat-card-title' }, stat.title);
          const iconWrapper = createElement('div', { class: `stat-card-icon ${stat.color}` });
          const iconEl = createElement('span', { class: 'material-icons' }, stat.icon);
          iconWrapper.appendChild(iconEl);
          header.appendChild(titleEl);
          header.appendChild(iconWrapper);

          const valueEl = createElement('p', { class: 'stat-card-value' }, stat.value);

          const changeEl = createElement('p', { class: `stat-card-change ${stat.change.type}` });
          const changeIcon = createElement('span', { class: 'material-icons' }, stat.change.type === 'positive' ? 'trending_up' : 'trending_down');
          const changeText = createElement('span', {}, `${stat.change.value}% dari bulan lalu`);
          changeEl.appendChild(changeIcon);
          changeEl.appendChild(changeText);

          card.appendChild(header);
          card.appendChild(valueEl);
          card.appendChild(changeEl);
          statsGridContainer.appendChild(card);
        });
      };

      // Render Tabel Unit Terbaru di Dashboard
      const renderRecentUnitsTable = () => {
        const tableBody = qs('#recentUnitsTable tbody');
        if (!tableBody) return;

        tableBody.innerHTML = ''; // Bersihkan dulu
        const recentUnits = [...appState.units]
          .sort((a, b) => new Date(b.addedDate) - new Date(a.addedDate)) // Urutkan berdasarkan tanggal terbaru
          .slice(0, 5); // Ambil 5 terbaru

        if (recentUnits.length === 0) {
          const row = tableBody.insertRow();
          const cell = row.insertCell();
          cell.colSpan = 5;
          cell.textContent = 'Belum ada data unit.';
          cell.style.textAlign = 'center';
          return;
        }

        recentUnits.forEach(unit => {
          const row = tableBody.insertRow();
          row.insertCell().textContent = unit.number;
          row.insertCell().textContent = unit.type;
          row.insertCell().textContent = unit.floor;
          row.insertCell().appendChild(createStatusBadge(unit.status));

          const actionsCell = row.insertCell();
          actionsCell.className = 'table-actions';
          const viewBtn = createElement('button', {
            class: 'btn btn-outline btn-sm btn-icon',
            'data-unit-id': unit.id,
            'aria-label': `Lihat detail unit ${unit.number}`
          });
          viewBtn.innerHTML = '<span class="material-icons">visibility</span>';
          viewBtn.addEventListener('click', () => handleViewUnit(unit.id));
          actionsCell.appendChild(viewBtn);
        });
      };

      // Render Tabel Semua Unit di Halaman Unit
      const renderAllUnitsTable = () => {
        const tableBody = qs('#allUnitsTable tbody');
        if (!tableBody) return;

        tableBody.innerHTML = ''; // Bersihkan dulu

        if (appState.units.length === 0) {
          const row = tableBody.insertRow();
          const cell = row.insertCell();
          cell.colSpan = 8; // Sesuaikan dengan jumlah kolom
          cell.textContent = 'Belum ada data unit. Silakan tambahkan unit baru.';
          cell.style.textAlign = 'center';
          return;
        }

        appState.units.forEach(unit => {
          const row = tableBody.insertRow();
          row.insertCell().textContent = unit.number;
          row.insertCell().textContent = unit.type;
          row.insertCell().textContent = unit.floor;
          row.insertCell().textContent = unit.area;
          row.insertCell().textContent = formatCurrency(unit.price);
          row.insertCell().appendChild(createStatusBadge(unit.status));
          row.insertCell().textContent = unit.resident || '-';

          const actionsCell = row.insertCell();
          actionsCell.className = 'table-actions';

          const editBtn = createElement('button', {
            class: 'btn btn-outline btn-sm btn-icon',
            'data-unit-id': unit.id,
            'aria-label': `Edit unit ${unit.number}`
          });
          editBtn.innerHTML = '<span class="material-icons">edit</span>';
          editBtn.addEventListener('click', () => handleEditUnit(unit.id));

          const deleteBtn = createElement('button', {
            class: 'btn btn-danger btn-sm btn-icon',
            'data-unit-id': unit.id,
            'aria-label': `Hapus unit ${unit.number}`
          });
          deleteBtn.innerHTML = '<span class="material-icons">delete_outline</span>';
          deleteBtn.addEventListener('click', () => handleDeleteUnit(unit.id));

          actionsCell.appendChild(editBtn);
          actionsCell.appendChild(deleteBtn);
        });
      };

      // Render semua konten yang dinamis
      const renderAllDynamicContent = () => {
        renderDashboardStats();
        renderRecentUnitsTable();
        renderAllUnitsTable();
        // Panggil fungsi render lain jika ada
      };


      // PAGE NAVIGATION (Layer Logika Navigasi - SPA)
      const setActivePage = (pageId) => {
        appState.currentPage = pageId;

        // Sembunyikan semua halaman
        qsa('.page').forEach(page => page.classList.remove('active'));
        // Tampilkan halaman yang aktif
        const activePageElement = qs(`#page-${pageId}`);
        if (activePageElement) {
          activePageElement.classList.add('active');
        } else {
          qs('#page-dashboard').classList.add('active'); // Fallback ke dashboard
          console.warn(`Halaman dengan ID 'page-${pageId}' tidak ditemukan. Kembali ke Dashboard.`);
        }

        // Update judul utama halaman
        if (mainPageTitle) {
          mainPageTitle.textContent = appState.pageTitles[pageId] || 'Green Valley Admin';
        }

        // Update link navigasi aktif di sidebar
        qsa('.sidebar-nav .nav-link').forEach(link => {
          link.classList.remove('active');
          if (link.dataset.page === pageId) {
            link.classList.add('active');
          }
        });

        // Gulir ke atas halaman
        qs('#pageContentWrapper').scrollTop = 0;

        // Tutup sidebar di mobile setelah navigasi
        if (window.innerWidth <= 1024 && appState.isSidebarOpen) {
          toggleSidebar(false);
        }

        // Render ulang tabel jika halaman yang dituju adalah halaman unit
        if (pageId === 'units') {
          renderAllUnitsTable();
        }
        if (pageId === 'dashboard') {
          renderDashboardStats();
          renderRecentUnitsTable();
        }
      };

      // SIDEBAR LOGIC (Layer Interaksi UI)
      const toggleSidebar = (forceState) => {
        const open = typeof forceState === 'boolean' ? forceState : !sidebar.classList.contains('open');
        sidebar.classList.toggle('open', open);
        appState.isSidebarOpen = open;

        // Tampilkan/sembunyikan overlay di mobile
        if (mainContentOverlay) {
          mainContentOverlay.style.display = open && window.innerWidth <= 1024 ? 'block' : 'none';
        }
      };

      // MODAL LOGIC (Layer Interaksi UI)
      const openUnitModal = (mode = 'add', unitId = null) => {
        appState.isModalOpen = true;
        appState.editingUnitId = mode === 'edit' ? unitId : null;

        unitModalOverlay.classList.add('open');
        document.body.style.overflow = 'hidden'; // Mencegah scroll background

        if (mode === 'edit' && unitId) {
          unitModalTitle.textContent = 'Edit Data Unit';
          const unit = appState.units.find(u => u.id === unitId);
          if (unit) {
            qs('#unitId', unitForm).value = unit.id;
            qs('#unitNumber', unitForm).value = unit.number;
            qs('#unitType', unitForm).value = unit.type;
            qs('#unitFloor', unitForm).value = unit.floor;
            qs('#unitArea', unitForm).value = unit.area;
            qs('#unitPrice', unitForm).value = unit.price;
            qs('#unitStatus', unitForm).value = unit.status;
            qs('#unitResident', unitForm).value = unit.resident || '';
          }
        } else {
          unitModalTitle.textContent = 'Tambah Unit Baru';
          unitForm.reset(); // Bersihkan form untuk mode tambah
          qs('#unitId', unitForm).value = ''; // Pastikan ID kosong
        }
        // Fokus ke input pertama di modal
        qs('#unitNumber', unitForm).focus();
      };

      const closeUnitModal = () => {
        appState.isModalOpen = false;
        appState.editingUnitId = null;
        unitModalOverlay.classList.remove('open');
        document.body.style.overflow = ''; // Kembalikan scroll background
        unitForm.reset();
      };

      // FORM HANDLING (Layer Logika Bisnis/Data)
      const handleUnitFormSubmit = (event) => {
        event.preventDefault();
        if (!unitForm.checkValidity()) {
          unitForm.reportValidity(); // Tampilkan pesan error browser default
          return;
        }

        const unitData = {
          id: qs('#unitId', unitForm).value || `U${Date.now().toString().slice(-4)}${Math.random().toString(36).substr(2, 2)}`, // Generate ID unik sederhana
          number: qs('#unitNumber', unitForm).value.trim(),
          type: qs('#unitType', unitForm).value,
          floor: parseInt(qs('#unitFloor', unitForm).value),
          area: parseInt(qs('#unitArea', unitForm).value),
          price: parseInt(qs('#unitPrice', unitForm).value),
          status: qs('#unitStatus', unitForm).value,
          resident: qs('#unitResident', unitForm).value.trim() || '-',
          addedDate: appState.editingUnitId ? appState.units.find(u => u.id === appState.editingUnitId).addedDate : new Date().toISOString().split('T')[0] // Tanggal ditambah hanya saat baru
        };

        // Validasi Nomor Unit unik (kecuali untuk unit yang sedang diedit)
        const existingUnit = appState.units.find(u => u.number === unitData.number && u.id !== unitData.id);
        if (existingUnit) {
          showToast('Nomor unit sudah ada. Harap gunakan nomor unit yang unik.', 'error');
          qs('#unitNumber', unitForm).focus();
          return;
        }

        if (appState.editingUnitId) { // Mode Edit
          const index = appState.units.findIndex(u => u.id === appState.editingUnitId);
          if (index > -1) {
            appState.units[index] = { ...appState.units[index], ...unitData };
            showToast('Data unit berhasil diperbarui!', 'success');
          }
        } else { // Mode Tambah
          appState.units.push(unitData);
          showToast('Unit baru berhasil ditambahkan!', 'success');
        }

        renderAllDynamicContent();
        closeUnitModal();
      };

      // UNIT ACTIONS (Edit, Delete, View)
      const handleEditUnit = (unitId) => {
        openUnitModal('edit', unitId);
      };

      const handleDeleteUnit = (unitId) => {
        const unit = appState.units.find(u => u.id === unitId);
        if (!unit) return;

        if (confirm(`Apakah Anda yakin ingin menghapus unit ${unit.number}? Tindakan ini tidak dapat dibatalkan.`)) {
          appState.units = appState.units.filter(u => u.id !== unitId);
          renderAllDynamicContent();
          showToast(`Unit ${unit.number} berhasil dihapus.`, 'success');
        }
      };

      const handleViewUnit = (unitId) => {
        const unit = appState.units.find(u => u.id === unitId);
        if (!unit) {
          showToast('Unit tidak ditemukan.', 'error');
          return;
        }
        // Untuk saat ini, kita akan edit. Idealnya, ini membuka modal detail read-only.
        // Atau, bisa navigasi ke halaman detail unit jika ada.
        // Untuk demo ini, kita arahkan ke fungsi edit.
        // Boleh juga ganti jadi alert detail
        alert(`Detail Unit:\nNo: ${unit.number}\nTipe: ${unit.type}\nLantai: ${unit.floor}\nStatus: ${unit.status}\nPenghuni: ${unit.resident}`);
        // Jika ingin membuka modal edit:
        // openUnitModal('edit', unitId); 
      };


      // EVENT LISTENERS (Layer Kontroler)
      const setupEventListeners = () => {
        // Toggle Sidebar
        sidebarToggleBtn.addEventListener('click', () => toggleSidebar());
        // Overlay untuk menutup sidebar di mobile
        if (mainContentOverlay) {
          mainContentOverlay.addEventListener('click', () => toggleSidebar(false));
        }

        // Navigasi SPA
        qsa('.nav-internal').forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            const pageId = link.dataset.page;
            if (pageId) {
              setActivePage(pageId);
            }
          });
        });

        // Modal Unit
        openAddUnitModalBtns.forEach(btn => {
          btn.addEventListener('click', () => openUnitModal('add'));
        });
        closeUnitModalBtn.addEventListener('click', closeUnitModal);
        cancelUnitFormBtn.addEventListener('click', closeUnitModal);
        unitModalOverlay.addEventListener('click', (e) => {
          if (e.target === unitModalOverlay) { // Hanya tutup jika klik di luar dialog
            closeUnitModal();
          }
        });
        // Tombol Escape untuk menutup modal
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && appState.isModalOpen) {
            closeUnitModal();
          }
        });

        // Form Submit
        unitForm.addEventListener('submit', handleUnitFormSubmit);

        // Tombol Refresh Data (Contoh)
        const refreshDataBtn = qs('#refreshDataBtn');
        if (refreshDataBtn) {
          refreshDataBtn.addEventListener('click', () => {
            showToast('Data sedang di-refresh...', 'info');
            // Simulasi refresh data
            setTimeout(() => {
              renderAllDynamicContent();
              showToast('Data berhasil di-refresh!', 'success');
            }, 1000);
          });
        }

        // Penyesuaian UI berdasarkan ukuran window
        window.addEventListener('resize', () => {
          const desktopView = window.innerWidth > 1024;
          if (appState.isSidebarOpen && !desktopView) { // Jika sidebar terbuka dan layar mengecil ke mobile
            // Tidak perlu otomatis tutup, biarkan user yg kontrol
          } else if (!appState.isSidebarOpen && desktopView) { // Jika sidebar tertutup dan layar membesar ke desktop
            toggleSidebar(true); // Buka otomatis di desktop jika tadinya tertutup
          }
          // Sembunyikan overlay jika tidak di mobile atau sidebar tidak terbuka
          if (mainContentOverlay) {
            mainContentOverlay.style.display = appState.isSidebarOpen && !desktopView ? 'block' : 'none';
          }
        });
      };

      // INITIALIZATION
      const initializeApp = () => {
        // Set halaman awal berdasarkan URL hash (jika ada) atau default
        const initialPage = window.location.hash.substring(1) || 'dashboard';
        setActivePage(initialPage);

        // Render konten awal
        renderAllDynamicContent();

        // Atur sidebar berdasarkan ukuran layar awal
        toggleSidebar(appState.isSidebarOpen);

        // Pasang semua event listener
        setupEventListeners();

        console.log("Aplikasi Manajemen Green Valley berhasil dimuat.");
        showToast('Selamat datang di Dashboard Admin!', 'success', 4000);
      };

      // Jalankan aplikasi ketika DOM sudah siap
      document.addEventListener('DOMContentLoaded', initializeApp);

    })();
  </script>
</body>

</html>