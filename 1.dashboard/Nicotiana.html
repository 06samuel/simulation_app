<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dasbor RentalApartment</title>
    <!-- Menggunakan ikon Font Awesome untuk kemudahan, bisa diganti SVG native jika diperlukan -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Menggunakan font Google, bisa di-host sendiri untuk dependensi minimal -->
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <style>
        /* === ROOT VARIABLES (PALET WARNA DAN UTILITIES) === */
        :root {
            --primary-color: #0070f3;
            --primary-color-hover: #005bb5;
            --primary-foreground-color: #ffffff;

            --secondary-color: #f0f2f5;
            /* Warna latar belakang utama yang lebih lembut */
            --secondary-foreground-color: #1f2937;

            --accent-color: #eef2ff;
            --accent-foreground-color: #2563eb;

            --background-color: #ffffff;
            --foreground-color: #1f2937;

            --card-background-color: #ffffff;
            --card-foreground-color: #1f2937;
            --card-border-color: #e5e7eb;
            --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.07);

            --muted-color: #f3f4f6;
            --muted-foreground-color: #6b7280;

            --border-color: #e5e7eb;
            --input-border-color: #d1d5db;
            --input-focus-ring-color: #a5b4fc;
            /* Ring fokus yang lebih jelas */

            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #3b82f6;

            --font-family-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-family-display: 'Poppins', var(--font-family-sans);

            --font-weight-light: 300;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;

            --border-radius-sm: 0.25rem;
            /* 4px */
            --border-radius-md: 0.5rem;
            /* 8px */
            --border-radius-lg: 0.75rem;
            /* 12px */
            --border-radius-full: 9999px;

            --transition-speed-fast: 150ms;
            --transition-speed-normal: 300ms;
            --transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);

            --sidebar-width: 260px;
            --navbar-height: 64px;
        }

        /* === DARK THEME VARIABLES === */
        html[data-theme="dark"] {
            --primary-color: #2563eb;
            --primary-color-hover: #1d4ed8;
            --primary-foreground-color: #ffffff;

            --secondary-color: #111827;
            /* Latar utama gelap */
            --secondary-foreground-color: #f9fafb;

            --accent-color: #1e293b;
            --accent-foreground-color: #60a5fa;

            --background-color: #0f172a;
            /* Latar belakang body gelap */
            --foreground-color: #f3f4f6;
            /* Teks utama terang */

            --card-background-color: #1e293b;
            /* Warna kartu gelap */
            --card-foreground-color: #f9fafb;
            --card-border-color: #374151;
            /* Border kartu lebih gelap */
            --card-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);

            --muted-color: #374151;
            --muted-foreground-color: #9ca3af;

            --border-color: #374151;
            --input-border-color: #4b5563;
            --input-focus-ring-color: #60a5fa;
        }

        /* === BASE STYLES === */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 16px;
            /* Basis untuk REM */
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-family-sans);
            background-color: var(--secondary-color);
            /* Menggunakan secondary-color untuk latar utama */
            color: var(--foreground-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            /* Untuk layout sidebar dan content */
            transition: background-color var(--transition-speed-normal) var(--transition-timing-function),
                color var(--transition-speed-normal) var(--transition-timing-function);
        }

        /* === UTILITIES === */
        .d-none {
            display: none !important;
        }

        .d-block {
            display: block !important;
        }

        .d-flex {
            display: flex !important;
        }

        .align-items-center {
            align-items: center !important;
        }

        .justify-content-between {
            justify-content: space-between !important;
        }

        .justify-content-center {
            justify-content: center !important;
        }

        .justify-content-end {
            justify-content: flex-end !important;
        }

        .text-center {
            text-align: center !important;
        }

        .fw-bold {
            font-weight: var(--font-weight-bold) !important;
        }

        .fw-semibold {
            font-weight: var(--font-weight-semibold) !important;
        }

        .fw-medium {
            font-weight: var(--font-weight-medium) !important;
        }

        .p-1 {
            padding: 0.25rem !important;
        }

        .p-2 {
            padding: 0.5rem !important;
        }

        .p-3 {
            padding: 1rem !important;
        }

        .p-4 {
            padding: 1.5rem !important;
        }

        .m-1 {
            margin: 0.25rem !important;
        }

        .m-2 {
            margin: 0.5rem !important;
        }

        .m-3 {
            margin: 1rem !important;
        }

        .m-4 {
            margin: 1.5rem !important;
        }

        .mt-1 {
            margin-top: 0.25rem !important;
        }

        .mb-1 {
            margin-bottom: 0.25rem !important;
        }

        .ms-1 {
            margin-left: 0.25rem !important;
        }

        .me-1 {
            margin-right: 0.25rem !important;
        }

        .mt-2 {
            margin-top: 0.5rem !important;
        }

        .mb-2 {
            margin-bottom: 0.5rem !important;
        }

        .ms-2 {
            margin-left: 0.5rem !important;
        }

        .me-2 {
            margin-right: 0.5rem !important;
        }

        .mt-3 {
            margin-top: 1rem !important;
        }

        .mb-3 {
            margin-bottom: 1rem !important;
        }

        .ms-3 {
            margin-left: 1rem !important;
        }

        .me-3 {
            margin-right: 1rem !important;
        }

        .rounded {
            border-radius: var(--border-radius-md) !important;
        }

        .rounded-circle {
            border-radius: var(--border-radius-full) !important;
        }

        .shadow {
            box-shadow: var(--card-shadow) !important;
        }

        .w-100 {
            width: 100% !important;
        }

        .h-100 {
            height: 100% !important;
        }

        /* === LAYOUT COMPONENTS === */
        .app-wrapper {
            display: flex;
            width: 100%;
            min-height: 100vh;
        }

        /* SIDEBAR */
        .sidebar {
            width: var(--sidebar-width);
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            /* Lebih tinggi dari navbar */
            background-color: var(--card-background-color);
            color: var(--card-foreground-color);
            border-right: 1px solid var(--border-color);
            padding-top: 1rem;
            transition: transform var(--transition-speed-normal) var(--transition-timing-function),
                background-color var(--transition-speed-normal) var(--transition-timing-function),
                color var(--transition-speed-normal) var(--transition-timing-function),
                border-color var(--transition-speed-normal) var(--transition-timing-function);
            display: flex;
            flex-direction: column;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            padding: 0.5rem 1.5rem 1.5rem 1.5rem;
            /* Penyesuaian padding */
            border-bottom: 1px solid var(--border-color);
            transition: border-color var(--transition-speed-normal) var(--transition-timing-function);
        }

        .sidebar-header .logo-img {
            width: 40px;
            height: 40px;
            object-fit: cover;
        }

        .sidebar-nav {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
            flex-grow: 1;
        }

        .sidebar-nav-item {
            margin: 0.25rem 0.75rem;
            /* Margin atas bawah dan kiri kanan */
        }

        .sidebar-nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            /* Padding internal link */
            color: var(--muted-foreground-color);
            text-decoration: none;
            border-radius: var(--border-radius-md);
            transition: background-color var(--transition-speed-fast) var(--transition-timing-function),
                color var(--transition-speed-fast) var(--transition-timing-function);
            font-weight: var(--font-weight-medium);
        }

        .sidebar-nav-link .nav-icon {
            margin-right: 0.75rem;
            width: 20px;
            /* Lebar ikon konsisten */
            text-align: center;
        }

        .sidebar-nav-link:hover,
        .sidebar-nav-link:focus {
            background-color: var(--accent-color);
            color: var(--accent-foreground-color);
            outline: none;
        }

        .sidebar-nav-item.active .sidebar-nav-link {
            background-color: var(--primary-color);
            color: var(--primary-foreground-color);
            font-weight: var(--font-weight-semibold);
        }

        /* MAIN CONTENT AREA */
        .main-content {
            width: calc(100% - var(--sidebar-width));
            margin-left: var(--sidebar-width);
            padding-top: var(--navbar-height);
            /* Ruang untuk fixed navbar */
            transition: margin-left var(--transition-speed-normal) var(--transition-timing-function),
                width var(--transition-speed-normal) var(--transition-timing-function);
            position: relative;
            /* Untuk positioning konten di dalamnya */
        }

        /* NAVBAR (HEADER DALAM MAIN CONTENT) */
        .app-navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1.5rem;
            height: var(--navbar-height);
            background-color: var(--card-background-color);
            border-bottom: 1px solid var(--border-color);
            position: fixed;
            top: 0;
            right: 0;
            left: var(--sidebar-width);
            /* Sejajar dengan batas sidebar */
            z-index: 900;
            transition: background-color var(--transition-speed-normal) var(--transition-timing-function),
                border-color var(--transition-speed-normal) var(--transition-timing-function),
                left var(--transition-speed-normal) var(--transition-timing-function);
        }

        .navbar-left {
            display: flex;
            align-items: center;
        }

        .navbar-right {
            display: flex;
            align-items: center;
        }

        .sidebar-toggle-btn {
            background: none;
            border: none;
            color: var(--foreground-color);
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.5rem;
            margin-right: 1rem;
            /* Jarak dengan elemen lain */
            transition: color var(--transition-speed-fast) var(--transition-timing-function);
        }

        .sidebar-toggle-btn:hover {
            color: var(--primary-color);
        }


        /* PAGE CONTAINER (WRAPPER UNTUK KONTEN SETIAP HALAMAN) */
        .page-container {
            padding: 1.5rem;
        }

        .page-section {
            /* Setiap "halaman" SPA */
            display: none;
            /* Defaultnya tersembunyi */
        }

        .page-section.active {
            display: block;
            animation: fadeIn 0.5s var(--transition-timing-function);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* === UI COMPONENTS === */
        /* CARD */
        .card {
            background-color: var(--card-background-color);
            color: var(--card-foreground-color);
            border: 1px solid var(--card-border-color);
            border-radius: var(--border-radius-lg);
            /* Radius lebih besar untuk tampilan modern */
            box-shadow: var(--card-shadow);
            margin-bottom: 1.5rem;
            transition: background-color var(--transition-speed-normal) var(--transition-timing-function),
                color var(--transition-speed-normal) var(--transition-timing-function),
                border-color var(--transition-speed-normal) var(--transition-timing-function);
        }

        .card-header {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            font-size: 1.125rem;
            /* 18px */
            font-weight: var(--font-weight-semibold);
            transition: border-color var(--transition-speed-normal) var(--transition-timing-function);
        }

        .card-body {
            padding: 1.5rem;
        }

        .card-title {
            font-family: var(--font-family-display);
            font-size: 1.25rem;
            /* 20px */
            font-weight: var(--font-weight-semibold);
            margin-bottom: 0.75rem;
            color: var(--card-foreground-color);
        }

        .card-subtitle {
            font-size: 0.875rem;
            /* 14px */
            color: var(--muted-foreground-color);
            margin-bottom: 0.5rem;
        }

        .card-text {
            margin-bottom: 1rem;
        }

        /* BUTTONS */
        .btn {
            display: inline-block;
            font-weight: var(--font-weight-medium);
            line-height: 1.5;
            color: var(--primary-foreground-color);
            text-align: center;
            text-decoration: none;
            vertical-align: middle;
            cursor: pointer;
            user-select: none;
            background-color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 0.5rem 1rem;
            /* Ukuran tombol default */
            font-size: 0.9375rem;
            /* 15px */
            border-radius: var(--border-radius-md);
            transition: color var(--transition-speed-fast) var(--transition-timing-function),
                background-color var(--transition-speed-fast) var(--transition-timing-function),
                border-color var(--transition-speed-fast) var(--transition-timing-function),
                box-shadow var(--transition-speed-fast) var(--transition-timing-function);
        }

        .btn:hover {
            background-color: var(--primary-color-hover);
            border-color: var(--primary-color-hover);
        }

        .btn:focus,
        .btn.focus {
            outline: 0;
            box-shadow: 0 0 0 0.25rem var(--input-focus-ring-color);
        }

        .btn-outline-primary {
            color: var(--primary-color);
            background-color: transparent;
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover {
            color: var(--primary-foreground-color);
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-light {
            background-color: var(--muted-color);
            color: var(--muted-foreground-color);
            border-color: var(--muted-color);
        }

        .btn-light:hover {
            background-color: var(--border-color);
            /* Sedikit lebih gelap */
        }

        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.875rem;
            border-radius: var(--border-radius-sm);
        }

        .btn-lg {
            padding: 0.75rem 1.5rem;
            font-size: 1.125rem;
            border-radius: var(--border-radius-lg);
        }

        .btn-icon {
            padding: 0.5rem;
            /* Padding sama untuk tombol ikon */
            width: 38px;
            /* Atau sesuaikan agar proporsional */
            height: 38px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* FORMS */
        .form-control,
        .form-select {
            display: block;
            width: 100%;
            padding: 0.625rem 0.875rem;
            /* Padding yang lebih nyaman */
            font-size: 0.9375rem;
            font-weight: var(--font-weight-normal);
            line-height: 1.5;
            color: var(--foreground-color);
            background-color: var(--background-color);
            background-clip: padding-box;
            border: 1px solid var(--input-border-color);
            appearance: none;
            border-radius: var(--border-radius-md);
            transition: border-color var(--transition-speed-fast) var(--transition-timing-function),
                box-shadow var(--transition-speed-fast) var(--transition-timing-function),
                background-color var(--transition-speed-normal) var(--transition-timing-function),
                color var(--transition-speed-normal) var(--transition-timing-function);
        }

        .form-control:focus,
        .form-select:focus {
            border-color: var(--primary-color);
            outline: 0;
            box-shadow: 0 0 0 0.25rem var(--input-focus-ring-color);
        }

        .input-group {
            position: relative;
            display: flex;
            flex-wrap: wrap;
            align-items: stretch;
            width: 100%;
        }

        .input-group-text {
            display: flex;
            align-items: center;
            padding: 0.625rem 0.875rem;
            font-size: 0.9375rem;
            font-weight: 400;
            line-height: 1.5;
            color: var(--muted-foreground-color);
            text-align: center;
            white-space: nowrap;
            background-color: var(--muted-color);
            border: 1px solid var(--input-border-color);
            border-radius: var(--border-radius-md);
            transition: background-color var(--transition-speed-normal) var(--transition-timing-function),
                color var(--transition-speed-normal) var(--transition-timing-function),
                border-color var(--transition-speed-normal) var(--transition-timing-function);
        }

        .input-group .form-control {
            position: relative;
            flex: 1 1 auto;
            width: 1%;
            min-width: 0;
        }

        .input-group>.form-control:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
        }

        .input-group>.form-control:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
        }

        .input-group>.input-group-text:not(:first-child) {
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            margin-left: -1px;
        }

        .input-group>.input-group-text:not(:last-child) {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            margin-right: -1px;
        }


        /* THEME SWITCH */
        .theme-switch-wrapper {
            display: flex;
            align-items: center;
        }

        .theme-switch {
            display: inline-block;
            position: relative;
            width: 50px;
            /* Sedikit lebih kecil */
            height: 28px;
            /* Sedikit lebih kecil */
        }

        .theme-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .theme-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--muted-color);
            transition: var(--transition-speed-normal) var(--transition-timing-function);
            border-radius: 28px;
        }

        .theme-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            /* Disesuaikan */
            width: 20px;
            /* Disesuaikan */
            left: 4px;
            bottom: 4px;
            background-color: var(--background-color);
            transition: var(--transition-speed-normal) var(--transition-timing-function);
            border-radius: 50%;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        input:checked+.theme-slider {
            background-color: var(--primary-color);
        }

        input:checked+.theme-slider:before {
            transform: translateX(22px);
            /* Disesuaikan */
        }

        /* DROPDOWN (UNTUK USER PROFILE) */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-toggle {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
        }

        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            z-index: 1000;
            display: none;
            /* Kontrol via JS */
            min-width: 160px;
            padding: 0.5rem 0;
            margin-top: 0.25rem;
            font-size: 0.9375rem;
            color: var(--card-foreground-color);
            text-align: left;
            list-style: none;
            background-color: var(--card-background-color);
            background-clip: padding-box;
            border: 1px solid var(--card-border-color);
            border-radius: var(--border-radius-md);
            box-shadow: var(--card-shadow);
        }

        .dropdown-menu.show {
            display: block;
        }

        .dropdown-item {
            display: block;
            width: 100%;
            padding: 0.5rem 1rem;
            clear: both;
            font-weight: var(--font-weight-normal);
            color: var(--card-foreground-color);
            text-align: inherit;
            text-decoration: none;
            white-space: nowrap;
            background-color: transparent;
            border: 0;
        }

        .dropdown-item:hover,
        .dropdown-item:focus {
            color: var(--accent-foreground-color);
            background-color: var(--accent-color);
        }

        .dropdown-divider {
            height: 0;
            margin: 0.5rem 0;
            overflow: hidden;
            border-top: 1px solid var(--border-color);
        }

        .profile-img {
            width: 36px;
            height: 36px;
            object-fit: cover;
        }

        /* TABLE */
        .table-responsive {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .table {
            width: 100%;
            margin-bottom: 1rem;
            color: var(--foreground-color);
            border-collapse: collapse;
            /* Untuk border yang lebih rapi */
        }

        .table th,
        .table td {
            padding: 0.75rem;
            vertical-align: top;
            border-top: 1px solid var(--border-color);
        }

        .table thead th {
            vertical-align: bottom;
            border-bottom: 2px solid var(--border-color);
            text-align: left;
            /* Konsistensi */
            font-weight: var(--font-weight-semibold);
        }

        .table tbody+tbody {
            border-top: 2px solid var(--border-color);
        }

        .table-hover tbody tr:hover {
            color: var(--accent-foreground-color);
            background-color: var(--accent-color);
        }

        .badge {
            display: inline-block;
            padding: 0.35em 0.65em;
            font-size: .75em;
            font-weight: var(--font-weight-bold);
            line-height: 1;
            color: var(--primary-foreground-color);
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: var(--border-radius-sm);
        }

        .bg-success {
            background-color: var(--success-color) !important;
        }

        .bg-warning {
            background-color: var(--warning-color) !important;
            color: #000 !important;
        }

        /* Teks hitam untuk kontras kuning */
        .bg-info {
            background-color: var(--info-color) !important;
        }

        .bg-danger {
            background-color: var(--danger-color) !important;
        }

        /* GRID SYSTEM SEDERHANA */
        .row {
            display: flex;
            flex-wrap: wrap;
            margin-right: -0.75rem;
            /* Gutter */
            margin-left: -0.75rem;
            /* Gutter */
        }

        .col,
        .col-1,
        .col-2,
        .col-3,
        .col-4,
        .col-5,
        .col-6,
        .col-7,
        .col-8,
        .col-9,
        .col-10,
        .col-11,
        .col-12,
        .col-md-1,
        .col-md-2,
        .col-md-3,
        .col-md-4,
        .col-md-5,
        .col-md-6,
        .col-md-7,
        .col-md-8,
        .col-md-9,
        .col-md-10,
        .col-md-11,
        .col-md-12,
        .col-lg-1,
        .col-lg-2,
        .col-lg-3,
        .col-lg-4,
        .col-lg-5,
        .col-lg-6,
        .col-lg-7,
        .col-lg-8,
        .col-lg-9,
        .col-lg-10,
        .col-lg-11,
        .col-lg-12 {
            position: relative;
            width: 100%;
            padding-right: 0.75rem;
            /* Gutter */
            padding-left: 0.75rem;
            /* Gutter */
        }

        .col {
            flex-basis: 0;
            flex-grow: 1;
            max-width: 100%;
        }

        .col-auto {
            flex: 0 0 auto;
            width: auto;
            max-width: 100%;
        }

        .col-1 {
            flex: 0 0 8.333333%;
            max-width: 8.333333%;
        }

        /* ... (lanjutkan untuk col-2 sampai col-12) ... */
        .col-12 {
            flex: 0 0 100%;
            max-width: 100%;
        }

        @media (min-width: 768px) {

            /* Medium devices (tablets, 768px and up) */
            .col-md-3 {
                flex: 0 0 25%;
                max-width: 25%;
            }

            .col-md-4 {
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }

            .col-md-6 {
                flex: 0 0 50%;
                max-width: 50%;
            }

            .col-md-8 {
                flex: 0 0 66.666667%;
                max-width: 66.666667%;
            }

            .col-md-12 {
                flex: 0 0 100%;
                max-width: 100%;
            }

            /* Sidebar behavior for larger screens remains fixed */
        }

        @media (min-width: 992px) {

            /* Large devices (desktops, 992px and up) */
            .col-lg-3 {
                flex: 0 0 25%;
                max-width: 25%;
            }

            .col-lg-4 {
                flex: 0 0 33.333333%;
                max-width: 33.333333%;
            }

            .col-lg-6 {
                flex: 0 0 50%;
                max-width: 50%;
            }

            .col-lg-8 {
                flex: 0 0 66.666667%;
                max-width: 66.666667%;
            }

            /* Sidebar behavior for larger screens remains fixed */
        }

        /* MODAL STYLES */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1050;
            display: none;
            width: 100%;
            height: 100%;
            overflow: hidden;
            outline: 0;
            background-color: rgba(0, 0, 0, 0.5);
            /* Backdrop */
        }

        .modal.show {
            display: flex;
            /* Use flex to center content */
            align-items: center;
            justify-content: center;
            animation: fadeInModalBackdrop 0.3s ease-out;
        }

        @keyframes fadeInModalBackdrop {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        .modal-dialog {
            position: relative;
            width: auto;
            margin: 0.5rem;
            pointer-events: none;
            max-width: 500px;
            /* Default max width */
            background-color: var(--card-background-color);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
            display: flex;
            flex-direction: column;
            animation: slideInModal 0.3s ease-out;
        }

        @keyframes slideInModal {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal.show .modal-dialog {
            pointer-events: auto;
        }

        .modal-dialog-centered {
            display: flex;
            align-items: center;
            min-height: calc(100% - 1rem);
            /* For vertical centering */
        }

        .modal-content {
            position: relative;
            display: flex;
            flex-direction: column;
            width: 100%;
            pointer-events: auto;
            background-color: var(--card-background-color);
            background-clip: padding-box;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-lg);
            outline: 0;
        }

        .modal-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
        }

        .modal-title {
            margin-bottom: 0;
            line-height: 1.5;
            font-size: 1.25rem;
            font-weight: var(--font-weight-semibold);
        }

        .btn-close {
            /* Custom close button */
            padding: 0.5rem;
            margin: -0.5rem -0.5rem -0.5rem auto;
            background: transparent;
            border: 0;
            font-size: 1.5rem;
            font-weight: var(--font-weight-bold);
            line-height: 1;
            color: var(--muted-foreground-color);
            text-shadow: 0 1px 0 var(--background-color);
            /* Light shadow for depth */
            opacity: 0.75;
            cursor: pointer;
        }

        .btn-close:hover {
            color: var(--foreground-color);
            opacity: 1;
        }

        .modal-body {
            position: relative;
            flex: 1 1 auto;
            padding: 1.5rem;
        }

        .modal-footer {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: flex-end;
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color);
            border-bottom-right-radius: var(--border-radius-lg);
            border-bottom-left-radius: var(--border-radius-lg);
        }

        .modal-footer>* {
            margin: 0.25rem;
        }

        .modal-lg .modal-dialog {
            max-width: 800px;
        }

        .modal-xl .modal-dialog {
            max-width: 1140px;
        }

        /* CAROUSEL STYLES (Native approach) */
        .carousel {
            position: relative;
            overflow: hidden;
            border-radius: var(--border-radius-md);
            /* Match card image radius */
        }

        .carousel-inner {
            position: relative;
            width: 100%;
            display: flex;
            /* Untuk item berdampingan */
            transition: transform 0.6s ease-in-out;
        }

        .carousel-item {
            min-width: 100%;
            /* Setiap item mengambil lebar penuh carousel */
            transition: opacity 0.6s ease-in-out;
            /* Untuk cross-fade jika digunakan */
        }

        .carousel-item img {
            display: block;
            width: 100%;
            height: 200px;
            /* Ketinggian tetap untuk konsistensi */
            object-fit: cover;
        }

        .carousel-control-prev,
        .carousel-control-next {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 5;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 15%;
            padding: 0;
            color: var(--primary-foreground-color);
            text-align: center;
            background: none;
            border: 0;
            opacity: 0.7;
            transition: opacity 0.15s ease;
            cursor: pointer;
        }

        .carousel-control-prev:hover,
        .carousel-control-next:hover {
            opacity: 1;
        }

        .carousel-control-prev {
            left: 0;
        }

        .carousel-control-next {
            right: 0;
        }

        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            background-repeat: no-repeat;
            background-position: 50%;
            background-size: 100% 100%;
            filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.5));
        }

        /* Gunakan SVG atau FontAwesome untuk ikon */
        .carousel-control-prev-icon::before {
            content: '\f053';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
        }

        .carousel-control-next-icon::before {
            content: '\f054';
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
        }

        /* RESPONSIVE SIDEBAR */
        @media (max-width: 991.98px) {

            /* Di bawah large desktop */
            .sidebar {
                transform: translateX(calc(-1 * var(--sidebar-width)));
                /* Sembunyikan di kiri */
            }

            .sidebar.active {
                transform: translateX(0);
                box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
                /* Shadow saat aktif di mobile */
            }

            .main-content {
                width: 100%;
                margin-left: 0;
            }

            .app-navbar {
                left: 0;
                /* Navbar menempati seluruh lebar saat sidebar tersembunyi */
            }

            /* Tidak perlu .main-content.active dan .app-navbar.active lagi, karena sidebar overlay */
            .page-container {
                padding: 1rem;
                /* Padding lebih kecil di mobile */
            }
        }

        /* Additional Apartment Card Styles */
        .apartment-card {
            transition: transform var(--transition-speed-normal) var(--transition-timing-function),
                box-shadow var(--transition-speed-normal) var(--transition-timing-function);
        }

        .apartment-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .apartment-card .card-body {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            /* Agar tombol selalu di bawah */
            min-height: 200px;
            /* Ketinggian minimum agar card seragam */
        }

        .apartment-card .price {
            font-size: 1.2rem;
            font-weight: var(--font-weight-semibold);
            color: var(--primary-color);
        }

        .apartment-card .rating {
            color: #f59e0b;
            /* Warna kuning untuk bintang */
        }

        .apartment-card .rating .fas {
            margin-right: 0.1rem;
        }

        .apartment-card .verified-badge {
            background-color: var(--success-color);
            color: white;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            border-radius: var(--border-radius-sm);
        }

        .apartment-card .virtual-tour-btn {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            background-color: rgba(255, 255, 255, 0.8);
            color: var(--foreground-color);
            border: none;
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
        }

        .apartment-card .virtual-tour-btn:hover {
            background-color: rgba(255, 255, 255, 1);
        }


        /* FOOTER */
        .app-footer {
            text-align: center;
            padding: 1.5rem;
            margin-top: auto;
            /* Mendorong footer ke bawah jika konten pendek */
            font-size: 0.875rem;
            color: var(--muted-foreground-color);
            border-top: 1px solid var(--border-color);
        }
    </style>
</head>

<body>
    <div class="app-wrapper">
        <!-- === SIDEBAR === -->
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <img src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?fit=crop&w=40&h=40&q=80"
                    alt="Logo Aplikasi" class="logo-img rounded-circle me-2">
                <span class="fw-semibold" style="font-size: 1.1rem;">RentalApartment</span>
            </div>
            <ul class="sidebar-nav">
                <li class="sidebar-nav-item active">
                    <a href="#dashboard" class="sidebar-nav-link" data-page="dashboard">
                        <i class="fas fa-chart-pie nav-icon"></i> Dasbor
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="#apartemen" class="sidebar-nav-link" data-page="apartemen">
                        <i class="fas fa-building nav-icon"></i> Apartemen
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="#penyewa" class="sidebar-nav-link" data-page="penyewa">
                        <i class="fas fa-users nav-icon"></i> Penyewa
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="#pemesanan" class="sidebar-nav-link" data-page="pemesanan">
                        <i class="fas fa-calendar-check nav-icon"></i> Pemesanan
                    </a>
                </li>
                <li class="sidebar-nav-item">
                    <a href="#pengaturan" class="sidebar-nav-link" data-page="pengaturan">
                        <i class="fas fa-cog nav-icon"></i> Pengaturan
                    </a>
                </li>
            </ul>
            <div class="app-footer" style="border-top: none; padding: 1rem 1.5rem;">
                <small>&copy; 2024 RentalApartment. Hak Cipta Dilindungi.</small>
            </div>
        </aside>

        <!-- === MAIN CONTENT & NAVBAR === -->
        <div class="main-content" id="mainContent">
            <header class="app-navbar">
                <div class="navbar-left">
                    <button type="button" id="sidebarToggleBtn" class="sidebar-toggle-btn" aria-label="Toggle Sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h1 id="pageTitle" class="fw-semibold" style="font-size: 1.25rem; margin-bottom: 0;">Dasbor</h1>
                </div>
                <div class="navbar-right">
                    <div class="theme-switch-wrapper me-3">
                        <label class="theme-switch" for="themeToggleCheckbox" aria-label="Ganti Tema">
                            <input type="checkbox" id="themeToggleCheckbox">
                            <span class="theme-slider"></span>
                        </label>
                    </div>
                    <div class="dropdown">
                        <a href="#" class="dropdown-toggle" id="userDropdownToggle" aria-expanded="false"
                            aria-label="Menu Pengguna">
                            <img src="https://images.unsplash.com/photo-1633332755192-727a05c4013d?fit=crop&w=36&h=36&q=80"
                                alt="Foto Profil" class="profile-img rounded-circle">
                        </a>
                        <ul class="dropdown-menu shadow" id="userDropdownMenu" aria-labelledby="userDropdownToggle">
                            <li><a class="dropdown-item" href="#">Profil Saya</a></li>
                            <li><a class="dropdown-item" href="#">Notifikasi <span
                                        class="badge bg-danger ms-1">3</span></a></li>
                            <li><a class="dropdown-item" href="#" data-page-link="pengaturan">Pengaturan Akun</a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item" href="#">Keluar</a></li>
                        </ul>
                    </div>
                </div>
            </header>

            <main class="page-container">
                <!-- Konten Halaman Dasbor -->
                <section id="dashboard-content" class="page-section active">
                    <!-- Statistik Ringkasan -->
                    <div class="row">
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-building fa-2x text-primary mb-2"></i>
                                    <h3 class="card-title mb-1">156</h3>
                                    <p class="card-subtitle mb-0">Total Apartemen</p>
                                    <small class="text-success"><i class="fas fa-arrow-up"></i> 12% dari bulan
                                        lalu</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-house-user fa-2x text-info mb-2"></i>
                                    <h3 class="card-title mb-1">132</h3>
                                    <p class="card-subtitle mb-0">Apartemen Terisi</p>
                                    <small class="text-success"><i class="fas fa-arrow-up"></i> 8% dari bulan
                                        lalu</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-dollar-sign fa-2x text-success mb-2"></i>
                                    <h3 class="card-title mb-1">$245,000</h3>
                                    <p class="card-subtitle mb-0">Pendapatan Bulanan</p>
                                    <small class="text-success"><i class="fas fa-arrow-up"></i> 15% dari bulan
                                        lalu</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body text-center">
                                    <i class="fas fa-users fa-2x text-warning mb-2"></i>
                                    <h3 class="card-title mb-1">198</h3>
                                    <p class="card-subtitle mb-0">Total Penyewa Aktif</p>
                                    <small class="text-success"><i class="fas fa-arrow-up"></i> 10% dari bulan
                                        lalu</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Grafik -->
                    <div class="row">
                        <div class="col-lg-8 mb-3">
                            <div class="card h-100">
                                <div class="card-header">Tren Pendapatan Bulanan</div>
                                <div class="card-body">
                                    <canvas id="incomeChart" style="width:100%; max-height:300px;"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-4 mb-3">
                            <div class="card h-100">
                                <div class="card-header">Tingkat Hunian</div>
                                <div class="card-body d-flex justify-content-center align-items-center">
                                    <canvas id="occupancyChart" style="width:100%; max-height:280px;"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Featured Listings di Dashboard -->
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            Unit Unggulan
                            <a href="#" class="btn btn-sm btn-outline-primary" data-page-link="apartemen">Lihat
                                Semua</a>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <div class="card apartment-card h-100">
                                        <div class="carousel" id="carouselFeatured1">
                                            <div class="carousel-inner">
                                                <div class="carousel-item active">
                                                    <img src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
                                                        alt="Apartemen 1">
                                                </div>
                                                <div class="carousel-item">
                                                    <img src="https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
                                                        alt="Apartemen 1 Interior">
                                                </div>
                                            </div>
                                            <button class="carousel-control-prev" type="button"
                                                data-carousel-target="#carouselFeatured1" data-carousel-slide="prev">
                                                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                <span class="visually-hidden">Sebelumnya</span>
                                            </button>
                                            <button class="carousel-control-next" type="button"
                                                data-carousel-target="#carouselFeatured1" data-carousel-slide="next">
                                                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                <span class="visually-hidden">Berikutnya</span>
                                            </button>
                                            <button class="btn btn-sm virtual-tour-btn"
                                                data-modal-target="#virtualTourModal">
                                                <i class="fas fa-vr-cardboard"></i> Tur Virtual
                                            </button>
                                        </div>
                                        <div class="card-body">
                                            <div>
                                                <div class="d-flex justify-content-between align-items-start mb-1">
                                                    <h5 class="card-title mb-0">Studio Mewah Pusat Kota</h5>
                                                    <span class="verified-badge">Terverifikasi</span>
                                                </div>
                                                <p class="card-text text-muted small mb-2"><i
                                                        class="fas fa-map-marker-alt me-1"></i> Jakarta Pusat</p>
                                                <p class="card-text small">Studio modern dengan pemandangan kota dan
                                                    fasilitas lengkap.</p>
                                            </div>
                                            <div class="mt-auto">
                                                <div class="d-flex justify-content-between align-items-center mt-2">
                                                    <p class="price mb-0">$1,200/bulan</p>
                                                    <div class="rating">
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star"></i>
                                                        <i class="fas fa-star-half-alt"></i>
                                                        <span class="small ms-1">(4.8)</span>
                                                    </div>
                                                </div>
                                                <button class="btn btn-primary w-100 mt-2">Lihat Detail</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Tambah 2 card apartemen unggulan lainnya -->
                                <div class="col-md-4 mb-3">
                                    <div class="card apartment-card h-100">
                                        <img src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
                                            class="card-img-top" alt="Apartemen 2"
                                            style="height: 200px; object-fit: cover;">
                                        <div class="card-body">
                                            <div>
                                                <h5 class="card-title">Apartemen 2 Kamar Tidur</h5>
                                                <p class="card-text text-muted small mb-2"><i
                                                        class="fas fa-map-marker-alt me-1"></i> Surabaya Barat</p>
                                                <p class="card-text small">Nyaman untuk keluarga, dekat pusat
                                                    perbelanjaan.</p>
                                            </div>
                                            <div class="mt-auto">
                                                <div class="d-flex justify-content-between align-items-center mt-2">
                                                    <p class="price mb-0">$950/bulan</p>
                                                    <div class="rating"><i class="fas fa-star"></i><i
                                                            class="fas fa-star"></i><i class="fas fa-star"></i><i
                                                            class="fas fa-star"></i><i class="far fa-star"></i> <span
                                                            class="small ms-1">(4.2)</span></div>
                                                </div>
                                                <button class="btn btn-primary w-100 mt-2">Lihat Detail</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="card apartment-card h-100">
                                        <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGFwYXJ0bWVudHxlbnwwfHwwfHx8MA&auto=format&fit=crop&w=500&q=60"
                                            class="card-img-top" alt="Apartemen 3"
                                            style="height: 200px; object-fit: cover;">
                                        <div class="card-body">
                                            <div>
                                                <h5 class="card-title">Penthouse Eksklusif</h5>
                                                <p class="card-text text-muted small mb-2"><i
                                                        class="fas fa-map-marker-alt me-1"></i> Bali, Seminyak</p>
                                                <p class="card-text small">Pemandangan laut, kolam renang pribadi,
                                                    layanan premium.</p>
                                            </div>
                                            <div class="mt-auto">
                                                <div class="d-flex justify-content-between align-items-center mt-2">
                                                    <p class="price mb-0">$3,500/bulan</p>
                                                    <div class="rating"><i class="fas fa-star"></i><i
                                                            class="fas fa-star"></i><i class="fas fa-star"></i><i
                                                            class="fas fa-star"></i><i class="fas fa-star"></i> <span
                                                            class="small ms-1">(5.0)</span></div>
                                                </div>
                                                <button class="btn btn-primary w-100 mt-2">Lihat Detail</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Aktivitas Terbaru -->
                    <div class="card">
                        <div class="card-header">Aktivitas Terbaru</div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Aktivitas</th>
                                            <th>Pengguna</th>
                                            <th>Status</th>
                                            <th>Tanggal</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Pemesanan Baru #APT1234</td>
                                            <td>John Smith</td>
                                            <td><span class="badge bg-success">Terkonfirmasi</span></td>
                                            <td>2024-07-15</td>
                                            <td><button class="btn btn-sm btn-outline-primary">Lihat</button></td>
                                        </tr>
                                        <tr>
                                            <td>Permintaan Pemeliharaan #SRV5678</td>
                                            <td>Emma Wilson</td>
                                            <td><span class="badge bg-warning">Tertunda</span></td>
                                            <td>2024-07-14</td>
                                            <td><button class="btn btn-sm btn-outline-primary">Proses</button></td>
                                        </tr>
                                        <tr>
                                            <td>Update Data Penyewa #USR9012</td>
                                            <td>Michael Brown</td>
                                            <td><span class="badge bg-info">Selesai</span></td>
                                            <td>2024-07-13</td>
                                            <td><button class="btn btn-sm btn-outline-primary">Detail</button></td>
                                        </tr>
                                        <tr>
                                            <td>Pembayaran Diterima #PAY4321</td>
                                            <td>Sarah Davis</td>
                                            <td><span class="badge bg-success">Lunas</span></td>
                                            <td>2024-07-12</td>
                                            <td><button class="btn btn-sm btn-outline-primary">Kwitansi</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Konten Halaman Apartemen -->
                <section id="apartemen-content" class="page-section">
                    <div class="card mb-4">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            Manajemen Apartemen
                            <button class="btn btn-primary"><i class="fas fa-plus me-1"></i> Tambah Apartemen
                                Baru</button>
                        </div>
                        <div class="card-body">
                            <h5 class="card-title mb-3">Pencarian & Filter Lanjutan</h5>
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-search"></i></span>
                                        <input type="text" class="form-control"
                                            placeholder="Cari nama atau ID apartemen...">
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                        <input type="text" class="form-control"
                                            placeholder="Lokasi (cth: Jakarta Selatan)">
                                        <button class="btn btn-outline-primary" type="button"
                                            data-modal-target="#mapModal">
                                            <i class="fas fa-map"></i> Peta
                                        </button>
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <select class="form-select">
                                        <option selected>Semua Tipe Apartemen</option>
                                        <option value="studio">Studio</option>
                                        <option value="1br">1 Kamar Tidur</option>
                                        <option value="2br">2 Kamar Tidur</option>
                                        <option value="3br+">3+ Kamar Tidur</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <div class="input-group">
                                        <span class="input-group-text">Rp</span>
                                        <input type="number" class="form-control" placeholder="Harga Min">
                                        <span class="input-group-text">-</span>
                                        <input type="number" class="form-control" placeholder="Harga Max">
                                    </div>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <select class="form-select">
                                        <option selected>Status Ketersediaan</option>
                                        <option value="tersedia">Tersedia</option>
                                        <option value="terisi">Terisi</option>
                                        <option value="maintenance">Dalam Perawatan</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3 d-flex align-items-end">
                                    <button class="btn btn-primary w-100"><i class="fas fa-filter me-1"></i> Terapkan
                                        Filter</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">Daftar Apartemen (250 Unit)</div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" aria-label="Pilih semua apartemen"></th>
                                            <th>ID Unit</th>
                                            <th>Nama Apartemen</th>
                                            <th>Lokasi</th>
                                            <th>Tipe</th>
                                            <th>Harga/Bulan</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><input type="checkbox" aria-label="Pilih apartemen JKT-S001"></td>
                                            <td>JKT-S001</td>
                                            <td>The Residence One</td>
                                            <td>Jakarta Selatan</td>
                                            <td>Studio</td>
                                            <td>Rp 8.500.000</td>
                                            <td><span class="badge bg-success">Tersedia</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Nonaktifkan"
                                                    style="color: var(--danger-color); border-color: var(--danger-color);"><i
                                                        class="fas fa-trash-alt"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><input type="checkbox" aria-label="Pilih apartemen BDG-2B012"></td>
                                            <td>BDG-2B012</td>
                                            <td>Bandung Heights Tower A</td>
                                            <td>Bandung Kota</td>
                                            <td>2 Kamar Tidur</td>
                                            <td>Rp 12.000.000</td>
                                            <td><span class="badge bg-info">Terisi</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Nonaktifkan"
                                                    style="color: var(--danger-color); border-color: var(--danger-color);"><i
                                                        class="fas fa-trash-alt"></i></button>
                                            </td>
                                        </tr>
                                        <!-- Tambahkan lebih banyak baris data apartemen -->
                                        <tr>
                                            <td><input type="checkbox" aria-label="Pilih apartemen SBY-P005"></td>
                                            <td>SBY-P005</td>
                                            <td>Surabaya View Penthouse</td>
                                            <td>Surabaya Timur</td>
                                            <td>Penthouse</td>
                                            <td>Rp 25.000.000</td>
                                            <td><span class="badge bg-warning">Perawatan</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Nonaktifkan"
                                                    style="color: var(--danger-color); border-color: var(--danger-color);"><i
                                                        class="fas fa-trash-alt"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!-- Navigasi Paginasi -->
                            <nav aria-label="Navigasi halaman" class="mt-3 d-flex justify-content-center">
                                <ul class="pagination" style="list-style: none; display: flex; padding-left:0;">
                                    <li class="page-item disabled me-1"><a class="btn btn-sm btn-outline-primary"
                                            href="#">Sebelumnya</a></li>
                                    <li class="page-item active me-1"><a class="btn btn-sm btn-primary" href="#">1</a>
                                    </li>
                                    <li class="page-item me-1"><a class="btn btn-sm btn-outline-primary" href="#">2</a>
                                    </li>
                                    <li class="page-item me-1"><a class="btn btn-sm btn-outline-primary" href="#">3</a>
                                    </li>
                                    <li class="page-item me-1"><span
                                            class="btn btn-sm btn-outline-primary disabled">...</span></li>
                                    <li class="page-item me-1"><a class="btn btn-sm btn-outline-primary" href="#">10</a>
                                    </li>
                                    <li class="page-item"><a class="btn btn-sm btn-outline-primary"
                                            href="#">Berikutnya</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>

                <!-- Konten Halaman Penyewa -->
                <section id="penyewa-content" class="page-section">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            Manajemen Penyewa
                            <button class="btn btn-primary"><i class="fas fa-user-plus me-1"></i> Tambah Penyewa
                                Baru</button>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <input type="text" class="form-control" placeholder="Cari nama penyewa atau ID...">
                                </div>
                                <div class="col-md-3">
                                    <select class="form-select">
                                        <option selected>Status Akun</option>
                                        <option value="aktif">Aktif</option>
                                        <option value="nonaktif">Nonaktif</option>
                                        <option value="pending">Menunggu Verifikasi</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-primary w-100"><i class="fas fa-search me-1"></i>
                                        Cari</button>
                                </div>
                            </div>
                            <p>Ini adalah halaman untuk mengelola data penyewa apartemen. Anda dapat melihat daftar
                                penyewa, menambah, mengubah, atau menghapus data penyewa.</p>
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>ID Penyewa</th>
                                            <th>Nama Lengkap</th>
                                            <th>Email</th>
                                            <th>No. Telepon</th>
                                            <th>Status</th>
                                            <th>Tanggal Bergabung</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>PNY-001</td>
                                            <td>Budi Santoso</td>
                                            <td>budi.s@example.com</td>
                                            <td>081234567890</td>
                                            <td><span class="badge bg-success">Aktif</span></td>
                                            <td>2023-01-15</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>PNY-002</td>
                                            <td>Citra Lestari</td>
                                            <td>citra.l@example.com</td>
                                            <td>082345678901</td>
                                            <td><span class="badge bg-warning">Menunggu Pembayaran</span></td>
                                            <td>2024-06-20</td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i class="fas fa-eye"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                            </td>
                                        </tr>
                                        <!-- Tambahkan lebih banyak baris data penyewa -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Konten Halaman Pemesanan -->
                <section id="pemesanan-content" class="page-section">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            Manajemen Pemesanan
                            <button class="btn btn-primary"><i class="fas fa-plus-circle me-1"></i> Buat Pemesanan
                                Baru</button>
                        </div>
                        <div class="card-body">
                            <p>Ini adalah halaman untuk mengelola data pemesanan apartemen. Anda dapat melihat daftar
                                pemesanan, status, dan detailnya.</p>
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>ID Pesanan</th>
                                            <th>Nama Penyewa</th>
                                            <th>ID Unit</th>
                                            <th>Tanggal Check-in</th>
                                            <th>Tanggal Check-out</th>
                                            <th>Total Biaya</th>
                                            <th>Status Pembayaran</th>
                                            <th>Status Pesanan</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ORD-00123</td>
                                            <td>Ahmad Dahlan</td>
                                            <td>JKT-S001</td>
                                            <td>2024-08-01</td>
                                            <td>2025-07-31</td>
                                            <td>Rp 102.000.000</td>
                                            <td><span class="badge bg-success">Lunas</span></td>
                                            <td><span class="badge bg-info">Aktif</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i
                                                        class="fas fa-file-invoice-dollar"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>ORD-00124</td>
                                            <td>Rina Mariana</td>
                                            <td>BDG-2B012</td>
                                            <td>2024-09-15</td>
                                            <td>2024-12-14</td>
                                            <td>Rp 36.000.000</td>
                                            <td><span class="badge bg-warning">Belum Lunas</span></td>
                                            <td><span class="badge bg-success">Dikonfirmasi</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline-primary btn-icon"
                                                    title="Lihat Detail"><i
                                                        class="fas fa-file-invoice-dollar"></i></button>
                                                <button class="btn btn-sm btn-outline-primary btn-icon" title="Edit"><i
                                                        class="fas fa-edit"></i></button>
                                            </td>
                                        </tr>
                                        <!-- Tambahkan data pemesanan -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Konten Halaman Pengaturan -->
                <section id="pengaturan-content" class="page-section">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">Pengaturan Profil</div>
                                <div class="card-body">
                                    <form>
                                        <div class="mb-3">
                                            <label for="profileName" class="form-label">Nama Lengkap</label>
                                            <input type="text" class="form-control" id="profileName"
                                                value="Admin RentalApartment">
                                        </div>
                                        <div class="mb-3">
                                            <label for="profileEmail" class="form-label">Alamat Email</label>
                                            <input type="email" class="form-control" id="profileEmail"
                                                value="admin@rentalapartment.com">
                                        </div>
                                        <div class="mb-3">
                                            <label for="profileAvatar" class="form-label">Foto Profil</label>
                                            <input type="file" class="form-control" id="profileAvatar">
                                        </div>
                                        <button type="submit" class="btn btn-primary">Simpan Perubahan Profil</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">Pengaturan Aplikasi</div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Tema Aplikasi</label>
                                        <div class="theme-switch-wrapper d-flex align-items-center">
                                            <span class="me-2">Mode Terang</span>
                                            <label class="theme-switch" for="themeToggleCheckboxPage">
                                                <input type="checkbox" id="themeToggleCheckboxPage">
                                                <span class="theme-slider"></span>
                                            </label>
                                            <span class="ms-2">Mode Gelap</span>
                                        </div>
                                    </div>
                                    <div class="mb-3">
                                        <label for="appLanguage" class="form-label">Bahasa</label>
                                        <select class="form-select" id="appLanguage">
                                            <option value="id" selected>Bahasa Indonesia</option>
                                            <option value="en">English</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label class="form-label">Notifikasi Email</label>
                                        <div>
                                            <input type="checkbox" id="emailNotifBooking" class="form-check-input me-1"
                                                checked>
                                            <label for="emailNotifBooking" class="form-check-label">Pemesanan
                                                baru</label>
                                        </div>
                                        <div>
                                            <input type="checkbox" id="emailNotifMaintenance"
                                                class="form-check-input me-1">
                                            <label for="emailNotifMaintenance" class="form-check-label">Permintaan
                                                perawatan</label>
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-primary">Simpan Pengaturan Aplikasi</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <footer class="app-footer">
                    RentalApartment - Solusi Manajemen Properti Anda &copy; <span id="currentYear"></span>.
                </footer>
            </main>
        </div>
    </div>

    <!-- Modal Peta Lokasi -->
    <div class="modal" id="mapModal" tabindex="-1" aria-labelledby="mapModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="mapModalLabel">Pilih Lokasi dari Peta</h5>
                    <button type="button" class="btn-close" data-modal-dismiss="mapModal" aria-label="Tutup"></button>
                </div>
                <div class="modal-body">
                    <div id="mapPlaceholder"
                        style="height: 400px; background-color: #e9e9e9; display:flex; align-items:center; justify-content:center; border-radius: var(--border-radius-md);">
                        <p>Integrasi peta (misalnya Leaflet.js atau Google Maps API) akan muncul di sini.</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-modal-dismiss="mapModal">Batal</button>
                    <button type="button" class="btn btn-primary">Pilih Lokasi Ini</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Tur Virtual -->
    <div class="modal" id="virtualTourModal" tabindex="-1" aria-labelledby="virtualTourModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="virtualTourModalLabel">Tur Virtual Apartemen</h5>
                    <button type="button" class="btn-close" data-modal-dismiss="virtualTourModal"
                        aria-label="Tutup"></button>
                </div>
                <div class="modal-body">
                    <div id="virtualTourPlaceholder"
                        style="height: 70vh; background-color: #333; color: white; display:flex; align-items:center; justify-content:center; border-radius: var(--border-radius-md);">
                        <p>Konten tur virtual 360° (misalnya menggunakan Pannellum atau viewer sejenis) akan dimuat di
                            sini.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Menggunakan Chart.js dari CDN untuk grafik, bisa di-host sendiri -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        // Script Aplikasi Native Monolith
        // Dibungkus dalam IIFE untuk menghindari polusi global scope
        (function () {
            'use strict';

            // === STATE APLIKASI ===
            const AppState = {
                currentPageId: 'dashboard-content', // Halaman default
                currentTheme: localStorage.getItem('theme') || 'light',
                isSidebarOpen: window.innerWidth > 991.98, // Buka jika layar lebar
                chartInstances: {} // Untuk menyimpan instance chart
            };

            // === ELEMENT CACHING (UTILITIES SEDERHANA) ===
            const $ = (selector) => document.querySelector(selector);
            const $$ = (selector) => document.querySelectorAll(selector);

            const DOM = {
                html: document.documentElement,
                body: document.body,
                sidebar: $('#sidebar'),
                mainContent: $('#mainContent'),
                appNavbar: $('.app-navbar'),
                sidebarToggleBtn: $('#sidebarToggleBtn'),
                themeToggleCheckbox: $('#themeToggleCheckbox'),
                themeToggleCheckboxPage: $('#themeToggleCheckboxPage'), // Toggle di halaman pengaturan
                userDropdownToggle: $('#userDropdownToggle'),
                userDropdownMenu: $('#userDropdownMenu'),
                sidebarNavLinks: $$('.sidebar-nav-link'),
                pageSections: $$('.page-section'),
                pageTitle: $('#pageTitle'),
                currentYearSpan: $('#currentYear'),
                // Modals
                mapModal: $('#mapModal'),
                virtualTourModal: $('#virtualTourModal'),
            };

            // === PENGELOLA TEMA ===
            const ThemeManager = {
                init: () => {
                    ThemeManager.applyTheme(AppState.currentTheme);
                    if (DOM.themeToggleCheckbox) {
                        DOM.themeToggleCheckbox.checked = AppState.currentTheme === 'dark';
                        DOM.themeToggleCheckbox.addEventListener('change', ThemeManager.handleToggle);
                    }
                    if (DOM.themeToggleCheckboxPage) {
                        DOM.themeToggleCheckboxPage.checked = AppState.currentTheme === 'dark';
                        DOM.themeToggleCheckboxPage.addEventListener('change', ThemeManager.handleToggle);
                    }
                },
                applyTheme: (theme) => {
                    DOM.html.setAttribute('data-theme', theme);
                    AppState.currentTheme = theme;
                    localStorage.setItem('theme', theme);
                    // Sinkronkan kedua checkbox jika ada
                    if (DOM.themeToggleCheckbox) DOM.themeToggleCheckbox.checked = (theme === 'dark');
                    if (DOM.themeToggleCheckboxPage) DOM.themeToggleCheckboxPage.checked = (theme === 'dark');

                    // Update chart colors if charts exist
                    ChartManager.updateChartThemes();
                },
                handleToggle: (event) => {
                    const newTheme = event.target.checked ? 'dark' : 'light';
                    ThemeManager.applyTheme(newTheme);
                }
            };

            // === PENGELOLA SIDEBAR ===
            const SidebarManager = {
                init: () => {
                    if (DOM.sidebarToggleBtn) {
                        DOM.sidebarToggleBtn.addEventListener('click', SidebarManager.toggle);
                    }
                    // Atur state awal berdasarkan AppState.isSidebarOpen
                    if (AppState.isSidebarOpen) {
                        DOM.sidebar.classList.add('active');
                    } else {
                        DOM.sidebar.classList.remove('active');
                    }
                    SidebarManager.adjustLayoutBasedOnSidebarState(); // Sesuaikan layout awal
                },
                toggle: () => {
                    AppState.isSidebarOpen = !AppState.isSidebarOpen;
                    DOM.sidebar.classList.toggle('active', AppState.isSidebarOpen);
                    SidebarManager.adjustLayoutBasedOnSidebarState();
                },
                adjustLayoutBasedOnSidebarState: () => {
                    // Hanya relevan untuk layar besar dimana sidebar tidak overlay
                    if (window.innerWidth > 991.98) {
                        if (AppState.isSidebarOpen) {
                            // DOM.mainContent.style.marginLeft = 'var(--sidebar-width)';
                            // DOM.mainContent.style.width = 'calc(100% - var(--sidebar-width))';
                            // DOM.appNavbar.style.left = 'var(--sidebar-width)';
                            // DOM.appNavbar.style.width = 'calc(100% - var(--sidebar-width))';
                            // Menggunakan class untuk lebih mudah (sudah dihandle CSS)
                        } else {
                            // DOM.mainContent.style.marginLeft = '0';
                            // DOM.mainContent.style.width = '100%';
                            // DOM.appNavbar.style.left = '0';
                            // DOM.appNavbar.style.width = '100%';
                            // Menggunakan class untuk lebih mudah (sudah dihandle CSS)
                        }
                    } else { // Untuk layar kecil, sidebar overlay, jadi reset style main content
                        // DOM.mainContent.style.marginLeft = '0';
                        // DOM.mainContent.style.width = '100%';
                        // DOM.appNavbar.style.left = '0';
                        // DOM.appNavbar.style.width = '100%';
                        // Menggunakan class untuk lebih mudah (sudah dihandle CSS)
                    }
                },
                closeOnMobileIfNeeded: () => {
                    if (window.innerWidth <= 991.98 && AppState.isSidebarOpen) {
                        SidebarManager.toggle();
                    }
                }
            };

            // === PENGELOLA NAVIGASI (SPA) ===
            const NavigationManager = {
                init: () => {
                    DOM.sidebarNavLinks.forEach(link => {
                        link.addEventListener('click', NavigationManager.handleNavClick);
                    });

                    // Handle link internal di konten yang menunjuk ke halaman lain
                    DOM.body.addEventListener('click', (event) => {
                        const pageLink = event.target.closest('[data-page-link]');
                        if (pageLink) {
                            event.preventDefault();
                            const pageId = pageLink.dataset.pageLink;
                            NavigationManager.navigateTo(pageId);
                        }
                    });

                    // Inisialisasi halaman berdasarkan hash atau default
                    const initialPageId = window.location.hash.substring(1) || AppState.currentPageId.replace('-content', '');
                    NavigationManager.navigateTo(initialPageId, true); // true untuk tidak push state
                },
                handleNavClick: (event) => {
                    event.preventDefault();
                    const pageId = event.currentTarget.dataset.page;
                    NavigationManager.navigateTo(pageId);
                    SidebarManager.closeOnMobileIfNeeded();
                },
                navigateTo: (pageId, isInitialLoad = false) => {
                    const targetPageIdContent = `${pageId}-content`;
                    const targetPageElement = $(`#${targetPageIdContent}`);

                    if (!targetPageElement) {
                        console.warn(`Halaman dengan ID "${targetPageIdContent}" tidak ditemukan.`);
                        // Fallback ke dashboard jika halaman tidak ada
                        if (pageId !== 'dashboard') NavigationManager.navigateTo('dashboard');
                        return;
                    }

                    // Sembunyikan semua section
                    DOM.pageSections.forEach(section => section.classList.remove('active'));

                    // Tampilkan section yang dituju
                    targetPageElement.classList.add('active');
                    AppState.currentPageId = targetPageIdContent;

                    // Update judul halaman
                    const activeLink = $(`a.sidebar-nav-link[data-page="${pageId}"]`);
                    if (DOM.pageTitle && activeLink) {
                        DOM.pageTitle.textContent = activeLink.textContent.trim();
                    } else if (DOM.pageTitle) {
                        // Handle jika navigasi dari non-sidebar link (misal user dropdown ke pengaturan)
                        const pageName = pageId.charAt(0).toUpperCase() + pageId.slice(1);
                        DOM.pageTitle.textContent = pageName;
                    }


                    // Update active state di sidebar
                    DOM.sidebarNavLinks.forEach(link => {
                        link.parentElement.classList.remove('active');
                        if (link.dataset.page === pageId) {
                            link.parentElement.classList.add('active');
                            // Set aria-current for accessibility
                            DOM.sidebarNavLinks.forEach(l => l.removeAttribute('aria-current'));
                            link.setAttribute('aria-current', 'page');
                        }
                    });

                    // Update URL hash (kecuali initial load jika sudah sesuai)
                    if (!isInitialLoad || window.location.hash !== `#${pageId}`) {
                        window.location.hash = pageId;
                    }

                    // Scroll ke atas halaman
                    DOM.mainContent.scrollTop = 0;
                }
            };

            // === PENGELOLA DROPDOWN ===
            const DropdownManager = {
                init: () => {
                    if (DOM.userDropdownToggle && DOM.userDropdownMenu) {
                        DOM.userDropdownToggle.addEventListener('click', DropdownManager.toggleUserDropdown);
                        // Menutup dropdown jika klik di luar
                        document.addEventListener('click', (event) => {
                            if (!DOM.userDropdownToggle.contains(event.target) && !DOM.userDropdownMenu.contains(event.target)) {
                                DOM.userDropdownMenu.classList.remove('show');
                                DOM.userDropdownToggle.setAttribute('aria-expanded', 'false');
                            }
                        });
                    }
                },
                toggleUserDropdown: (event) => {
                    event.preventDefault();
                    event.stopPropagation(); // Mencegah penutupan langsung oleh event listener dokumen
                    const isShown = DOM.userDropdownMenu.classList.toggle('show');
                    DOM.userDropdownToggle.setAttribute('aria-expanded', isShown.toString());
                }
            };

            // === PENGELOLA MODAL ===
            const ModalManager = {
                init: () => {
                    // Buka modal
                    $$('[data-modal-target]').forEach(button => {
                        button.addEventListener('click', () => {
                            const modalId = button.dataset.modalTarget;
                            const modalElement = $(modalId);
                            if (modalElement) ModalManager.show(modalElement);
                        });
                    });

                    // Tutup modal
                    $$('[data-modal-dismiss]').forEach(button => {
                        button.addEventListener('click', () => {
                            const modalElement = button.closest('.modal');
                            if (modalElement) ModalManager.hide(modalElement);
                        });
                    });

                    // Tutup modal saat klik backdrop
                    $$('.modal').forEach(modalElement => {
                        modalElement.addEventListener('click', (event) => {
                            if (event.target === modalElement) { // Hanya jika klik pada .modal itu sendiri (backdrop)
                                ModalManager.hide(modalElement);
                            }
                        });
                    });
                    // Tutup modal dengan tombol Escape
                    document.addEventListener('keydown', (event) => {
                        if (event.key === 'Escape') {
                            const openModal = $('.modal.show');
                            if (openModal) {
                                ModalManager.hide(openModal);
                            }
                        }
                    });
                },
                show: (modalElement) => {
                    modalElement.classList.add('show');
                    modalElement.setAttribute('aria-hidden', 'false');
                    DOM.body.style.overflow = 'hidden'; // Mencegah scroll body saat modal terbuka
                    // Fokus ke elemen pertama yang bisa difokus di dalam modal jika ada
                    const focusableElements = modalElement.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
                    if (focusableElements.length > 0) {
                        focusableElements[0].focus();
                    }
                },
                hide: (modalElement) => {
                    modalElement.classList.remove('show');
                    modalElement.setAttribute('aria-hidden', 'true');
                    DOM.body.style.overflow = ''; // Kembalikan scroll body
                }
            };

            // === PENGELOLA CAROUSEL NATIVE ===
            const CarouselManager = {
                init: () => {
                    $$('.carousel').forEach(carouselElement => {
                        const carouselId = carouselElement.id;
                        if (!carouselId) {
                            console.warn('Carousel detected without an ID. Please assign a unique ID for it to function.');
                            return;
                        }
                        const inner = carouselElement.querySelector('.carousel-inner');
                        const items = carouselElement.querySelectorAll('.carousel-item');
                        const prevButton = carouselElement.querySelector('[data-carousel-slide="prev"]');
                        const nextButton = carouselElement.querySelector('[data-carousel-slide="next"]');
                        let currentIndex = 0;
                        const totalItems = items.length;

                        if (!inner || !items.length) return;

                        function goToSlide(index) {
                            if (index < 0) index = totalItems - 1;
                            else if (index >= totalItems) index = 0;

                            inner.style.transform = `translateX(-${index * 100}%)`;
                            items.forEach((item, i) => item.classList.toggle('active', i === index));
                            currentIndex = index;
                        }

                        if (prevButton) {
                            prevButton.addEventListener('click', () => {
                                goToSlide(currentIndex - 1);
                            });
                        }
                        if (nextButton) {
                            nextButton.addEventListener('click', () => {
                                goToSlide(currentIndex + 1);
                            });
                        }
                        // Inisialisasi slide pertama
                        goToSlide(0);
                    });
                }
            };


            // === PENGELOLA GRAFIK (CHART.JS) ===
            const ChartManager = {
                init: () => {
                    ChartManager.createIncomeChart();
                    ChartManager.createOccupancyChart();
                    // Panggil update tema untuk chart setelah chart dibuat
                    ChartManager.updateChartThemes();
                },
                getChartColors: () => {
                    const isDark = AppState.currentTheme === 'dark';
                    return {
                        gridColor: isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)',
                        ticksColor: isDark ? '#adb5bd' : '#495057', // Warna untuk label sumbu
                        legendColor: isDark ? '#f8f9fa' : '#212529', // Warna untuk legenda
                        primaryDatasetColor: 'rgba(0, 112, 243, 0.8)', // --primary-color (opacity 0.8)
                        primaryDatasetBorderColor: 'rgba(0, 112, 243, 1)', // --primary-color
                        secondaryDatasetColor: 'rgba(238, 242, 255, 0.8)', // --accent-color (opacity 0.8)
                        secondaryDatasetBorderColor: 'rgba(37, 99, 235, 1)', // --accent-foreground-color
                    };
                },
                createIncomeChart: () => {
                    const ctx = document.getElementById('incomeChart');
                    if (!ctx) return;
                    const colors = ChartManager.getChartColors();

                    AppState.chartInstances.incomeChart = new Chart(ctx.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
                            datasets: [{
                                label: 'Pendapatan (dalam ribuan $)',
                                data: [150, 170, 190, 180, 200, 210, 230, 220, 240, 250, 245, 260],
                                backgroundColor: colors.primaryDatasetColor,
                                borderColor: colors.primaryDatasetBorderColor,
                                borderWidth: 2,
                                tension: 0.4, // Membuat garis lebih melengkung
                                fill: true,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    grid: { color: colors.gridColor },
                                    ticks: { color: colors.ticksColor }
                                },
                                x: {
                                    grid: { display: false }, // Sembunyikan grid X agar lebih bersih
                                    ticks: { color: colors.ticksColor }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'top',
                                    labels: { color: colors.legendColor }
                                },
                                tooltip: {
                                    mode: 'index',
                                    intersect: false,
                                    titleColor: AppState.currentTheme === 'dark' ? '#fff' : '#000',
                                    bodyColor: AppState.currentTheme === 'dark' ? '#fff' : '#000',
                                    backgroundColor: AppState.currentTheme === 'dark' ? 'rgba(0,0,0,0.7)' : 'rgba(255,255,255,0.9)',
                                    borderColor: AppState.currentTheme === 'dark' ? 'rgba(255,255,255,0.2)' : 'rgba(0,0,0,0.2)',
                                    borderWidth: 1,
                                }
                            },
                            interaction: {
                                mode: 'nearest',
                                axis: 'x',
                                intersect: false
                            }
                        }
                    });
                },
                createOccupancyChart: () => {
                    const ctx = document.getElementById('occupancyChart');
                    if (!ctx) return;
                    const colors = ChartManager.getChartColors();

                    AppState.chartInstances.occupancyChart = new Chart(ctx.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: ['Terisi (132 unit)', 'Kosong (24 unit)'],
                            datasets: [{
                                label: 'Tingkat Hunian',
                                data: [132, 24], // 132 / (132+24) = 84.6%
                                backgroundColor: [
                                    colors.primaryDatasetColor,
                                    colors.secondaryDatasetColor,
                                ],
                                borderColor: [
                                    colors.primaryDatasetBorderColor,
                                    colors.secondaryDatasetBorderColor,
                                ],
                                borderWidth: 1
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { color: colors.legendColor }
                                },
                                tooltip: {
                                    titleColor: AppState.currentTheme === 'dark' ? '#fff' : '#000',
                                    bodyColor: AppState.currentTheme === 'dark' ? '#fff' : '#000',
                                    backgroundColor: AppState.currentTheme === 'dark' ? 'rgba(0,0,0,0.7)' : 'rgba(255,255,255,0.9)',
                                }
                            }
                        }
                    });
                },
                updateChartThemes: () => {
                    const colors = ChartManager.getChartColors();
                    for (const chartName in AppState.chartInstances) {
                        const chart = AppState.chartInstances[chartName];
                        if (chart) {
                            // Update warna umum
                            chart.options.scales.y.grid.color = colors.gridColor;
                            chart.options.scales.y.ticks.color = colors.ticksColor;
                            if (chart.options.scales.x) { // Tidak semua chart punya sumbu X (misal doughnut)
                                chart.options.scales.x.ticks.color = colors.ticksColor;
                                chart.options.scales.x.grid.color = colors.gridColor; // atau display:false
                            }
                            chart.options.plugins.legend.labels.color = colors.legendColor;
                            chart.options.plugins.tooltip.titleColor = AppState.currentTheme === 'dark' ? '#fff' : '#000';
                            chart.options.plugins.tooltip.bodyColor = AppState.currentTheme === 'dark' ? '#fff' : '#000';
                            chart.options.plugins.tooltip.backgroundColor = AppState.currentTheme === 'dark' ? 'rgba(0,0,0,0.7)' : 'rgba(255,255,255,0.9)';

                            // Update warna dataset spesifik
                            chart.data.datasets.forEach((dataset, index) => {
                                if (chart.config.type === 'line') {
                                    dataset.backgroundColor = colors.primaryDatasetColor;
                                    dataset.borderColor = colors.primaryDatasetBorderColor;
                                } else if (chart.config.type === 'doughnut' || chart.config.type === 'pie') {
                                    // Untuk doughnut/pie, biasanya warna per slice diatur saat pembuatan
                                    // Tapi jika ingin merubahnya secara dinamis berdasarkan tema juga bisa:
                                    dataset.backgroundColor = [colors.primaryDatasetColor, colors.secondaryDatasetColor, '#anotherColorForDark', '#etc'];
                                    dataset.borderColor = [colors.primaryDatasetBorderColor, colors.secondaryDatasetBorderColor, '#anotherBorderDark', '#etc'];
                                }
                            });
                            chart.update();
                        }
                    }
                }
            };

            // === INISIALISASI APLIKASI ===
            const initApp = () => {
                if (DOM.currentYearSpan) {
                    DOM.currentYearSpan.textContent = new Date().getFullYear();
                }
                ThemeManager.init();
                SidebarManager.init();
                NavigationManager.init();
                DropdownManager.init();
                ModalManager.init();
                CarouselManager.init(); // Inisialisasi carousel setelah DOM siap
                ChartManager.init(); // Inisialisasi chart

                // Listener untuk resize window (misalnya untuk sidebar)
                window.addEventListener('resize', () => {
                    // Update status sidebar jika layar berubah ukuran melintasi breakpoint
                    const shouldSidebarBeOpen = window.innerWidth > 991.98;
                    if (AppState.isSidebarOpen !== shouldSidebarBeOpen && window.innerWidth > 991.98) { //Hanya update jika melewati breakpoint
                        AppState.isSidebarOpen = shouldSidebarBeOpen;
                        DOM.sidebar.classList.toggle('active', AppState.isSidebarOpen);
                    }
                    SidebarManager.adjustLayoutBasedOnSidebarState();
                });

                // Handle navigasi back/forward browser
                window.addEventListener('popstate', () => {
                    const pageIdFromHash = window.location.hash.substring(1);
                    if (pageIdFromHash) {
                        NavigationManager.navigateTo(pageIdFromHash, true); // true untuk isInitialLoad/noPushState
                    } else {
                        // Jika hash kosong, kembali ke halaman default (misalnya dashboard)
                        NavigationManager.navigateTo('dashboard', true);
                    }
                });

                console.log("Aplikasi RentalApartment berhasil dimuat dengan arsitektur SPA Monolith Native.");
            };

            // Tunggu hingga DOM sepenuhnya dimuat sebelum menjalankan skrip utama
            document.addEventListener('DOMContentLoaded', initApp);

        })();
    </script>
</body>

</html>