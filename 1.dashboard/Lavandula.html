<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rentelindo - Penyewaan Apartemen</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Design System */
    :root {
      --color-primary: hsl(200, 85%, 45%);
      --color-primary-dark: hsl(200, 85%, 35%);
      --color-secondary: hsl(160, 60%, 45%);
      --color-background: hsl(0, 0%, 98%);
      --color-foreground: hsl(200, 20%, 20%);
      --color-border: hsl(200, 20%, 80%);
      --space-1: clamp(0.25rem, 0.2rem + 0.1vw, 0.375rem);
      --space-2: clamp(0.5rem, 0.4rem + 0.2vw, 0.75rem);
      --space-3: clamp(1rem, 0.8rem + 0.5vw, 1.5rem);
      --space-4: clamp(1.5rem, 1.2rem + 0.8vw, 2.25rem);
      --space-5: clamp(2rem, 1.6rem + 1vw, 3rem);
      --radius-sm: 0.25rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --shadow-sm: 0 4px 6px -2px rgba(0,0,0,0.05);
      --shadow-md: 0 6px 12px -2px rgba(0,0,0,0.1);
      --transition: all 0.2s ease-in-out;
      --font-family: 'Inter', sans-serif;
    }

    /* Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: var(--font-family); background: var(--color-background); color: var(--color-foreground); line-height: 1.6; }
    a { text-decoration: none; color: inherit; }
    button, input, select, textarea { font-family: inherit; outline: none; }

    /* Custom Utilities */
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .flex-center { justify-content: center; align-items: center; }
    .justify-between { justify-content: space-between; }
    .items-center { align-items: center; }
    .gap-1 { gap: var(--space-1); }
    .gap-2 { gap: var(--space-2); }
    .gap-3 { gap: var(--space-3); }
    .gap-4 { gap: var(--space-4); }
    .m-1 { margin: var(--space-1); }
    .m-2 { margin: var(--space-2); }
    .m-3 { margin: var(--space-3); }
    .mt-1 { margin-top: var(--space-1); }
    .mt-2 { margin-top: var(--space-2); }
    .mt-3 { margin-top: var(--space-3); }
    .mt-4 { margin-top: var(--space-4); }
    .mb-2 { margin-bottom: var(--space-2); }
    .mb-3 { margin-bottom: var(--space-3); }
    .mb-4 { margin-bottom: var(--space-4); }
    .p-2 { padding: var(--space-2); }
    .p-3 { padding: var(--space-3); }
    .p-4 { padding: var(--space-4); }
    .w-full { width: 100%; }
    .text-primary { color: var(--color-primary); }
    .text-sm { font-size: 0.875rem; }
    .text-lg { font-size: 1.25rem; }
    .font-bold { font-weight: 700; }
    .rounded-sm { border-radius: var(--radius-sm); }
    .rounded-md { border-radius: var(--radius-md); }
    .shadow-sm { box-shadow: var(--shadow-sm); }
    .shadow-md { box-shadow: var(--shadow-md); }
    .transition { transition: var(--transition); }
    .hidden { display: none; }
    .fade-in { opacity: 0; transform: translateY(10px); transition: all 0.5s ease-out; }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    /* Layout */
    .container { max-width: 1200px; margin: 0 auto; padding: var(--space-3); }
    .grid { display: grid; gap: var(--space-3); }
    .grid-2 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: repeat(3, 1fr); }
    .grid-auto { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }

    /* Navigation */
    .navbar {
      background: #fff;
      padding: var(--space-3);
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: var(--shadow-sm);
    }
    .nav-brand { font-size: 1.5rem; font-weight: 700; color: var(--color-primary); }
    .nav-links { display: flex; gap: var(--space-3); list-style: none; }
    .nav-link { font-weight: 500; cursor: pointer; position: relative; padding-bottom: var(--space-1); }
    .nav-link:hover::after, .nav-link.active::after {
      content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background: var(--color-primary);
    }

    /* Buttons */
    .btn {
      background: var(--color-primary);
      color: #fff;
      padding: var(--space-2) var(--space-3);
      border-radius: var(--radius-md);
      font-weight: 500;
      cursor: pointer;
      border: none;
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
      transition: var(--transition);
    }
    .btn:hover { background: var(--color-primary-dark); transform: translateY(-2px); }
    .btn-outline {
      background: transparent;
      border: 1px solid var(--color-border);
      color: var(--color-foreground);
    }
    .btn-outline:hover { border-color: var(--color-primary); color: var(--color-primary); }

    /* Card */
    .card {
      background: #fff;
      border-radius: var(--radius-md);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }
    .card:hover { transform: translateY(-5px); box-shadow: var(--shadow-md); }
    .card img { width: 100%; height: 180px; object-fit: cover; }
    .card figcaption { padding: var(--space-3); }
    .card h3 { font-size: 1.1rem; margin-bottom: var(--space-2); display: flex; align-items: center; gap: var(--space-2); }
    .card-details { display: flex; justify-content: space-between; margin-bottom: var(--space-2); }
    .card-price { color: var(--color-primary); font-weight: 600; }
    .card-location { display: flex; align-items: center; gap: var(--space-1); }
    .card-features { display: flex; flex-wrap: wrap; gap: var(--space-2); color: hsl(200, 20%, 40%); }
    details { padding: var(--space-3); border-top: 1px solid var(--color-border); }
    summary { cursor: pointer; color: var(--color-primary); font-weight: 500; }
    quote { display: block; font-style: italic; margin: var(--space-2) 0; border-left: 3px solid var(--color-primary); padding-left: var(--space-2); }

    /* Search Form */
    .search-form { background: #fff; padding: var(--space-4); border-radius: var(--radius-md); box-shadow: var(--shadow-sm); }
    .filter-group { margin-bottom: var(--space-3); }
    .filter-group label { display: block; font-weight: 500; margin-bottom: var(--space-2); }
    .filter-group input, .filter-group select { padding: var(--space-2); border: 1px solid var(--color-border); border-radius: var(--radius-sm); width: 100%; }
    .map-canvas { width: 100%; height: 250px; background: hsl(200, 20%, 95%); border-radius: var(--radius-md); }

    /* Calendar */
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: var(--space-1); }
    .calendar-day { padding: var(--space-2); text-align: center; border-radius: var(--radius-sm); cursor: pointer; }
    .calendar-day.available { background: var(--color-secondary); color: #fff; }
    .calendar-day.booked { background: hsl(30, 80%, 50%); color: #fff; cursor: not-allowed; }
    .calendar-day.selected { background: var(--color-primary); color: #fff; }

    /* Gallery */
    .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: var(--space-2); }
    .gallery img { width: 100%; height: 120px; object-fit: cover; border-radius: var(--radius-md); transition: transform 0.3s; }
    .gallery img:hover { transform: scale(1.05); }
    .virtual-tour { position: relative; overflow: hidden; }
    .virtual-tour img { transition: transform 0.5s ease; }
    .virtual-tour:hover img { transform: rotate(3deg) scale(1.1); }

    /* Chat */
    .chat-window { height: 250px; overflow-y: auto; border: 1px solid var(--color-border); padding: var(--space-2); border-radius: var(--radius-md); }
    .chat-message { margin-bottom: var(--space-2); padding: var(--space-2); border-radius: var(--radius-sm); }
    .chat-message.sent { background: var(--color-primary); color: #fff; margin-left: 20%; }
    .chat-message.received { background: hsl(200, 20%, 95%); margin-right: 20%; }

    /* Payment */
    .payment-methods { display: flex; gap: var(--space-2); }
    .payment-method { padding: var(--space-2); border: 1px solid var(--color-border); border-radius: var(--radius-sm); cursor: pointer; }
    .payment-method.selected { border-color: var(--color-primary); background: hsl(200, 85%, 95%); }

    /* Cost Breakdown */
    .cost-breakdown { background: #fff; padding: var(--space-3); border-radius: var(--radius-md); margin-top: var(--space-3); }
    .cost-line { display: flex; justify-content: space-between; margin-bottom: var(--space-2); }
    .total { font-weight: bold; font-size: 1.1rem; }

    /* Escrow */
    .escrow-info { background: hsl(60, 80%, 95%); padding: var(--space-2); border-left: 4px solid hsl(60, 80%, 50%); margin: var(--space-3) 0; }

    /* Chatbox */
    .chatbox {
      position: fixed;
      bottom: 70px;
      right: var(--space-3);
      background: #fff;
      width: 280px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      display: none;
      flex-direction: column;
      height: 350px;
    }
    .chat-header {
      background: var(--color-primary);
      color: #fff;
      padding: var(--space-2);
      border-top-left-radius: var(--radius-md);
      border-top-right-radius: var(--radius-md);
    }
    .chat-body { flex: 1; overflow-y: auto; padding: var(--space-2); }
    .chat-input { display: flex; padding: var(--space-2); border-top: 1px solid var(--color-border); }
    .chat-input input { flex: 1; padding: var(--space-2); border: 1px solid var(--color-border); border-right: none; border-radius: var(--radius-sm) 0 0 var(--radius-sm); }
    .chat-input button { padding: var(--space-2); background: var(--color-primary); color: #fff; border: none; border-radius: 0 var(--radius-sm) var(--radius-sm) 0; }

    /* Loyalty */
    .loyalty-badge {
      background: hsl(30, 80%, 50%);
      color: #fff;
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-sm);
      font-size: 0.8rem;
    }

    /* Report Form */
    .report-form { background: #fff; padding: var(--space-3); border-radius: var(--radius-md); margin-top: var(--space-3); }
    .report-form textarea { resize: vertical; min-height: 80px; }

    /* Responsive */
    @media (max-width: 1024px) {
      .grid-3 { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .navbar { flex-direction: column; gap: var(--space-3); }
      .nav-links { flex-direction: column; align-items: center; }
      .grid-3, .grid-2 { grid-template-columns: 1fr; }
      .search-form { grid-template-columns: 1fr; }
      .chatbox { width: 90%; }
      .card { padding: calc(var(--space-3) / 1.5); }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) { * { transition-duration: 0.01ms !important; } }
    [tabindex="0"]:focus, button:focus, input:focus, select:focus, textarea:focus {
      outline: 2px solid var(--color-primary);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <header class="container">
    <nav class="navbar flex items-center justify-between">
      <div class="nav-brand">Rentelindo</div>
      <ul class="nav-links">
        <li><span class="nav-link active" data-page="home">Beranda</span></li>
        <li><span class="nav-link" data-page="search">Pencarian</span></li>
        <li><span class="nav-link" data-page="profile">Profil</span></li>
        <li><span class="nav-link" data-page="support">Dukungan</span></li>
      </ul>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- Home Page -->
    <section id="home" class="page fade-in">
      <h1 class="text-center mt-4">Temukan Apartemen Impian Anda</h1>
      <p class="text-center mb-4">Sewa apartemen modern dengan fasilitas premium</p>

      <!-- Quick Search -->
      <form class="search-form grid-3 mb-4">
        <div class="filter-group">
          <label for="quick-location">Lokasi</label>
          <input type="text" id="quick-location" placeholder="Masukkan kota atau area" aria-label="Cari lokasi">
        </div>
        <div class="filter-group">
          <label for="quick-checkin">Check-in</label>
          <input type="date" id="quick-checkin" aria-label="Tanggal check-in">
        </div>
        <div class="filter-group">
          <label for="quick-checkout">Check-out</label>
          <input type="date" id="quick-checkout" aria-label="Tanggal check-out">
        </div>
        <button type="submit" class="btn mt-3"><span class="material-icons">search</span>Cari</button>
      </form>

      <!-- Featured Properties -->
      <h2 class="mt-4">Properti Unggulan</h2>
      <div class="grid grid-auto mb-4">
        <figure class="card">
          <img src="https://source.unsplash.com/random/600x400/?apartment" alt="Luxury Penthouse" loading="lazy">
          <figcaption>
            <h3>Luxury Penthouse <span class="material-icons" title="Pemilik Terverifikasi">verified</span></h3>
            <div class="card-details">
              <span class="card-price">$2,500/bln</span>
              <span class="card-location"><i class="material-icons">location_on</i> Jakarta Pusat</span>
            </div>
            <div class="card-features">
              <span><i class="material-icons">hotel</i> 3 BR</span>
              <span><i class="material-icons">square_foot</i> 2000 sqft</span>
              <span><i class="material-icons">pool</i> Kolam</span>
            </div>
            <quote>"Pemandangan kota yang luar biasa!"</quote>
          </figcaption>
          <details>
            <summary>Detail Lebih Lanjut</summary>
            <p>Apartemen premium dengan gym dan keamanan 24/7.</p>
            <button class="btn" onclick="navigateToDetail(1)">Lihat Detail</button>
          </details>
        </figure>
        <figure class="card">
          <img src="https://source.unsplash.com/random/600x400/?modern-apartment" alt="Modern Studio" loading="lazy">
          <figcaption>
            <h3>Modern Studio <span class="material-icons" title="Pemilik Terverifikasi">verified</span></h3>
            <div class="card-details">
              <span class="card-price">$1,200/bln</span>
              <span class="card-location"><i class="material-icons">location_on</i> Jakarta Selatan</span>
            </div>
            <div class="card-features">
              <span><i class="material-icons">hotel</i> Studio</span>
              <span><i class="material-icons">square_foot</i> 500 sqft</span>
              <span><i class="material-icons">wifi</i> WiFi</span>
            </div>
            <quote>"Cocok untuk profesional muda!"</quote>
          </figcaption>
          <details>
            <summary>Detail Lebih Lanjut</summary>
            <p>Studio modern dengan akses mudah ke pusat kota.</p>
            <button class="btn" onclick="navigateToDetail(2)">Lihat Detail</button>
          </details>
        </figure>
        <figure class="card">
          <img src="https://source.unsplash.com/random/600x400/?condo" alt="Family Apartment" loading="lazy">
          <figcaption>
            <h3>Family Apartment <span class="material-icons" title="Pemilik Terverifikasi">verified</span></h3>
            <div class="card-details">
              <span class="card-price">$1,800/bln</span>
              <span class="card-location"><i class="material-icons">location_on</i> Jakarta Barat</span>
            </div>
            <div class="card-features">
              <span><i class="material-icons">hotel</i> 2 BR</span>
              <span><i class="material-icons">square_foot</i> 1200 sqft</span>
              <span><i class="material-icons">local_parking</i> Parkir</span>
            </div>
            <quote>"Nyaman untuk keluarga!"</quote>
          </figcaption>
          <details>
            <summary>Detail Lebih Lanjut</summary>
            <p>Apartemen luas dengan fasilitas lengkap.</p>
            <button class="btn" onclick="navigateToDetail(3)">Lihat Detail</button>
          </details>
        </figure>
      </div>

      <!-- Testimonials -->
      <h2 class="mt-4">Testimoni</h2>
      <div class="grid grid-auto">
        <div class="card p-3">
          <quote>"Proses pemesanan sangat mudah!"</quote>
          <p>- Ani W.</p>
        </div>
        <div class="card p-3">
          <quote>"Apartemen bersih dan nyaman!"</quote>
          <p>- Budi S.</p>
        </div>
      </div>
    </section>

    <!-- Search Page -->
    <section id="search" class="page fade-in hidden">
      <h1 class="mt-4">Cari Apartemen</h1>
      <div class="grid-2">
        <div>
          <form class="search-form">
            <div class="filter-group">
              <label>Lokasi</label>
              <canvas class="map-canvas" id="searchMap" aria-label="Peta interaktif"></canvas>
              <input type="range" min="1" max="10" value="5" id="radiusSlider" aria-label="Filter radius">
              <p>Radius: <span id="radiusValue">5</span> km</p>
            </div>
            <div class="filter-group">
              <label>Tanggal</label>
              <div class="calendar" id="searchCalendar" role="grid" aria-label="Kalender ketersediaan"></div>
            </div>
            <div class="filter-group">
              <label>Rentang Harga</label>
              <input type="range" min="500" max="5000" value="2500" id="priceSlider" aria-label="Filter harga">
              <p>Maks: $<span id="priceValue">2500</span></p>
            </div>
            <div class="filter-group">
              <label>Fasilitas</label>
              <div class="flex-col gap-2">
                <label><input type="checkbox" value="pool"> Kolam Renang</label>
                <label><input type="checkbox" value="gym"> Gym</label>
                <label><input type="checkbox" value="wifi"> WiFi</label>
                <label><input type="checkbox" value="parking"> Parkir</label>
                <label><input type="checkbox" value="ac"> AC</label>
                <label><input type="checkbox" value="laundry"> Laundry</label>
              </div>
            </div>
            <div class="filter-group">
              <label for="apartment-type">Tipe Apartemen</label>
              <select id="apartment-type">
                <option value="">Semua Tipe</option>
                <option value="studio">Studio</option>
                <option value="1br">1 Kamar</option>
                <option value="2br">2 Kamar</option>
                <option value="penthouse">Penthouse</option>
                <option value="family">Keluarga</option>
              </select>
            </div>
            <button type="submit" class="btn mt-3"><span class="material-icons">filter_alt</span>Filter</button>
          </form>
        </div>
        <div>
          <h2 class="mt-4">Hasil Pencarian</h2>
          <div class="grid grid-auto" id="searchResults"></div>
        </div>
      </div>
    </section>

    <!-- Apartment Detail Page -->
    <section id="apartment" class="page fade-in hidden">
      <h1 id="apartment-title" class="mt-4"></h1>
      <div class="gallery mb-4">
        <div class="virtual-tour">
          <img src="https://source.unsplash.com/random/600x400/?apartment,interior" alt="Tur Virtual">
        </div>
        <img src="https://source.unsplash.com/random/300x200/?bedroom" alt="Kamar Tidur">
        <img src="https://source.unsplash.com/random/300x200/?kitchen" alt="Dapur">
        <img src="https://source.unsplash.com/random/300x200/?living-room" alt="Ruang Tamu">
      </div>
      <div class="grid-2">
        <div>
          <h2 class="mt-3">Detail</h2>
          <p>Harga: <span id="apartment-price"></span></p>
          <p>Lokasi: <span id="apartment-location"></span></p>
          <p>Fasilitas: <span id="apartment-amenities"></span></p>
          <canvas class="map-canvas" id="apartmentMap" aria-label="Peta lokasi"></canvas>
          <h3 class="mt-3">Ulasan</h3>
          <div id="apartment-reviews"></div>
          <form class="report-form hidden" id="report-form">
            <h3>Laporkan Masalah</h3>
            <div class="filter-group">
              <label for="report-reason">Alasan</label>
              <textarea id="report-reason" placeholder="Jelaskan masalah"></textarea>
            </div>
            <button type="submit" class="btn">Kirim Laporan</button>
            <button type="button" class="btn btn-outline" onclick="hideReportForm()">Batal</button>
          </form>
        </div>
        <div>
          <h2 class="mt-3">Pesan Sekarang</h2>
          <form class="booking-form">
            <div class="filter-group">
              <label for="book-checkin">Check-in</label>
              <input type="date" id="book-checkin" required>
            </div>
            <div class="filter-group">
              <label for="book-checkout">Check-out</label>
              <input type="date" id="book-checkout" required>
            </div>
            <div class="filter-group">
              <label for="guests">Tamu</label>
              <input type="number" id="guests" min="1" value="1" required>
            </div>
            <div class="filter-group">
              <label>Metode Pembayaran</label>
              <div class="payment-methods">
                <div class="payment-method" data-method="credit" tabindex="0">Kartu Kredit</div>
                <div class="payment-method" data-method="bank" tabindex="0">Transfer Bank</div>
                <div class="payment-method" data-method="ewallet" tabindex="0">E-Wallet</div>
              </div>
            </div>
            <div class="filter-group">
              <label><input type="checkbox" id="insurance"> Tambah Asuransi (+10%)</label>
            </div>
            <div class="cost-breakdown hidden" id="cost-breakdown">
              <h3>Rincian Biaya</h3>
              <div class="cost-line"><span>Sewa</span><span id="base-cost"></span></div>
              <div class="cost-line"><span>Biaya Layanan</span><span id="service-cost"></span></div>
              <div class="cost-line"><span>Asuransi</span><span id="insurance-cost"></span></div>
              <div class="cost-line total"><span>Total</span><span id="total-cost"></span></div>
            </div>
            <p class="escrow-info">Pembayaran aman melalui sistem escrow.</p>
            <button type="submit" class="btn"><span class="material-icons">book</span>Pesan</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Profile Page -->
    <section id="profile" class="page fade-in hidden">
      <h1 class="mt-4">Profil Pengguna</h1>
      <div class="grid-2">
        <div class="card p-3">
          <h2>Informasi Akun</h2>
          <p>Nama: Ani Wulandari</p>
          <p>Email: ani@example.com</p>
          <p>Poin Loyalitas: <span class="loyalty-badge">100</span></p>
          <button class="btn btn-outline mt-2">Edit Profil</button>
        </div>
        <div class="card p-3">
          <h2>Pesan</h2>
          <div class="chat-window" id="chatWindow">
            <div class="chat-message sent">Apakah unit tersedia?</div>
            <div class="chat-message received">Ya, tersedia!</div>
          </div>
          <input type="text" id="chatInput" placeholder="Ketik pesan...">
          <button class="btn mt-2" onclick="sendMessage()">Kirim</button>
        </div>
      </div>
      <h2 class="mt-4">Riwayat Pemesanan</h2>
      <div class="grid grid-auto" id="booking-history"></div>
      <h2 class="mt-4">Notifikasi</h2>
      <div class="card p-3">
        <p>Pengingat: Check-in dalam 3 hari.</p>
      </div>
    </section>

    <!-- Support Page -->
    <section id="support" class="page fade-in hidden">
      <h1 class="mt-4">Dukungan Pelanggan</h1>
      <div class="grid-3">
        <div class="card p-3">
          <h2>Live Chat</h2>
          <button class="btn" onclick="openChat()">Mulai Chat</button>
        </div>
        <div class="card p-3">
          <h2>Email</h2>
          <p><a href="mailto:support@rentelindo.com">support@rentelindo.com</a></p>
        </div>
        <div class="card p-3">
          <h2>Telepon</h2>
          <p><a href="tel:+628001234567">+62-800-123-4567</a></p>
        </div>
      </div>
    </section>
  </main>

  <!-- Chatbox -->
  <button class="btn" id="chatBtn" style="position: fixed; bottom: 20px; right: 20px;" aria-label="Buka chat">
    <span class="material-icons">chat</span>
  </button>
  <div class="chatbox" id="chatbox">
    <div class="chat-header">Dukungan Pelanggan</div>
    <div class="chat-body" id="chatBody">
      <div class="chat-message system">Selamat datang! Bagaimana kami bisa membantu?</div>
    </div>
    <div class="chat-input">
      <input type="text" id="supportChatInput" placeholder="Ketik pesan...">
      <button onclick="sendSupportMessage()">Kirim</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center p-4" style="background: var(--color-foreground); color: #fff;">
    <p>© 2025 Rentelindo. Hak cipta dilindungi.</p>
  </footer>

  <script>
    // Mock Data
    const apartments = [
      {
        id: 1,
        title: 'Luxury Penthouse',
        price: 2500,
        location: 'Jakarta Pusat',
        bedrooms: 3,
        sqft: 2000,
        type: 'penthouse',
        amenities: ['pool', 'gym', 'wifi', 'parking', 'ac'],
        images: [
          'https://source.unsplash.com/random/600x400/?apartment',
          'https://source.unsplash.com/random/300x200/?bedroom',
          'https://source.unsplash.com/random/300x200/?kitchen',
          'https://source.unsplash.com/random/300x200/?living-room'
        ],
        description: 'Apartemen premium dengan pemandangan kota.',
        reviews: [
          { user: 'Budi', comment: 'Pemandangan luar biasa!', rating: 5 },
          { user: 'Siti', comment: 'Fasilitas lengkap.', rating: 4 }
        ],
        bookedDates: []
      },
      {
        id: 2,
        title: 'Modern Studio',
        price: 1200,
        location: 'Jakarta Selatan',
        bedrooms: 0,
        sqft: 500,
        type: 'studio',
        amenities: ['wifi', 'ac', 'laundry'],
        images: [
          'https://source.unsplash.com/random/600x400/?modern-apartment',
          'https://source.unsplash.com/random/300x200/?living-room',
          'https://source.unsplash.com/random/300x200/?bathroom'
        ],
        description: 'Studio modern untuk profesional.',
        reviews: [
          { user: 'Ani', comment: 'Lokasi strategis!', rating: 4 }
        ],
        bookedDates: ['2025-06-01', '2025-06-02']
      },
      {
        id: 3,
        title: 'Family Apartment',
        price: 1800,
        location: 'Jakarta Barat',
        bedrooms: 2,
        sqft: 1200,
        type: 'family',
        amenities: ['parking', 'ac', 'laundry'],
        images: [
          'https://source.unsplash.com/random/600x400/?condo',
          'https://source.unsplash.com/random/300x200/?bedroom',
          'https://source.unsplash.com/random/300x200/?kitchen'
        ],
        description: 'Apartemen luas untuk keluarga.',
        reviews: [
          { user: 'Dedi', comment: 'Nyaman untuk keluarga!', rating: 5 }
        ],
        bookedDates: []
      }
    ];

    // Router
    const router = {
      init() {
        window.addEventListener('hashchange', () => this.handleRoute());
        window.addEventListener('load', () => this.handleRoute());
        document.querySelectorAll('.nav-link').forEach(link => {
          link.addEventListener('click', () => this.showPage(link.dataset.page));
        });
      },
      handleRoute() {
        const hash = window.location.hash.slice(1) || 'home';
        this.showPage(hash);
      },
      showPage(pageId) {
        document.querySelectorAll('.page').forEach(page => {
          page.classList.toggle('hidden', page.id !== pageId);
        });
        document.querySelectorAll('.nav-link').forEach(link => {
          link.classList.toggle('active', link.dataset.page === pageId);
        });
        window.scrollTo({ top: 0, behavior: 'smooth' });
        loadDynamicContent(pageId);
      }
    };
    router.init();

    // Navigate to Detail
    function navigateToDetail(id) {
      localStorage.setItem('selectedApartment', id);
      router.showPage('apartment');
    }

    // Dynamic Content
    function loadDynamicContent(pageId) {
      switch (pageId) {
        case 'search':
          renderSearchResults();
          break;
        case 'apartment':
          renderApartmentDetails();
          break;
        case 'profile':
          renderBookingHistory();
          break;
      }
    }

    // Fade Animation
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) entry.target.classList.add('visible');
      });
    }, { threshold: 0.1 });
    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // Search and Filter
    const searchForm = document.querySelector('.search-form');
    const searchResults = document.getElementById('searchResults');
    const radiusSlider = document.getElementById('radiusSlider');
    const radiusValue = document.getElementById('radiusValue');
    const priceSlider = document.getElementById('priceSlider');
    const priceValue = document.getElementById('priceValue');

    radiusSlider.addEventListener('input', () => {
      radiusValue.textContent = radiusSlider.value;
      renderSearchResults();
    });
    priceSlider.addEventListener('input', () => {
      priceValue.textContent = priceSlider.value;
      renderSearchResults();
    });

    function renderSearchResults() {
      const location = document.querySelector('#quick-location')?.value.toLowerCase() || '';
      const price = parseInt(priceSlider.value);
      const amenities = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const type = document.querySelector('#apartment-type').value;
      const checkin = document.querySelector('#quick-checkin')?.value;
      const checkout = document.querySelector('#quick-checkout')?.value;

      const results = apartments.filter(apartment => {
        const isDateAvailable = !checkin || !checkout || !apartment.bookedDates.some(date => {
          const booked = new Date(date);
          const start = new Date(checkin);
          const end = new Date(checkout);
          return booked >= start && booked <= end;
        });

        return (
          (!location || apartment.location.toLowerCase().includes(location)) &&
          apartment.price <= price &&
          (!amenities.length || amenities.every(amenity => apartment.amenities.includes(amenity))) &&
          (!type || apartment.type === type) &&
          isDateAvailable
        );
      });

      searchResults.innerHTML = results.map(apartment => `
        <figure class="card">
          <img src="${apartment.images[0]}" alt="${apartment.title}" loading="lazy">
          <figcaption>
            <h3>${apartment.title} <span class="material-icons" title="Pemilik Terverifikasi">verified</span></h3>
            <div class="card-details">
              <span class="card-price">$${apartment.price}/bln</span>
              <span class="card-location"><i class="material-icons">location_on</i> ${apartment.location}</span>
            </div>
            <div class="card-features">
              <span><i class="material-icons">hotel</i> ${apartment.bedrooms || 'Studio'} BR</span>
              <span><i class="material-icons">square_foot</i> ${apartment.sqft} sqft</span>
            </div>
            <quote>"${apartment.reviews[0]?.comment || 'Tempat luar biasa!'}"</quote>
          </figcaption>
          <details>
            <summary>Detail Lebih Lanjut</summary>
            <p>${apartment.description}</p>
            <button class="btn" onclick="navigateToDetail(${apartment.id})">Lihat Detail</button>
          </details>
        </figure>
      `).join('') || '<p class="text-center">Tidak ada hasil.</p>';
    }

    searchForm.addEventListener('submit', e => {
      e.preventDefault();
      router.showPage('search');
      renderSearchResults();
    });

    // Calendar
    function renderCalendar(containerId, checkin = null, checkout = null) {
      const calendar = document.getElementById(containerId);
      const today = new Date();
      const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
      const days = Array(daysInMonth).fill().map((_, i) => {
        const date = new Date(today.getFullYear(), today.getMonth(), i + 1);
        const dateStr = date.toISOString().split('T')[0];
        const isBooked = apartments.some(a => a.bookedDates.includes(dateStr));
        return {
          day: i + 1,
          date: dateStr,
          status: isBooked ? 'booked' : 'available',
          selected: dateStr === checkin || dateStr === checkout
        };
      });

      calendar.innerHTML = days.map(day => `
        <div class="calendar-day ${day.status} ${day.selected ? 'selected' : ''}" 
             data-date="${day.date}" 
             onclick="selectCalendarDate('${containerId}', '${day.date}', ${day.status === 'booked'})">
          ${day.day}
        </div>
      `).join('');
    }

    function selectCalendarDate(containerId, date, isBooked) {
      if (isBooked) return;
      const checkinInput = document.getElementById('book-checkin') || document.getElementById('quick-checkin');
      const checkoutInput = document.getElementById('book-checkout') || document.getElementById('quick-checkout');

      if (!checkinInput.value || (checkinInput.value && checkoutInput.value)) {
        checkinInput.value = date;
        checkoutInput.value = '';
      } else if (new Date(date) > new Date(checkinInput.value)) {
        checkoutInput.value = date;
      } else {
        checkinInput.value = date;
        checkoutInput.value = '';
      }

      renderCalendar(containerId, checkinInput.value, checkoutInput.value);
    }

    renderCalendar('searchCalendar');

    // Map Simulation
    function drawMap(canvasId, interactive = false) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = 'hsl(200, 20%, 95%)';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = 'hsl(160, 60%, 45%)';
      ctx.beginPath();
      ctx.arc(canvas.width / 2, canvas.height / 2, 15, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = 'hsl(200, 85%, 45%)';
      ctx.fillRect(canvas.width / 2 - 8, canvas.height / 2 - 30, 16, 16);

      if (interactive) {
        canvas.addEventListener('click', e => {
          const rect = canvas.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;
          ctx.fillStyle = '#ff0000';
          ctx.beginPath();
          ctx.arc(x, y, 5, 0, Math.PI * 2);
          ctx.fill();
        });
      }
    }
    drawMap('searchMap', true);
    drawMap('apartmentMap');

    // Apartment Details
    function renderApartmentDetails() {
      const id = parseInt(localStorage.getItem('selectedApartment'));
      const apartment = apartments.find(a => a.id === id);
      if (!apartment) {
        document.getElementById('apartment').innerHTML = '<p class="text-center">Apartemen tidak ditemukan.</p>';
        return;
      }

      document.getElementById('apartment-title').textContent = apartment.title;
      document.getElementById('apartment-price').textContent = `$${apartment.price}/bln`;
      document.getElementById('apartment-location').textContent = apartment.location;
      document.getElementById('apartment-amenities').textContent = apartment.amenities.join(', ');

      const gallery = document.querySelector('.gallery');
      gallery.innerHTML = `
        <div class="virtual-tour">
          <img src="${apartment.images[0]}" alt="Tur Virtual" loading="lazy">
        </div>
        ${apartment.images.slice(1).map(img => `<img src="${img}" alt="Interior" loading="lazy">`).join('')}
      `;

      document.getElementById('apartment-reviews').innerHTML = apartment.reviews.map(review => `
        <div class="card p-3">
          <quote>"${review.comment}"</quote>
          <p>- ${review.user} (${review.rating}/5)</p>
          <span class="material-icons" onclick="showReportForm(${review.user})" tabindex="0">report</span>
        </div>
      `).join('');
    }

    // Booking Form
    const bookingForm = document.querySelector('.booking-form');
    bookingForm.addEventListener('submit', e => {
      e.preventDefault();
      const checkin = document.getElementById('book-checkin').value;
      const checkout = document.getElementById('book-checkout').value;
      const guests = document.getElementById('guests').value;
      const insurance = document.getElementById('insurance').checked;
      const paymentMethod = document.querySelector('.payment-method.selected')?.dataset.method;
      const id = parseInt(localStorage.getItem('selectedApartment'));
      const apartment = apartments.find(a => a.id === id);

      if (!checkin || !checkout || !paymentMethod) {
        alert('Lengkapi semua field!');
        return;
      }

      const days = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
      if (days <= 0) {
        alert('Tanggal check-out harus setelah check-in.');
        return;
      }

      const isBooked = apartment.bookedDates.some(date => {
        const booked = new Date(date);
        const start = new Date(checkin);
        const end = new Date(checkout);
        return booked >= start && booked <= end;
      });

      if (isBooked) {
        alert('Tanggal sudah dipesan!');
        return;
      }

      const baseCost = apartment.price * days;
      const serviceFee = baseCost * 0.05;
      const insuranceFee = insurance ? baseCost * 0.1 : 0;
      const total = baseCost + serviceFee + insuranceFee;

      document.getElementById('base-cost').textContent = `$${baseCost.toLocaleString()}`;
      document.getElementById('service-cost').textContent = `$${serviceFee.toLocaleString()}`;
      document.getElementById('insurance-cost').textContent = `$${insuranceFee.toLocaleString()}`;
      document.getElementById('total-cost').textContent = `$${total.toLocaleString()}`;
      document.getElementById('cost-breakdown').classList.remove('hidden');

      const currentDate = new Date(checkin);
      const endDate = new Date(checkout);
      while (currentDate <= endDate) {
        apartment.bookedDates.push(currentDate.toISOString().split('T')[0]);
        currentDate.setDate(currentDate.getDate() + 1);
      }

      updateBookingHistory(apartment, checkin, checkout, total);
      alert(`Pemesanan untuk ${guests} tamu berhasil!`);
    });

    // Payment Method
    document.querySelectorAll('.payment-method').forEach(method => {
      method.addEventListener('click', () => {
        document.querySelectorAll('.payment-method').forEach(m => m.classList.remove('selected'));
        method.classList.add('selected');
      });
      method.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') method.click();
      });
    });

    // Chat System
    function sendMessage() {
      const input = document.getElementById('chatInput');
      const window = document.getElementById('chatWindow');
      if (input.value.trim()) {
        window.innerHTML += `<div class="chat-message sent">${input.value}</div>`;
        input.value = '';
        window.scrollTop = window.scrollHeight;
        setTimeout(() => {
          window.innerHTML += `<div class="chat-message received">Terima kasih! Kami akan balas segera.</div>`;
          window.scrollTop = window.scrollHeight;
        }, 1000);
      }
    }

    function sendSupportMessage() {
      const input = document.getElementById('supportChatInput');
      const body = document.getElementById('chatBody');
      if (input.value.trim()) {
        body.innerHTML += `<div class="chat-message system">${input.value}</div>`;
        input.value = '';
        body.scrollTop = body.scrollHeight;
        setTimeout(() => {
          body.innerHTML += `<div class="chat-message system">Kami akan segera membantu!</div>`;
          body.scrollTop = body.scrollHeight;
        }, 1000);
      }
    }

    document.getElementById('supportChatInput').addEventListener('keypress', e => {
      if (e.key === 'Enter') sendSupportMessage();
    });

    // Report Form
    function showReportForm(user) {
      const form = document.getElementById('report-form');
      form.classList.remove('hidden');
      form.onsubmit = e => {
        e.preventDefault();
        const reason = document.getElementById('report-reason').value;
        if (reason.trim()) {
          alert(`Laporan untuk ${user} dikirim!`);
          form.classList.add('hidden');
          document.getElementById('report-reason').value = '';
        }
      };
    }

    function hideReportForm() {
      document.getElementById('report-form').classList.add('hidden');
    }

    // Chatbox
    function openChat() {
      const chatbox = document.getElementById('chatbox');
      chatbox.style.display = 'flex';
      document.getElementById('supportChatInput').focus();
    }

    document.getElementById('chatBtn').addEventListener('click', () => {
      const chatbox = document.getElementById('chatbox');
      chatbox.style.display = chatbox.style.display === 'flex' ? 'none' : 'flex';
    });

    // Booking History
    let bookingHistory = JSON.parse(localStorage.getItem('bookingHistory')) || [];

    function updateBookingHistory(apartment, checkin, checkout, total) {
      bookingHistory.push({
        title: apartment.title,
        checkin,
        checkout,
        total: total.toLocaleString()
      });
      localStorage.setItem('bookingHistory', JSON.stringify(bookingHistory));
      renderBookingHistory();
    }

    function renderBookingHistory() {
      const history = document.getElementById('booking-history');
      history.innerHTML = bookingHistory.map(booking => `
        <div class="card p-3">
          <h3>${booking.title}</h3>
          <p>Check-in: ${booking.checkin}</p>
          <p>Check-out: ${booking.checkout}</p>
          <p>Total: $${booking.total}</p>
        </div>
      `).join('') || '<p class="text-center">Belum ada pemesanan.</p>';
    }
  </script>
</body>
</html>