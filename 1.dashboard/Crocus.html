<!DOCTYPE html>
<html lang="id" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Dashboard Manajemen Rental Apartemen - Solusi lengkap untuk mengelola properti apartemen Anda.">
  <meta name="keywords" content="rental, apartemen, dashboard, manajemen, properti, sewa">
  <meta name="author" content="Pengembang Aplikasi">
  <title>RentalApartemen Dashboard</title>

  <!-- Ikona Favicon (Contoh menggunakan Font Awesome sebagai basis, bisa diganti dengan file .ico) -->
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè¢</text></svg>">

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
    rel="stylesheet">

  <!-- Font Awesome (untuk ikon, sesuai permintaan ikon online gratis) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <style>
    /* LAYER 0: UTILITIES & RESET */
    :root {
      /* Tema Terang */
      --color-bg-light: #f8f9fa;
      --color-bg-alt-light: #ffffff;
      --color-text-light: #212529;
      --color-text-muted-light: #6c757d;
      --color-primary-light: #4f46e5;
      /* Indigo */
      --color-primary-hover-light: #4338ca;
      --color-secondary-light: #6366f1;
      --color-card-light: #ffffff;
      --color-border-light: #e5e7eb;
      --color-sidebar-light: #ffffff;
      --color-sidebar-text-light: #374151;
      --color-sidebar-active-bg-light: #e0e7ff;
      --color-sidebar-active-text-light: var(--color-primary-light);
      --color-navbar-light: #ffffff;
      --color-success-light: #10b981;
      /* Emerald */
      --color-danger-light: #ef4444;
      /* Red */
      --color-warning-light: #f59e0b;
      /* Amber */
      --color-info-light: #3b82f6;
      /* Blue */
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
      --border-radius-sm: 0.25rem;
      --border-radius-md: 0.5rem;
      --border-radius-lg: 0.75rem;
    }

    [data-theme="dark"] {
      --color-bg-light: #111827;
      /* Slate 900 */
      --color-bg-alt-light: #1f2937;
      /* Slate 800 */
      --color-text-light: #f3f4f6;
      /* Gray 100 */
      --color-text-muted-light: #9ca3af;
      /* Gray 400 */
      --color-primary-light: #818cf8;
      /* Indigo 400 */
      --color-primary-hover-light: #6366f1;
      /* Indigo 500 */
      --color-secondary-light: #a78bfa;
      /* Violet 400 */
      --color-card-light: #1f2937;
      --color-border-light: #374151;
      /* Slate 700 */
      --color-sidebar-light: #111827;
      --color-sidebar-text-light: #d1d5db;
      /* Gray 300 */
      --color-sidebar-active-bg-light: #312e81;
      /* Indigo 800 */
      --color-sidebar-active-text-light: var(--color-primary-light);
      --color-navbar-light: #1f2937;
      --color-success-light: #34d399;
      /* Emerald 400 */
      --color-danger-light: #f87171;
      /* Red 400 */
      --color-warning-light: #fbbf24;
      /* Amber 400 */
      --color-info-light: #60a5fa;
      /* Blue 400 */
    }

    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
      /* Basis untuk REM */
    }

    body {
      font-family: 'Inter', 'Poppins', Arial, sans-serif;
      background-color: var(--color-bg-light);
      color: var(--color-text-light);
      line-height: 1.6;
      display: flex;
      min-height: 100vh;
      transition: background-color 0.3s ease, color 0.3s ease;
      overflow-x: hidden;
      /* Mencegah scroll horizontal utama */
    }

    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    a {
      text-decoration: none;
      color: var(--color-primary-light);
      transition: color 0.2s ease;
    }

    a:hover {
      color: var(--color-primary-hover-light);
    }

    button,
    input,
    select,
    textarea {
      font-family: inherit;
      font-size: 1rem;
      border: 1px solid var(--color-border-light);
      border-radius: var(--border-radius-sm);
      padding: 0.5rem 0.75rem;
      background-color: var(--color-bg-alt-light);
      color: var(--color-text-light);
      transition: border-color 0.2s ease, background-color 0.2s ease;
    }

    button:focus,
    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid var(--color-primary-light);
      outline-offset: 2px;
      border-color: var(--color-primary-light);
    }

    button {
      cursor: pointer;
      background-color: var(--color-primary-light);
      color: #fff;
      border: none;
    }

    button:hover {
      background-color: var(--color-primary-hover-light);
    }

    button.btn-secondary {
      background-color: var(--color-secondary-light);
    }

    button.btn-outline {
      background-color: transparent;
      border: 1px solid var(--color-primary-light);
      color: var(--color-primary-light);
    }

    button.btn-outline:hover {
      background-color: var(--color-primary-light);
      color: #fff;
    }

    .container-fluid {
      width: 100%;
      padding-right: 1rem;
      padding-left: 1rem;
      margin-right: auto;
      margin-left: auto;
    }

    .row {
      display: flex;
      flex-wrap: wrap;
      margin-right: -0.75rem;
      margin-left: -0.75rem;
    }

    .col,
    .col-1,
    .col-2,
    .col-3,
    .col-4,
    .col-5,
    .col-6,
    .col-7,
    .col-8,
    .col-9,
    .col-10,
    .col-11,
    .col-12,
    .col-sm,
    .col-sm-1,
    .col-sm-2,
    .col-sm-3,
    .col-sm-4,
    .col-sm-5,
    .col-sm-6,
    .col-sm-7,
    .col-sm-8,
    .col-sm-9,
    .col-sm-10,
    .col-sm-11,
    .col-sm-12,
    .col-md,
    .col-md-1,
    .col-md-2,
    .col-md-3,
    .col-md-4,
    .col-md-5,
    .col-md-6,
    .col-md-7,
    .col-md-8,
    .col-md-9,
    .col-md-10,
    .col-md-11,
    .col-md-12,
    .col-lg,
    .col-lg-1,
    .col-lg-2,
    .col-lg-3,
    .col-lg-4,
    .col-lg-5,
    .col-lg-6,
    .col-lg-7,
    .col-lg-8,
    .col-lg-9,
    .col-lg-10,
    .col-lg-11,
    .col-lg-12,
    .col-xl,
    .col-xl-1,
    .col-xl-2,
    .col-xl-3,
    .col-xl-4,
    .col-xl-5,
    .col-xl-6,
    .col-xl-7,
    .col-xl-8,
    .col-xl-9,
    .col-xl-10,
    .col-xl-11,
    .col-xl-12 {
      position: relative;
      width: 100%;
      padding-right: 0.75rem;
      padding-left: 0.75rem;
    }

    .col {
      flex-basis: 0;
      flex-grow: 1;
      max-width: 100%;
    }

    .col-auto {
      flex: 0 0 auto;
      width: auto;
      max-width: 100%;
    }

    /* Grid System Example: 12 columns */
    .col-1 {
      flex: 0 0 8.333333%;
      max-width: 8.333333%;
    }

    .col-2 {
      flex: 0 0 16.666667%;
      max-width: 16.666667%;
    }

    .col-3 {
      flex: 0 0 25%;
      max-width: 25%;
    }

    .col-4 {
      flex: 0 0 33.333333%;
      max-width: 33.333333%;
    }

    .col-5 {
      flex: 0 0 41.666667%;
      max-width: 41.666667%;
    }

    .col-6 {
      flex: 0 0 50%;
      max-width: 50%;
    }

    /* ... tambahkan sisanya jika diperlukan secara spesifik atau gunakan pendekatan generik */

    /* Breakpoints (contoh, bisa disesuaikan) */
    @media (min-width: 576px) {

      /* sm */
      .col-sm-3 {
        flex: 0 0 25%;
        max-width: 25%;
      }

      .col-sm-4 {
        flex: 0 0 33.333333%;
        max-width: 33.333333%;
      }

      .col-sm-6 {
        flex: 0 0 50%;
        max-width: 50%;
      }

      .col-sm-8 {
        flex: 0 0 66.666667%;
        max-width: 66.666667%;
      }

      .col-sm-12 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }

    @media (min-width: 768px) {

      /* md */
      .col-md-2 {
        flex: 0 0 16.666667%;
        max-width: 16.666667%;
      }

      .col-md-3 {
        flex: 0 0 25%;
        max-width: 25%;
      }

      .col-md-4 {
        flex: 0 0 33.333333%;
        max-width: 33.333333%;
      }

      .col-md-6 {
        flex: 0 0 50%;
        max-width: 50%;
      }

      .col-md-8 {
        flex: 0 0 66.666667%;
        max-width: 66.666667%;
      }

      .col-md-9 {
        flex: 0 0 75%;
        max-width: 75%;
      }

      .col-md-12 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }

    @media (min-width: 992px) {

      /* lg */
      .col-lg-2 {
        flex: 0 0 16.666667%;
        max-width: 16.666667%;
      }

      .col-lg-3 {
        flex: 0 0 25%;
        max-width: 25%;
      }

      .col-lg-4 {
        flex: 0 0 33.333333%;
        max-width: 33.333333%;
      }

      .col-lg-6 {
        flex: 0 0 50%;
        max-width: 50%;
      }

      .col-lg-9 {
        flex: 0 0 75%;
        max-width: 75%;
      }

      .col-lg-12 {
        flex: 0 0 100%;
        max-width: 100%;
      }
    }

    @media (min-width: 1200px) {

      /* xl */
      .col-xl-2 {
        flex: 0 0 16.666667%;
        max-width: 16.666667%;
      }

      .col-xl-3 {
        flex: 0 0 25%;
        max-width: 25%;
      }
    }

    /* Flexbox Utilities */
    .d-flex {
      display: flex !important;
    }

    .d-none {
      display: none !important;
    }

    .flex-column {
      flex-direction: column !important;
    }

    .flex-grow-1 {
      flex-grow: 1 !important;
    }

    .justify-content-start {
      justify-content: flex-start !important;
    }

    .justify-content-end {
      justify-content: flex-end !important;
    }

    .justify-content-center {
      justify-content: center !important;
    }

    .justify-content-between {
      justify-content: space-between !important;
    }

    .align-items-start {
      align-items: flex-start !important;
    }

    .align-items-end {
      align-items: flex-end !important;
    }

    .align-items-center {
      align-items: center !important;
    }

    .ms-auto {
      margin-left: auto !important;
    }

    .me-auto {
      margin-right: auto !important;
    }

    .m-1 {
      margin: 0.25rem !important;
    }

    .mt-1 {
      margin-top: 0.25rem !important;
    }

    .mb-1 {
      margin-bottom: 0.25rem !important;
    }

    .ms-1 {
      margin-left: 0.25rem !important;
    }

    .me-1 {
      margin-right: 0.25rem !important;
    }

    .m-2 {
      margin: 0.5rem !important;
    }

    .mt-2 {
      margin-top: 0.5rem !important;
    }

    .mb-2 {
      margin-bottom: 0.5rem !important;
    }

    .ms-2 {
      margin-left: 0.5rem !important;
    }

    .me-2 {
      margin-right: 0.5rem !important;
    }

    .m-3 {
      margin: 1rem !important;
    }

    .mt-3 {
      margin-top: 1rem !important;
    }

    .mb-3 {
      margin-bottom: 1rem !important;
    }

    .ms-3 {
      margin-left: 1rem !important;
    }

    .me-3 {
      margin-right: 1rem !important;
    }

    .m-4 {
      margin: 1.5rem !important;
    }

    .mt-4 {
      margin-top: 1.5rem !important;
    }

    .mb-4 {
      margin-bottom: 1.5rem !important;
    }

    .ms-4 {
      margin-left: 1.5rem !important;
    }

    .me-4 {
      margin-right: 1.5rem !important;
    }

    .p-1 {
      padding: 0.25rem !important;
    }

    .pt-1 {
      padding-top: 0.25rem !important;
    }

    .pb-1 {
      padding-bottom: 0.25rem !important;
    }

    .ps-1 {
      padding-left: 0.25rem !important;
    }

    .pe-1 {
      padding-right: 0.25rem !important;
    }

    .p-2 {
      padding: 0.5rem !important;
    }

    .pt-2 {
      padding-top: 0.5rem !important;
    }

    .pb-2 {
      padding-bottom: 0.5rem !important;
    }

    .ps-2 {
      padding-left: 0.5rem !important;
    }

    .pe-2 {
      padding-right: 0.5rem !important;
    }

    .p-3 {
      padding: 1rem !important;
    }

    .pt-3 {
      padding-top: 1rem !important;
    }

    .pb-3 {
      padding-bottom: 1rem !important;
    }

    .ps-3 {
      padding-left: 1rem !important;
    }

    .pe-3 {
      padding-right: 1rem !important;
    }

    .p-4 {
      padding: 1.5rem !important;
    }

    .pt-4 {
      padding-top: 1.5rem !important;
    }

    .pb-4 {
      padding-bottom: 1.5rem !important;
    }

    .ps-4 {
      padding-left: 1.5rem !important;
    }

    .pe-4 {
      padding-right: 1.5rem !important;
    }

    .text-center {
      text-align: center !important;
    }

    .text-primary {
      color: var(--color-primary-light) !important;
    }

    .text-success {
      color: var(--color-success-light) !important;
    }

    .text-danger {
      color: var(--color-danger-light) !important;
    }

    .text-warning {
      color: var(--color-warning-light) !important;
    }

    .text-info {
      color: var(--color-info-light) !important;
    }

    .text-muted {
      color: var(--color-text-muted-light) !important;
    }

    .text-white {
      color: #fff !important;
    }

    .text-dark {
      color: #212529 !important;
    }

    /* Untuk kontras pada background terang */

    .bg-primary {
      background-color: var(--color-primary-light) !important;
    }

    .bg-success {
      background-color: var(--color-success-light) !important;
    }

    .bg-danger {
      background-color: var(--color-danger-light) !important;
    }

    .bg-warning {
      background-color: var(--color-warning-light) !important;
    }

    .bg-info {
      background-color: var(--color-info-light) !important;
    }

    .bg-white {
      background-color: #fff !important;
    }

    .fw-bold {
      font-weight: 700 !important;
    }

    .fw-semibold {
      font-weight: 600 !important;
    }

    .fw-medium {
      font-weight: 500 !important;
    }

    .fw-normal {
      font-weight: 400 !important;
    }

    .rounded {
      border-radius: var(--border-radius-md) !important;
    }

    .rounded-sm {
      border-radius: var(--border-radius-sm) !important;
    }

    .rounded-lg {
      border-radius: var(--border-radius-lg) !important;
    }

    .rounded-circle {
      border-radius: 50% !important;
    }

    .shadow-sm {
      box-shadow: var(--shadow-sm) !important;
    }

    .shadow-md {
      box-shadow: var(--shadow-md) !important;
    }

    .shadow-lg {
      box-shadow: var(--shadow-lg) !important;
    }

    .w-100 {
      width: 100% !important;
    }

    .h-100 {
      height: 100% !important;
    }

    .visually-hidden {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      white-space: nowrap !important;
      border: 0 !important;
    }

    /* LAYER 1: LAYOUT COMPONENTS */
    .app-layout {
      display: flex;
      width: 100%;
    }

    .sidebar {
      width: 250px;
      /* Lebar default sidebar */
      min-height: 100vh;
      background-color: var(--color-sidebar-light);
      border-right: 1px solid var(--color-border-light);
      display: flex;
      flex-direction: column;
      padding: 1rem 0;
      transition: width 0.3s ease, transform 0.3s ease, left 0.3s ease;
      position: fixed;
      /* Untuk mobile */
      left: -250px;
      top: 0;
      z-index: 1050;
    }

    .sidebar.open {
      /* Untuk mobile */
      left: 0;
    }

    .sidebar.collapsed {
      /* Untuk desktop */
      width: 70px;
    }

    .sidebar.collapsed .sidebar-header .brand-text,
    .sidebar.collapsed .nav-link span,
    .sidebar.collapsed .theme-switch span,
    .sidebar.collapsed .sidebar-user .user-name {
      display: none;
    }

    .sidebar.collapsed .sidebar-header .brand-icon {
      margin-right: 0;
    }

    .sidebar.collapsed .nav-link i {
      margin-right: 0;
      font-size: 1.25rem;
    }

    .sidebar.collapsed .nav-link {
      justify-content: center;
    }

    .sidebar.collapsed .sidebar-footer .btn-collapse-sidebar span {
      display: none;
    }


    .sidebar-header {
      padding: 1rem 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      color: var(--color-primary-light);
      border-bottom: 1px solid var(--color-border-light);
      margin-bottom: 1rem;
    }

    .sidebar-header .brand-icon {
      font-size: 1.8rem;
    }

    .sidebar-header .brand-text {
      font-size: 1.25rem;
      font-weight: 600;
      white-space: nowrap;
    }

    .sidebar-header .btn-close-sidebar {
      /* Hanya untuk mobile */
      margin-left: auto;
      background: none;
      border: none;
      color: var(--color-text-light);
      font-size: 1.5rem;
      padding: 0.25rem;
      display: none;
      /* Default hidden, JS akan menampilkan di mobile */
    }

    .sidebar-nav {
      list-style: none;
      padding: 0 1rem;
      flex-grow: 1;
    }

    .sidebar-nav .nav-item {
      margin-bottom: 0.25rem;
    }

    .sidebar-nav .nav-link {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      color: var(--color-sidebar-text-light);
      border-radius: var(--border-radius-md);
      transition: background-color 0.2s ease, color 0.2s ease;
      white-space: nowrap;
    }

    .sidebar-nav .nav-link i {
      margin-right: 0.875rem;
      /* 14px */
      width: 20px;
      /* Jaga ikon tetap align saat sidebar collapse */
      text-align: center;
      font-size: 1.1rem;
    }

    .sidebar-nav .nav-link.active,
    .sidebar-nav .nav-link:hover {
      background-color: var(--color-sidebar-active-bg-light);
      color: var(--color-sidebar-active-text-light);
    }

    .sidebar-footer {
      padding: 1rem;
      border-top: 1px solid var(--color-border-light);
    }

    .theme-switch {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      color: var(--color-sidebar-text-light);
      background-color: var(--color-bg-alt-light);
      border: 1px solid var(--color-border-light);
      justify-content: center;
    }

    .theme-switch:hover {
      background-color: var(--color-border-light);
    }

    .theme-switch i {
      font-size: 1.1rem;
    }

    .theme-switch span {
      font-size: 0.9rem;
    }

    .btn-collapse-sidebar {
      width: 100%;
      margin-top: 1rem;
      display: none;
      /* Default hidden, JS akan menampilkan di desktop */
      background-color: var(--color-bg-alt-light);
      color: var(--color-text-light);
      border: 1px solid var(--color-border-light);
    }

    .btn-collapse-sidebar:hover {
      background-color: var(--color-border-light);
    }

    .btn-collapse-sidebar i {
      margin-right: 0.5rem;
    }

    .main-wrapper {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: margin-left 0.3s ease;
    }

    .app-navbar {
      background-color: var(--color-navbar-light);
      border-bottom: 1px solid var(--color-border-light);
      padding: 0.75rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-sm);
      position: sticky;
      top: 0;
      z-index: 1000;
      /* Di atas konten, di bawah sidebar mobile */
    }

    .app-navbar .btn-open-sidebar {
      /* Hanya untuk mobile */
      background: none;
      border: none;
      color: var(--color-text-light);
      font-size: 1.5rem;
      padding: 0.25rem;
      margin-right: 1rem;
      display: none;
      /* Default hidden, JS akan menampilkan di mobile */
    }

    .app-navbar .navbar-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text-light);
    }

    .app-navbar .user-profile {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .app-navbar .user-profile img {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
    }

    .app-navbar .user-profile .user-name {
      font-weight: 500;
      color: var(--color-text-light);
    }

    .app-content {
      flex-grow: 1;
      padding: 1.5rem;
      /* Padding untuk konten */
      background-color: var(--color-bg-light);
    }

    /* LAYER 2: COMPONENT STYLES */
    .card {
      background-color: var(--color-card-light);
      border: 1px solid var(--color-border-light);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
      transition: background-color 0.3s, border-color 0.3s;
      overflow: hidden;
      /* Untuk card-header/footer yang rapi */
    }

    .card-header,
    .card-footer {
      padding: 1rem 1.25rem;
      background-color: var(--color-bg-alt-light);
      border-bottom: 1px solid var(--color-border-light);
    }

    .card-footer {
      border-top: 1px solid var(--color-border-light);
      border-bottom: none;
    }

    .card-body {
      padding: 1.25rem;
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
    }

    .stat-card {
      padding: 1.5rem 1.25rem;
      text-align: center;
    }

    .stat-card .stat-icon {
      font-size: 2.5rem;
      margin-bottom: 0.75rem;
    }

    .stat-card .stat-label {
      font-size: 0.9rem;
      color: var(--color-text-muted-light);
      margin-bottom: 0.25rem;
    }

    .stat-card .stat-value {
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--color-primary-light);
    }

    .chart-placeholder {
      background: linear-gradient(135deg, var(--color-primary-light) 0%, var(--color-secondary-light) 100%);
      border-radius: var(--border-radius-lg);
      min-height: 280px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 1.25rem;
      font-weight: 500;
      box-shadow: var(--shadow-md);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th,
    .data-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      vertical-align: middle;
      border-bottom: 1px solid var(--color-border-light);
    }

    .data-table thead th {
      background-color: var(--color-bg-alt-light);
      font-weight: 600;
      color: var(--color-text-muted-light);
      font-size: 0.9rem;
      text-transform: uppercase;
    }

    .data-table tbody tr:last-child td {
      border-bottom: none;
    }

    .data-table tbody tr:hover {
      background-color: var(--color-bg-light);
      /* Sedikit beda saat hover */
    }

    .badge {
      display: inline-block;
      padding: 0.3em 0.6em;
      font-size: 0.8em;
      font-weight: 600;
      line-height: 1;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: var(--border-radius-sm);
    }

    .badge.bg-success {
      background-color: var(--color-success-light);
      color: #fff;
    }

    .badge.bg-warning {
      background-color: var(--color-warning-light);
      color: var(--color-text-light);
    }

    /* Warna teks disesuaikan agar kontras */
    .badge.bg-danger {
      background-color: var(--color-danger-light);
      color: #fff;
    }

    .badge.bg-info {
      background-color: var(--color-info-light);
      color: #fff;
    }

    .badge.bg-secondary {
      background-color: var(--color-text-muted-light);
      color: #fff;
    }


    .form-group {
      margin-bottom: 1rem;
    }

    .form-label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .form-control {
      display: block;
      width: 100%;
    }

    select.form-control {
      appearance: none;
      /* Hapus tampilan default browser */
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 0.75rem center;
      background-size: 16px 12px;
      padding-right: 2.5rem;
      /* Ruang untuk ikon panah */
    }

    [data-theme="dark"] select.form-control {
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23f3f4f6' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
    }


    /* Notifikasi Toast */
    .toast-container {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 1100;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .toast {
      background-color: var(--color-card-light);
      color: var(--color-text-light);
      border: 1px solid var(--color-border-light);
      border-left: 4px solid var(--color-primary-light);
      /* Aksen warna */
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-lg);
      padding: 1rem;
      min-width: 250px;
      max-width: 350px;
      opacity: 0;
      transform: translateX(100%);
      transition: opacity 0.3s ease, transform 0.3s ease;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(0);
    }

    .toast.toast-success {
      border-left-color: var(--color-success-light);
    }

    .toast.toast-danger {
      border-left-color: var(--color-danger-light);
    }

    .toast.toast-warning {
      border-left-color: var(--color-warning-light);
    }

    .toast.toast-info {
      border-left-color: var(--color-info-light);
    }

    .toast-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .toast-title {
      font-weight: 600;
    }

    .toast-close {
      background: none;
      border: none;
      color: var(--color-text-muted-light);
      font-size: 1.2rem;
      padding: 0.25rem;
      line-height: 1;
    }

    .toast-close:hover {
      color: var(--color-text-light);
    }

    /* Hero Section */
    .hero-section {
      background-color: var(--color-primary-light);
      /* Menggunakan variabel warna */
      color: #fff;
      /* Teks putih agar kontras */
      padding: 2.5rem;
      border-radius: var(--border-radius-lg);
      margin-bottom: 2rem;
      box-shadow: var(--shadow-lg);
    }

    .hero-section h1 {
      font-size: 2.5rem;
      /* Ukuran font lebih besar untuk H1 */
      font-weight: 700;
      margin-bottom: 1rem;
    }

    .hero-section p.lead {
      font-size: 1.1rem;
      margin-bottom: 1.5rem;
      opacity: 0.9;
    }

    .hero-search-box {
      background-color: var(--color-card-light);
      /* Warna card agar kontras */
      padding: 1.5rem;
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-md);
    }

    .hero-search-box .form-label {
      color: var(--color-text-light);
      /* Teks label normal */
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    .hero-search-box .form-control,
    .hero-search-box .form-select {
      background-color: var(--color-bg-light);
      /* Input field slightly different */
    }

    .hero-search-box button[type="submit"] {
      height: calc(2.25rem + 2px + 1rem);
      /* Sesuaikan tinggi dengan input */
    }

    .hero-image img {
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
    }

    /* Featured Properties */
    .featured-properties {
      margin-bottom: 2rem;
    }

    .featured-properties .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
    }

    .featured-properties .section-title i {
      margin-right: 0.5rem;
      color: var(--color-warning-light);
    }

    .property-card {
      /* Card kustom untuk properti jika diperlukan, atau gunakan .card umum */
      height: 100%;
      /* Agar semua card sama tinggi jika dalam .row */
      display: flex;
      flex-direction: column;
    }

    .property-card .card-img-top {
      height: 200px;
      object-fit: cover;
    }

    .property-card .card-body {
      flex-grow: 1;
      /* Pastikan body mengisi sisa ruang */
      display: flex;
      flex-direction: column;
    }

    .property-card .card-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .property-card .card-text.text-muted {
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }

    .property-card .price-tag {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-primary-light);
      margin-bottom: 0;
      /* Hapus margin jika di flex-container */
    }

    .property-card .card-footer-actions {
      /* Untuk bagian bawah card dengan harga & tombol */
      margin-top: auto;
      /* Dorong ke bawah */
      padding-top: 1rem;
      /* Beri jarak dari konten di atasnya */
      border-top: 1px solid var(--color-border-light);
    }

    .property-card .btn-sm {
      padding: 0.35rem 0.7rem;
      font-size: 0.875rem;
    }

    /* LAYER 3: RESPONSIVE ADJUSTMENTS */
    @media (max-width: 991.98px) {

      /* Tablet dan di bawahnya */
      .sidebar {
        box-shadow: var(--shadow-lg);
      }

      .main-wrapper {
        margin-left: 0 !important;
        /* Konten utama mengisi penuh saat sidebar mobile tertutup */
      }

      .app-navbar .btn-open-sidebar,
      .sidebar-header .btn-close-sidebar {
        display: inline-block;
        /* Tampilkan tombol buka/tutup sidebar mobile */
      }

      .btn-collapse-sidebar {
        display: none !important;
        /* Sembunyikan tombol collapse desktop di mobile */
      }

      .hero-section {
        padding: 1.5rem;
      }

      .hero-section h1 {
        font-size: 2rem;
      }
    }

    @media (min-width: 992px) {

      /* Desktop */
      .sidebar {
        position: sticky;
        /* Sidebar tetap di tempat saat scroll */
        left: 0;
        /* Reset dari mobile */
      }

      .main-wrapper {
        margin-left: 250px;
        /* Lebar sidebar default */
      }

      .sidebar.collapsed~.main-wrapper {
        margin-left: 70px;
        /* Lebar sidebar collapsed */
      }

      .btn-collapse-sidebar {
        display: flex;
        /* Tampilkan tombol collapse desktop */
        align-items: center;
        justify-content: center;
      }
    }

    /* Custom scrollbar (opsional, untuk konsistensi visual) */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--color-bg-light);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--color-border-light);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--color-text-muted-light);
    }
  </style>
</head>

<body>
  <div class="app-layout">
    <!-- LAYER: SIDEBAR -->
    <aside id="appSidebar" class="sidebar" aria-label="Navigasi Utama Aplikasi">
      <header class="sidebar-header">
        <i class="fas fa-building brand-icon"></i>
        <span class="brand-text">RentalApart</span>
        <button class="btn-close-sidebar" id="btnCloseSidebar" aria-label="Tutup Sidebar">
          <i class="fas fa-times"></i>
        </button>
      </header>

      <nav>
        <ul class="sidebar-nav">
          <li class="nav-item">
            <a class="nav-link active" href="#dashboard" data-page="dashboard">
              <i class="fas fa-tachometer-alt fa-fw"></i> <span>Dashboard</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#gallery" data-page="gallery">
              <i class="fas fa-images fa-fw"></i> <span>Galeri Apartemen</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#crud" data-page="crud">
              <i class="fas fa-database fa-fw"></i> <span>Manajemen Data</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#docs" data-page="docs">
              <i class="fas fa-book fa-fw"></i> <span>Dokumentasi</span>
            </a>
          </li>
        </ul>
      </nav>

      <footer class="sidebar-footer">
        <div class="theme-switch" id="themeToggle" tabindex="0" role="button" aria-pressed="false"
          aria-label="Ganti Tema Gelap/Terang">
          <i class="fas fa-sun"></i>
          <span id="themeLabel">Mode Terang</span>
        </div>
        <button class="btn-collapse-sidebar" id="btnCollapseSidebar" aria-label="Perkecil/Perbesar Sidebar">
          <i class="fas fa-bars"></i> <span>Menu</span>
        </button>
      </footer>
    </aside>

    <!-- LAYER: MAIN CONTENT WRAPPER -->
    <div class="main-wrapper" id="mainWrapper">
      <!-- LAYER: NAVBAR -->
      <header class="app-navbar" aria-label="Navbar Aplikasi">
        <div class="d-flex align-items-center">
          <button class="btn-open-sidebar" id="btnOpenSidebar" aria-label="Buka Sidebar">
            <i class="fas fa-bars"></i>
          </button>
          <h1 class="navbar-title" id="pageTitle">Dashboard</h1>
        </div>
        <div class="user-profile">
          <span class="user-name d-none d-sm-block">Halo, Admin</span>
          <img src="https://i.pravatar.cc/40?u=admin" alt="Foto Profil Admin" class="rounded-circle">
        </div>
      </header>

      <!-- LAYER: PAGE CONTENT AREA (SPA Target) -->
      <main id="appContent" class="app-content">
        <!-- Konten halaman akan dimuat di sini oleh JavaScript -->
      </main>
    </div>
  </div>

  <!-- Notifikasi Toast Container -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- TEMPLATE UNTUK HALAMAN SPA -->
  <!-- Disimpan di sini agar tidak mengotori HTML utama, bisa juga di string JS -->

  <template id="template-dashboard">
    <div class="container-fluid p-0">
      <!-- Hero Section -->
      <section class="hero-section">
        <div class="row align-items-center">
          <div class="col-lg-7 col-md-12">
            <h1 class="display-5 fw-bold">Selamat Datang di RentalApartemen</h1>
            <p class="lead mb-4">Temukan apartemen impian Anda dengan sistem manajemen penyewaan kami yang komprehensif
              dan mudah digunakan.</p>
            <div class="hero-search-box">
              <form id="searchForm" class="row" style="gap: 0.75rem 0;"> <!-- style untuk gap antar row item -->
                <div class="col-md-4 col-sm-6">
                  <label for="searchLocation" class="form-label">Lokasi</label>
                  <input type="text" class="form-control" id="searchLocation" placeholder="Masukkan lokasi">
                </div>
                <div class="col-md-3 col-sm-6">
                  <label for="searchPrice" class="form-label">Rentang Harga</label>
                  <select class="form-control" id="searchPrice">
                    <option selected value="">Semua Harga</option>
                    <option value="<5M">Di bawah 5 Jt</option>
                    <option value="5M-10M">5 Jt - 10 Jt</option>
                    <option value=">10M">Diatas 10 Jt</option>
                  </select>
                </div>
                <div class="col-md-3 col-sm-6">
                  <label for="searchType" class="form-label">Tipe Unit</label>
                  <select class="form-control" id="searchType">
                    <option selected value="">Semua Tipe</option>
                    <option value="studio">Studio</option>
                    <option value="1br">1 Kamar Tidur</option>
                    <option value="2br">2 Kamar Tidur</option>
                  </select>
                </div>
                <div class="col-md-2 col-sm-6 d-flex align-items-end">
                  <button type="submit" class="btn-primary w-100"
                    style="background-color: var(--color-secondary-light); border-color: var(--color-secondary-light);"><i
                      class="fas fa-search me-1"></i> Cari</button>
                </div>
              </form>
            </div>
          </div>
          <div class="col-lg-5 d-none d-lg-block hero-image">
            <img
              src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
              alt="Interior Apartemen Modern" class="img-fluid rounded-lg shadow-lg">
          </div>
        </div>
      </section>

      <!-- Featured Properties -->
      <section class="featured-properties">
        <h2 class="section-title"><i class="fas fa-star"></i>Properti Unggulan</h2>
        <div class="row">
          <div class="col-lg-4 col-md-6 mb-4">
            <div class="card property-card">
              <img
                src="https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
                class="card-img-top" alt="Apartemen Mewah">
              <div class="card-body">
                <span class="badge bg-success mb-2">Tersedia</span>
                <h5 class="card-title">Suite Apartemen Mewah</h5>
                <p class="card-text text-muted"><i class="fas fa-map-marker-alt me-1"></i> Jakarta Pusat, DKI Jakarta
                </p>
              </div>
              <div class="card-footer-actions d-flex justify-content-between align-items-center p-3">
                <span class="price-tag">Rp 8.5 Jt/bln</span>
                <button class="btn-outline btn-sm">Lihat Detail</button>
              </div>
            </div>
          </div>
          <div class="col-lg-4 col-md-6 mb-4">
            <div class="card property-card">
              <img
                src="https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
                class="card-img-top" alt="Studio Modern">
              <div class="card-body">
                <span class="badge bg-success mb-2">Tersedia</span>
                <h5 class="card-title">Unit Studio Modern</h5>
                <p class="card-text text-muted"><i class="fas fa-map-marker-alt me-1"></i> Jakarta Selatan, DKI Jakarta
                </p>
              </div>
              <div class="card-footer-actions d-flex justify-content-between align-items-center p-3">
                <span class="price-tag">Rp 5.2 Jt/bln</span>
                <button class="btn-outline btn-sm">Lihat Detail</button>
              </div>
            </div>
          </div>
          <div class="col-lg-4 col-md-6 mb-4">
            <div class="card property-card">
              <img
                src="https://images.unsplash.com/photo-1493809842364-78817add7ffb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGFwYXJ0bWVudHxlbnwwfHx8fHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
                class="card-img-top" alt="Apartemen Keluarga">
              <div class="card-body">
                <span class="badge bg-warning mb-2">Unit Terbatas</span>
                <h5 class="card-title">Rumah Nyaman Keluarga</h5>
                <p class="card-text text-muted"><i class="fas fa-map-marker-alt me-1"></i> Jakarta Barat, DKI Jakarta
                </p>
              </div>
              <div class="card-footer-actions d-flex justify-content-between align-items-center p-3">
                <span class="price-tag">Rp 12 Jt/bln</span>
                <button class="btn-outline btn-sm">Lihat Detail</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Kartu Statistik -->
      <section class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card stat-card h-100" aria-label="Total Apartemen">
            <div class="stat-icon text-primary"><i class="fas fa-city"></i></div>
            <div class="stat-label">Total Properti</div>
            <div class="stat-value" id="statTotalApt">128</div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card stat-card h-100" aria-label="Disewa Saat Ini">
            <div class="stat-icon text-success"><i class="fas fa-door-open"></i></div>
            <div class="stat-label">Unit Tersewa</div>
            <div class="stat-value" id="statAptRented">75</div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card stat-card h-100" aria-label="Pendapatan Bulanan">
            <div class="stat-icon text-warning"><i class="fas fa-wallet"></i></div>
            <div class="stat-label">Pendapatan (Bulan Ini)</div>
            <div class="stat-value" id="statIncome">Rp 245 Jt</div>
          </div>
        </div>
        <div class="col-xl-3 col-md-6 mb-4">
          <div class="card stat-card h-100" aria-label="Total Penyewa">
            <div class="stat-icon text-info"><i class="fas fa-users-line"></i></div>
            <div class="stat-label">Total Penyewa Aktif</div>
            <div class="stat-value" id="statTenants">150</div>
          </div>
        </div>
      </section>

      <!-- Grafik Placeholder -->
      <section class="mb-4">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title"><i class="fas fa-chart-line me-2"></i>Statistik Penyewaan</h3>
          </div>
          <div class="card-body">
            <div class="chart-placeholder" id="chartPlaceholder" aria-label="Grafik Statistik Penyewaan">
              <span><i class="fas fa-spinner fa-spin me-2"></i> Data Grafik Sedang Dimuat...</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Tabel Data Penyewaan -->
      <section class="mb-4">
        <div class="card" aria-label="Tabel Penyewaan Terbaru">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h3 class="card-title mb-0"><i class="fas fa-list-ul me-2"></i>Data Penyewaan Terbaru</h3>
            <button class="btn-primary btn-sm"><i class="fas fa-plus me-1"></i> Tambah Sewa</button>
          </div>
          <div class="card-body p-0"> <!-- p-0 agar tabel rapat dengan card -->
            <div style="overflow-x: auto;"> <!-- Wrapper untuk scroll horizontal tabel di mobile -->
              <table class="data-table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Penyewa</th>
                    <th>Apartemen</th>
                    <th>Tgl. Mulai</th>
                    <th>Status</th>
                    <th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="rentTableBody">
                  <!-- Data akan diinjeksikan oleh JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
          <div class="card-footer text-center">
            <button class="btn-outline btn-sm">Lihat Semua Data Penyewaan</button>
          </div>
        </div>
      </section>
    </div>
  </template>

  <template id="template-gallery">
    <div class="container-fluid p-0">
      <h2 class="mb-4 fw-bold"><i class="fas fa-images me-2"></i>Galeri Apartemen</h2>
      <p class="text-muted mb-4">Jelajahi koleksi foto apartemen berkualitas tinggi kami. Temukan inspirasi untuk hunian
        Anda berikutnya.</p>
      <div class="row">
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1616046229478-9901c5536a45?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NXx8YXBhcnRtZW50JTIwbGl2aW5nJTIwcm9vbXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 1" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Ruang Tamu Elegan</h5>
              <p class="card-text text-muted">Desain modern dengan pencahayaan alami.</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8N3x8YXBhcnRtZW50JTIwa2l0Y2hlbnxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 2" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Dapur Minimalis</h5>
              <p class="card-text text-muted">Fungsional dan dilengkapi peralatan modern.</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1595526114035-0d45ed16cfbf?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTF8fGFwYXJ0bWVudCUyMGJlZHJvb218ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 3" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Kamar Tidur Nyaman</h5>
              <p class="card-text text-muted">Tempat istirahat yang tenang dan privat.</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1582582494482-d506f5690065?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50JTIwYmFsY29ueXxlbnwwfHwwfHx8MA%3D%3D&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 4" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Balkon dengan Pemandangan</h5>
              <p class="card-text text-muted">Nikmati udara segar dan pemandangan kota.</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1579725942955-4135d703405c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGFwYXJ0bWVudCUyMGJhdGhyb29tfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 5" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Kamar Mandi Bersih</h5>
              <p class="card-text text-muted">Fasilitas lengkap dan higienis.</p>
            </div>
          </div>
        </div>
        <div class="col-lg-4 col-md-6 mb-4">
          <div class="card shadow-sm">
            <img
              src="https://images.unsplash.com/photo-1512918728675-ed5a9ecdebfd?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTV8fGFwYXJ0bWVudCUyMGV4dGVyaW9yfGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60"
              alt="Apartemen 6" class="rounded-top" style="height: 250px; object-fit: cover;">
            <div class="card-body">
              <h5 class="card-title">Fasad Gedung Modern</h5>
              <p class="card-text text-muted">Arsitektur menawan di lokasi strategis.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="template-crud">
    <div class="container-fluid p-0">
      <h2 class="mb-4 fw-bold"><i class="fas fa-edit me-2"></i>Manajemen Data Penyewaan</h2>
      <p class="text-muted mb-4">Kelola semua data penyewaan apartemen Anda dengan mudah. Tambah, lihat, ubah, dan hapus
        data penyewa dan properti.</p>

      <div class="card mb-4">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h3 class="card-title mb-0">Form Tambah/Edit Data Penyewaan</h3>
          <button type="button" id="resetFormCrud" class="btn-secondary btn-sm"><i class="fas fa-times me-1"></i>
            Batal</button>
        </div>
        <div class="card-body">
          <form id="crudForm">
            <input type="hidden" id="rentalId" name="rentalId">
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="tenantName" class="form-label">Nama Penyewa</label>
                  <input type="text" id="tenantName" name="tenantName" class="form-control"
                    placeholder="Contoh: Budi Santoso" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="apartmentName" class="form-label">Nama Apartemen</label>
                  <select id="apartmentName" name="apartmentName" class="form-control" required>
                    <option value="">Pilih Apartemen</option>
                    <option value="Apartemen Sakura">Apartemen Sakura</option>
                    <option value="Apartemen Melati">Apartemen Melati</option>
                    <option value="Apartemen Kenanga">Apartemen Kenanga</option>
                    <option value="Apartemen Mawar">Apartemen Mawar</option>
                    <option value="Apartemen Anggrek">Apartemen Anggrek</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="startDate" class="form-label">Tanggal Mulai Sewa</label>
                  <input type="date" id="startDate" name="startDate" class="form-control" required>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="rentalStatus" class="form-label">Status Penyewaan</label>
                  <select id="rentalStatus" name="rentalStatus" class="form-control" required>
                    <option value="Aktif">Aktif</option>
                    <option value="Menunggu">Menunggu Pembayaran</option>
                    <option value="Berakhir">Berakhir</option>
                    <option value="Dibatalkan">Dibatalkan</option>
                  </select>
                </div>
              </div>
            </div>
            <div class="form-group text-end mt-3">
              <button type="submit" class="btn-primary"><i class="fas fa-save me-1"></i> Simpan Data</button>
            </div>
          </form>
        </div>
      </div>

      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h3 class="card-title mb-0">Daftar Penyewaan</h3>
          <input type="text" id="searchCrudTable" class="form-control" placeholder="Cari data..." style="width: 250px;">
        </div>
        <div class="card-body p-0">
          <div style="overflow-x: auto;">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Penyewa</th>
                  <th>Apartemen</th>
                  <th>Tgl. Mulai</th>
                  <th>Status</th>
                  <th>Aksi</th>
                </tr>
              </thead>
              <tbody id="crudTableBody">
                <!-- Data CRUD akan diinjeksikan di sini -->
              </tbody>
            </table>
          </div>
        </div>
        <div class="card-footer d-flex justify-content-between align-items-center">
          <span id="crudTableInfo">Menampilkan 0 dari 0 data.</span>
          <div>
            <button id="prevCrudPage" class="btn-outline btn-sm" disabled><i class="fas fa-chevron-left"></i></button>
            <span id="crudPageIndicator" class="mx-2">Hal 1 dari 1</span>
            <button id="nextCrudPage" class="btn-outline btn-sm" disabled><i class="fas fa-chevron-right"></i></button>
          </div>
        </div>
      </div>
    </div>
  </template>

  <template id="template-docs">
    <div class="container-fluid p-0">
      <h2 class="mb-4 fw-bold"><i class="fas fa-file-alt me-2"></i>Dokumentasi Aplikasi</h2>
      <p class="text-muted mb-4">Panduan lengkap penggunaan dan informasi teknis mengenai Dashboard Rental Apartemen.
      </p>

      <div class="card mb-4">
        <div class="card-header">
          <h3 class="card-title">Pendahuluan</h3>
        </div>
        <div class="card-body">
          <p>Selamat datang di dokumentasi aplikasi RentalApartemen Dashboard. Aplikasi ini dirancang untuk membantu
            Anda mengelola penyewaan apartemen secara efisien. Dibangun dengan teknologi web native (HTML, CSS,
            JavaScript) untuk performa optimal dan kemudahan pemeliharaan.</p>
          <p>Fitur utama meliputi:</p>
          <ul>
            <li>Manajemen data penyewaan (CRUD).</li>
            <li>Visualisasi statistik penyewaan.</li>
            <li>Galeri foto apartemen.</li>
            <li>Desain responsif dan tema gelap/terang.</li>
            <li>Arsitektur Single Page Application (SPA) untuk pengalaman pengguna yang mulus.</li>
          </ul>
        </div>
      </div>

      <div class="card mb-4">
        <div class="card-header">
          <h3 class="card-title">Struktur Aplikasi</h3>
        </div>
        <div class="card-body">
          <p>Aplikasi ini memiliki struktur sebagai berikut:</p>
          <ul class="list-unstyled">
            <li><strong>HTML (<code>index.html</code>):</strong>
              <ul>
                <li>Struktur dasar halaman.</li>
                <li>Layout utama (sidebar, navbar, area konten).</li>
                <li>Elemen <code>&lt;template&gt;</code> untuk setiap halaman SPA.</li>
              </ul>
            </li>
            <li><strong>CSS (inline <code>&lt;style&gt;</code>):</strong>
              <ul>
                <li>Variabel CSS untuk theming dan konsistensi.</li>
                <li>Styling untuk layout, komponen, dan utilitas.</li>
                <li>Media queries untuk responsivitas.</li>
                <li>Layered CSS (Utilities, Layout, Components, Responsive).</li>
              </ul>
            </li>
            <li><strong>JavaScript (inline <code>&lt;script&gt;</code>):</strong>
              <ul>
                <li>Logika SPA (routing, rendering halaman).</li>
                <li>Manajemen state (tema, halaman aktif, data).</li>
                <li>Interaksi DOM dan event handling.</li>
                <li>Fungsi utilitas (notifikasi, dll.).</li>
                <li>Semua kode bersifat native, tanpa framework/library eksternal untuk fungsionalitas inti.</li>
              </ul>
            </li>
          </ul>
        </div>
      </div>

      <div class="card mb-4">
        <div class="card-header">
          <h3 class="card-title">Penggunaan Fitur</h3>
        </div>
        <div class="card-body">
          <h4>1. Navigasi</h4>
          <p>Gunakan menu di sidebar kiri untuk berpindah antar halaman (Dashboard, Galeri, Manajemen Data,
            Dokumentasi). Navigasi tidak menyebabkan refresh halaman penuh.</p>

          <h4>2. Tema Gelap/Terang</h4>
          <p>Klik ikon matahari/bulan di bagian bawah sidebar untuk mengganti tema. Preferensi tema akan disimpan di
            browser Anda.</p>

          <h4>3. Sidebar Collapse/Expand (Desktop)</h4>
          <p>Klik tombol "Menu" di bawah sidebar untuk memperkecil atau memperbesar sidebar.</p>

          <h4>4. Manajemen Data (CRUD)</h4>
          <p>Di halaman "Manajemen Data":</p>
          <ul>
            <li><strong>Tambah Data:</strong> Isi form di bagian atas, lalu klik "Simpan Data".</li>
            <li><strong>Edit Data:</strong> Klik ikon pensil <i class="fas fa-edit text-warning"></i> pada baris data.
              Form akan terisi, ubah data, lalu klik "Simpan Data".</li>
            <li><strong>Hapus Data:</strong> Klik ikon tong sampah <i class="fas fa-trash text-danger"></i> pada baris
              data. Akan ada konfirmasi sebelum penghapusan.</li>
            <li><strong>Pencarian & Paginasi:</strong> Gunakan kolom pencarian dan tombol paginasi untuk menavigasi
              data.</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">Prinsip & Best Practices</h3>
        </div>
        <div class="card-body">
          <p>Pengembangan aplikasi ini mengikuti beberapa prinsip dan praktik terbaik:</p>
          <ul>
            <li><strong>HTML Semantik:</strong> Penggunaan tag HTML5 yang sesuai untuk struktur dan aksesibilitas.</li>
            <li><strong>CSS Modular:</strong> Penggunaan variabel CSS dan pendekatan BEM-like untuk styling yang
              terorganisir.</li>
            <li><strong>JavaScript Vanilla:</strong> Kode JavaScript murni untuk kontrol penuh dan performa.</li>
            <li><strong>Single Responsibility Principle (SRP):</strong> Fungsi-fungsi JavaScript dirancang untuk
              melakukan satu tugas spesifik.</li>
            <li><strong>Don't Repeat Yourself (DRY):</strong> Menghindari duplikasi kode dengan menggunakan fungsi
              reusable.</li>
            <li><strong>Responsif & Mobile-first (Consideration):</strong> Desain yang beradaptasi dengan berbagai
              ukuran layar.</li>
            <li><strong>Aksesibilitas (A11y):</strong> Penggunaan atribut ARIA dan praktik desain inklusif.</li>
            <li><strong>Keamanan Sisi Klien:</strong> Validasi input dasar dan menghindari praktik berisiko (misalnya,
              `innerHTML` dengan data pengguna tanpa sanitasi - di sini data dari array statis jadi aman).</li>
            <li><strong>Kode Bersih & Mudah Dipelihara:</strong> Penamaan yang jelas, komentar, dan struktur kode yang
              logis.</li>
          </ul>
        </div>
      </div>
    </div>
  </template>


  <script>
    // ======== APLIKASI INTI (NATIVE VANILLA JS) ========

    // LAYER 0: STATE APLIKASI & KONFIGURASI
    const AppState = {
      currentTheme: 'light',
      currentPage: 'dashboard',
      isSidebarCollapsed: false,
      isMobileView: window.innerWidth < 992,
      // Data untuk tabel penyewaan (bisa dari API nantinya)
      rentalData: [
        { id: 1, tenant: 'Budi Santoso', apt: 'Apartemen Sakura', startDate: '2025-05-01', status: 'Aktif' },
        { id: 2, tenant: 'Siti Aminah', apt: 'Apartemen Melati', startDate: '2025-04-20', status: 'Aktif' },
        { id: 3, tenant: 'Dewi Lestari', apt: 'Apartemen Kenanga', startDate: '2025-04-15', status: 'Berakhir' },
        { id: 4, tenant: 'Agus Pratama', apt: 'Apartemen Mawar', startDate: '2025-03-10', status: 'Aktif' },
        { id: 5, tenant: 'Rina Sari', apt: 'Apartemen Anggrek', startDate: '2025-02-01', status: 'Menunggu' },
        { id: 6, tenant: 'Joko Widodo', apt: 'Apartemen Sakura', startDate: '2025-06-10', status: 'Aktif' },
        { id: 7, tenant: 'Ani Yudhoyono', apt: 'Apartemen Melati', startDate: '2025-07-01', status: 'Menunggu' },
        { id: 8, tenant: 'Rudi Hartono', apt: 'Apartemen Kenanga', startDate: '2025-01-15', status: 'Berakhir' },
      ],
      crudData: [], // Akan diisi dari rentalData dan bisa dimodifikasi
      crudCurrentPage: 1,
      crudItemsPerPage: 5,
      crudSearchTerm: '',
    };

    // LAYER 1: ELEMEN DOM UTAMA
    const DOM = {
      html: document.documentElement,
      body: document.body,
      sidebar: document.getElementById('appSidebar'),
      mainWrapper: document.getElementById('mainWrapper'),
      appContent: document.getElementById('appContent'),
      pageTitle: document.getElementById('pageTitle'),

      // Sidebar elements
      btnCloseSidebar: document.getElementById('btnCloseSidebar'),
      btnOpenSidebar: document.getElementById('btnOpenSidebar'),
      btnCollapseSidebar: document.getElementById('btnCollapseSidebar'),
      navLinks: document.querySelectorAll('.sidebar-nav .nav-link'),

      // Theme elements
      themeToggle: document.getElementById('themeToggle'),
      themeLabel: document.getElementById('themeLabel'),
      themeIcon: document.querySelector('#themeToggle i'),

      // Toast container
      toastContainer: document.getElementById('toastContainer'),
    };

    // LAYER 2: FUNGSI UTILITAS
    const Utils = {
      // Fungsi untuk menampilkan notifikasi toast
      showToast: (message, type = 'info', duration = 3000) => {
        const toast = document.createElement('div');
        toast.className = `toast toast-${type}`;
        toast.setAttribute('role', 'alert');
        toast.setAttribute('aria-live', 'assertive');
        toast.setAttribute('aria-atomic', 'true');

        const toastId = 'toast-' + Date.now();
        toast.id = toastId;

        toast.innerHTML = `
                <div class="toast-header">
                    <strong class="toast-title">${type.charAt(0).toUpperCase() + type.slice(1)}</strong>
                    <button type="button" class="toast-close" data-dismiss-toast="${toastId}" aria-label="Tutup">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            `;
        DOM.toastContainer.appendChild(toast);

        // Memicu animasi
        requestAnimationFrame(() => {
          toast.classList.add('show');
        });

        const closeButton = toast.querySelector('.toast-close');
        closeButton.addEventListener('click', () => Utils.dismissToast(toast));

        setTimeout(() => {
          Utils.dismissToast(toast);
        }, duration);
      },

      dismissToast: (toastElement) => {
        if (toastElement && toastElement.classList.contains('show')) {
          toastElement.classList.remove('show');
          // Hapus elemen setelah transisi selesai
          toastElement.addEventListener('transitionend', () => {
            if (toastElement.parentElement) {
              toastElement.remove();
            }
          }, { once: true });
        } else if (toastElement && toastElement.parentElement) {
          // Jika tidak ada transisi atau sudah hilang, hapus langsung
          toastElement.remove();
        }
      },
      // Format tanggal YYYY-MM-DD ke DD NamaBulan YYYY
      formatDate: (dateString) => {
        if (!dateString) return '-';
        const [year, month, day] = dateString.split('-');
        const date = new Date(year, month - 1, day);
        const options = { day: 'numeric', month: 'long', year: 'numeric' };
        return date.toLocaleDateString('id-ID', options);
      },
      // Fungsi escape HTML sederhana untuk mencegah XSS dasar jika data dinamis dari user
      escapeHTML: (str) => {
        if (typeof str !== 'string') return str;
        return str.replace(/[&<>"']/g, function (match) {
          const escape = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#39;'
          };
          return escape[match];
        });
      }
    };

    // LAYER 3: MODUL-MODUL APLIKASI

    // Modul Tema
    const ThemeManager = (() => {
      function applyTheme(theme) {
        DOM.html.setAttribute('data-theme', theme);
        AppState.currentTheme = theme;
        if (theme === 'dark') {
          DOM.themeIcon.classList.remove('fa-sun');
          DOM.themeIcon.classList.add('fa-moon');
          DOM.themeLabel.textContent = 'Mode Gelap';
          DOM.themeToggle.setAttribute('aria-pressed', 'true');
        } else {
          DOM.themeIcon.classList.remove('fa-moon');
          DOM.themeIcon.classList.add('fa-sun');
          DOM.themeLabel.textContent = 'Mode Terang';
          DOM.themeToggle.setAttribute('aria-pressed', 'false');
        }
      }

      function toggleTheme() {
        const newTheme = AppState.currentTheme === 'light' ? 'dark' : 'light';
        applyTheme(newTheme);
        localStorage.setItem('appTheme', newTheme);
        Utils.showToast(`Tema diubah ke ${newTheme === 'dark' ? 'Gelap' : 'Terang'}`, 'info');
      }

      function init() {
        const savedTheme = localStorage.getItem('appTheme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        applyTheme(savedTheme);
        DOM.themeToggle.addEventListener('click', toggleTheme);
        DOM.themeToggle.addEventListener('keydown', (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            toggleTheme();
          }
        });
      }
      return { init };
    })();

    // Modul Sidebar
    const SidebarManager = (() => {
      function collapseSidebar() {
        DOM.sidebar.classList.add('collapsed');
        AppState.isSidebarCollapsed = true;
        DOM.btnCollapseSidebar.setAttribute('aria-expanded', 'false');
        DOM.btnCollapseSidebar.setAttribute('aria-label', 'Perbesar Sidebar');
        // Update margin main content jika tidak di mobile view
        if (!AppState.isMobileView) {
          DOM.mainWrapper.style.marginLeft = '70px';
        }
      }

      function expandSidebar() {
        DOM.sidebar.classList.remove('collapsed');
        AppState.isSidebarCollapsed = false;
        DOM.btnCollapseSidebar.setAttribute('aria-expanded', 'true');
        DOM.btnCollapseSidebar.setAttribute('aria-label', 'Perkecil Sidebar');
        if (!AppState.isMobileView) {
          DOM.mainWrapper.style.marginLeft = '250px';
        }
      }

      function toggleCollapse() {
        if (AppState.isSidebarCollapsed) {
          expandSidebar();
        } else {
          collapseSidebar();
        }
        localStorage.setItem('sidebarCollapsed', AppState.isSidebarCollapsed);
      }

      function openMobileSidebar() {
        DOM.sidebar.classList.add('open');
        DOM.body.style.overflow = 'hidden'; // Mencegah scroll body saat sidebar mobile terbuka
        // Tambahkan overlay jika diperlukan
      }

      function closeMobileSidebar() {
        DOM.sidebar.classList.remove('open');
        DOM.body.style.overflow = '';
      }

      function handleResize() {
        const previouslyMobile = AppState.isMobileView;
        AppState.isMobileView = window.innerWidth < 992;

        if (AppState.isMobileView) {
          DOM.btnCollapseSidebar.style.display = 'none';
          DOM.btnOpenSidebar.style.display = 'inline-block';
          DOM.btnCloseSidebar.style.display = 'inline-block';
          // Jika sidebar desktop tadinya collapse, di mobile harus expand
          if (DOM.sidebar.classList.contains('collapsed')) {
            DOM.sidebar.classList.remove('collapsed'); // Hapus state collapsed
            // Margin main wrapper jadi 0 di mobile
            DOM.mainWrapper.style.marginLeft = '0px';
          }
          // Pastikan sidebar mobile tertutup saat resize ke mobile, kecuali jika memang sedang dibuka
          if (!DOM.sidebar.classList.contains('open')) {
            closeMobileSidebar();
          }

        } else { // Desktop view
          DOM.btnOpenSidebar.style.display = 'none';
          DOM.btnCloseSidebar.style.display = 'none';
          DOM.btnCollapseSidebar.style.display = 'flex';
          closeMobileSidebar(); // Tutup sidebar mobile jika terbuka

          // Kembalikan state collapse dari localStorage atau default
          const storedCollapseState = localStorage.getItem('sidebarCollapsed') === 'true';
          if (storedCollapseState) {
            collapseSidebar();
          } else {
            expandSidebar();
          }
        }
      }

      function init() {
        handleResize(); // Panggil saat init untuk set state awal
        window.addEventListener('resize', handleResize);

        // Event listener untuk tombol desktop
        DOM.btnCollapseSidebar.addEventListener('click', toggleCollapse);

        // Event listener untuk tombol mobile
        DOM.btnOpenSidebar.addEventListener('click', openMobileSidebar);
        DOM.btnCloseSidebar.addEventListener('click', closeMobileSidebar);

        // Tutup sidebar mobile jika klik di luar area sidebar
        document.addEventListener('click', (event) => {
          if (AppState.isMobileView && DOM.sidebar.classList.contains('open')) {
            if (!DOM.sidebar.contains(event.target) && !DOM.btnOpenSidebar.contains(event.target)) {
              closeMobileSidebar();
            }
          }
        });
      }
      return { init, closeMobileSidebar };
    })();

    // Modul SPA Router & Content Loader
    const SpaRouter = (() => {
      const pageRenderers = {
        dashboard: renderDashboardPage,
        gallery: renderGalleryPage,
        crud: renderCrudPage,
        docs: renderDocsPage,
      };

      function updateActiveNavLink(page) {
        DOM.navLinks.forEach(link => {
          link.classList.remove('active');
          link.removeAttribute('aria-current');
          if (link.dataset.page === page) {
            link.classList.add('active');
            link.setAttribute('aria-current', 'page');
          }
        });
      }

      function renderPage(page) {
        AppState.currentPage = page;
        const templateId = `template-${page}`;
        const template = document.getElementById(templateId);

        if (template) {
          DOM.appContent.innerHTML = ''; // Kosongkan konten lama
          const content = template.content.cloneNode(true);
          DOM.appContent.appendChild(content);
          DOM.pageTitle.textContent = page.charAt(0).toUpperCase() + page.slice(1).replace(/-/g, ' ');

          // Panggil fungsi render spesifik halaman jika ada
          if (pageRenderers[page] && typeof pageRenderers[page] === 'function') {
            pageRenderers[page]();
          }

          updateActiveNavLink(page);
          window.scrollTo(0, 0); // Scroll ke atas halaman
        } else {
          DOM.appContent.innerHTML = `<div class="card"><div class="card-body"><p class="text-danger">Error: Konten untuk halaman '${page}' tidak ditemukan.</p></div></div>`;
          DOM.pageTitle.textContent = 'Error';
          console.error(`Template not found: ${templateId}`);
        }
      }

      function navigateTo(page) {
        if (page === AppState.currentPage && DOM.appContent.innerHTML !== '') return; // Hindari render ulang jika halaman sama & sudah dirender

        // Update hash tanpa memicu hashchange handler untuk sementara
        // agar tidak terjadi infinite loop jika navigasi dari hashchange handler
        const currentHash = window.location.hash.substring(1);
        if (currentHash !== page) {
          window.location.hash = page; // Ini akan memicu hashchange jika berbeda
        }

        renderPage(page); // Render halaman langsung

        if (AppState.isMobileView) {
          SidebarManager.closeMobileSidebar();
        }
      }

      function handleHashChange() {
        const page = window.location.hash.substring(1) || 'dashboard';
        // Hanya render jika halaman berbeda dari yang sekarang untuk mencegah loop
        if (page !== AppState.currentPage) {
          renderPage(page);
        }
      }

      function init() {
        // Event listener untuk link navigasi
        DOM.navLinks.forEach(link => {
          link.addEventListener('click', (e) => {
            e.preventDefault();
            const page = link.dataset.page;
            navigateTo(page);
          });
        });

        // Listener untuk perubahan hash (back/forward browser, direct URL)
        window.addEventListener('hashchange', handleHashChange);

        // Muat halaman awal berdasarkan hash atau default ke dashboard
        const initialPage = window.location.hash.substring(1) || 'dashboard';
        navigateTo(initialPage); // Ini akan mengatur hash jika belum ada
      }

      return { init, navigateTo, getCurrentPage: () => AppState.currentPage };
    })();

    // Modul spesifik per halaman
    // 1. Dashboard Page Renderer
    function renderDashboardPage() {
      // Data untuk tabel di dashboard
      const dashboardRentTableBody = document.getElementById('rentTableBody');
      if (dashboardRentTableBody) {
        dashboardRentTableBody.innerHTML = ''; // Kosongkan dulu
        AppState.rentalData.slice(0, 5).forEach((row, idx) => { // Ambil 5 data pertama
          const statusClassDetails = getStatusClass(row.status);
          dashboardRentTableBody.innerHTML += `
                    <tr>
                        <td>${idx + 1}</td>
                        <td><i class="fas fa-user me-2 text-muted"></i>${Utils.escapeHTML(row.tenant)}</td>
                        <td><i class="fas fa-building me-2 text-muted"></i>${Utils.escapeHTML(row.apt)}</td>
                        <td><i class="fas fa-calendar-alt me-2 text-muted"></i>${Utils.formatDate(row.startDate)}</td>
                        <td><span class="badge ${statusClassDetails.className}">${Utils.escapeHTML(row.status)}</span></td>
                        <td>
                            <button class="btn-outline btn-sm me-1" onclick="AppActions.viewRentalDetail(${row.id})" aria-label="Lihat Detail ${row.tenant}">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-outline btn-sm" style="border-color:var(--color-warning-light); color:var(--color-warning-light);" onclick="AppActions.editRentalFromDashboard(${row.id})" aria-label="Edit ${row.tenant}">
                                <i class="fas fa-edit"></i>
                            </button>
                        </td>
                    </tr>
                `;
        });
      }

      // Dummy search form handler
      const searchForm = document.getElementById('searchForm');
      if (searchForm) {
        searchForm.addEventListener('submit', (e) => {
          e.preventDefault();
          const location = document.getElementById('searchLocation').value;
          const price = document.getElementById('searchPrice').value;
          const type = document.getElementById('searchType').value;
          Utils.showToast(`Pencarian: Lokasi '${location}', Harga '${price}', Tipe '${type}'. Fitur ini dalam pengembangan.`, 'info');
        });
      }

      // Placeholder untuk chart, bisa diintegrasikan dengan library chart jika diperlukan
      const chartPlaceholder = document.getElementById('chartPlaceholder');
      if (chartPlaceholder) {
        setTimeout(() => {
          chartPlaceholder.innerHTML = `<span><i class="fas fa-chart-bar me-2"></i> Grafik Statistik Penyewaan (Contoh)</span>`;
        }, 1500); // Simulasi loading
      }
    }

    // 2. Gallery Page Renderer (jika ada logika spesifik)
    function renderGalleryPage() {
      // Logika spesifik galeri jika ada, misal: event listener untuk modal gambar, dll.
      // Saat ini, konten galeri statis dari template.
      Utils.showToast('Selamat datang di Galeri Apartemen!', 'info', 2000);
    }

    // 3. CRUD Page Renderer
    let crudForm, crudTableBody, rentalIdField, tenantNameField, apartmentNameField, startDateField, rentalStatusField;
    let searchCrudTableInput, crudTableInfo, prevCrudPageBtn, nextCrudPageBtn, crudPageIndicator;

    function initializeCrudElements() {
      crudForm = document.getElementById('crudForm');
      crudTableBody = document.getElementById('crudTableBody');
      rentalIdField = document.getElementById('rentalId');
      tenantNameField = document.getElementById('tenantName');
      apartmentNameField = document.getElementById('apartmentName');
      startDateField = document.getElementById('startDate');
      rentalStatusField = document.getElementById('rentalStatus');
      searchCrudTableInput = document.getElementById('searchCrudTable');
      crudTableInfo = document.getElementById('crudTableInfo');
      prevCrudPageBtn = document.getElementById('prevCrudPage');
      nextCrudPageBtn = document.getElementById('nextCrudPage');
      crudPageIndicator = document.getElementById('crudPageIndicator');

      if (crudForm) {
        crudForm.addEventListener('submit', handleCrudFormSubmit);
        document.getElementById('resetFormCrud')?.addEventListener('click', resetCrudForm);
      }
      if (searchCrudTableInput) {
        searchCrudTableInput.addEventListener('input', (e) => {
          AppState.crudSearchTerm = e.target.value.toLowerCase();
          AppState.crudCurrentPage = 1; // Reset ke halaman pertama saat mencari
          renderCrudTable();
        });
      }
      if (prevCrudPageBtn) prevCrudPageBtn.addEventListener('click', () => {
        if (AppState.crudCurrentPage > 1) {
          AppState.crudCurrentPage--;
          renderCrudTable();
        }
      });
      if (nextCrudPageBtn) nextCrudPageBtn.addEventListener('click', () => {
        const filteredData = getFilteredCrudData();
        const totalPages = Math.ceil(filteredData.length / AppState.crudItemsPerPage);
        if (AppState.crudCurrentPage < totalPages) {
          AppState.crudCurrentPage++;
          renderCrudTable();
        }
      });
    }

    function getFilteredCrudData() {
      return AppState.crudData.filter(item =>
        item.tenant.toLowerCase().includes(AppState.crudSearchTerm) ||
        item.apt.toLowerCase().includes(AppState.crudSearchTerm) ||
        item.status.toLowerCase().includes(AppState.crudSearchTerm)
      );
    }

    function renderCrudTable() {
      if (!crudTableBody) return;
      crudTableBody.innerHTML = '';

      const filteredData = getFilteredCrudData();
      const totalItems = filteredData.length;
      const totalPages = Math.ceil(totalItems / AppState.crudItemsPerPage);
      AppState.crudCurrentPage = Math.min(AppState.crudCurrentPage, totalPages) || 1; // Pastikan halaman saat ini valid

      const startIndex = (AppState.crudCurrentPage - 1) * AppState.crudItemsPerPage;
      const endIndex = startIndex + AppState.crudItemsPerPage;
      const paginatedData = filteredData.slice(startIndex, endIndex);

      if (paginatedData.length === 0 && totalItems > 0) { // Jika filter menghasilkan kosong tapi ada data
        crudTableBody.innerHTML = `<tr><td colspan="6" class="text-center p-3">Tidak ada data yang cocok dengan pencarian "${Utils.escapeHTML(AppState.crudSearchTerm)}".</td></tr>`;
      } else if (totalItems === 0) { // Jika tidak ada data sama sekali
        crudTableBody.innerHTML = `<tr><td colspan="6" class="text-center p-3">Belum ada data penyewaan. Silakan tambahkan data baru.</td></tr>`;
      } else {
        paginatedData.forEach(item => {
          const statusClassDetails = getStatusClass(item.status);
          crudTableBody.innerHTML += `
                    <tr data-id="${item.id}">
                        <td>${item.id}</td>
                        <td>${Utils.escapeHTML(item.tenant)}</td>
                        <td>${Utils.escapeHTML(item.apt)}</td>
                        <td>${Utils.formatDate(item.startDate)}</td>
                        <td><span class="badge ${statusClassDetails.className}">${Utils.escapeHTML(item.status)}</span></td>
                        <td>
                            <button class="btn-outline btn-sm me-1" onclick="AppActions.editCrudItem(${item.id})" aria-label="Edit ${item.tenant}" style="border-color:var(--color-warning-light); color:var(--color-warning-light);">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-outline btn-sm" onclick="AppActions.deleteCrudItem(${item.id})" aria-label="Hapus ${item.tenant}" style="border-color:var(--color-danger-light); color:var(--color-danger-light);">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `;
        });
      }

      // Update info paginasi
      const startItemNum = totalItems > 0 ? startIndex + 1 : 0;
      const endItemNum = Math.min(endIndex, totalItems);
      if (crudTableInfo) crudTableInfo.textContent = `Menampilkan ${startItemNum}-${endItemNum} dari ${totalItems} data.`;
      if (crudPageIndicator) crudPageIndicator.textContent = `Hal ${AppState.crudCurrentPage} dari ${totalPages || 1}`;
      if (prevCrudPageBtn) prevCrudPageBtn.disabled = AppState.crudCurrentPage === 1;
      if (nextCrudPageBtn) nextCrudPageBtn.disabled = AppState.crudCurrentPage === totalPages || totalPages === 0;
    }

    function handleCrudFormSubmit(event) {
      event.preventDefault();
      const id = rentalIdField.value ? parseInt(rentalIdField.value) : null;
      const rental = {
        tenant: tenantNameField.value.trim(),
        apt: apartmentNameField.value,
        startDate: startDateField.value,
        status: rentalStatusField.value
      };

      if (!rental.tenant || !rental.apt || !rental.startDate || !rental.status) {
        Utils.showToast('Semua field wajib diisi!', 'warning');
        return;
      }

      if (id) { // Update
        const index = AppState.crudData.findIndex(item => item.id === id);
        if (index > -1) {
          AppState.crudData[index] = { ...AppState.crudData[index], ...rental };
          Utils.showToast(`Data penyewaan ID ${id} berhasil diperbarui.`, 'success');
        }
      } else { // Create
        const newId = AppState.crudData.length > 0 ? Math.max(...AppState.crudData.map(item => item.id)) + 1 : 1;
        AppState.crudData.push({ id: newId, ...rental });
        Utils.showToast(`Data penyewaan baru (ID ${newId}) berhasil ditambahkan.`, 'success');
      }
      // Sinkronkan juga ke AppState.rentalData jika diperlukan, atau anggap crudData sebagai sumber utama untuk halaman ini
      // AppState.rentalData = [...AppState.crudData]; 

      renderCrudTable();
      resetCrudForm();
    }

    function resetCrudForm() {
      crudForm.reset();
      rentalIdField.value = '';
      tenantNameField.focus();
    }

    function fillCrudForm(item) {
      rentalIdField.value = item.id;
      tenantNameField.value = item.tenant;
      apartmentNameField.value = item.apt;
      startDateField.value = item.startDate; // Format YYYY-MM-DD
      rentalStatusField.value = item.status;
      tenantNameField.focus();
      window.scrollTo({ top: crudForm.offsetTop - 70, behavior: 'smooth' }); // Scroll ke form
    }

    function renderCrudPage() {
      // Salin data rental awal ke crudData jika crudData kosong (pertama kali load)
      if (AppState.crudData.length === 0) {
        AppState.crudData = JSON.parse(JSON.stringify(AppState.rentalData)); // Deep copy
      }
      initializeCrudElements();
      renderCrudTable();
    }

    // 4. Docs Page Renderer (jika ada logika spesifik)
    function renderDocsPage() {
      // Logika spesifik dokumentasi jika ada
      Utils.showToast('Halaman Dokumentasi dimuat.', 'info', 2000);
    }

    // Fungsi helper untuk status badge
    function getStatusClass(status) {
      switch (status.toLowerCase()) {
        case 'aktif': return { className: 'bg-success', icon: 'fa-check-circle' };
        case 'menunggu':
        case 'menunggu pembayaran':
          return { className: 'bg-warning text-dark', icon: 'fa-clock' }; // text-dark untuk kontras
        case 'berakhir': return { className: 'bg-secondary', icon: 'fa-times-circle' };
        case 'dibatalkan': return { className: 'bg-danger', icon: 'fa-ban' };
        default: return { className: 'bg-info', icon: 'fa-info-circle' };
      }
    }

    // LAYER 4: AKSI APLIKASI GLOBAL (dipanggil dari HTML via onclick atau lainnya)
    const AppActions = {
      viewRentalDetail: (id) => {
        const item = AppState.rentalData.find(r => r.id === id);
        if (item) {
          Utils.showToast(`Melihat detail untuk: ${item.tenant} - ${item.apt}. Fitur ini dalam pengembangan.`, 'info');
        }
      },
      editRentalFromDashboard: (id) => {
        const item = AppState.rentalData.find(r => r.id === id);
        if (item) {
          SpaRouter.navigateTo('crud');
          // Tunggu hingga halaman CRUD dirender, lalu isi form
          // Ini cara sederhana, idealnya pakai callback atau event
          setTimeout(() => {
            const crudItem = AppState.crudData.find(ci => ci.id === id);
            if (crudItem) {
              fillCrudForm(crudItem);
              Utils.showToast(`Mengedit data: ${crudItem.tenant}. Silakan ubah pada form.`, 'info');
            } else {
              Utils.showToast(`Data dengan ID ${id} tidak ditemukan di halaman CRUD.`, 'warning');
            }
          }, 200); // delay kecil untuk memastikan DOM crud sudah ada
        }
      },
      editCrudItem: (id) => {
        const item = AppState.crudData.find(i => i.id === id);
        if (item) {
          fillCrudForm(item);
        }
      },
      deleteCrudItem: (id) => {
        const item = AppState.crudData.find(i => i.id === id);
        if (item) {
          if (confirm(`Apakah Anda yakin ingin menghapus data penyewaan untuk "${item.tenant}"?`)) {
            AppState.crudData = AppState.crudData.filter(i => i.id !== id);
            renderCrudTable(); // Re-render tabel di halaman CRUD
            // Jika halaman aktif adalah dashboard, re-render juga tabel dashboard
            if (SpaRouter.getCurrentPage() === 'dashboard') {
              renderDashboardPage();
            }
            Utils.showToast(`Data untuk "${item.tenant}" berhasil dihapus.`, 'success');
          }
        }
      }
    };
    // Ekspos AppActions ke global scope agar bisa dipanggil dari onclick di HTML
    window.AppActions = AppActions;


    // LAYER 5: INISIALISASI APLIKASI
    document.addEventListener('DOMContentLoaded', () => {
      console.log(" Aplikasi RentalApartemen Dimuat ");
      ThemeManager.init();
      SidebarManager.init();
      SpaRouter.init(); // Ini akan memuat halaman awal

      Utils.showToast('Selamat datang di RentalApartemen Dashboard!', 'success', 3500);
    });

  </script>
</body>

</html>