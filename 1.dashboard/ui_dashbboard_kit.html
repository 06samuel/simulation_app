<!DOCTYPE html>
<html lang="id" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Rentelindo - Platform manajemen properti sewaan dengan fitur lengkap untuk pemilik dan pengelola properti di Indonesia">
    <meta name="keywords"
        content="sewa apartemen, manajemen properti, platform rental, sistem pembayaran, laporan keuangan, tur virtual">
    <meta name="author" content="Tim Rentelindo">
    <title>Rentelindo | Sistem Manajemen Properti Sewa</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üè†</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
        as="style" onload="this.rel='stylesheet'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    </noscript>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            /* Sistem Warna */
            --color-primary: hsl(214, 100%, 54%);
            --color-primary-dark: hsl(214, 100%, 42%);
            --color-primary-light: hsl(214, 100%, 92%);
            --color-accent: hsl(40, 90%, 60%);
            --color-success: hsl(140, 60%, 45%);
            --color-danger: hsl(0, 80%, 56%);
            --color-warning: hsl(40, 90%, 60%);
            --color-info: hsl(200, 90%, 60%);

            /* Warna Netral */
            --color-bg: hsl(220, 16%, 98%);
            --color-bg-alt: hsl(0, 0%, 100%);
            --color-text: hsl(220, 24%, 16%);
            --color-text-light: hsl(220, 10%, 50%);
            --color-border: hsl(220, 20%, 90%);
            --color-focus: hsl(214, 100%, 85%);
            --color-overlay: rgba(0, 0, 0, 0.5);

            /* Tipografi */
            --font-main: 'Inter', system-ui, sans-serif;
            --font-xs: clamp(0.75rem, 2vw, 0.875rem);
            --font-sm: clamp(0.875rem, 2.5vw, 1rem);
            --font-md: clamp(1rem, 3vw, 1.125rem);
            --font-lg: clamp(1.25rem, 3.5vw, 1.375rem);
            --font-xl: clamp(1.5rem, 4vw, 1.75rem);
            --font-display: clamp(2rem, 5vw, 2.25rem);
            --font-heading: clamp(1.5rem, 4vw, 1.75rem);

            /* Spasi */
            --space-xxs: 0.25rem;
            --space-xs: 0.5rem;
            --space-sm: 0.75rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;

            /* Border Radius */
            --radius-xs: 0.375rem;
            --radius-sm: 0.5rem;
            --radius-md: 0.75rem;
            --radius-lg: 1rem;
            --radius-full: 9999px;

            /* Bayangan */
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.04);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.12);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.16);

            /* Transisi */
            --transition-fast: all 0.15s ease-in-out;
            --transition-normal: all 0.3s ease-in-out;
            --transition-slow: all 0.5s ease-in-out;

            /* Z-index */
            --z-index-dropdown: 100;
            --z-index-sticky: 200;
            --z-index-modal: 1000;
            --z-index-toast: 1100;
        }

        /* Tema Gelap */
        [data-theme="dark"] {
            --color-bg: hsl(220, 24%, 16%);
            --color-bg-alt: hsl(224, 29%, 14%);
            --color-text: hsl(210, 40%, 98%);
            --color-text-light: hsl(215, 20%, 65%);
            --color-border: hsl(217, 33%, 20%);
            --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.2);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.25);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        /* Reset & Dasar */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            border-color: var(--color-border);
        }

        html {
            font-size: 16px;
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: var(--font-main);
            background: var(--color-bg);
            color: var(--color-text);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Tata Letak */
        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: var(--space-md);
        }

        .grid {
            display: grid;
            gap: var(--space-md);
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .flex {
            display: flex;
            gap: var(--space-md);
        }

        .flex-col {
            flex-direction: column;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-center {
            justify-content: center;
        }

        .align-center {
            align-items: center;
        }

        .text-center {
            text-align: center;
        }

        .text-right {
            text-align: right;
        }

        .w-full {
            width: 100%;
        }

        .gap-xs {
            gap: var(--space-xs);
        }

        .gap-sm {
            gap: var(--space-sm);
        }

        .gap-md {
            gap: var(--space-md);
        }

        .gap-lg {
            gap: var(--space-lg);
        }

        /* Tipografi */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: var(--space-md);
            color: var(--color-text);
        }

        h1 {
            font-size: var(--font-display);
        }

        h2 {
            font-size: var(--font-heading);
        }

        h3 {
            font-size: var(--font-xl);
        }

        h4 {
            font-size: var(--font-lg);
        }

        .text-muted {
            color: var(--color-text-light);
        }

        .text-primary {
            color: var(--color-primary);
        }

        .text-success {
            color: var(--color-success);
        }

        .text-danger {
            color: var(--color-danger);
        }

        .text-warning {
            color: var(--color-warning);
        }

        /* Komponen */
        .c-header {
            background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
            padding: var(--space-md) 0;
            position: sticky;
            top: 0;
            z-index: var(--z-index-sticky);
            box-shadow: var(--shadow-sm);
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fff;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .logo i {
            font-size: 1.2em;
        }

        /* Tombol */
        .c-button {
            padding: var(--space-sm) var(--space-lg);
            background: var(--color-primary);
            color: #fff;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-weight: 500;
            font-size: var(--font-sm);
            transition: var(--transition-fast);
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            min-height: 40px;
            white-space: nowrap;
        }

        .c-button:hover {
            background: var(--color-primary-dark);
            transform: translateY(-2px);
            box-shadow: var(--shadow-sm);
        }

        .c-button:active {
            transform: translateY(0);
        }

        .c-button:focus-visible {
            outline: 2px solid var(--color-focus);
            outline-offset: 2px;
        }

        .c-button.btn-outline {
            background: transparent;
            border: 2px solid var(--color-primary);
            color: var(--color-primary);
        }

        .c-button.btn-outline:hover {
            background: var(--color-primary-light);
            color: var(--color-primary-dark);
        }

        .c-button.btn-success {
            background: var(--color-success);
        }

        .c-button.btn-success:hover {
            background: hsl(140, 60%, 40%);
        }

        .c-button.btn-danger {
            background: var(--color-danger);
        }

        .c-button.btn-danger:hover {
            background: hsl(0, 80%, 50%);
        }

        .c-button.btn-warning {
            background: var(--color-warning);
        }

        .c-button.btn-warning:hover {
            background: hsl(40, 90%, 55%);
        }

        .c-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Sidebar */
        .sidebar {
            background: var(--color-primary-dark);
            color: #fff;
            min-width: 280px;
            height: 100vh;
            position: sticky;
            top: 0;
            padding: var(--space-xl) var(--space-lg);
            overflow-y: auto;
            transition: var(--transition-normal);
        }

        .sidebar .logo {
            display: flex;
            text-align: left;
            margin-bottom: var(--space-xl);
            padding: 0 var(--space-sm);
        }

        .sidebar nav ul {
            list-style: none;
        }

        .sidebar nav li {
            margin-bottom: var(--space-xs);
        }

        .sidebar nav a {
            color: #fff;
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-sm);
            transition: var(--transition-fast);
            text-decoration: none;
        }

        .sidebar nav a:hover,
        .sidebar nav a.active {
            background: var(--color-primary);
            transform: translateX(4px);
        }

        .sidebar nav a i {
            width: 24px;
            text-align: center;
        }

        /* Konten Utama */
        .main-content {
            flex: 1;
            padding: var(--space-xl);
            background: var(--color-bg-alt);
            transition: var(--transition-normal);
        }

        /* Hero Section */
        .c-hero {
            min-height: 360px;
            border-radius: var(--radius-lg);
            background: linear-gradient(135deg, var(--color-primary-light) 0%, var(--color-primary) 100%);
            display: flex;
            align-items: center;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            position: relative;
        }

        .hero-content {
            padding: var(--space-xl);
            color: #fff;
            max-width: 600px;
            position: relative;
            z-index: 1;
        }

        .hero-title {
            font-size: var(--font-display);
            font-weight: 800;
            margin-bottom: var(--space-md);
            line-height: 1.2;
        }

        .hero-desc {
            font-size: var(--font-lg);
            margin-bottom: var(--space-lg);
            color: rgba(255, 255, 255, 0.9);
        }

        .hero-image {
            position: absolute;
            right: 0;
            top: 0;
            height: 100%;
            object-fit: cover;
            opacity: 0.15;
            width: 50%;
        }

        /* Kartu */
        .c-card {
            background: var(--color-bg-alt);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            transition: var(--transition-fast);
            border: 1px solid var(--color-border);
        }

        .c-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }

        .c-card .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .c-card .card-title {
            font-size: var(--font-lg);
            font-weight: 600;
            color: var(--color-primary);
        }

        .c-card .card-body {
            margin-bottom: var(--space-md);
        }

        .stat-card {
            text-align: center;
            padding: var(--space-lg);
        }

        .stat-card .stat-value {
            font-size: var(--font-display);
            font-weight: 700;
            color: var(--color-primary);
            margin: var(--space-sm) 0;
        }

        .stat-card .stat-label {
            color: var(--color-text-light);
            font-size: var(--font-sm);
        }

        /* Tab */
        .feature-tabs {
            display: flex;
            gap: var(--space-xs);
            flex-wrap: wrap;
            margin-bottom: var(--space-lg);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: var(--space-sm);
        }

        .feature-tab {
            padding: var(--space-sm) var(--space-lg);
            background: transparent;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition-fast);
            border: none;
            color: var(--color-text-light);
        }

        .feature-tab.active,
        .feature-tab:hover {
            background: var(--color-primary);
            color: #fff;
        }

        /* Formulir */
        .c-form {
            display: flex;
            flex-direction: column;
            gap: var(--space-md);
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
        }

        .form-row {
            display: flex;
            gap: var(--space-md);
        }

        .form-row .form-group {
            flex: 1;
        }

        .c-input,
        .c-form select,
        .c-form textarea {
            padding: var(--space-sm);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-sm);
            font-size: var(--font-sm);
            transition: var(--transition-fast);
            background: var(--color-bg-alt);
            color: var(--color-text);
        }

        .c-input:focus,
        .c-form select:focus,
        .c-form textarea:focus {
            border-color: var(--color-primary);
            outline: none;
            box-shadow: 0 0 0 3px hsla(214, 100%, 85%, 0.2);
        }

        .c-input[aria-invalid="true"],
        .c-form select[aria-invalid="true"],
        .c-form textarea[aria-invalid="true"] {
            border-color: var(--color-danger);
        }

        .error {
            color: var(--color-danger);
            font-size: var(--font-xs);
            margin-top: var(--space-xxs);
        }

        label {
            font-weight: 500;
            font-size: var(--font-sm);
            color: var(--color-text);
        }

        /* Tabel */
        .c-table {
            width: 100%;
            border-collapse: collapse;
            border-radius: var(--radius-md);
            overflow: hidden;
            box-shadow: var(--shadow-xs);
            background: var(--color-bg-alt);
        }

        .c-table thead {
            background: var(--color-primary-light);
        }

        .c-table th {
            padding: var(--space-md);
            text-align: left;
            font-weight: 600;
            color: var(--color-primary-dark);
            font-size: var(--font-sm);
        }

        .c-table tbody tr {
            border-top: 1px solid var(--color-border);
            transition: var(--transition-fast);
        }

        .c-table tbody tr:hover {
            background: var(--color-primary-light);
        }

        .c-table td {
            padding: var(--space-md);
            font-size: var(--font-sm);
        }

        .badge {
            display: inline-block;
            padding: var(--space-xxs) var(--space-sm);
            border-radius: var(--radius-xs);
            font-size: var(--font-xs);
            font-weight: 600;
        }

        .badge-success {
            background: var(--color-success);
            color: white;
        }

        .badge-warning {
            background: var(--color-warning);
            color: white;
        }

        .badge-danger {
            background: var(--color-danger);
            color: white;
        }

        .badge-info {
            background: var(--color-info);
            color: white;
        }

        /* Modal */
        .c-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-overlay);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: var(--z-index-modal);
            backdrop-filter: blur(4px);
        }

        .c-modal.open {
            display: flex;
            animation: fadeIn 0.3s ease-in-out;
        }

        .modal-content {
            background: var(--color-bg-alt);
            border-radius: var(--radius-md);
            padding: var(--space-xl);
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: var(--shadow-lg);
        }

        .modal-close {
            position: absolute;
            top: var(--space-md);
            right: var(--space-md);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--color-text-light);
            transition: var(--transition-fast);
            padding: var(--space-xs);
            border-radius: var(--radius-full);
        }

        .modal-close:hover {
            color: var(--color-danger);
            background: var(--color-primary-light);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: var(--space-lg);
            right: var(--space-lg);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            box-shadow: var(--shadow-md);
            z-index: var(--z-index-toast);
            opacity: 0;
            transform: translateY(20px);
            transition: var(--transition-normal);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            max-width: 400px;
        }

        .toast.success {
            background: var(--color-success);
            color: #fff;
        }

        .toast.error {
            background: var(--color-danger);
            color: #fff;
        }

        .toast.warning {
            background: var(--color-warning);
            color: #fff;
        }

        .toast i {
            font-size: 1.2rem;
        }

        /* Animasi */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* Responsif */
        @media (max-width: 1024px) {
            .sidebar {
                min-width: 240px;
            }
        }

        @media (max-width: 768px) {
            .dashboard {
                flex-direction: column;
            }

            .sidebar {
                min-width: 100%;
                height: auto;
                position: relative;
                padding: var(--space-md);
            }

            .sidebar .logo {
                margin-bottom: var(--space-md);
            }

            .main-content {
                padding: var(--space-md);
            }

            .hero-title {
                font-size: 2rem;
            }

            .grid-cols-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .c-button {
                padding: var(--space-xs) var(--space-md);
                font-size: var(--font-xs);
            }

            .hero-content {
                padding: var(--space-lg);
            }

            .grid-cols-2,
            .grid-cols-3,
            .grid-cols-4 {
                grid-template-columns: 1fr;
            }

            .form-row {
                flex-direction: column;
                gap: var(--space-sm);
            }
        }

        /* Aksesibilitas */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        [data-tooltip] {
            position: relative;
        }

        [data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--color-text);
            color: var(--color-bg);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-xs);
            font-size: var(--font-xs);
            white-space: nowrap;
            z-index: 10;
            pointer-events: none;
        }
    </style>
</head>

<body>
    <header class="c-header" role="banner">
        <div class="container header-container">
            <a href="#" class="logo" aria-label="Rentelindo Beranda">
                <i class="fas fa-home"></i>
                <span>Rentelindo</span>
            </a>
            <div class="flex align-center gap-sm">
                <button class="c-button btn-outline" id="notifications" aria-label="Notifikasi"
                    data-tooltip="Notifikasi">
                    <i class="fas fa-bell"></i>
                    <span class="badge badge-danger" id="notification-badge" style="display: none;">3</span>
                </button>
                <button class="c-button btn-outline theme-toggle" aria-label="Ubah tema">
                    <i class="fas fa-moon"></i>
                    <span class="theme-text">Mode Gelap</span>
                </button>
                <div class="user-dropdown">
                    <button class="c-button btn-outline" id="user-menu" aria-label="Menu pengguna">
                        <i class="fas fa-user-circle"></i>
                        <span>Admin</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="dashboard flex">
        <aside class="sidebar" aria-label="Menu navigasi">
            <a href="#" class="logo">
                <i class="fas fa-home"></i>
                <span>Rentelindo</span>
            </a>
            <nav>
                <ul>
                    <li>
                        <a href="#dashboard" class="active" data-section="dashboard">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>Dasbor</span>
                        </a>
                    </li>
                    <li>
                        <a href="#penyewa" data-section="penyewa">
                            <i class="fas fa-users"></i>
                            <span>Penyewa</span>
                        </a>
                    </li>
                    <li>
                        <a href="#unit" data-section="unit">
                            <i class="fas fa-building"></i>
                            <span>Unit Properti</span>
                        </a>
                    </li>
                    <li>
                        <a href="#kontrak" data-section="kontrak">
                            <i class="fas fa-file-contract"></i>
                            <span>Kontrak Sewa</span>
                        </a>
                    </li>
                    <li>
                        <a href="#pembayaran" data-section="pembayaran">
                            <i class="fas fa-credit-card"></i>
                            <span>Pembayaran</span>
                        </a>
                    </li>
                    <li>
                        <a href="#pemeliharaan" data-section="pemeliharaan">
                            <i class="fas fa-tools"></i>
                            <span>Pemeliharaan</span>
                        </a>
                    </li>
                    <li>
                        <a href="#laporan" data-section="laporan">
                            <i class="fas fa-chart-line"></i>
                            <span>Laporan</span>
                        </a>
                    </li>
                    <li>
                        <a href="#pengaturan" data-section="pengaturan">
                            <i class="fas fa-cog"></i>
                            <span>Pengaturan</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Keluar</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <main class="main-content" id="main-content" tabindex="-1">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section-content">
                <div class="c-hero">
                    <div class="hero-content">
                        <h1 class="hero-title">Selamat Datang di Rentelindo</h1>
                        <p class="hero-desc">Kelola properti sewaan Anda dengan mudah dan efisien dalam satu platform
                            terpadu.</p>
                        <div class="flex gap-md">
                            <button class="c-button" onclick="openModal('add-tenant')">
                                <i class="fas fa-user-plus"></i>
                                <span>Tambah Penyewa</span>
                            </button>
                            <button class="c-button btn-outline" onclick="openModal('add-unit')">
                                <i class="fas fa-building"></i>
                                <span>Tambah Unit</span>
                            </button>
                        </div>
                    </div>
                    <img src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                        alt="Properti" class="hero-image">
                </div>

                <div class="container mt-4">
                    <h2>Ringkasan Properti</h2>
                    <p class="text-muted mb-4">Ikhtisar statistik properti dan penyewa Anda</p>

                    <div class="grid grid-cols-4 gap-md mb-4">
                        <div class="stat-card c-card">
                            <i class="fas fa-building text-primary" style="font-size: 2rem;"></i>
                            <div class="stat-value" id="total-units">0</div>
                            <div class="stat-label">Total Unit</div>
                        </div>
                        <div class="stat-card c-card">
                            <i class="fas fa-user-check text-success" style="font-size: 2rem;"></i>
                            <div class="stat-value" id="rented-units">0</div>
                            <div class="stat-label">Unit Ditempati</div>
                        </div>
                        <div class="stat-card c-card">
                            <i class="fas fa-home text-info" style="font-size: 2rem;"></i>
                            <div class="stat-value" id="vacant-units">0</div>
                            <div class="stat-label">Unit Kosong</div>
                        </div>
                        <div class="stat-card c-card">
                            <i class="fas fa-money-bill-wave text-warning" style="font-size: 2rem;"></i>
                            <div class="stat-value" id="monthly-income">Rp 0</div>
                            <div class="stat-label">Pendapatan Bulanan</div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-md">
                        <div class="c-card">
                            <h3>Status Unit</h3>
                            <canvas id="unit-chart" style="max-height: 300px;"></canvas>
                        </div>
                        <div class="c-card">
                            <div class="card-header">
                                <h3 class="card-title">Pembayaran Terakhir</h3>
                                <a href="#pembayaran" class="text-primary">Lihat Semua</a>
                            </div>
                            <div class="card-body">
                                <table class="c-table">
                                    <thead>
                                        <tr>
                                            <th>Penyewa</th>
                                            <th>Jumlah</th>
                                            <th>Tanggal</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recent-payments">
                                        <tr>
                                            <td colspan="3" class="text-center">Memuat data...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="c-card mt-4">
                        <div class="card-header">
                            <h3 class="card-title">Pemeliharaan Terkini</h3>
                            <a href="#pemeliharaan" class="text-primary">Lihat Semua</a>
                        </div>
                        <div class="card-body">
                            <table class="c-table">
                                <thead>
                                    <tr>
                                        <th>Unit</th>
                                        <th>Masalah</th>
                                        <th>Status</th>
                                        <th>Prioritas</th>
                                    </tr>
                                </thead>
                                <tbody id="recent-maintenance">
                                    <tr>
                                        <td colspan="4" class="text-center">Memuat data...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Penyewa Section -->
            <section id="penyewa" class="section-content" hidden>
                <div class="container">
                    <div class="flex justify-between align-center mb-4">
                        <div>
                            <h2>Manajemen Penyewa</h2>
                            <p class="text-muted">Kelola data penyewa properti Anda</p>
                        </div>
                        <button class="c-button" onclick="openModal('add-tenant')">
                            <i class="fas fa-user-plus"></i>
                            <span>Tambah Penyewa</span>
                        </button>
                    </div>

                    <div class="c-card">
                        <div class="flex justify-between align-center mb-4">
                            <div class="flex gap-md align-center">
                                <div class="form-group" style="min-width: 250px;">
                                    <input type="text" class="c-input" id="tenant-filter" placeholder="Cari penyewa..."
                                        aria-label="Cari penyewa">
                                </div>
                                <select class="c-input" id="tenant-status-filter" aria-label="Filter status penyewa">
                                    <option value="">Semua Status</option>
                                    <option value="Aktif">Aktif</option>
                                    <option value="Menunggu">Menunggu</option>
                                    <option value="Nonaktif">Nonaktif</option>
                                </select>
                            </div>
                            <button class="c-button btn-outline" onclick="exportTenantData()">
                                <i class="fas fa-download"></i>
                                <span>Ekspor Data</span>
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="c-table" aria-label="Daftar penyewa">
                                <thead>
                                    <tr>
                                        <th>ID Penyewa</th>
                                        <th>Nama Lengkap</th>
                                        <th>Kontak</th>
                                        <th>Unit</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="tenants-tbody">
                                    <tr>
                                        <td colspan="6" class="text-center">Memuat data penyewa...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-between align-center mt-4">
                            <div class="text-muted" id="tenant-pagination-info">Menampilkan 0 dari 0 penyewa</div>
                            <div class="flex gap-xs">
                                <button class="c-button btn-outline" id="prev-tenant-page" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="c-button btn-outline" id="next-tenant-page" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Unit Section -->
            <section id="unit" class="section-content" hidden>
                <div class="container">
                    <div class="flex justify-between align-center mb-4">
                        <div>
                            <h2>Manajemen Unit Properti</h2>
                            <p class="text-muted">Kelola unit properti yang tersedia</p>
                        </div>
                        <button class="c-button" onclick="openModal('add-unit')">
                            <i class="fas fa-building"></i>
                            <span>Tambah Unit</span>
                        </button>
                    </div>

                    <div class="c-card">
                        <div class="flex justify-between align-center mb-4">
                            <div class="flex gap-md align-center">
                                <div class="form-group" style="min-width: 250px;">
                                    <input type="text" class="c-input" id="unit-filter" placeholder="Cari unit..."
                                        aria-label="Cari unit">
                                </div>
                                <select class="c-input" id="unit-status-filter" aria-label="Filter status unit">
                                    <option value="">Semua Status</option>
                                    <option value="Tersedia">Tersedia</option>
                                    <option value="Ditempati">Ditempati</option>
                                    <option value="Perbaikan">Perbaikan</option>
                                </select>
                            </div>
                            <button class="c-button btn-outline" onclick="exportUnitData()">
                                <i class="fas fa-download"></i>
                                <span>Ekspor Data</span>
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="c-table" aria-label="Daftar unit">
                                <thead>
                                    <tr>
                                        <th>Kode Unit</th>
                                        <th>Tipe</th>
                                        <th>Lokasi</th>
                                        <th>Status</th>
                                        <th>Harga Sewa</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="units-tbody">
                                    <tr>
                                        <td colspan="6" class="text-center">Memuat data unit...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-between align-center mt-4">
                            <div class="text-muted" id="unit-pagination-info">Menampilkan 0 dari 0 unit</div>
                            <div class="flex gap-xs">
                                <button class="c-button btn-outline" id="prev-unit-page" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="c-button btn-outline" id="next-unit-page" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Kontrak Section -->
            <section id="kontrak" class="section-content" hidden>
                <div class="container">
                    <div class="flex justify-between align-center mb-4">
                        <div>
                            <h2>Manajemen Kontrak Sewa</h2>
                            <p class="text-muted">Kelola kontrak sewa penyewa</p>
                        </div>
                        <button class="c-button" onclick="openModal('add-contract')">
                            <i class="fas fa-file-contract"></i>
                            <span>Buat Kontrak Baru</span>
                        </button>
                    </div>

                    <div class="c-card">
                        <div class="flex justify-between align-center mb-4">
                            <div class="flex gap-md align-center">
                                <div class="form-group" style="min-width: 250px;">
                                    <input type="text" class="c-input" id="contract-filter"
                                        placeholder="Cari kontrak..." aria-label="Cari kontrak">
                                </div>
                                <select class="c-input" id="contract-status-filter" aria-label="Filter status kontrak">
                                    <option value="">Semua Status</option>
                                    <option value="Aktif">Aktif</option>
                                    <option value="Akan Berakhir">Akan Berakhir</option>
                                    <option value="Selesai">Selesai</option>
                                </select>
                            </div>
                            <button class="c-button btn-outline" onclick="exportContractData()">
                                <i class="fas fa-download"></i>
                                <span>Ekspor Data</span>
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="c-table" aria-label="Daftar kontrak">
                                <thead>
                                    <tr>
                                        <th>No. Kontrak</th>
                                        <th>Penyewa</th>
                                        <th>Unit</th>
                                        <th>Periode</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="contracts-tbody">
                                    <tr>
                                        <td colspan="6" class="text-center">Memuat data kontrak...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-between align-center mt-4">
                            <div class="text-muted" id="contract-pagination-info">Menampilkan 0 dari 0 kontrak</div>
                            <div class="flex gap-xs">
                                <button class="c-button btn-outline" id="prev-contract-page" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="c-button btn-outline" id="next-contract-page" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pembayaran Section -->
            <section id="pembayaran" class="section-content" hidden>
                <div class="container">
                    <div class="flex justify-between align-center mb-4">
                        <div>
                            <h2>Manajemen Pembayaran</h2>
                            <p class="text-muted">Kelola pembayaran sewa penyewa</p>
                        </div>
                        <button class="c-button" onclick="openModal('add-payment')">
                            <i class="fas fa-plus-circle"></i>
                            <span>Catat Pembayaran</span>
                        </button>
                    </div>

                    <div class="grid grid-cols-2 gap-md">
                        <div class="c-card">
                            <h3>Pencatatan Pembayaran</h3>
                            <form id="payment-form" class="c-form">
                                <div class="form-group">
                                    <label for="payment-tenant">Penyewa</label>
                                    <select id="payment-tenant" class="c-input" required>
                                        <option value="">Pilih Penyewa</option>
                                    </select>
                                    <span class="error" id="payment-tenant-error"></span>
                                </div>

                                <div class="form-group">
                                    <label for="payment-amount">Jumlah Pembayaran (Rp)</label>
                                    <input type="number" id="payment-amount" class="c-input"
                                        placeholder="Masukkan jumlah" required>
                                    <span class="error" id="payment-amount-error"></span>
                                </div>

                                <div class="form-group">
                                    <label for="payment-date">Tanggal Pembayaran</label>
                                    <input type="date" id="payment-date" class="c-input" required>
                                    <span class="error" id="payment-date-error"></span>
                                </div>

                                <div class="form-group">
                                    <label for="payment-method">Metode Pembayaran</label>
                                    <select id="payment-method" class="c-input" required>
                                        <option value="">Pilih Metode</option>
                                        <option value="Transfer Bank">Transfer Bank</option>
                                        <option value="Tunai">Tunai</option>
                                        <option value="E-Wallet">E-Wallet</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                    <span class="error" id="payment-method-error"></span>
                                </div>

                                <div class="form-group">
                                    <label for="payment-note">Catatan (Opsional)</label>
                                    <textarea id="payment-note" class="c-input" rows="2"></textarea>
                                </div>

                                <button type="submit" class="c-button">
                                    <i class="fas fa-save"></i>
                                    <span>Simpan Pembayaran</span>
                                </button>
                            </form>
                        </div>

                        <div class="c-card">
                            <div class="flex justify-between align-center mb-4">
                                <h3>Riwayat Pembayaran</h3>
                                <button class="c-button btn-outline" onclick="exportPaymentData()">
                                    <i class="fas fa-download"></i>
                                    <span>Ekspor Data</span>
                                </button>
                            </div>

                            <div class="flex gap-md align-center mb-4">
                                <div class="form-group" style="flex: 1;">
                                    <input type="text" class="c-input" id="payment-history-filter"
                                        placeholder="Cari pembayaran...">
                                </div>
                                <input type="month" class="c-input" id="payment-month-filter">
                            </div>

                            <div class="table-responsive">
                                <table class="c-table">
                                    <thead>
                                        <tr>
                                            <th>Tanggal</th>
                                            <th>Penyewa</th>
                                            <th>Jumlah</th>
                                            <th>Metode</th>
                                            <th>Status</th>
                                        </tr>
                                    </thead>
                                    <tbody id="payments-tbody">
                                        <tr>
                                            <td colspan="5" class="text-center">Memuat riwayat pembayaran...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="flex justify-between align-center mt-4">
                                <div class="text-muted" id="payment-pagination-info">Menampilkan 0 dari 0 pembayaran
                                </div>
                                <div class="flex gap-xs">
                                    <button class="c-button btn-outline" id="prev-payment-page" disabled>
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <button class="c-button btn-outline" id="next-payment-page" disabled>
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pemeliharaan Section -->
            <section id="pemeliharaan" class="section-content" hidden>
                <div class="container">
                    <div class="flex justify-between align-center mb-4">
                        <div>
                            <h2>Manajemen Pemeliharaan</h2>
                            <p class="text-muted">Kelola permintaan perbaikan dan pemeliharaan</p>
                        </div>
                        <button class="c-button" onclick="openModal('add-maintenance')">
                            <i class="fas fa-tools"></i>
                            <span>Buat Tiket Baru</span>
                        </button>
                    </div>

                    <div class="c-card">
                        <div class="flex justify-between align-center mb-4">
                            <div class="flex gap-md align-center">
                                <div class="form-group" style="min-width: 250px;">
                                    <input type="text" class="c-input" id="maintenance-filter"
                                        placeholder="Cari tiket...">
                                </div>
                                <select class="c-input" id="maintenance-status-filter">
                                    <option value="">Semua Status</option>
                                    <option value="Dibuat">Dibuat</option>
                                    <option value="Diproses">Diproses</option>
                                    <option value="Selesai">Selesai</option>
                                </select>
                                <select class="c-input" id="maintenance-priority-filter">
                                    <option value="">Semua Prioritas</option>
                                    <option value="Rendah">Rendah</option>
                                    <option value="Sedang">Sedang</option>
                                    <option value="Tinggi">Tinggi</option>
                                    <option value="Darurat">Darurat</option>
                                </select>
                            </div>
                            <button class="c-button btn-outline" onclick="exportMaintenanceData()">
                                <i class="fas fa-download"></i>
                                <span>Ekspor Data</span>
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="c-table">
                                <thead>
                                    <tr>
                                        <th>No. Tiket</th>
                                        <th>Unit</th>
                                        <th>Masalah</th>
                                        <th>Prioritas</th>
                                        <th>Status</th>
                                        <th>Tanggal Dibuat</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="maintenance-tbody">
                                    <tr>
                                        <td colspan="7" class="text-center">Memuat data pemeliharaan...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-between align-center mt-4">
                            <div class="text-muted" id="maintenance-pagination-info">Menampilkan 0 dari 0 tiket</div>
                            <div class="flex gap-xs">
                                <button class="c-button btn-outline" id="prev-maintenance-page" disabled>
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="c-button btn-outline" id="next-maintenance-page" disabled>
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Laporan Section -->
            <section id="laporan" class="section-content" hidden>
                <div class="container">
                    <h2>Laporan dan Analitik</h2>
                    <p class="text-muted mb-4">Analisis kinerja properti dan keuangan</p>

                    <div class="feature-tabs">
                        <button class="feature-tab active" data-tab="financial">Keuangan</button>
                        <button class="feature-tab" data-tab="occupancy">Tingkat Hunian</button>
                        <button class="feature-tab" data-tab="maintenance">Pemeliharaan</button>
                    </div>

                    <div id="financial-report" class="tab-content">
                        <div class="grid grid-cols-2 gap-md mb-4">
                            <div class="c-card">
                                <h3>Pendapatan Bulanan</h3>
                                <canvas id="income-chart" style="max-height: 300px;"></canvas>
                            </div>
                            <div class="c-card">
                                <h3>Status Pembayaran</h3>
                                <canvas id="payment-status-chart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>

                        <div class="c-card">
                            <div class="flex justify-between align-center mb-4">
                                <h3>Rincian Pendapatan</h3>
                                <div class="flex gap-md">
                                    <input type="month" class="c-input" id="financial-month-filter">
                                    <button class="c-button btn-outline" onclick="exportFinancialReport()">
                                        <i class="fas fa-download"></i>
                                        <span>Ekspor Laporan</span>
                                    </button>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="c-table">
                                    <thead>
                                        <tr>
                                            <th>Unit</th>
                                            <th>Penyewa</th>
                                            <th>Jumlah Sewa</th>
                                            <th>Status Pembayaran</th>
                                            <th>Tunggakan</th>
                                        </tr>
                                    </thead>
                                    <tbody id="financial-details">
                                        <tr>
                                            <td colspan="5" class="text-center">Memuat data keuangan...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="occupancy-report" class="tab-content" hidden>
                        <div class="grid grid-cols-2 gap-md mb-4">
                            <div class="c-card">
                                <h3>Tingkat Hunian</h3>
                                <canvas id="occupancy-chart" style="max-height: 300px;"></canvas>
                            </div>
                            <div class="c-card">
                                <h3>Perbandingan Unit</h3>
                                <canvas id="unit-comparison-chart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>

                        <div class="c-card">
                            <div class="flex justify-between align-center mb-4">
                                <h3>Riwayat Penyewaan</h3>
                                <button class="c-button btn-outline" onclick="exportOccupancyReport()">
                                    <i class="fas fa-download"></i>
                                    <span>Ekspor Laporan</span>
                                </button>
                            </div>

                            <div class="table-responsive">
                                <table class="c-table">
                                    <thead>
                                        <tr>
                                            <th>Unit</th>
                                            <th>Tipe</th>
                                            <th>Status</th>
                                            <th>Penyewa Terakhir</th>
                                            <th>Durasi Sewa</th>
                                        </tr>
                                    </thead>
                                    <tbody id="occupancy-details">
                                        <tr>
                                            <td colspan="5" class="text-center">Memuat data hunian...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="maintenance-report" class="tab-content" hidden>
                        <div class="grid grid-cols-2 gap-md mb-4">
                            <div class="c-card">
                                <h3>Statistik Pemeliharaan</h3>
                                <canvas id="maintenance-stats-chart" style="max-height: 300px;"></canvas>
                            </div>
                            <div class="c-card">
                                <h3>Biaya Pemeliharaan</h3>
                                <canvas id="maintenance-cost-chart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>

                        <div class="c-card">
                            <div class="flex justify-between align-center mb-4">
                                <h3>Riwayat Pemeliharaan</h3>
                                <div class="flex gap-md">
                                    <input type="month" class="c-input" id="maintenance-month-filter">
                                    <button class="c-button btn-outline" onclick="exportMaintenanceReport()">
                                        <i class="fas fa-download"></i>
                                        <span>Ekspor Laporan</span>
                                    </button>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table class="c-table">
                                    <thead>
                                        <tr>
                                            <th>No. Tiket</th>
                                            <th>Unit</th>
                                            <th>Masalah</th>
                                            <th>Biaya</th>
                                            <th>Durasi Perbaikan</th>
                                        </tr>
                                    </thead>
                                    <tbody id="maintenance-details">
                                        <tr>
                                            <td colspan="5" class="text-center">Memuat data pemeliharaan...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Pengaturan Section -->
            <section id="pengaturan" class="section-content" hidden>
                <div class="container">
                    <h2>Pengaturan Sistem</h2>
                    <p class="text-muted mb-4">Kelola pengaturan akun dan sistem</p>

                    <div class="grid grid-cols-3 gap-md">
                        <div class="c-card">
                            <h3>Profil Akun</h3>
                            <form id="profile-form" class="c-form">
                                <div class="form-group">
                                    <label for="profile-name">Nama Lengkap</label>
                                    <input type="text" id="profile-name" class="c-input" value="Admin Rentelindo"
                                        required>
                                </div>

                                <div class="form-group">
                                    <label for="profile-email">Email</label>
                                    <input type="email" id="profile-email" class="c-input" value="admin@rentelindo.com"
                                        required>
                                </div>

                                <div class="form-group">
                                    <label for="profile-phone">Nomor Telepon</label>
                                    <input type="tel" id="profile-phone" class="c-input" value="+6281234567890">
                                </div>

                                <button type="submit" class="c-button">
                                    <i class="fas fa-save"></i>
                                    <span>Simpan Perubahan</span>
                                </button>
                            </form>
                        </div>

                        <div class="c-card">
                            <h3>Ubah Password</h3>
                            <form id="password-form" class="c-form">
                                <div class="form-group">
                                    <label for="current-password">Password Saat Ini</label>
                                    <input type="password" id="current-password" class="c-input" required>
                                </div>

                                <div class="form-group">
                                    <label for="new-password">Password Baru</label>
                                    <input type="password" id="new-password" class="c-input" required>
                                </div>

                                <div class="form-group">
                                    <label for="confirm-password">Konfirmasi Password Baru</label>
                                    <input type="password" id="confirm-password" class="c-input" required>
                                </div>

                                <button type="submit" class="c-button">
                                    <i class="fas fa-key"></i>
                                    <span>Ubah Password</span>
                                </button>
                            </form>
                        </div>

                        <div class="c-card">
                            <h3>Pengaturan Sistem</h3>
                            <form id="system-form" class="c-form">
                                <div class="form-group">
                                    <label for="currency">Mata Uang</label>
                                    <select id="currency" class="c-input">
                                        <option value="IDR" selected>Rupiah (IDR)</option>
                                        <option value="USD">Dollar AS (USD)</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="date-format">Format Tanggal</label>
                                    <select id="date-format" class="c-input">
                                        <option value="DD/MM/YYYY" selected>DD/MM/YYYY</option>
                                        <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                                        <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label for="notifications">Notifikasi Email</label>
                                    <div class="flex align-center gap-sm">
                                        <input type="checkbox" id="notifications" class="c-input" checked>
                                        <span>Aktifkan notifikasi email</span>
                                    </div>
                                </div>

                                <button type="submit" class="c-button">
                                    <i class="fas fa-cog"></i>
                                    <span>Simpan Pengaturan</span>
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div> <!-- Modal Tambah Penyewa -->
    <div class="c-modal" id="add-tenant-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('add-tenant')"
                aria-label="Tutup modal"> <i class="fas fa-times"></i> </button>
            <h2>Tambah Penyewa Baru</h2>
            <form id="add-tenant-form" class="c-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="tenant-id">ID Penyewa</label>
                        <input type="text" id="tenant-id" class="c-input" placeholder="T001" required>
                        <span class="error" id="tenant-id-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="tenant-status">Status</label>
                        <select id="tenant-status" class="c-input" required>
                            <option value="Aktif">Aktif</option>
                            <option value="Menunggu">Menunggu</option>
                            <option value="Nonaktif">Nonaktif</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tenant-name">Nama Lengkap</label>
                    <input type="text" id="tenant-name" class="c-input" placeholder="Masukkan nama lengkap" required>
                    <span class="error" id="tenant-name-error"></span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tenant-email">Email</label>
                        <input type="email" id="tenant-email" class="c-input" placeholder="contoh@email.com" required>
                        <span class="error" id="tenant-email-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="tenant-phone">Nomor Telepon</label>
                        <input type="tel" id="tenant-phone" class="c-input" placeholder="+6281234567890" required>
                        <span class="error" id="tenant-phone-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tenant-ktp">Nomor KTP</label>
                    <input type="text" id="tenant-ktp" class="c-input" placeholder="Masukkan nomor KTP" required>
                    <span class="error" id="tenant-ktp-error"></span>
                </div>

                <div class="form-group">
                    <label for="tenant-address">Alamat</label>
                    <textarea id="tenant-address" class="c-input" rows="2"
                        placeholder="Masukkan alamat lengkap"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tenant-unit">Unit yang Disewa</label>
                        <select id="tenant-unit" class="c-input" required>
                            <option value="">Pilih Unit</option>
                        </select>
                        <span class="error" id="tenant-unit-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="tenant-rent">Harga Sewa (Rp)</label>
                        <input type="number" id="tenant-rent" class="c-input" placeholder="Masukkan harga sewa"
                            required>
                        <span class="error" id="tenant-rent-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tenant-photo">Foto Penyewa</label>
                    <input type="file" id="tenant-photo" class="c-input" accept="image/*">
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('add-tenant')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-save"></i>
                        <span>Simpan Penyewa</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Edit Penyewa -->
    <div class="c-modal" id="edit-tenant-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('edit-tenant')"
                aria-label="Tutup modal"> <i class="fas fa-times"></i> </button>
            <h2>Edit Data Penyewa</h2>
            <form id="edit-tenant-form" class="c-form">
                <input type="hidden" id="edit-tenant-id">

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-tenant-name">Nama Lengkap</label>
                        <input type="text" id="edit-tenant-name" class="c-input" required>
                        <span class="error" id="edit-tenant-name-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="edit-tenant-status">Status</label>
                        <select id="edit-tenant-status" class="c-input" required>
                            <option value="Aktif">Aktif</option>
                            <option value="Menunggu">Menunggu</option>
                            <option value="Nonaktif">Nonaktif</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-tenant-email">Email</label>
                        <input type="email" id="edit-tenant-email" class="c-input" required>
                        <span class="error" id="edit-tenant-email-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="edit-tenant-phone">Nomor Telepon</label>
                        <input type="tel" id="edit-tenant-phone" class="c-input" required>
                        <span class="error" id="edit-tenant-phone-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit-tenant-ktp">Nomor KTP</label>
                    <input type="text" id="edit-tenant-ktp" class="c-input" required>
                    <span class="error" id="edit-tenant-ktp-error"></span>
                </div>

                <div class="form-group">
                    <label for="edit-tenant-address">Alamat</label>
                    <textarea id="edit-tenant-address" class="c-input" rows="2"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-tenant-unit">Unit yang Disewa</label>
                        <select id="edit-tenant-unit" class="c-input" required>
                            <option value="">Pilih Unit</option>
                        </select>
                        <span class="error" id="edit-tenant-unit-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="edit-tenant-rent">Harga Sewa (Rp)</label>
                        <input type="number" id="edit-tenant-rent" class="c-input" required>
                        <span class="error" id="edit-tenant-rent-error"></span>
                    </div>
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('edit-tenant')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-save"></i>
                        <span>Simpan Perubahan</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Tambah Unit -->
    <div class="c-modal" id="add-unit-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('add-unit')"
                aria-label="Tutup modal">
                <i class="fas fa-times"></i> </button>
            <h2>Tambah Unit Properti</h2>
            <form id="add-unit-form" class="c-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="unit-code">Kode Unit</label>
                        <input type="text" id="unit-code" class="c-input" placeholder="A101" required>
                        <span class="error" id="unit-code-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="unit-type">Tipe Unit</label>
                        <select id="unit-type" class="c-input" required>
                            <option value="">Pilih Tipe</option>
                            <option value="Studio">Studio</option>
                            <option value="1BR">1 Kamar Tidur</option>
                            <option value="2BR">2 Kamar Tidur</option>
                            <option value="3BR">3 Kamar Tidur</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="unit-location">Lokasi/Gedung</label>
                        <input type="text" id="unit-location" class="c-input" placeholder="Gedung A" required>
                    </div>

                    <div class="form-group">
                        <label for="unit-status">Status</label>
                        <select id="unit-status" class="c-input" required>
                            <option value="Tersedia">Tersedia</option>
                            <option value="Ditempati">Ditempati</option>
                            <option value="Perbaikan">Perbaikan</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="unit-size">Luas (m¬≤)</label>
                        <input type="number" id="unit-size" class="c-input" placeholder="Masukkan luas unit">
                    </div>

                    <div class="form-group">
                        <label for="unit-rent">Harga Sewa (Rp)</label>
                        <input type="number" id="unit-rent" class="c-input" placeholder="Masukkan harga sewa" required>
                        <span class="error" id="unit-rent-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="unit-facilities">Fasilitas</label>
                    <div class="flex flex-wrap gap-sm">
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="AC"> AC
                        </label>
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="Kamar Mandi Dalam"> Kamar Mandi Dalam
                        </label>
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="Dapur"> Dapur
                        </label>
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="Internet"> Internet
                        </label>
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="TV"> TV
                        </label>
                        <label class="flex align-center gap-xs">
                            <input type="checkbox" name="facilities" value="Lemari"> Lemari
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="unit-photos">Foto Unit</label>
                    <input type="file" id="unit-photos" class="c-input" accept="image/*" multiple>
                </div>

                <div class="form-group">
                    <label for="unit-description">Deskripsi</label>
                    <textarea id="unit-description" class="c-input" rows="3"
                        placeholder="Masukkan deskripsi unit"></textarea>
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('add-unit')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-save"></i>
                        <span>Simpan Unit</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Edit Unit -->
    <div class="c-modal" id="edit-unit-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('edit-unit')"
                aria-label="Tutup modal">
                <i class="fas fa-times"></i> </button>
            <h2>Edit Unit Properti</h2>
            <form id="edit-unit-form" class="c-form">
                <input type="hidden" id="edit-unit-id">

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-unit-code">Kode Unit</label>
                        <input type="text" id="edit-unit-code" class="c-input" required>
                        <span class="error" id="edit-unit-code-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="edit-unit-type">Tipe Unit</label>
                        <select id="edit-unit-type" class="c-input" required>
                            <option value="">Pilih Tipe</option>
                            <option value="Studio">Studio</option>
                            <option value="1BR">1 Kamar Tidur</option>
                            <option value="2BR">2 Kamar Tidur</option>
                            <option value="3BR">3 Kamar Tidur</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-unit-location">Lokasi/Gedung</label>
                        <input type="text" id="edit-unit-location" class="c-input" required>
                    </div>

                    <div class="form-group">
                        <label for="edit-unit-status">Status</label>
                        <select id="edit-unit-status" class="c-input" required>
                            <option value="Tersedia">Tersedia</option>
                            <option value="Ditempati">Ditempati</option>
                            <option value="Perbaikan">Perbaikan</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-unit-size">Luas (m¬≤)</label>
                        <input type="number" id="edit-unit-size" class="c-input">
                    </div>

                    <div class="form-group">
                        <label for="edit-unit-rent">Harga Sewa (Rp)</label>
                        <input type="number" id="edit-unit-rent" class="c-input" required>
                        <span class="error" id="edit-unit-rent-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Fasilitas</label>
                    <div class="flex flex-wrap gap-sm" id="edit-unit-facilities">
                        <!-- Facilities will be populated by JavaScript -->
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit-unit-description">Deskripsi</label>
                    <textarea id="edit-unit-description" class="c-input" rows="3"></textarea>
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('edit-unit')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-save"></i>
                        <span>Simpan Perubahan</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Tambah Kontrak -->
    <div class="c-modal" id="add-contract-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('add-contract')"
                aria-label="Tutup modal"> <i class="fas fa-times"></i> </button>
            <h2>Buat Kontrak Sewa Baru</h2>
            <form id="add-contract-form" class="c-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="contract-number">Nomor Kontrak</label>
                        <input type="text" id="contract-number" class="c-input" placeholder="KONTRAK/2023/001" required>
                        <span class="error" id="contract-number-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="contract-tenant">Penyewa</label>
                        <select id="contract-tenant" class="c-input" required>
                            <option value="">Pilih Penyewa</option>
                        </select>
                        <span class="error" id="contract-tenant-error"></span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="contract-unit">Unit Properti</label>
                        <select id="contract-unit" class="c-input" required>
                            <option value="">Pilih Unit</option>
                        </select>
                        <span class="error" id="contract-unit-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="contract-rent">Harga Sewa (Rp)</label>
                        <input type="number" id="contract-rent" class="c-input" required>
                        <span class="error" id="contract-rent-error"></span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="contract-start">Tanggal Mulai</label>
                        <input type="date" id="contract-start" class="c-input" required>
                        <span class="error" id="contract-start-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="contract-end">Tanggal Berakhir</label>
                        <input type="date" id="contract-end" class="c-input" required>
                        <span class="error" id="contract-end-error"></span>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="contract-deposit">Deposit (Rp)</label>
                        <input type="number" id="contract-deposit" class="c-input" required>
                        <span class="error" id="contract-deposit-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="contract-payment-day">Tanggal Jatuh Tempo</label>
                        <input type="number" id="contract-payment-day" class="c-input" min="1" max="31" value="10"
                            required>
                        <span class="error" id="contract-payment-day-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="contract-terms">Syarat dan Ketentuan</label>
                    <textarea id="contract-terms" class="c-input" rows="4"
                        placeholder="Masukkan syarat dan ketentuan kontrak"></textarea>
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('add-contract')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-file-signature"></i>
                        <span>Buat Kontrak</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Detail Kontrak -->
    <div class="c-modal" id="contract-detail-modal">
        <div class="modal-content" style="max-width: 800px;"> <button class="modal-close"
                onclick="toggleModal('contract-detail')" aria-label="Tutup modal"> <i class="fas fa-times"></i>
            </button>
            <h2>Detail Kontrak Sewa</h2>
            <div class="contract-detail-content">
                <div class="flex justify-between mb-4">
                    <div>
                        <h3 id="contract-detail-number">KONTRAK/2023/001</h3>
                        <p class="text-muted" id="contract-detail-status"><span class="badge badge-success">Aktif</span>
                        </p>
                    </div>
                    <div class="text-right">
                        <button class="c-button btn-outline" onclick="printContract()">
                            <i class="fas fa-print"></i>
                            <span>Cetak Kontrak</span>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-md mb-4">
                    <div class="c-card">
                        <h4>Informasi Penyewa</h4>
                        <p id="contract-detail-tenant">Nama Penyewa</p>
                        <p id="contract-detail-tenant-contact">Kontak Penyewa</p>
                        <p id="contract-detail-tenant-id">ID: T001</p>
                    </div>

                    <div class="c-card">
                        <h4>Informasi Unit</h4>
                        <p id="contract-detail-unit">Nama Unit</p>
                        <p id="contract-detail-unit-location">Lokasi Unit</p>
                        <p id="contract-detail-unit-rent">Harga Sewa: Rp 0</p>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-md mb-4">
                    <div class="c-card">
                        <h4>Periode Kontrak</h4>
                        <p id="contract-detail-period">01 Jan 2023 - 31 Des 2023</p>
                    </div>

                    <div class="c-card">
                        <h4>Pembayaran</h4>
                        <p id="contract-detail-payment">Jatuh Tempo: Tiap bulan tanggal 10</p>
                    </div>

                    <div class="c-card">
                        <h4>Deposit</h4>
                        <p id="contract-detail-deposit">Rp 0</p>
                    </div>
                </div>

                <div class="c-card mb-4">
                    <h4>Riwayat Pembayaran</h4>
                    <div class="table-responsive">
                        <table class="c-table">
                            <thead>
                                <tr>
                                    <th>Bulan</th>
                                    <th>Jumlah</th>
                                    <th>Status</th>
                                    <th>Tanggal Bayar</th>
                                </tr>
                            </thead>
                            <tbody id="contract-payment-history">
                                <tr>
                                    <td colspan="4" class="text-center">Memuat riwayat pembayaran...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="c-card">
                    <h4>Syarat dan Ketentuan</h4>
                    <div id="contract-detail-terms" class="prose">
                        <!-- Contract terms will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- Modal Tambah Pemeliharaan -->
    <div class="c-modal" id="add-maintenance-modal">
        <div class="modal-content"> <button class="modal-close" onclick="toggleModal('add-maintenance')"
                aria-label="Tutup modal"> <i class="fas fa-times"></i> </button>
            <h2>Buat Tiket Pemeliharaan</h2>
            <form id="add-maintenance-form" class="c-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="maintenance-unit">Unit Properti</label>
                        <select id="maintenance-unit" class="c-input" required>
                            <option value="">Pilih Unit</option>
                        </select>
                        <span class="error" id="maintenance-unit-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="maintenance-priority">Prioritas</label>
                        <select id="maintenance-priority" class="c-input" required>
                            <option value="Rendah">Rendah</option>
                            <option value="Sedang">Sedang</option>
                            <option value="Tinggi">Tinggi</option>
                            <option value="Darurat">Darurat</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="maintenance-issue">Masalah</label>
                    <input type="text" id="maintenance-issue" class="c-input" placeholder="Jelaskan masalahnya"
                        required>
                    <span class="error" id="maintenance-issue-error"></span>
                </div>

                <div class="form-group">
                    <label for="maintenance-description">Deskripsi Lengkap</label>
                    <textarea id="maintenance-description" class="c-input" rows="3"
                        placeholder="Jelaskan secara detail masalah yang terjadi"></textarea>
                </div>

                <div class="form-group">
                    <label for="maintenance-photos">Foto Bukti</label>
                    <input type="file" id="maintenance-photos" class="c-input" accept="image/*" multiple>
                </div>

                <div class="flex justify-end gap-sm">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('add-maintenance')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="submit" class="c-button">
                        <i class="fas fa-tools"></i>
                        <span>Buat Tiket</span>
                    </button>
                </div>
            </form>
        </div>
    </div> <!-- Modal Detail Pemeliharaan -->
    <div class="c-modal" id="maintenance-detail-modal">
        <div class="modal-content" style="max-width: 800px;"> <button class="modal-close"
                onclick="toggleModal('maintenance-detail')" aria-label="Tutup modal"> <i class="fas fa-times"></i>
            </button>
            <h2>Detail Pemeliharaan</h2>
            <div class="maintenance-detail-content">
                <div class="flex justify-between mb-4">
                    <div>
                        <h3 id="maintenance-detail-id">TIKET/2023/001</h3>
                        <p class="text-muted">
                            <span id="maintenance-detail-status" class="badge">Status</span>
                            <span id="maintenance-detail-priority" class="badge ml-2">Prioritas</span>
                        </p>
                    </div>
                    <div class="flex gap-sm">
                        <button class="c-button btn-outline" id="maintenance-edit-btn">
                            <i class="fas fa-edit"></i>
                            <span>Edit</span>
                        </button>
                        <button class="c-button btn-outline" onclick="printMaintenanceTicket()">
                            <i class="fas fa-print"></i>
                            <span>Cetak</span>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-md mb-4">
                    <div class="c-card">
                        <h4>Informasi Unit</h4>
                        <p id="maintenance-detail-unit">Nama Unit</p>
                        <p id="maintenance-detail-unit-location">Lokasi Unit</p>
                        <p id="maintenance-detail-tenant">Penyewa: Nama Penyewa</p>
                    </div>

                    <div class="c-card">
                        <h4>Detail Tiket</h4>
                        <p id="maintenance-detail-date">Dibuat pada: 01 Jan 2023</p>
                        <p id="maintenance-detail-assignee">Ditangani oleh: -</p>
                        <p id="maintenance-detail-cost">Biaya: Rp 0</p>
                    </div>
                </div>

                <div class="c-card mb-4">
                    <h4>Deskripsi Masalah</h4>
                    <p id="maintenance-detail-issue">Masalah yang dilaporkan</p>
                    <div id="maintenance-detail-description" class="mt-2">
                        <!-- Detailed description will be here -->
                    </div>
                </div>

                <div class="c-card mb-4">
                    <h4>Foto Bukti</h4>
                    <div class="grid grid-cols-3 gap-md" id="maintenance-detail-photos">
                        <!-- Photos will be populated here -->
                    </div>
                </div>

                <div class="c-card">
                    <h4>Riwayat Perbaikan</h4>
                    <div id="maintenance-detail-history">
                        <!-- Maintenance history will be populated here -->
                    </div>

                    <form id="maintenance-update-form" class="c-form mt-4">
                        <div class="form-group">
                            <label for="maintenance-update-status">Update Status</label>
                            <select id="maintenance-update-status" class="c-input">
                                <option value="Diproses">Diproses</option>
                                <option value="Selesai">Selesai</option>
                                <option value="Dibatalkan">Dibatalkan</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="maintenance-update-note">Catatan</label>
                            <textarea id="maintenance-update-note" class="c-input" rows="2"
                                placeholder="Tambahkan catatan update"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="maintenance-update-cost">Biaya Perbaikan (Rp)</label>
                            <input type="number" id="maintenance-update-cost" class="c-input"
                                placeholder="Masukkan biaya jika ada">
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="c-button">
                                <i class="fas fa-save"></i>
                                <span>Simpan Update</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div> <!-- Modal Konfirmasi -->
    <div class="c-modal" id="confirm-modal">
        <div class="modal-content" style="max-width: 500px;"> <button class="modal-close"
                onclick="toggleModal('confirm')" aria-label="Tutup modal"> <i class="fas fa-times"></i> </button>
            <h2 id="confirm-title">Konfirmasi</h2>
            <div class="confirm-content">
                <p id="confirm-message">Apakah Anda yakin ingin melakukan tindakan ini?</p>

                <div class="flex justify-end gap-sm mt-4">
                    <button type="button" class="c-button btn-outline" onclick="toggleModal('confirm')">
                        <i class="fas fa-times"></i>
                        <span>Batal</span>
                    </button>
                    <button type="button" class="c-button btn-danger" id="confirm-action-btn">
                        <i class="fas fa-check"></i>
                        <span>Konfirmasi</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <footer class="c-footer text-center py-4 mt-8" role="contentinfo">
        <div class="container">
            <p>¬© 2023 Rentelindo. Semua Hak Dilindungi.</p>
            <p class="text-muted">Versi 1.0.0 | Dibuat dengan ‚ù§Ô∏è untuk pengelola properti di Indonesia</p>
        </div>
    </footer>
    <div class="toast" id="toast"></div>
    <script> (function () {
            'use strict'; // State Management const state = { theme: 'light', currentSection: 'dashboard', currentTab: 'financial', tenants: [], units: [], contracts: [], payments: [], maintenance: [], notifications: [], settings: { currency: 'IDR', dateFormat: 'DD/MM/YYYY', emailNotifications: true }, pagination: { tenants: { page: 1, perPage: 10, total: 0 }, units: { page: 1, perPage: 10, total: 0 }, contracts: { page: 1, perPage: 10, total: 0 }, payments: { page: 1, perPage: 10, total: 0 }, maintenance: { page: 1, perPage: 10, total: 0 } } }; // DOM Elements const elements = { // Header themeToggle: document.querySelector('.theme-toggle'), themeText: document.querySelector('.theme-text'), notificationsBtn: document.getElementById('notifications'), notificationBadge: document.getElementById('notification-badge'), // Main Content mainContent: document.querySelector('.main-content'), sectionContents: document.querySelectorAll('.section-content'), // Dashboard totalUnits: document.getElementById('total-units'), rentedUnits: document.getElementById('rented-units'), vacantUnits: document.getElementById('vacant-units'), monthlyIncome: document.getElementById('monthly-income'), unitChart: document.getElementById('unit-chart'), recentPayments: document.getElementById('recent-payments'), recentMaintenance: document.getElementById('recent-maintenance'), // Tenants tenantFilter: document.getElementById('tenant-filter'), tenantStatusFilter: document.getElementById('tenant-status-filter'), tenantsTbody: document.getElementById('tenants-tbody'), tenantPaginationInfo: document.getElementById('tenant-pagination-info'), prevTenantPage: document.getElementById('prev-tenant-page'), nextTenantPage: document.getElementById('next-tenant-page'), // Units unitFilter: document.getElementById('unit-filter'), unitStatusFilter: document.getElementById('unit-status-filter'), unitsTbody: document.getElementById('units-tbody'), unitPaginationInfo: document.getElementById('unit-pagination-info'), prevUnitPage: document.getElementById('prev-unit-page'), nextUnitPage: document.getElementById('next-unit-page'), // Contracts contractFilter: document.getElementById('contract-filter'), contractStatusFilter: document.getElementById('contract-status-filter'), contractsTbody: document.getElementById('contracts-tbody'), contractPaginationInfo: document.getElementById('contract-pagination-info'), prevContractPage: document.getElementById('prev-contract-page'), nextContractPage: document.getElementById('next-contract-page'), // Payments paymentForm: document.getElementById('payment-form'), paymentTenant: document.getElementById('payment-tenant'), paymentAmount: document.getElementById('payment-amount'), paymentDate: document.getElementById('payment-date'), paymentMethod: document.getElementById('payment-method'), paymentNote: document.getElementById('payment-note'), paymentHistoryFilter: document.getElementById('payment-history-filter'), paymentMonthFilter: document.getElementById('payment-month-filter'), paymentsTbody: document.getElementById('payments-tbody'), paymentPaginationInfo: document.getElementById('payment-pagination-info'), prevPaymentPage: document.getElementById('prev-payment-page'), nextPaymentPage: document.getElementById('next-payment-page'), // Maintenance maintenanceFilter: document.getElementById('maintenance-filter'), maintenanceStatusFilter: document.getElementById('maintenance-status-filter'), maintenancePriorityFilter: document.getElementById('maintenance-priority-filter'), maintenanceTbody: document.getElementById('maintenance-tbody'), maintenancePaginationInfo: document.getElementById('maintenance-pagination-info'), prevMaintenancePage: document.getElementById('prev-maintenance-page'), nextMaintenancePage: document.getElementById('next-maintenance-page'), // Reports reportTabs: document.querySelectorAll('.feature-tab'), tabContents: document.querySelectorAll('.tab-content'), financialMonthFilter: document.getElementById('financial-month-filter'), financialDetails: document.getElementById('financial-details'), maintenanceMonthFilter: document.getElementById('maintenance-month-filter'), maintenanceDetails: document.getElementById('maintenance-details'), // Modals modals: document.querySelectorAll('.c-modal'), modalCloses: document.querySelectorAll('.modal-close'), // Toast toast: document.getElementById('toast') }; // Chart Instances const charts = { unitChart: null, incomeChart: null, paymentStatusChart: null, occupancyChart: null, unitComparisonChart: null, maintenanceStatsChart: null, maintenanceCostChart: null }; // Initialize the application function init() { loadData(); initTheme(); initNavigation(); initForms(); initModals(); initEventListeners(); renderDashboard(); showSection('dashboard'); } // Load sample data function loadData() { // Sample tenants data state.tenants = [ { id: 'T001', name: 'Budi Santoso', email: 'budi@example.com', phone: '+6281234567890', ktp: '1234567890123456', address: 'Jl. Merdeka No. 123, Jakarta', unit: 'A101', rent: 5000000, status: 'Aktif', joinDate: '2023-01-15', photo: null }, { id: 'T002', name: 'Siti Rahayu', email: 'siti@example.com', phone: '+6289876543210', ktp: '6543210987654321', address: 'Jl. Sudirman No. 456, Jakarta', unit: 'B202', rent: 7500000, status: 'Aktif', joinDate: '2023-02-20', photo: null }, { id: 'T003', name: 'Andi Wijaya', email: 'andi@example.com', phone: '+6281122334455', ktp: '9876543210123456', address: 'Jl. Thamrin No. 789, Jakarta', unit: 'C303', rent: 6000000, status: 'Menunggu', joinDate: '2023-03-10', photo: null } ]; // Sample units data state.units = [ { code: 'A101', type: '1BR', location: 'Gedung A', size: 45, rent: 5000000, status: 'Ditempati', facilities: ['AC', 'Kamar Mandi Dalam', 'Internet'], description: 'Unit 1 kamar tidur dengan view kota', photos: [], tenant: 'T001' }, { code: 'B202', type: '2BR', location: 'Gedung B', size: 65, rent: 7500000, status: 'Ditempati', facilities: ['AC', 'Kamar Mandi Dalam', 'Dapur', 'Internet', 'TV'], description: 'Unit 2 kamar tidur dengan balkon', photos: [], tenant: 'T002' }, { code: 'C303', type: 'Studio', location: 'Gedung C', size: 35, rent: 4000000, status: 'Tersedia', facilities: ['AC', 'Kamar Mandi Dalam'], description: 'Unit studio cocok untuk single', photos: [], tenant: null }, { code: 'D404', type: '3BR', location: 'Gedung D', size: 85, rent: 9000000, status: 'Perbaikan', facilities: ['AC', 'Kamar Mandi Dalam', 'Dapur', 'Internet', 'TV', 'Lemari'], description: 'Unit mewah 3 kamar tidur', photos: [], tenant: null } ]; // Sample contracts data state.contracts = [ { number: 'KONTRAK/2023/001', tenantId: 'T001', unitCode: 'A101', startDate: '2023-01-15', endDate: '2024-01-14', rent: 5000000, deposit: 10000000, paymentDay: 10, status: 'Aktif', terms: 'Pembayaran dilakukan setiap bulan sebelum tanggal 10. Deposit akan dikembalikan setelah kontrak berakhir dengan potongan jika ada kerusakan.' }, { number: 'KONTRAK/2023/002', tenantId: 'T002', unitCode: 'B202', startDate: '2023-02-20', endDate: '2024-02-19', rent: 7500000, deposit: 15000000, paymentDay: 10, status: 'Aktif', terms: 'Pembayaran dilakukan setiap bulan sebelum tanggal 10. Deposit akan dikembalikan setelah kontrak berakhir dengan potongan jika ada kerusakan.' }, { number: 'KONTRAK/2023/003', tenantId: 'T003', unitCode: 'C303', startDate: '2023-03-10', endDate: '2024-03-09', rent: 6000000, deposit: 12000000, paymentDay: 10, status: 'Menunggu', terms: 'Pembayaran dilakukan setiap bulan sebelum tanggal 10. Deposit akan dikembalikan setelah kontrak berakhir dengan potongan jika ada kerusakan.' } ]; // Sample payments data state.payments = [ { id: 'P001', contractNumber: 'KONTRAK/2023/001', tenantId: 'T001', amount: 5000000, date: '2023-06-10', method: 'Transfer Bank', status: 'Lunas', note: 'Pembayaran bulan Juni 2023' }, { id: 'P002', contractNumber: 'KONTRAK/2023/002', tenantId: 'T002', amount: 7500000, date: '2023-06-10', method: 'Transfer Bank', status: 'Lunas', note: 'Pembayaran bulan Juni 2023' }, { id: 'P003', contractNumber: 'KONTRAK/2023/001', tenantId: 'T001', amount: 5000000, date: '2023-05-10', method: 'Transfer Bank', status: 'Lunas', note: 'Pembayaran bulan Mei 2023' }, { id: 'P004', contractNumber: 'KONTRAK/2023/002', tenantId: 'T002', amount: 7500000, date: '2023-05-10', method: 'Transfer Bank', status: 'Lunas', note: 'Pembayaran bulan Mei 2023' } ]; // Sample maintenance data state.maintenance = [ { id: 'MT-001', unitCode: 'A101', issue: 'AC tidak dingin', description: 'AC di ruang utama tidak mengeluarkan udara dingin', priority: 'Sedang', status: 'Selesai', createdDate: '2023-05-15', completedDate: '2023-05-17', cost: 350000, photos: [], history: [ { date: '2023-05-15', status: 'Dibuat', note: 'Tiket dibuat oleh Budi Santoso' }, { date: '2023-05-16', status: 'Diproses', note: 'Teknisi telah dikirim untuk memeriksa' }, { date: '2023-05-17', status: 'Selesai', note: 'AC telah diperbaiki dengan mengganti freon' } ] }, { id: 'MT-002', unitCode: 'B202', issue: 'Kebocoran pipa', description: 'Ada kebocoran pipa air di kamar mandi utama', priority: 'Tinggi', status: 'Diproses', createdDate: '2023-06-01', completedDate: null, cost: null, photos: [], history: [ { date: '2023-06-01', status: 'Dibuat', note: 'Tiket dibuat oleh Siti Rahayu' }, { date: '2023-06-01', status: 'Diproses', note: 'Teknisi sedang dalam perjalanan' } ] } ]; // Sample notifications state.notifications = [ { id: 'N001', title: 'Pembayaran Baru', message: 'Budi Santoso telah melakukan pembayaran sewa bulan Juni', date: '2023-06-10', read: false }, { id: 'N002', title: 'Kontrak Akan Berakhir', message: 'Kontrak untuk unit A101 akan berakhir dalam 30 hari', date: '2023-05-15', read: false }, { id: 'N003', title: 'Permintaan Pemeliharaan', message: 'Ada permintaan pemeliharaan baru untuk unit B202', date: '2023-06-01', read: false } ]; // Update pagination totals state.pagination.tenants.total = state.tenants.length; state.pagination.units.total = state.units.length; state.pagination.contracts.total = state.contracts.length; state.pagination.payments.total = state.payments.length; state.pagination.maintenance.total = state.maintenance.length; // Update notification badge updateNotificationBadge(); } // Theme Management function initTheme() { const savedTheme = localStorage.getItem('theme') || 'light'; state.theme = savedTheme; document.documentElement.setAttribute('data-theme', state.theme); if (state.theme === 'light') { elements.themeText.textContent = 'Mode Gelap'; elements.themeToggle.innerHTML = '<i class="fas fa-moon"></i> Mode Gelap'; } else { elements.themeText.textContent = 'Mode Terang'; elements.themeToggle.innerHTML = '<i class="fas fa-sun"></i> Mode Terang'; } } function toggleTheme() { state.theme = state.theme === 'light' ? 'dark' : 'light'; document.documentElement.setAttribute('data-theme', state.theme); localStorage.setItem('theme', state.theme); if (state.theme === 'light') { elements.themeText.textContent = 'Mode Gelap'; elements.themeToggle.innerHTML = '<i class="fas fa-moon"></i> Mode Gelap'; } else { elements.themeText.textContent = 'Mode Terang'; elements.themeToggle.innerHTML = '<i class="fas fa-sun"></i> Mode Terang'; } } // Navigation function initNavigation() { const navLinks = document.querySelectorAll('.sidebar nav a'); navLinks.forEach(link => { if (link.getAttribute('data-section')) { link.addEventListener('click', function(e) { e.preventDefault(); const section = this.getAttribute('data-section'); showSection(section); }); } }); } function showSection(section) { // Hide all sections elements.sectionContents.forEach(content => { content.hidden = true; }); // Show selected section document.getElementById(section).hidden = false; state.currentSection = section; // Update active nav link const navLinks = document.querySelectorAll('.sidebar nav a'); navLinks.forEach(link => { link.classList.remove('active'); if (link.getAttribute('data-section') === section) { link.classList.add('active'); } }); // Render section content switch(section) { case 'dashboard': renderDashboard(); break; case 'penyewa': renderTenants(); break; case 'unit': renderUnits(); break; case 'kontrak': renderContracts(); break; case 'pembayaran': renderPayments(); break; case 'pemeliharaan': renderMaintenance(); break; case 'laporan': renderReports(); break; case 'pengaturan': renderSettings(); break; } } // Form Handling function initForms() { // Add Tenant Form if (document.getElementById('add-tenant-form')) { document.getElementById('add-tenant-form').addEventListener('submit', function(e) { e.preventDefault(); addTenant(); }); } // Edit Tenant Form
            if (document.getElementById('edit-tenant-form')) {
                document.getElementById('edit-tenant-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updateTenant();
                });
            }    // Add Unit Form
            if (document.getElementById('add-unit-form')) {
                document.getElementById('add-unit-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    addUnit();
                });
            }

            // Edit Unit Form
            if (document.getElementById('edit-unit-form')) {
                document.getElementById('edit-unit-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updateUnit();
                });
            }

            // Payment Form
            if (document.getElementById('payment-form')) {
                document.getElementById('payment-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    addPayment();
                });
            }

            // Add Maintenance Form
            if (document.getElementById('add-maintenance-form')) {
                document.getElementById('add-maintenance-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    addMaintenance();
                });
            }

            // Maintenance Update Form
            if (document.getElementById('maintenance-update-form')) {
                document.getElementById('maintenance-update-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updateMaintenance();
                });
            }

            // Profile Form
            if (document.getElementById('profile-form')) {
                document.getElementById('profile-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updateProfile();
                });
            }

            // Password Form
            if (document.getElementById('password-form')) {
                document.getElementById('password-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updatePassword();
                });
            }

            // System Settings Form
            if (document.getElementById('system-form')) {
                document.getElementById('system-form').addEventListener('submit', function (e) {
                    e.preventDefault();
                    updateSystemSettings();
                });
            }
        }

  // Modal Handling
  function initModals() {
            // Close modals when clicking close button
            elements.modalCloses.forEach(closeBtn => {
                closeBtn.addEventListener('click', function () {
                    const modal = this.closest('.c-modal');
                    modal.classList.remove('open');
                });
            });

            // Close modals when clicking outside content
            elements.modals.forEach(modal => {
                modal.addEventListener('click', function (e) {
                    if (e.target === this) {
                        this.classList.remove('open');
                    }
                });
            });
        }

        function toggleModal(modalId, data = null) {
            const modal = document.getElementById(`${modalId}-modal`);
            if (!modal) return;

            const isOpen = modal.classList.toggle('open');
            document.body.style.overflow = isOpen ? 'hidden' : '';

            if (isOpen) {
                // Focus first input when modal opens
                const input = modal.querySelector('input, select, textarea');
                if (input) input.focus();

                // Initialize modal data if provided
                if (data) {
                    switch (modalId) {
                        case 'edit-tenant':
                            initEditTenantModal(data);
                            break;
                        case 'edit-unit':
                            initEditUnitModal(data);
                            break;
                        case 'contract-detail':
                            initContractDetailModal(data);
                            break;
                        case 'maintenance-detail':
                            initMaintenanceDetailModal(data);
                            break;
                    }
                }
            }
        }

        function openModal(modalId, data = null) {
            const modal = document.getElementById(`${modalId}-modal`);
            if (!modal) return;

            modal.classList.add('open');
            document.body.style.overflow = 'hidden';

            // Focus first input when modal opens
            const input = modal.querySelector('input, select, textarea');
            if (input) input.focus();

            // Initialize modal data if provided
            if (data) {
                switch (modalId) {
                    case 'edit-tenant':
                        initEditTenantModal(data);
                        break;
                    case 'edit-unit':
                        initEditUnitModal(data);
                        break;
                    case 'contract-detail':
                        initContractDetailModal(data);
                        break;
                    case 'maintenance-detail':
                        initMaintenanceDetailModal(data);
                        break;
                }
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(`${modalId}-modal`);
            if (!modal) return;

            modal.classList.remove('open');
            document.body.style.overflow = '';
        }

        // Toast Notifications
        function showToast(message, type = 'success', duration = 3000) {
            const toast = elements.toast;
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.style.opacity = '1';
            toast.style.transform = 'translateY(0)';

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateY(20px)';
            }, duration);
        }

        // Notification Badge
        function updateNotificationBadge() {
            const unreadCount = state.notifications.filter(n => !n.read).length;
            if (unreadCount > 0) {
                elements.notificationBadge.textContent = unreadCount;
                elements.notificationBadge.style.display = 'flex';
            } else {
                elements.notificationBadge.style.display = 'none';
            }
        }

        // Data Rendering
        function renderDashboard() {
            // Update stats
            elements.totalUnits.textContent = state.units.length;
            elements.rentedUnits.textContent = state.units.filter(u => u.status === 'Ditempati').length;
            elements.vacantUnits.textContent = state.units.filter(u => u.status === 'Tersedia').length;

            const monthlyIncome = state.payments
                .filter(p => new Date(p.date).getMonth() === new Date().getMonth())
                .reduce((sum, payment) => sum + payment.amount, 0);

            elements.monthlyIncome.textContent = formatCurrency(monthlyIncome);

            // Render recent payments
            const recentPayments = [...state.payments]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);

            elements.recentPayments.innerHTML = recentPayments.map(payment => {
                const tenant = state.tenants.find(t => t.id === payment.tenantId);
                return `
        <tr>
          <td>${tenant ? tenant.name : 'Unknown'}</td>
          <td>${formatCurrency(payment.amount)}</td>
          <td>${formatDate(payment.date)}</td>
        </tr>
      `;
            }).join('');

            // Render recent maintenance
            const recentMaintenance = [...state.maintenance]
                .sort((a, b) => new Date(b.createdDate) - new Date(a.createdDate))
                .slice(0, 5);

            elements.recentMaintenance.innerHTML = recentMaintenance.map(m => {
                const unit = state.units.find(u => u.code === m.unitCode);
                return `
        <tr>
          <td>${unit ? unit.code : 'Unknown'}</td>
          <td>${m.issue}</td>
          <td><span class="badge ${getStatusBadgeClass(m.status)}">${m.status}</span></td>
          <td><span class="badge ${getPriorityBadgeClass(m.priority)}">${m.priority}</span></td>
        </tr>
      `;
            }).join('');

            // Render charts
            renderDashboardCharts();
        }

        function renderDashboardCharts() {
            // Unit Status Chart
            const unitStatusCtx = elements.unitChart.getContext('2d');
            const unitStatusData = {
                labels: ['Ditempati', 'Tersedia', 'Perbaikan'],
                datasets: [{
                    data: [
                        state.units.filter(u => u.status === 'Ditempati').length,
                        state.units.filter(u => u.status === 'Tersedia').length,
                        state.units.filter(u => u.status === 'Perbaikan').length
                    ],
                    backgroundColor: [
                        'hsl(140, 60%, 45%)',
                        'hsl(214, 100%, 54%)',
                        'hsl(40, 90%, 60%)'
                    ]
                }]
            };

            if (charts.unitChart) charts.unitChart.destroy();
            charts.unitChart = new Chart(unitStatusCtx, {
                type: 'doughnut',
                data: unitStatusData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function renderTenants() {
            const { page, perPage } = state.pagination.tenants;
            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;

            // Filter tenants
            let filteredTenants = [...state.tenants];
            const searchTerm = elements.tenantFilter.value.toLowerCase();
            const statusFilter = elements.tenantStatusFilter.value;

            if (searchTerm) {
                filteredTenants = filteredTenants.filter(tenant =>
                    tenant.name.toLowerCase().includes(searchTerm) ||
                    tenant.id.toLowerCase().includes(searchTerm) ||
                    tenant.email.toLowerCase().includes(searchTerm) ||
                    tenant.phone.includes(searchTerm)
                );
            }

            if (statusFilter) {
                filteredTenants = filteredTenants.filter(tenant => tenant.status === statusFilter);
            }

            // Update pagination
            state.pagination.tenants.total = filteredTenants.length;
            const paginatedTenants = filteredTenants.slice(startIdx, endIdx);

            // Render table
            elements.tenantsTbody.innerHTML = paginatedTenants.map(tenant => {
                const unit = state.units.find(u => u.code === tenant.unit);
                return `
        <tr>
          <td>${tenant.id}</td>
          <td>
            <div class="flex align-center gap-sm">
              ${tenant.photo ? `<img src="${tenant.photo}" alt="${tenant.name}" class="avatar">` : '<div class="avatar-placeholder"><i class="fas fa-user"></i></div>'}
              <span>${tenant.name}</span>
            </div>
          </td>
          <td>
            <div>${tenant.email}</div>
            <div class="text-muted">${tenant.phone}</div>
          </td>
          <td>${unit ? unit.code : '-'}</td>
          <td><span class="badge ${getStatusBadgeClass(tenant.status)}">${tenant.status}</span></td>
          <td>
            <div class="flex gap-xs">
              <button class="c-button btn-outline" data-id="${tenant.id}" data-action="edit">
                <i class="fas fa-edit"></i>
              </button>
              <button class="c-button btn-outline" data-id="${tenant.id}" data-action="contract">
                <i class="fas fa-file-contract"></i>
              </button>
              <button class="c-button btn-outline" data-id="${tenant.id}" data-action="delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
            }).join('');

            // Update pagination info
            elements.tenantPaginationInfo.textContent = `Menampilkan ${startIdx + 1}-${Math.min(endIdx, filteredTenants.length)} dari ${filteredTenants.length} penyewa`;

            // Update pagination buttons
            elements.prevTenantPage.disabled = page <= 1;
            elements.nextTenantPage.disabled = endIdx >= filteredTenants.length;

            // Add event listeners to action buttons
            document.querySelectorAll('#tenants-tbody [data-action]').forEach(btn => {
                btn.addEventListener('click', function () {
                    const tenantId = this.getAttribute('data-id');
                    const action = this.getAttribute('data-action');
                    handleTenantAction(tenantId, action);
                });
            });
        }

        function renderUnits() {
            const { page, perPage } = state.pagination.units;
            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;

            // Filter units
            let filteredUnits = [...state.units];
            const searchTerm = elements.unitFilter.value.toLowerCase();
            const statusFilter = elements.unitStatusFilter.value;

            if (searchTerm) {
                filteredUnits = filteredUnits.filter(unit =>
                    unit.code.toLowerCase().includes(searchTerm) ||
                    unit.type.toLowerCase().includes(searchTerm) ||
                    unit.location.toLowerCase().includes(searchTerm)
                );
            }

            if (statusFilter) {
                filteredUnits = filteredUnits.filter(unit => unit.status === statusFilter);
            }

            // Update pagination
            state.pagination.units.total = filteredUnits.length;
            const paginatedUnits = filteredUnits.slice(startIdx, endIdx);

            // Render table
            elements.unitsTbody.innerHTML = paginatedUnits.map(unit => {
                const tenant = unit.tenant ? state.tenants.find(t => t.id === unit.tenant) : null;
                return `
        <tr>
          <td>${unit.code}</td>
          <td>${unit.type}</td>
          <td>${unit.location}</td>
          <td><span class="badge ${getStatusBadgeClass(unit.status)}">${unit.status}</span></td>
          <td>${formatCurrency(unit.rent)}</td>
          <td>
            <div class="flex gap-xs">
              <button class="c-button btn-outline" data-code="${unit.code}" data-action="edit">
                <i class="fas fa-edit"></i>
              </button>
              <button class="c-button btn-outline" data-code="${unit.code}" data-action="detail">
                <i class="fas fa-info-circle"></i>
              </button>
              <button class="c-button btn-outline" data-code="${unit.code}" data-action="delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
            }).join('');

            // Update pagination info
            elements.unitPaginationInfo.textContent = `Menampilkan ${startIdx + 1}-${Math.min(endIdx, filteredUnits.length)} dari ${filteredUnits.length} unit`;

            // Update pagination buttons
            elements.prevUnitPage.disabled = page <= 1;
            elements.nextUnitPage.disabled = endIdx >= filteredUnits.length;

            // Add event listeners to action buttons
            document.querySelectorAll('#units-tbody [data-action]').forEach(btn => {
                btn.addEventListener('click', function () {
                    const unitCode = this.getAttribute('data-code');
                    const action = this.getAttribute('data-action');
                    handleUnitAction(unitCode, action);
                });
            });
        }

        function renderContracts() {
            const { page, perPage } = state.pagination.contracts;
            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;

            // Filter contracts
            let filteredContracts = [...state.contracts];
            const searchTerm = elements.contractFilter.value.toLowerCase();
            const statusFilter = elements.contractStatusFilter.value;

            if (searchTerm) {
                filteredContracts = filteredContracts.filter(contract =>
                    contract.number.toLowerCase().includes(searchTerm) ||
                    contract.tenantId.toLowerCase().includes(searchTerm) ||
                    contract.unitCode.toLowerCase().includes(searchTerm)
                );
            }

            if (statusFilter) {
                filteredContracts = filteredContracts.filter(contract => contract.status === statusFilter);
            }

            // Update pagination
            state.pagination.contracts.total = filteredContracts.length;
            const paginatedContracts = filteredContracts.slice(startIdx, endIdx);

            // Render table
            elements.contractsTbody.innerHTML = paginatedContracts.map(contract => {
                const tenant = state.tenants.find(t => t.id === contract.tenantId);
                const unit = state.units.find(u => u.code === contract.unitCode);
                return `
        <tr>
          <td>${contract.number}</td>
          <td>${tenant ? tenant.name : 'Unknown'}</td>
          <td>${unit ? unit.code : 'Unknown'}</td>
          <td>${formatDate(contract.startDate)} - ${formatDate(contract.endDate)}</td>
          <td><span class="badge ${getStatusBadgeClass(contract.status)}">${contract.status}</span></td>
          <td>
            <div class="flex gap-xs">
              <button class="c-button btn-outline" data-number="${contract.number}" data-action="detail">
                <i class="fas fa-eye"></i>
              </button>
              <button class="c-button btn-outline" data-number="${contract.number}" data-action="delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
            }).join('');

            // Update pagination info
            elements.contractPaginationInfo.textContent = `Menampilkan ${startIdx + 1}-${Math.min(endIdx, filteredContracts.length)} dari ${filteredContracts.length} kontrak`;

            // Update pagination buttons
            elements.prevContractPage.disabled = page <= 1;
            elements.nextContractPage.disabled = endIdx >= filteredContracts.length;

            // Add event listeners to action buttons
            document.querySelectorAll('#contracts-tbody [data-action]').forEach(btn => {
                btn.addEventListener('click', function () {
                    const contractNumber = this.getAttribute('data-number');
                    const action = this.getAttribute('data-action');
                    handleContractAction(contractNumber, action);
                });
            });
        }

        function renderPayments() {
            const { page, perPage } = state.pagination.payments;
            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;

            // Filter payments
            let filteredPayments = [...state.payments];
            const searchTerm = elements.paymentFilter.value.toLowerCase();
            const dateFilter = elements.paymentDateFilter.value;

            if (searchTerm) {
                filteredPayments = filteredPayments.filter(payment =>
                    payment.tenantId.toLowerCase().includes(searchTerm) ||
                    payment.contractNumber.toLowerCase().includes(searchTerm)
                );
            }

            if (dateFilter) {
                filteredPayments = filteredPayments.filter(payment => payment.date === dateFilter);
            }

            // Update pagination
            state.pagination.payments.total = filteredPayments.length;
            const paginatedPayments = filteredPayments.slice(startIdx, endIdx);

            // Render table
            elements.paymentsTbody.innerHTML = paginatedPayments.map(payment => {
                const tenant = state.tenants.find(t => t.id === payment.tenantId);
                return `
        <tr>
          <td>${formatDate(payment.date)}</td>
          <td>${tenant ? tenant.name : 'Unknown'}</td>
          <td>${formatCurrency(payment.amount)}</td>
          <td>${payment.method}</td>
          <td><span class="badge ${getStatusBadgeClass(payment.status)}">${payment.status}</span></td>
        </tr>
      `;
            }).join('');

            // Update pagination info
            elements.paymentPaginationInfo.textContent = `Menampilkan ${startIdx + 1}-${Math.min(endIdx, filteredPayments.length)} dari ${filteredPayments.length} pembayaran`;

            // Update pagination buttons
            elements.prevPaymentPage.disabled = page <= 1;
            elements.nextPaymentPage.disabled = endIdx >= filteredPayments.length;
        }

        function renderMaintenance() {
            const { page, perPage } = state.pagination.maintenance;
            const startIdx = (page - 1) * perPage;
            const endIdx = startIdx + perPage;

            // Filter maintenance
            let filteredMaintenance = [...state.maintenance];
            const searchTerm = elements.maintenanceFilter.value.toLowerCase();
            const statusFilter = elements.maintenanceStatusFilter.value;
            const priorityFilter = elements.maintenancePriorityFilter.value;

            if (searchTerm) {
                filteredMaintenance = filteredMaintenance.filter(m =>
                    m.id.toLowerCase().includes(searchTerm) ||
                    m.unitCode.toLowerCase().includes(searchTerm) ||
                    m.issue.toLowerCase().includes(searchTerm)
                );
            }

            if (statusFilter) {
                filteredMaintenance = filteredMaintenance.filter(m => m.status === statusFilter);
            }

            if (priorityFilter) {
                filteredMaintenance = filteredMaintenance.filter(m => m.priority === priorityFilter);
            }

            // Update pagination
            state.pagination.maintenance.total = filteredMaintenance.length;
            const paginatedMaintenance = filteredMaintenance.slice(startIdx, endIdx);

            // Render table
            elements.maintenanceTbody.innerHTML = paginatedMaintenance.map(m => {
                const unit = state.units.find(u => u.code === m.unitCode);
                return `
        <tr>
          <td>${m.id}</td>
          <td>${unit ? unit.code : 'Unknown'}</td>
          <td>${m.issue}</td>
          <td><span class="badge ${getPriorityBadgeClass(m.priority)}">${m.priority}</span></td>
          <td><span class="badge ${getStatusBadgeClass(m.status)}">${m.status}</span></td>
          <td>${formatDate(m.createdDate)}</td>
          <td>
            <div class="flex gap-xs">
              <button class="c-button btn-outline" data-id="${m.id}" data-action="detail">
                <i class="fas fa-eye"></i>
              </button>
              <button class="c-button btn-outline" data-id="${m.id}" data-action="delete">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      `;
            }).join('');

            // Update pagination info
            elements.maintenancePaginationInfo.textContent = `Menampilkan ${startIdx + 1}-${Math.min(endIdx, filteredMaintenance.length)} dari ${filteredMaintenance.length} tiket`;

            // Update pagination buttons
            elements.prevMaintenancePage.disabled = page <= 1;
            elements.nextMaintenancePage.disabled = endIdx >= filteredMaintenance.length;

            // Add event listeners to action buttons
            document.querySelectorAll('#maintenance-tbody [data-action]').forEach(btn => {
                btn.addEventListener('click', function () {
                    const maintenanceId = this.getAttribute('data-id');
                    const action = this.getAttribute('data-action');
                    handleMaintenanceAction(maintenanceId, action);
                });
            });
        }

        function renderReports() {
            // Initialize report tabs
            elements.reportTabs.forEach(tab => {
                tab.addEventListener('click', function () {
                    const tabId = this.getAttribute('data-tab');
                    showReportTab(tabId);
                });
            });

            // Show current tab
            showReportTab(state.currentTab);
        }

        function showReportTab(tabId) {
            // Update active tab
            elements.reportTabs.forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                }
            });

            // Show corresponding content
            elements.tabContents.forEach(content => {
                content.hidden = content.id !== `${tabId}-report`;
            });

            state.currentTab = tabId;

            // Render tab content
            switch (tabId) {
                case 'financial':
                    renderFinancialReport();
                    break;
                case 'occupancy':
                    renderOccupancyReport();
                    break;
                case 'maintenance':
                    renderMaintenanceReport();
                    break;
            }
        }

        function renderFinancialReport() {
            // Income Chart
            const incomeCtx = document.getElementById('income-chart').getContext('2d');
            const incomeData = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Pendapatan (Rp)',
                    data: Array(12).fill(0).map((_, i) => {
                        return state.payments
                            .filter(p => new Date(p.date).getMonth() === i)
                            .reduce((sum, p) => sum + p.amount, 0);
                    }),
                    backgroundColor: 'hsl(214, 100%, 54%)',
                    borderColor: 'hsl(214, 100%, 42%)',
                    borderWidth: 1
                }]
            };

            if (charts.incomeChart) charts.incomeChart.destroy();
            charts.incomeChart = new Chart(incomeCtx, {
                type: 'bar',
                data: incomeData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function (value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });

            // Payment Status Chart
            const paymentStatusCtx = document.getElementById('payment-status-chart').getContext('2d');
            const paymentStatusData = {
                labels: ['Lunas', 'Belum Lunas', 'Terlambat'],
                datasets: [{
                    data: [85, 10, 5], // Sample data
                    backgroundColor: [
                        'hsl(140, 60%, 45%)',
                        'hsl(40, 90%, 60%)',
                        'hsl(0, 80%, 56%)'
                    ]
                }]
            };

            if (charts.paymentStatusChart) charts.paymentStatusChart.destroy();
            charts.paymentStatusChart = new Chart(paymentStatusCtx, {
                type: 'doughnut',
                data: paymentStatusData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Financial Details
            const selectedMonth = elements.financialMonthFilter.value || new Date().toISOString().slice(0, 7);
            const filteredContracts = state.contracts.filter(c => c.status === 'Aktif');

            elements.financialDetails.innerHTML = filteredContracts.map(contract => {
                const tenant = state.tenants.find(t => t.id === contract.tenantId);
                const unit = state.units.find(u => u.code === contract.unitCode);
                const payment = state.payments.find(p =>
                    p.contractNumber === contract.number &&
                    p.date.startsWith(selectedMonth)
                );

                return `
        <tr>
          <td>${unit ? unit.code : 'Unknown'}</td>
          <td>${tenant ? tenant.name : 'Unknown'}</td>
          <td>${formatCurrency(contract.rent)}</td>
          <td>
            <span class="badge ${payment ? 'badge-success' : 'badge-warning'}">
              ${payment ? 'Lunas' : 'Belum Lunas'}
            </span>
          </td>
          <td>${payment ? '-' : formatCurrency(contract.rent)}</td>
        </tr>
      `;
            }).join('');
        }

        function renderOccupancyReport() {
            // Occupancy Chart
            const occupancyCtx = document.getElementById('occupancy-chart').getContext('2d');
            const occupancyData = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Tingkat Hunian (%)',
                    data: [85, 88, 90, 92, 90, 88, 85, 87, 89, 91, 93, 95], // Sample data
                    backgroundColor: 'hsla(214, 100%, 54%, 0.2)',
                    borderColor: 'hsl(214, 100%, 54%)',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true
                }]
            };

            if (charts.occupancyChart) charts.occupancyChart.destroy();
            charts.occupancyChart = new Chart(occupancyCtx, {
                type: 'line',
                data: occupancyData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false,
                            min: 80,
                            max: 100,
                            ticks: {
                                callback: function (value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });

            // Unit Comparison Chart
            const unitComparisonCtx = document.getElementById('unit-comparison-chart').getContext('2d');
            const unitComparisonData = {
                labels: state.units.map(u => u.code),
                datasets: [{
                    label: 'Harga Sewa (Rp)',
                    data: state.units.map(u => u.rent),
                    backgroundColor: 'hsl(40, 90%, 60%)'
                }]
            };

            if (charts.unitComparisonChart) charts.unitComparisonChart.destroy();
            charts.unitComparisonChart = new Chart(unitComparisonCtx, {
                type: 'bar',
                data: unitComparisonData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function (value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });

            // Occupancy Details
            elements.occupancyDetails.innerHTML = state.units.map(unit => {
                const tenant = unit.tenant ? state.tenants.find(t => t.id === unit.tenant) : null;
                const contract = state.contracts.find(c => c.unitCode === unit.code);

                return `
        <tr>
          <td>${unit.code}</td>
          <td>${unit.type}</td>
          <td><span class="badge ${getStatusBadgeClass(unit.status)}">${unit.status}</span></td>
          <td>${tenant ? tenant.name : '-'}</td>
          <td>${contract ? formatDate(contract.startDate) + ' - ' + formatDate(contract.endDate) : '-'}</td>
        </tr>
      `;
            }).join('');
        }

        function renderMaintenanceReport() {
            // Maintenance Stats Chart
            const maintenanceStatsCtx = document.getElementById('maintenance-stats-chart').getContext('2d');
            const maintenanceStatsData = {
                labels: ['Dibuat', 'Diproses', 'Selesai'],
                datasets: [{
                    data: [
                        state.maintenance.filter(m => m.status === 'Dibuat').length,
                        state.maintenance.filter(m => m.status === 'Diproses').length,
                        state.maintenance.filter(m => m.status === 'Selesai').length
                    ],
                    backgroundColor: [
                        'hsl(40, 90%, 60%)',
                        'hsl(214, 100%, 54%)',
                        'hsl(140, 60%, 45%)'
                    ]
                }]
            };

            if (charts.maintenanceStatsChart) charts.maintenanceStatsChart.destroy();
            charts.maintenanceStatsChart = new Chart(maintenanceStatsCtx, {
                type: 'pie',
                data: maintenanceStatsData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Maintenance Cost Chart
            const maintenanceCostCtx = document.getElementById('maintenance-cost-chart').getContext('2d');
            const maintenanceCostData = {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Biaya Pemeliharaan (Rp)',
                    data: Array(12).fill(0).map((_, i) => {
                        return state.maintenance
                            .filter(m => m.status === 'Selesai' && new Date(m.completedDate).getMonth() === i)
                            .reduce((sum, m) => sum + (m.cost || 0), 0);
                    }),
                    backgroundColor: 'hsla(0, 80%, 56%, 0.2)',
                    borderColor: 'hsl(0, 80%, 56%)',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true
                }]
            };

            if (charts.maintenanceCostChart) charts.maintenanceCostChart.destroy();
            charts.maintenanceCostChart = new Chart(maintenanceCostCtx, {
                type: 'line',
                data: maintenanceCostData,
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function (value) {
                                    return formatCurrency(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    return formatCurrency(context.raw);
                                }
                            }
                        }
                    }
                }
            });

            // Maintenance Details
            const selectedMonth = elements.maintenanceMonthFilter.value || new Date().toISOString().slice(0, 7);
            const filteredMaintenance = state.maintenance.filter(m =>
                m.completedDate && m.completedDate.startsWith(selectedMonth)
            );

            elements.maintenanceDetails.innerHTML = filteredMaintenance.map(m => {
                const unit = state.units.find(u => u.code === m.unitCode);
                const duration = m.completedDate ?
                    Math.ceil((new Date(m.completedDate) - new Date(m.createdDate)) / (1000 * 60 * 60 * 24) :
                        null;

                return `
        <tr>
          <td>${m.id}</td>
          <td>${unit ? unit.code : 'Unknown'}</td>
          <td>${m.issue}</td>
          <td>${m.cost ? formatCurrency(m.cost) : '-'}</td>
          <td>${duration ? duration.toFixed(1) + ' hari' : '-'}</td>
        </tr>
      `;
            }).join('');
        }

        function renderSettings() {
            // Populate settings form
            document.getElementById('profile-name').value = 'Admin Rentelindo';
            document.getElementById('profile-email').value = 'admin@rentelindo.com';
            document.getElementById('profile-phone').value = '+6281234567890';

            document.getElementById('currency').value = state.settings.currency;
            document.getElementById('date-format').value = state.settings.dateFormat;
            document.getElementById('notifications').checked = state.settings.emailNotifications;
        }

        // Modal Initialization
        function initEditTenantModal(tenantId) {
            const tenant = state.tenants.find(t => t.id === tenantId);
            if (!tenant) return;

            document.getElementById('edit-tenant-id').value = tenant.id;
            document.getElementById('edit-tenant-name').value = tenant.name;
            document.getElementById('edit-tenant-email').value = tenant.email;
            document.getElementById('edit-tenant-phone').value = tenant.phone;
            document.getElementById('edit-tenant-ktp').value = tenant.ktp;
            document.getElementById('edit-tenant-address').value = tenant.address;
            document.getElementById('edit-tenant-status').value = tenant.status;
            document.getElementById('edit-tenant-rent').value = tenant.rent;

            // Populate unit select
            const unitSelect = document.getElementById('edit-tenant-unit');
            unitSelect.innerHTML = '<option value="">Pilih Unit</option>' +
                state.units.map(u => `<option value="${u.code}" ${u.code === tenant.unit ? 'selected' : ''}>${u.code}</option>`).join('');
        }

        function initEditUnitModal(unitCode) {
            const unit = state.units.find(u => u.code === unitCode);
            if (!unit) return;

            document.getElementById('edit-unit-id').value = unit.code;
            document.getElementById('edit-unit-code').value = unit.code;
            document.getElementById('edit-unit-type').value = unit.type;
            document.getElementById('edit-unit-location').value = unit.location;
            document.getElementById('edit-unit-size').value = unit.size;
            document.getElementById('edit-unit-rent').value = unit.rent;
            document.getElementById('edit-unit-status').value = unit.status;
            document.getElementById('edit-unit-description').value = unit.description;

            // Populate facilities
            const facilitiesContainer = document.getElementById('edit-unit-facilities');
            facilitiesContainer.innerHTML = ''; const allFacilities = ['AC', 'Kamar Mandi Dalam', 'Dapur', 'Internet', 'TV', 'Lemari'];
            allFacilities.forEach(facility => {
                const isChecked = unit.facilities.includes(facility);
                const checkboxId = `edit-facility-${facility.toLowerCase().replace(/\s+/g, '-')}`;

                const label = document.createElement('label');
                label.className = 'flex align-center gap-xs';
                label.innerHTML = `
        <input type="checkbox" id="${checkboxId}" value="${facility}" ${isChecked ? 'checked' : ''}>
        <span>${facility}</span>
      `;
                facilitiesContainer.appendChild(label);
            });
        }

        function initContractDetailModal(contractNumber) {
            const contract = state.contracts.find(c => c.number === contractNumber);
            if (!contract) return;

            const tenant = state.tenants.find(t => t.id === contract.tenantId);
            const unit = state.units.find(u => u.code === contract.unitCode);
            const payments = state.payments.filter(p => p.contractNumber === contract.number);

            // Set basic info
            document.getElementById('contract-detail-number').textContent = contract.number;
            document.getElementById('contract-detail-status').innerHTML = `<span class="badge ${getStatusBadgeClass(contract.status)}">${contract.status}</span>`;

            // Tenant info
            document.getElementById('contract-detail-tenant').textContent = tenant ? tenant.name : 'Unknown';
            document.getElementById('contract-detail-tenant-contact').textContent = tenant ? `${tenant.email} | ${tenant.phone}` : '-';
            document.getElementById('contract-detail-tenant-id').textContent = `ID: ${contract.tenantId}`;

            // Unit info
            document.getElementById('contract-detail-unit').textContent = unit ? `${unit.code} (${unit.type})` : 'Unknown';
            document.getElementById('contract-detail-unit-location').textContent = unit ? unit.location : '-';
            document.getElementById('contract-detail-unit-rent').textContent = `Harga Sewa: ${formatCurrency(contract.rent)}`;

            // Contract details
            document.getElementById('contract-detail-period').textContent = `${formatDate(contract.startDate)} - ${formatDate(contract.endDate)}`;
            document.getElementById('contract-detail-payment').textContent = `Jatuh Tempo: Tiap bulan tanggal ${contract.paymentDay}`;
            document.getElementById('contract-detail-deposit').textContent = formatCurrency(contract.deposit);

            // Payment history
            const paymentHistory = document.getElementById('contract-payment-history');
            paymentHistory.innerHTML = payments.length > 0 ?
                payments.map(p => `
        <tr>
          <td>${formatDate(p.date, 'MMMM YYYY')}</td>
          <td>${formatCurrency(p.amount)}</td>
          <td><span class="badge ${getStatusBadgeClass(p.status)}">${p.status}</span></td>
          <td>${formatDate(p.date)}</td>
        </tr>
      `).join('') :
                '<tr><td colspan="4" class="text-center">Belum ada riwayat pembayaran</td></tr>';

            // Contract terms
            document.getElementById('contract-detail-terms').textContent = contract.terms;
        }

        function initMaintenanceDetailModal(maintenanceId) {
            const maintenance = state.maintenance.find(m => m.id === maintenanceId);
            if (!maintenance) return;

            const unit = state.units.find(u => u.code === maintenance.unitCode);
            const tenant = unit && unit.tenant ? state.tenants.find(t => t.id === unit.tenant) : null;

            // Set basic info
            document.getElementById('maintenance-detail-id').textContent = maintenance.id;
            document.getElementById('maintenance-detail-status').className = `badge ${getStatusBadgeClass(maintenance.status)}`;
            document.getElementById('maintenance-detail-status').textContent = maintenance.status;
            document.getElementById('maintenance-detail-priority').className = `badge ${getPriorityBadgeClass(maintenance.priority)}`;
            document.getElementById('maintenance-detail-priority').textContent = maintenance.priority;

            // Unit info
            document.getElementById('maintenance-detail-unit').textContent = unit ? unit.code : 'Unknown';
            document.getElementById('maintenance-detail-unit-location').textContent = unit ? unit.location : '-';
            document.getElementById('maintenance-detail-tenant').textContent = tenant ? tenant.name : '-';

            // Ticket details
            document.getElementById('maintenance-detail-date').textContent = `Dibuat pada: ${formatDate(maintenance.createdDate)}`;
            document.getElementById('maintenance-detail-assignee').textContent = 'Ditangani oleh: Admin';
            document.getElementById('maintenance-detail-cost').textContent = `Biaya: ${maintenance.cost ? formatCurrency(maintenance.cost) : '-'}`;

            // Issue description
            document.getElementById('maintenance-detail-issue').textContent = maintenance.issue;
            document.getElementById('maintenance-detail-description').textContent = maintenance.description;

            // Photos
            const photosContainer = document.getElementById('maintenance-detail-photos');
            photosContainer.innerHTML = maintenance.photos.length > 0 ?
                maintenance.photos.map((photo, i) => `
        <div class="maintenance-photo">
          <img src="${photo}" alt="Bukti pemeliharaan ${i + 1}" class="w-full rounded">
        </div>
      `).join('') : '<div class="text-muted">Tidak ada foto bukti</div>';

            // History
            const historyContainer = document.getElementById('maintenance-detail-history');
            historyContainer.innerHTML = maintenance.history.map(item => `
      <div class="maintenance-history-item mb-3">
        <div class="flex justify-between">
          <strong>${item.status}</strong>
          <span class="text-muted">${formatDate(item.date)}</span>
        </div>
        <p class="text-muted">${item.note}</p>
      </div>
    `).join('');

            // Set up edit button
            document.getElementById('maintenance-edit-btn').setAttribute('data-id', maintenance.id);
        }

        // Action Handlers
        function handleTenantAction(tenantId, action) {
            switch (action) {
                case 'edit':
                    openModal('edit-tenant', tenantId);
                    break;
                case 'contract':
                    const contract = state.contracts.find(c => c.tenantId === tenantId);
                    if (contract) {
                        openModal('contract-detail', contract.number);
                    } else {
                        showToast('Penyewa ini belum memiliki kontrak', 'warning');
                    }
                    break;
                case 'delete':
                    showConfirmModal(
                        'Hapus Penyewa',
                        'Apakah Anda yakin ingin menghapus penyewa ini? Data yang dihapus tidak dapat dikembalikan.',
                        () => deleteTenant(tenantId)
                    );
                    break;
            }
        }

        function handleUnitAction(unitCode, action) {
            switch (action) {
                case 'edit':
                    openModal('edit-unit', unitCode);
                    break;
                case 'detail':
                    // Show unit details (could be implemented as another modal)
                    showToast(`Detail untuk unit ${unitCode}`, 'info');
                    break;
                case 'delete':
                    showConfirmModal(
                        'Hapus Unit',
                        'Apakah Anda yakin ingin menghapus unit ini? Data yang dihapus tidak dapat dikembalikan.',
                        () => deleteUnit(unitCode)
                    );
                    break;
            }
        }

        function handleContractAction(contractNumber, action) {
            switch (action) {
                case 'detail':
                    openModal('contract-detail', contractNumber);
                    break;
                case 'delete':
                    showConfirmModal(
                        'Hapus Kontrak',
                        'Apakah Anda yakin ingin menghapus kontrak ini? Data yang dihapus tidak dapat dikembalikan.',
                        () => deleteContract(contractNumber)
                    );
                    break;
            }
        }

        function handleMaintenanceAction(maintenanceId, action) {
            switch (action) {
                case 'detail':
                    openModal('maintenance-detail', maintenanceId);
                    break;
                case 'delete':
                    showConfirmModal(
                        'Hapus Tiket Pemeliharaan',
                        'Apakah Anda yakin ingin menghapus tiket pemeliharaan ini? Data yang dihapus tidak dapat dikembalikan.',
                        () => deleteMaintenance(maintenanceId)
                    );
                    break;
            }
        }

        function showConfirmModal(title, message, confirmCallback) {
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;

            const confirmBtn = document.getElementById('confirm-action-btn');
            // Remove previous event listeners
            confirmBtn.replaceWith(confirmBtn.cloneNode(true));

            document.getElementById('confirm-action-btn').addEventListener('click', function () {
                confirmCallback();
                closeModal('confirm');
            });

            openModal('confirm');
        }

        // CRUD Operations
        function addTenant() {
            const form = document.getElementById('add-tenant-form');
            const formData = new FormData(form);

            // Basic validation
            if (!formData.get('tenant-id') || !formData.get('tenant-name') || !formData.get('tenant-email') || !formData.get('tenant-phone')) {
                showToast('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            // Check if tenant ID already exists
            if (state.tenants.some(t => t.id === formData.get('tenant-id'))) {
                showToast('ID Penyewa sudah digunakan', 'error');
                return;
            }

            const newTenant = {
                id: formData.get('tenant-id'),
                name: formData.get('tenant-name'),
                email: formData.get('tenant-email'),
                phone: formData.get('tenant-phone'),
                ktp: formData.get('tenant-ktp'),
                address: formData.get('tenant-address'),
                unit: formData.get('tenant-unit'),
                rent: Number(formData.get('tenant-rent')) || 0,
                status: formData.get('tenant-status'),
                joinDate: new Date().toISOString().split('T')[0],
                photo: null
            };

            // Handle photo upload if exists
            const photoFile = formData.get('tenant-photo');
            if (photoFile && photoFile.size > 0) {
                // In a real app, you would upload the file to a server
                newTenant.photo = URL.createObjectURL(photoFile);
            }

            state.tenants.push(newTenant);
            state.pagination.tenants.total = state.tenants.length;

            // If unit is assigned, update unit status
            if (newTenant.unit) {
                const unit = state.units.find(u => u.code === newTenant.unit);
                if (unit) {
                    unit.status = 'Ditempati';
                    unit.tenant = newTenant.id;
                }
            }

            showToast('Penyewa baru berhasil ditambahkan', 'success');
            closeModal('add-tenant');
            form.reset();

            // Refresh tenants and units lists
            renderTenants();
            renderUnits();
        }

        function updateTenant() {
            const form = document.getElementById('edit-tenant-form');
            const tenantId = document.getElementById('edit-tenant-id').value;
            const tenantIndex = state.tenants.findIndex(t => t.id === tenantId);

            if (tenantIndex === -1) {
                showToast('Penyewa tidak ditemukan', 'error');
                return;
            }

            const oldUnit = state.tenants[tenantIndex].unit;
            const newUnit = document.getElementById('edit-tenant-unit').value;

            // Update tenant data
            state.tenants[tenantIndex] = {
                ...state.tenants[tenantIndex],
                name: document.getElementById('edit-tenant-name').value,
                email: document.getElementById('edit-tenant-email').value,
                phone: document.getElementById('edit-tenant-phone').value,
                ktp: document.getElementById('edit-tenant-ktp').value,
                address: document.getElementById('edit-tenant-address').value,
                unit: newUnit,
                rent: Number(document.getElementById('edit-tenant-rent').value) || 0,
                status: document.getElementById('edit-tenant-status').value
            };

            // Handle unit changes
            if (oldUnit !== newUnit) {
                // Clear tenant from old unit
                if (oldUnit) {
                    const oldUnitObj = state.units.find(u => u.code === oldUnit);
                    if (oldUnitObj) {
                        oldUnitObj.tenant = null;
                        oldUnitObj.status = 'Tersedia';
                    }
                }

                // Assign tenant to new unit
                if (newUnit) {
                    const newUnitObj = state.units.find(u => u.code === newUnit);
                    if (newUnitObj) {
                        newUnitObj.tenant = tenantId;
                        newUnitObj.status = 'Ditempati';
                    }
                }
            }

            showToast('Data penyewa berhasil diperbarui', 'success');
            closeModal('edit-tenant');

            // Refresh tenants and units lists
            renderTenants();
            renderUnits();
        }

        function deleteTenant(tenantId) {
            const tenantIndex = state.tenants.findIndex(t => t.id === tenantId);
            if (tenantIndex === -1) {
                showToast('Penyewa tidak ditemukan', 'error');
                return;
            }

            const tenant = state.tenants[tenantIndex];

            // Check if tenant has active contract
            const hasContract = state.contracts.some(c => c.tenantId === tenantId && c.status === 'Aktif');
            if (hasContract) {
                showToast('Penyewa memiliki kontrak aktif. Hapus kontrak terlebih dahulu.', 'error');
                return;
            }

            // Remove tenant from unit if assigned
            if (tenant.unit) {
                const unit = state.units.find(u => u.code === tenant.unit);
                if (unit) {
                    unit.tenant = null;
                    unit.status = 'Tersedia';
                }
            }

            state.tenants.splice(tenantIndex, 1);
            state.pagination.tenants.total = state.tenants.length;

            showToast('Penyewa berhasil dihapus', 'success');

            // Refresh tenants and units lists
            renderTenants();
            renderUnits();
        }

        function addUnit() {
            const form = document.getElementById('add-unit-form');
            const formData = new FormData(form);

            // Basic validation
            if (!formData.get('unit-code') || !formData.get('unit-type') || !formData.get('unit-rent')) {
                showToast('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            // Check if unit code already exists
            if (state.units.some(u => u.code === formData.get('unit-code'))) {
                showToast('Kode Unit sudah digunakan', 'error');
                return;
            }

            // Get selected facilities
            const facilities = [];
            formData.getAll('facilities').forEach(f => facilities.push(f));

            const newUnit = {
                code: formData.get('unit-code'),
                type: formData.get('unit-type'),
                location: formData.get('unit-location'),
                size: Number(formData.get('unit-size')) || 0,
                rent: Number(formData.get('unit-rent')) || 0,
                status: formData.get('unit-status'),
                facilities: facilities,
                description: formData.get('unit-description'),
                photos: [],
                tenant: null
            };

            // Handle photo uploads if exists
            const photoFiles = formData.getAll('unit-photos');
            if (photoFiles && photoFiles.length > 0) {
                photoFiles.forEach(file => {
                    if (file.size > 0) {
                        // In a real app, you would upload the file to a server
                        newUnit.photos.push(URL.createObjectURL(file));
                    }
                });
            }

            state.units.push(newUnit);
            state.pagination.units.total = state.units.length;

            showToast('Unit baru berhasil ditambahkan', 'success');
            closeModal('add-unit');
            form.reset();

            // Refresh units list and tenant unit selects
            renderUnits();
            updateTenantUnitSelects();
        }

        function updateUnit() {
            const unitCode = document.getElementById('edit-unit-id').value;
            const unitIndex = state.units.findIndex(u => u.code === unitCode);

            if (unitIndex === -1) {
                showToast('Unit tidak ditemukan', 'error');
                return;
            }

            // Get selected facilities
            const facilities = [];
            document.querySelectorAll('#edit-unit-facilities input[type="checkbox"]:checked').forEach(checkbox => {
                facilities.push(checkbox.value);
            });

            // Update unit data
            state.units[unitIndex] = {
                ...state.units[unitIndex],
                code: document.getElementById('edit-unit-code').value,
                type: document.getElementById('edit-unit-type').value,
                location: document.getElementById('edit-unit-location').value,
                size: Number(document.getElementById('edit-unit-size').value) || 0,
                rent: Number(document.getElementById('edit-unit-rent').value) || 0,
                status: document.getElementById('edit-unit-status').value,
                facilities: facilities,
                description: document.getElementById('edit-unit-description').value
            };

            showToast('Data unit berhasil diperbarui', 'success');
            closeModal('edit-unit');

            // Refresh units list and tenant unit selects
            renderUnits();
            updateTenantUnitSelects();
        }

        function deleteUnit(unitCode) {
            const unitIndex = state.units.findIndex(u => u.code === unitCode);
            if (unitIndex === -1) {
                showToast('Unit tidak ditemukan', 'error');
                return;
            }

            const unit = state.units[unitIndex];

            // Check if unit is occupied
            if (unit.status === 'Ditempati') {
                showToast('Unit sedang ditempati. Tidak dapat dihapus.', 'error');
                return;
            }

            state.units.splice(unitIndex, 1);
            state.pagination.units.total = state.units.length;

            showToast('Unit berhasil dihapus', 'success');

            // Refresh units list and tenant unit selects
            renderUnits();
            updateTenantUnitSelects();
        }

        function addContract() {
            const form = document.getElementById('add-contract-form');
            const formData = new FormData(form);

            // Basic validation
            if (!formData.get('contract-number') || !formData.get('contract-tenant') || !formData.get('contract-unit') ||
                !formData.get('contract-start') || !formData.get('contract-end') || !formData.get('contract-rent')) {
                showToast('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            // Check if contract number already exists
            if (state.contracts.some(c => c.number === formData.get('contract-number'))) {
                showToast('Nomor Kontrak sudah digunakan', 'error');
                return;
            }

            // Check if tenant already has active contract
            const tenantActiveContract = state.contracts.find(c =>
                c.tenantId === formData.get('contract-tenant') && c.status === 'Aktif'
            );

            if (tenantActiveContract) {
                showToast('Penyewa sudah memiliki kontrak aktif', 'error');
                return;
            }

            // Check if unit is already occupied
            const unit = state.units.find(u => u.code === formData.get('contract-unit'));
            if (unit && unit.status === 'Ditempati') {
                showToast('Unit sudah ditempati oleh penyewa lain', 'error');
                return;
            }

            const newContract = {
                number: formData.get('contract-number'),
                tenantId: formData.get('contract-tenant'),
                unitCode: formData.get('contract-unit'),
                startDate: formData.get('contract-start'),
                endDate: formData.get('contract-end'),
                rent: Number(formData.get('contract-rent')) || 0,
                deposit: Number(formData.get('contract-deposit')) || 0,
                paymentDay: Number(formData.get('contract-payment-day')) || 10,
                status: 'Aktif',
                terms: formData.get('contract-terms') || ''
            };

            state.contracts.push(newContract);
            state.pagination.contracts.total = state.contracts.length;

            // Update tenant's unit and unit status
            const tenant = state.tenants.find(t => t.id === newContract.tenantId);
            if (tenant) {
                tenant.unit = newContract.unitCode;
            }

            if (unit) {
                unit.tenant = newContract.tenantId;
                unit.status = 'Ditempati';
            }

            showToast('Kontrak baru berhasil dibuat', 'success');
            closeModal('add-contract');
            form.reset();

            // Refresh contracts, tenants and units lists
            renderContracts();
            renderTenants();
            renderUnits();
        }

        function deleteContract(contractNumber) {
            const contractIndex = state.contracts.findIndex(c => c.number === contractNumber);
            if (contractIndex === -1) {
                showToast('Kontrak tidak ditemukan', 'error');
                return;
            }

            const contract = state.contracts[contractIndex];

            // Check if contract is active
            if (contract.status === 'Aktif') {
                showToast('Kontrak masih aktif. Tidak dapat dihapus.', 'error');
                return;
            }

            state.contracts.splice(contractIndex, 1);
            state.pagination.contracts.total = state.contracts.length;

            showToast('Kontrak berhasil dihapus', 'success');

            // Refresh contracts list
            renderContracts();
        }

        function addPayment() {
            const form = document.getElementById('payment-form');
            const formData = new FormData(form);

            // Basic validation
            if (!formData.get('payment-tenant') || !formData.get('payment-amount') || !formData.get('payment-date')) {
                showToast('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            const paymentId = `P${Date.now().toString().slice(-6)}`;
            const tenantId = formData.get('payment-tenant');
            const contract = state.contracts.find(c => c.tenantId === tenantId && c.status === 'Aktif');

            if (!contract) {
                showToast('Penyewa tidak memiliki kontrak aktif', 'error');
                return;
            }

            const newPayment = {
                id: paymentId,
                contractNumber: contract.number,
                tenantId: tenantId,
                amount: Number(formData.get('payment-amount')) || 0,
                date: formData.get('payment-date'),
                method: formData.get('payment-method') || 'Transfer Bank',
                status: 'Lunas',
                note: formData.get('payment-note') || ''
            };

            state.payments.push(newPayment);
            state.pagination.payments.total = state.payments.length;

            showToast('Pembayaran berhasil dicatat', 'success');
            form.reset();

            // Refresh payments list and dashboard
            renderPayments();
            renderDashboard();
        }

        function addMaintenance() {
            const form = document.getElementById('add-maintenance-form');
            const formData = new FormData(form);

            // Basic validation
            if (!formData.get('maintenance-unit') || !formData.get('maintenance-issue')) {
                showToast('Harap isi semua field yang wajib diisi', 'error');
                return;
            }

            const maintenanceId = `MT-${Date.now().toString().slice(-6)}`;
            const unitCode = formData.get('maintenance-unit');
            const unit = state.units.find(u => u.code === unitCode);

            if (!unit) {
                showToast('Unit tidak ditemukan', 'error');
                return;
            }

            const newMaintenance = {
                id: maintenanceId,
                unitCode: unitCode,
                issue: formData.get('maintenance-issue'),
                description: formData.get('maintenance-description') || '',
                priority: formData.get('maintenance-priority') || 'Sedang',
                status: 'Dibuat',
                createdDate: new Date().toISOString().split('T')[0],
                completedDate: null,
                cost: null,
                photos: [],
                history: [
                    {
                        date: new Date().toISOString().split('T')[0],
                        status: 'Dibuat',
                        note: 'Tiket pemeliharaan dibuat'
                    }
                ]
            };

            // Handle photo uploads if exists
            const photoFiles = formData.getAll('maintenance-photos');
            if (photoFiles && photoFiles.length > 0) {
                photoFiles.forEach(file => {
                    if (file.size > 0) {
                        // In a real app, you would upload the file to a server
                        newMaintenance.photos.push(URL.createObjectURL(file));
                    }
                });
            }

            state.maintenance.push(newMaintenance);
            state.pagination.maintenance.total = state.maintenance.length;

            // Update unit status if needed
            if (unit.status !== 'Perbaikan') {
                unit.status = 'Perbaikan';
                renderUnits();
            }

            showToast('Tiket pemeliharaan berhasil dibuat', 'success');
            closeModal('add-maintenance');
            form.reset();

            // Refresh maintenance list and dashboard
            renderMaintenance();
            renderDashboard();
        }

        function updateMaintenance() {
            const maintenanceId = document.getElementById('maintenance-edit-btn').getAttribute('data-id');
            const maintenanceIndex = state.maintenance.findIndex(m => m.id === maintenanceId);

            if (maintenanceIndex === -1) {
                showToast('Tiket pemeliharaan tidak ditemukan', 'error');
                return;
            }

            const maintenance = state.maintenance[maintenanceIndex];
            const newStatus = document.getElementById('maintenance-update-status').value;
            const note = document.getElementById('maintenance-update-note').value;
            const cost = Number(document.getElementById('maintenance-update-cost').value) || null;

            // Update maintenance status
            maintenance.status = newStatus;

            // If completed, set completion date
            if (newStatus === 'Selesai' && !maintenance.completedDate) {
                maintenance.completedDate = new Date().toISOString().split('T')[0];
                maintenance.cost = cost;
            }

            // Add to history
            maintenance.history.push({
                date: new Date().toISOString().split('T')[0],
                status: newStatus,
                note: note || 'Status diperbarui'
            });

            // Update unit status if maintenance is completed
            if (newStatus === 'Selesai') {
                const unit = state.units.find(u => u.code === maintenance.unitCode);
                if (unit) {
                    const tenant = state.tenants.find(t => t.id === unit.tenant);
                    unit.status = tenant ? 'Ditempati' : 'Tersedia';
                    renderUnits();
                }
            }

            showToast('Status pemeliharaan berhasil diperbarui', 'success');
            closeModal('maintenance-detail');

            // Refresh maintenance list and dashboard
            renderMaintenance();
            renderDashboard();
        }

        function deleteMaintenance(maintenanceId) {
            const maintenanceIndex = state.maintenance.findIndex(m => m.id === maintenanceId);
            if (maintenanceIndex === -1) {
                showToast('Tiket pemeliharaan tidak ditemukan', 'error');
                return;
            }

            state.maintenance.splice(maintenanceIndex, 1);
            state.pagination.maintenance.total = state.maintenance.length;

            showToast('Tiket pemeliharaan berhasil dihapus', 'success');

            // Refresh maintenance list
            renderMaintenance();
        }

        function updateProfile() {
            // In a real app, this would update user profile on the server
            showToast('Profil berhasil diperbarui', 'success');
        }

        function updatePassword() {
            const currentPassword = document.getElementById('current-password').value;
            const newPassword = document.getElementById('new-password').value;
            const confirmPassword = document.getElementById('confirm-password').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showToast('Harap isi semua field', 'error');
                return;
            }

            if (newPassword !== confirmPassword) {
                showToast('Password baru tidak cocok', 'error');
                return;
            }

            // In a real app, you would verify current password and update to new one
            showToast('Password berhasil diubah', 'success');
            document.getElementById('password-form').reset();
        }

        function updateSystemSettings() {
            const currency = document.getElementById('currency').value;
            const dateFormat = document.getElementById('date-format').value;
            const emailNotifications = document.getElementById('notifications').checked;

            state.settings = {
                currency,
                dateFormat,
                emailNotifications
            };

            showToast('Pengaturan sistem berhasil diperbarui', 'success');
        }

        // Helper Functions
        function updateTenantUnitSelects() {
            const availableUnits = state.units.filter(u => u.status === 'Tersedia');

            // Update unit selects in tenant forms
            const tenantUnitSelects = [
                document.getElementById('tenant-unit'),
                document.getElementById('edit-tenant-unit'),
                document.getElementById('contract-unit')
            ];

            tenantUnitSelects.forEach(select => {
                if (select) {
                    select.innerHTML = '<option value="">Pilih Unit</option>' +
                        availableUnits.map(u => `<option value="${u.code}">${u.code} (${u.type})</option>`).join('');
                }
            });

            // Update unit select in maintenance form
            const maintenanceUnitSelect = document.getElementById('maintenance-unit');
            if (maintenanceUnitSelect) {
                maintenanceUnitSelect.innerHTML = '<option value="">Pilih Unit</option>' +
                    state.units.map(u => `<option value="${u.code}">${u.code} (${u.type})</option>`).join('');
            }
        }

        function updateTenantSelects() {
            // Update tenant selects in payment and contract forms
            const tenantSelects = [
                document.getElementById('payment-tenant'),
                document.getElementById('contract-tenant')
            ];

            tenantSelects.forEach(select => {
                if (select) {
                    select.innerHTML = '<option value="">Pilih Penyewa</option>' +
                        state.tenants.map(t => `<option value="${t.id}">${t.name} (${t.id})</option>`).join('');
                }
            });
        }

        function getStatusBadgeClass(status) {
            switch (status) {
                case 'Aktif':
                case 'Lunas':
                case 'Selesai':
                    return 'badge-success';
                case 'Menunggu':
                case 'Belum Lunas':
                    return 'badge-warning';
                case 'Nonaktif':
                case 'Terlambat':
                case 'Dibatalkan':
                    return 'badge-danger';
                case 'Diproses':
                    return 'badge-info';
                default:
                    return 'badge-secondary';
            }
        }

        function getPriorityBadgeClass(priority) {
            switch (priority) {
                case 'Rendah':
                    return 'badge-info';
                case 'Sedang':
                    return 'badge-warning';
                case 'Tinggi':
                case 'Darurat':
                    return 'badge-danger';
                default:
                    return 'badge-secondary';
            }
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function formatDate(dateString, format = 'DD/MM/YYYY') {
            if (!dateString) return '-';

            const date = new Date(dateString);
            if (isNaN(date.getTime())) return dateString;

            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear();

            if (format === 'MMMM YYYY') {
                const monthNames = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                    'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
                return `${monthNames[date.getMonth()]} ${year}`;
            }

            return `${day}/${month}/${year}`;
        }

        function printContract() {
            // In a real app, this would generate a printable contract document
            showToast('Mempersiapkan kontrak untuk dicetak...', 'info');
        }

        function printMaintenanceTicket() {
            // In a real app, this would generate a printable maintenance ticket
            showToast('Mempersiapkan tiket pemeliharaan untuk dicetak...', 'info');
        }

        function exportTenantData() {
            const headers = ['ID', 'Nama', 'Email', 'Telepon', 'KTP', 'Alamat', 'Unit', 'Harga Sewa', 'Status', 'Tanggal Bergabung'];
            const data = state.tenants.map(t => [
                t.id,
                t.name,
                t.email,
                t.phone,
                t.ktp,
                t.address,
                t.unit || '-',
                t.rent,
                t.status,
                t.joinDate
            ]);

            exportToCSV('data_penyewa', headers, data);
            showToast('Data penyewa berhasil diekspor', 'success');
        }

        function exportUnitData() {
            const headers = ['Kode', 'Tipe', 'Lokasi', 'Luas (m¬≤)', 'Harga Sewa', 'Status', 'Fasilitas', 'Penyewa', 'Deskripsi'];
            const data = state.units.map(u => [
                u.code,
                u.type,
                u.location,
                u.size,
                u.rent,
                u.status,
                u.facilities.join(', '),
                u.tenant || '-',
                u.description
            ]);

            exportToCSV('data_unit', headers, data);
            showToast('Data unit berhasil diekspor', 'success');
        }

        function exportContractData() {
            const headers = ['Nomor Kontrak', 'ID Penyewa', 'Kode Unit', 'Tanggal Mulai', 'Tanggal Berakhir',
                'Harga Sewa', 'Deposit', 'Tanggal Jatuh Tempo', 'Status'];
            const data = state.contracts.map(c => [
                c.number,
                c.tenantId,
                c.unitCode,
                c.startDate,
                c.endDate,
                c.rent,
                c.deposit,
                c.paymentDay,
                c.status
            ]);

            exportToCSV('data_kontrak', headers, data);
            showToast('Data kontrak berhasil diekspor', 'success');
        }

        function exportPaymentData() {
            const headers = ['ID Pembayaran', 'Nomor Kontrak', 'ID Penyewa', 'Jumlah', 'Tanggal',
                'Metode', 'Status', 'Catatan'];
            const data = state.payments.map(p => [
                p.id,
                p.contractNumber,
                p.tenantId,
                p.amount,
                p.date,
                p.method,
                p.status,
                p.note || '-'
            ]);

            exportToCSV('data_pembayaran', headers, data);
            showToast('Data pembayaran berhasil diekspor', 'success');
        }

        function exportMaintenanceData() {
            const headers = ['ID Tiket', 'Kode Unit', 'Masalah', 'Prioritas', 'Status',
                'Tanggal Dibuat', 'Tanggal Selesai', 'Biaya', 'Deskripsi'];
            const data = state.maintenance.map(m => [
                m.id,
                m.unitCode,
                m.issue,
                m.priority,
                m.status,
                m.createdDate,
                m.completedDate || '-',
                m.cost || '-',
                m.description
            ]);

            exportToCSV('data_pemeliharaan', headers, data);
            showToast('Data pemeliharaan berhasil diekspor', 'success');
        } function exportFinancialReport() {
            const headers = ['Bulan', 'Pendapatan Sewa', 'Biaya Pemeliharaan', 'Pendapatan Bersih'];
            const data = Array(12).fill().map((_, i) => {
                const monthIncome = state.payments
                    .filter(p => new Date(p.date).getMonth() === i)
                    .reduce((sum, p) => sum + p.amount, 0);

                const monthCost = state.maintenance
                    .filter(m => m.status === 'Selesai' && new Date(m.completedDate).getMonth() === i)
                    .reduce((sum, m) => sum + (m.cost || 0), 0);

                return [
                    new Date(2023, i, 1).toLocaleString('id-ID', { month: 'long' }),
                    monthIncome,
                    monthCost,
                    monthIncome - monthCost
                ];
            });

            exportToCSV('laporan_keuangan', headers, data);
            showToast('Laporan keuangan berhasil diekspor', 'success');
        }

        function exportOccupancyReport() {
            const headers = ['Kode Unit', 'Tipe', 'Status', 'Penyewa', 'Tanggal Mulai', 'Tanggal Berakhir', 'Harga Sewa'];
            const data = state.units.map(u => {
                const contract = state.contracts.find(c => c.unitCode === u.code);
                const tenant = contract ? state.tenants.find(t => t.id === contract.tenantId) : null;

                return [
                    u.code,
                    u.type,
                    u.status,
                    tenant ? tenant.name : '-',
                    contract ? contract.startDate : '-',
                    contract ? contract.endDate : '-',
                    u.rent
                ];
            });

            exportToCSV('laporan_hunian', headers, data);
            showToast('Laporan hunian berhasil diekspor', 'success');
        }

        function exportMaintenanceReport() {
            const headers = ['ID Tiket', 'Kode Unit', 'Masalah', 'Prioritas', 'Status',
                'Tanggal Dibuat', 'Tanggal Selesai', 'Durasi (hari)', 'Biaya'];
            const data = state.maintenance.map(m => {
                const duration = m.completedDate ?
                    Math.ceil((new Date(m.completedDate) - new Date(m.createdDate)) / (1000 * 60 * 60 * 24)) :
                    null;

                return [
                    m.id,
                    m.unitCode,
                    m.issue,
                    m.priority,
                    m.status,
                    m.createdDate,
                    m.completedDate || '-',
                    duration || '-',
                    m.cost || '-'
                ];
            });

            exportToCSV('laporan_pemeliharaan', headers, data);
            showToast('Laporan pemeliharaan berhasil diekspor', 'success');
        }

        function exportToCSV(filename, headers, data) {
            const csvContent = [
                headers.join(','),
                ...data.map(row => row.map(field => `"${field}"`).join(','))
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');

            link.setAttribute('href', url);
            link.setAttribute('download', `${filename}_${new Date().toISOString().slice(0, 10)}.csv`);
            link.style.visibility = 'hidden';

            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function logout() {
            showToast('Anda akan keluar dari sistem...', 'info');
            setTimeout(() => {
                // In a real app, this would clear the session and redirect to login
                window.location.href = 'login.html';
            }, 1500);
        }

        // Event Listeners
        function initEventListeners() {
            // Theme toggle
            elements.themeToggle.addEventListener('click', toggleTheme);

            // Tenant pagination
            elements.prevTenantPage.addEventListener('click', () => {
                if (state.pagination.tenants.page > 1) {
                    state.pagination.tenants.page--;
                    renderTenants();
                }
            });

            elements.nextTenantPage.addEventListener('click', () => {
                const { page, perPage, total } = state.pagination.tenants;
                if (page * perPage < total) {
                    state.pagination.tenants.page++;
                    renderTenants();
                }
            });

            // Unit pagination
            elements.prevUnitPage.addEventListener('click', () => {
                if (state.pagination.units.page > 1) {
                    state.pagination.units.page--;
                    renderUnits();
                }
            });

            elements.nextUnitPage.addEventListener('click', () => {
                const { page, perPage, total } = state.pagination.units;
                if (page * perPage < total) {
                    state.pagination.units.page++;
                    renderUnits();
                }
            });

            // Contract pagination
            elements.prevContractPage.addEventListener('click', () => {
                if (state.pagination.contracts.page > 1) {
                    state.pagination.contracts.page--;
                    renderContracts();
                }
            });

            elements.nextContractPage.addEventListener('click', () => {
                const { page, perPage, total } = state.pagination.contracts;
                if (page * perPage < total) {
                    state.pagination.contracts.page++;
                    renderContracts();
                }
            });

            // Payment pagination
            elements.prevPaymentPage.addEventListener('click', () => {
                if (state.pagination.payments.page > 1) {
                    state.pagination.payments.page--;
                    renderPayments();
                }
            });

            elements.nextPaymentPage.addEventListener('click', () => {
                const { page, perPage, total } = state.pagination.payments;
                if (page * perPage < total) {
                    state.pagination.payments.page++;
                    renderPayments();
                }
            });

            // Maintenance pagination
            elements.prevMaintenancePage.addEventListener('click', () => {
                if (state.pagination.maintenance.page > 1) {
                    state.pagination.maintenance.page--;
                    renderMaintenance();
                }
            });

            elements.nextMaintenancePage.addEventListener('click', () => {
                const { page, perPage, total } = state.pagination.maintenance;
                if (page * perPage < total) {
                    state.pagination.maintenance.page++;
                    renderMaintenance();
                }
            });

            // Filters
            if (elements.tenantFilter) {
                elements.tenantFilter.addEventListener('input', () => {
                    state.pagination.tenants.page = 1;
                    renderTenants();
                });
            }

            if (elements.tenantStatusFilter) {
                elements.tenantStatusFilter.addEventListener('change', () => {
                    state.pagination.tenants.page = 1;
                    renderTenants();
                });
            }

            if (elements.unitFilter) {
                elements.unitFilter.addEventListener('input', () => {
                    state.pagination.units.page = 1;
                    renderUnits();
                });
            }

            if (elements.unitStatusFilter) {
                elements.unitStatusFilter.addEventListener('change', () => {
                    state.pagination.units.page = 1;
                    renderUnits();
                });
            }

            if (elements.contractFilter) {
                elements.contractFilter.addEventListener('input', () => {
                    state.pagination.contracts.page = 1;
                    renderContracts();
                });
            }

            if (elements.contractStatusFilter) {
                elements.contractStatusFilter.addEventListener('change', () => {
                    state.pagination.contracts.page = 1;
                    renderContracts();
                });
            }

            if (elements.paymentFilter) {
                elements.paymentFilter.addEventListener('input', () => {
                    state.pagination.payments.page = 1;
                    renderPayments();
                });
            }

            if (elements.paymentDateFilter) {
                elements.paymentDateFilter.addEventListener('change', () => {
                    state.pagination.payments.page = 1;
                    renderPayments();
                });
            }

            if (elements.maintenanceFilter) {
                elements.maintenanceFilter.addEventListener('input', () => {
                    state.pagination.maintenance.page = 1;
                    renderMaintenance();
                });
            }

            if (elements.maintenanceStatusFilter) {
                elements.maintenanceStatusFilter.addEventListener('change', () => {
                    state.pagination.maintenance.page = 1;
                    renderMaintenance();
                });
            }

            if (elements.maintenancePriorityFilter) {
                elements.maintenancePriorityFilter.addEventListener('change', () => {
                    state.pagination.maintenance.page = 1;
                    renderMaintenance();
                });
            }

            // Report filters
            if (elements.financialMonthFilter) {
                elements.financialMonthFilter.addEventListener('change', renderFinancialReport);
            }

            if (elements.maintenanceMonthFilter) {
                elements.maintenanceMonthFilter.addEventListener('change', renderMaintenanceReport);
            }

            // Notification button
            if (elements.notificationsBtn) {
                elements.notificationsBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    showToast('Fitur notifikasi akan segera hadir', 'info');
                });
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', init);
}) ();</script>
</body>

</html>