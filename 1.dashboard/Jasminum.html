<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Elite Apartment Rental</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Design System */
    :root {
      --primary: #3b82f6;
      --primary-dark: #1d4ed8;
      --secondary: #ec4899;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --text-primary: #111827;
      --text-secondary: #6b7280;
      --bg-light: #f9fafb;
      --bg-white: #ffffff;
      --border-color: #d1d5db;
      --spacing-xs: 0.25rem;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 1.5rem;
      --spacing-xl: 2rem;
      --radius-sm: 0.25rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.1);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --transition-fast: all 0.2s ease-in-out;
      --font-family: 'Inter', sans-serif;
    }

    /* Reset */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: var(--font-family); background: var(--bg-light); color: var(--text-primary); line-height: 1.6; }
    a { text-decoration: none; color: inherit; }
    button, input, select, textarea { font-family: inherit; }

    /* Utilities */
    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .flex-center { justify-content: center; align-items: center; }
    .gap-xs { gap: var(--spacing-xs); }
    .gap-sm { gap: var(--spacing-sm); }
    .gap-md { gap: var(--spacing-md); }
    .gap-lg { gap: var(--spacing-lg); }
    .mt-xs { margin-top: var(--spacing-xs); }
    .mt-sm { margin-top: var(--spacing-sm); }
    .mt-md { margin-top: var(--spacing-md); }
    .mt-lg { margin-top: var(--spacing-lg); }
    .mb-sm { margin-bottom: var(--spacing-sm); }
    .mb-md { margin-bottom: var(--spacing-md); }
    .mb-lg { margin-bottom: var(--spacing-lg); }
    .p-sm { padding: var(--spacing-sm); }
    .p-md { padding: var(--spacing-md); }
    .p-lg { padding: var(--spacing-lg); }
    .text-center { text-align: center; }
    .w-full { width: 100%; }
    .rounded { border-radius: var(--radius-md); }
    .shadow { box-shadow: var(--shadow-md); }
    .hidden { display: none; }
    .fade-in { opacity: 0; transform: translateY(20px); transition: all 0.5s ease-out; }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    /* Layout */
    .container { max-width: 1200px; margin: 0 auto; padding: var(--spacing-md); }
    .section { padding: var(--spacing-xl) 0; }
    .grid { display: grid; gap: var(--spacing-lg); }
    .grid-2 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: repeat(3, 1fr); }
    .grid-auto { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }

    /* Navigation */
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--bg-white);
      padding: var(--spacing-md) 0;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: var(--shadow-sm);
    }
    .nav-brand { font-size: 1.5rem; font-weight: 700; color: var(--primary); }
    .nav-links { display: flex; gap: var(--spacing-lg); list-style: none; }
    .nav-link { font-weight: 500; padding: var(--spacing-sm) 0; cursor: pointer; position: relative; }
    .nav-link:hover::after, .nav-link.is-active::after {
      content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 2px; background: var(--primary);
    }

    /* Buttons */
    .btn {
      padding: var(--spacing-sm) var(--spacing-lg);
      border-radius: var(--radius-md);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition-fast);
      border: none;
      display: inline-flex;
      align-items: center;
      gap: var(--spacing-sm);
    }
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover { background: var(--primary-dark); transform: translateY(-2px); }
    .btn-outline { background: transparent; border: 1px solid var(--border-color); }
    .btn-outline:hover { border-color: var(--primary); color: var(--primary); }

    /* Card Styles */
    .property-card {
      background: var(--bg-white);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-md);
      transition: var(--transition-fast);
    }
    .property-card:hover { transform: translateY(-5px); }
    .property-card img { width: 100%; height: 200px; object-fit: cover; }
    .property-card figcaption { padding: var(--spacing-md); }
    .property-card h3 { font-size: 1.2rem; margin-bottom: var(--spacing-sm); display: flex; align-items: center; gap: var(--spacing-sm); }
    .property-details { display: flex; justify-content: space-between; margin-bottom: var(--spacing-sm); }
    .price { color: var(--primary); font-weight: 600; }
    .location { display: flex; align-items: center; gap: var(--spacing-xs); color: var(--text-secondary); }
    .property-features { display: flex; flex-wrap: wrap; gap: var(--spacing-md); color: var(--text-secondary); }
    details { padding: var(--spacing-md); border-top: 1px solid var(--border-color); }
    summary { cursor: pointer; color: var(--primary); font-weight: 500; }
    blockquote { border-left: 3px solid var(--primary); padding-left: var(--spacing-md); margin: var(--spacing-md) 0; font-style: italic; }

    /* Search and Filter */
    .search-form { background: var(--bg-white); padding: var(--spacing-lg); border-radius: var(--radius-lg); box-shadow: var(--shadow-md); }
    .filter-group { margin-bottom: var(--spacing-md); }
    .filter-group label { display: block; font-weight: 500; margin-bottom: var(--spacing-sm); }
    .filter-group input, .filter-group select { padding: var(--spacing-sm); border: 1px solid var(--border-color); border-radius: var(--radius-sm); width: 100%; }
    .map-canvas { width: 100%; height: 300px; background: #e2e8f0; border-radius: var(--radius-md); }

    /* Calendar */
    .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: var(--spacing-xs); }
    .calendar-day { padding: var(--spacing-sm); text-align: center; border-radius: var(--radius-sm); cursor: pointer; }
    .calendar-day.available { background: var(--success); color: white; }
    .calendar-day.booked { background: var(--warning); color: white; cursor: not-allowed; }

    /* Gallery and Virtual Tour */
    .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-md); }
    .gallery img { width: 100%; height: 150px; object-fit: cover; border-radius: var(--radius-md); transition: transform 0.3s; }
    .gallery img:hover { transform: scale(1.1); }
    .virtual-tour { position: relative; overflow: hidden; }
    .virtual-tour img { transition: transform 0.5s ease; }
    .virtual-tour:hover img { transform: rotate(5deg) scale(1.1); }

    /* Chat System */
    .chat-window { height: 300px; overflow-y: auto; border: 1px solid var(--border-color); padding: var(--spacing-md); border-radius: var(--radius-md); }
    .chat-message { margin-bottom: var(--spacing-sm); padding: var(--spacing-sm); border-radius: var(--radius-md); }
    .chat-message.sent { background: var(--primary); color: white; margin-left: 20%; }
    .chat-message.received { background: var(--bg-light); margin-right: 20%; }

    /* Payment Methods */
    .payment-methods { display: flex; gap: var(--spacing-md); }
    .payment-method { padding: var(--spacing-sm); border: 1px solid var(--border-color); border-radius: var(--radius-md); cursor: pointer; transition: var(--transition-fast); }
    .payment-method.selected { border-color: var(--primary); background: #bfdbfe; }

    /* Cost Breakdown */
    .cost-breakdown { background: var(--bg-white); padding: var(--spacing-md); border-radius: var(--radius-md); margin-top: var(--spacing-md); }
    .cost-breakdown h3 { margin-bottom: var(--spacing-sm); }
    .cost-line { display: flex; justify-content: space-between; margin-bottom: var(--spacing-sm); }
    .total { font-weight: bold; font-size: 1.2rem; }

    /* Escrow Info */
    .escrow-info { background: #fef9c3; padding: var(--spacing-sm); border-left: 4px solid gold; margin: var(--spacing-md) 0; }

    /* Chatbox */
    .chatbox {
      position: fixed;
      bottom: 80px;
      right: var(--spacing-lg);
      background: var(--bg-white);
      width: 300px;
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-md);
      display: none;
      flex-direction: column;
      height: 400px;
    }
    .chat-header {
      background: var(--primary);
      color: white;
      padding: var(--spacing-sm);
      border-top-left-radius: var(--radius-md);
      border-top-right-radius: var(--radius-md);
    }
    .chat-body {
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing-sm);
    }
    .chat-input {
      display: flex;
      padding: var(--spacing-sm);
      border-top: 1px solid var(--border-color);
    }
    .chat-input input {
      flex: 1;
      padding: var(--spacing-sm);
      border: 1px solid var(--border-color);
      border-right: none;
      border-top-left-radius: var(--radius-sm);
      border-bottom-left-radius: var(--radius-sm);
    }
    .chat-input button {
      padding: var(--spacing-sm);
      border: 1px solid var(--border-color);
      background: var(--primary);
      color: white;
      border-top-right-radius: var(--radius-sm);
      border-bottom-right-radius: var(--radius-sm);
    }

    /* Loyalty Badge */
    .loyalty-badge {
      background: orange;
      color: white;
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-sm);
      font-size: 0.8rem;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .grid-3 { grid-template-columns: repeat(2, 1fr); }
    }
    @media (max-width: 768px) {
      .navbar { flex-direction: column; gap: var(--spacing-md); }
      .nav-links { flex-direction: column; align-items: center; }
      .grid-3, .grid-2 { grid-template-columns: 1fr; }
      .search-form { grid-template-columns: 1fr; }
      .chatbox { width: 90%; }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
      * { transition-duration: 0.01ms !important; }
    }
    [tabindex="0"]:focus, button:focus, input:focus, select:focus {
      outline: 2px solid var(--primary);
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <!-- Navigation -->
  <header class="container">
    <nav class="navbar">
      <div class="nav-brand">EliteRent</div>
      <ul class="nav-links">
        <li><span class="nav-link is-active" data-page="home">Home</span></li>
        <li><span class="nav-link" data-page="search">Search</span></li>
        <li><span class="nav-link" data-page="profile">Profile</span></li>
        <li><span class="nav-link" data-page="support">Support</span></li>
      </ul>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- Home Page -->
    <section id="home" class="section page fade-in active">
      <h1 class="text-center">Find Your Dream Apartment</h1>
      <p class="text-center mb-lg">Discover modern apartments with premium amenities</p>

      <!-- Quick Search -->
      <form class="search-form mb-lg">
        <div class="grid-3">
          <div class="filter-group">
            <label for="quick-location">Location</label>
            <input type="text" id="quick-location" placeholder="Enter city or area" aria-label="Search location">
          </div>
          <div class="filter-group">
            <label for="quick-checkin">Check-in</label>
            <input type="date" id="quick-checkin" aria-label="Check-in date">
          </div>
          <div class="filter-group">
            <label for="quick-checkout">Check-out</label>
            <input type="date" id="quick-checkout" aria-label="Check-out date">
          </div>
        </div>
        <button type="submit" class="btn btn-primary mt-md"><span class="material-icons">search</span>Search Now</button>
      </form>

      <!-- Featured Properties -->
      <h2>Featured Properties</h2>
      <div class="grid grid-auto">
        <figure class="property-card">
          <img src="https://source.unsplash.com/800x600/?apartment,modern" alt="Luxury Apartment" loading="lazy">
          <figcaption>
            <h3>Luxury Sky Residence <span class="material-icons verified-icon" title="Verified Owner">verified</span></h3>
            <div class="property-details">
              <span class="price">$2,500/month</span>
              <span class="location"><i class="material-icons">location_on</i> Downtown</span>
            </div>
            <div class="property-features">
              <span><i class="material-icons">hotel</i> 2 BR</span>
              <span><i class="material-icons">square_foot</i> 850 sqft</span>
              <span><i class="material-icons">pool</i> Pool</span>
            </div>
            <blockquote>
              <p>"Amazing views and top-notch amenities!"</p>
              <footer>- John Doe <span class="material-icons report-icon" tabindex="0" onclick="reportReview()" title="Report Review">report</span></footer>
            </blockquote>
          </figcaption>
          <details>
            <summary>More Details</summary>
            <p>Modern apartment with city views, gym, and 24/7 security.</p>
            <button class="btn btn-primary" onclick="navigateToDetail(1)">View Details</button>
          </details>
        </figure>
        <figure class="property-card">
          <img src="https://source.unsplash.com/800x600/?apartment,studio" alt="Cozy Studio" loading="lazy">
          <figcaption>
            <h3>Cozy Urban Studio <span class="material-icons verified-icon" title="Verified Owner">verified</span></h3>
            <div class="property-details">
              <span class="price">$1,500/month</span>
              <span class="location"><i class="material-icons">location_on</i> Midtown</span>
            </div>
            <div class="property-features">
              <span><i class="material-icons">hotel</i> Studio</span>
              <span><i class="material-icons">square_foot</i> 400 sqft</span>
              <span><i class="material-icons">wifi</i> WiFi</span>
            </div>
            <blockquote>
              <p>"Perfect for young professionals!"</p>
              <footer>- Jane Smith <span class="material-icons report-icon" tabindex="0" onclick="reportReview()" title="Report Review">report</span></footer>
            </blockquote>
          </figcaption>
          <details>
            <summary>More Details</summary>
            <p>Compact studio with modern amenities in a vibrant neighborhood.</p>
            <button class="btn btn-primary" onclick="navigateToDetail(2)">View Details</button>
          </details>
        </figure>
      </div>

      <!-- Why Choose Us -->
      <h2 class="mt-lg">Why Choose Us</h2>
      <div class="grid grid-3">
        <div class="card p-md">
          <h3>Secure Payments</h3>
          <p>Escrow-protected transactions with multiple payment options.</p>
        </div>
        <div class="card p-md">
          <h3>24/7 Support</h3>
          <p>Reach our team anytime via chat, email, or phone.</p>
        </div>
        <div class="card p-md">
          <h3>Verified Owners</h3>
          <p>All owners are identity-verified for your safety.</p>
        </div>
      </div>

      <!-- Testimonials -->
      <h2 class="mt-lg">Testimonials</h2>
      <div class="grid grid-auto">
        <div class="card p-md">
          <blockquote>
            <p>"Found my dream apartment in just a few clicks!"</p>
            <footer>- Sarah Johnson</footer>
          </blockquote>
        </div>
        <div class="card p-md">
          <blockquote>
            <p>"The booking process was seamless and secure."</p>
            <footer>- Michael Lee</footer>
          </blockquote>
        </div>
      </div>
    </section>

    <!-- Search Page -->
    <section id="search" class="section page fade-in hidden">
      <h1>Search Apartments</h1>
      <div class="grid-2">
        <div>
          <form class="search-form">
            <div class="filter-group">
              <label>Location</label>
              <canvas class="map-canvas" id="searchMap" aria-label="Interactive map"></canvas>
              <input type="range" min="1" max="10" value="5" id="radiusSlider" aria-label="Radius filter">
              <p>Radius: <span id="radiusValue">5</span> km</p>
            </div>
            <div class="filter-group">
              <label>Dates</label>
              <div class="calendar" id="searchCalendar" role="grid" aria-label="Availability calendar"></div>
            </div>
            <div class="filter-group">
              <label>Price Range</label>
              <input type="range" min="500" max="5000" value="2500" id="priceSlider" aria-label="Price filter">
              <p>Max: $<span id="priceValue">2500</span></p>
            </div>
            <div class="filter-group">
              <label>Amenities</label>
              <div class="flex-col gap-sm">
                <label><input type="checkbox" value="pool" aria-label="Pool"> Pool</label>
                <label><input type="checkbox" value="gym" aria-label="Gym"> Gym</label>
                <label><input type="checkbox" value="wifi" aria-label="WiFi"> WiFi</label>
                <label><input type="checkbox" value="parking" aria-label="Parking"> Parking</label>
                <label><input type="checkbox" value="ac" aria-label="AC"> AC</label>
                <label><input type="checkbox" value="laundry" aria-label="Laundry"> Laundry</label>
              </div>
            </div>
            <div class="filter-group">
              <label for="apartment-type">Apartment Type</label>
              <select id="apartment-type" aria-label="Apartment type filter">
                <option value="">All Types</option>
                <option value="studio">Studio</option>
                <option value="1br">1 Bedroom</option>
                <option value="2br">2 Bedroom</option>
                <option value="3br">3 Bedroom+</option>
                <option value="penthouse">Penthouse</option>
                <option value="family">Family</option>
              </select>
            </div>
            <button type="submit" class="btn btn-primary mt-md"><span class="material-icons">filter_alt</span>Apply Filters</button>
          </form>
        </div>
        <div>
          <h2>Results</h2>
          <div class="grid grid-auto" id="searchResults"></div>
        </div>
      </div>
    </section>

    <!-- Apartment Detail Page -->
    <section id="apartment" class="section page fade-in hidden">
      <h1 id="apartment-title"></h1>
      <div class="gallery mb-lg">
        <div class="virtual-tour">
          <img src="https://source.unsplash.com/800x600/?apartment,interior" alt="Apartment Interior Virtual Tour" loading="lazy">
        </div>
        <img src="https://source.unsplash.com/400x300/?bedroom" alt="Bedroom" loading="lazy">
        <img src="https://source.unsplash.com/400x300/?kitchen" alt="Kitchen" loading="lazy">
        <img src="https://source.unsplash.com/400x300/?living-room" alt="Living Room" loading="lazy">
      </div>
      <div class="grid-2">
        <div>
          <h2>Details</h2>
          <p>Price: <span id="apartment-price"></span></p>
          <p>Location: <span id="apartment-location"></span></p>
          <p>Amenities: <span id="apartment-amenities"></span></p>
          <canvas class="map-canvas" id="apartmentMap" aria-label="Apartment location map"></canvas>
          <p><a href="https://maps.google.com" target="_blank" aria-label="View on Google Maps">View on Google Maps</a></p>
          <h3>Reviews</h3>
          <div id="apartment-reviews"></div>
        </div>
        <div>
          <h2>Book Now</h2>
          <form class="booking-form">
            <div class="filter-group">
              <label for="book-checkin">Check-in</label>
              <input type="date" id="book-checkin" required aria-label="Booking check-in date">
            </div>
            <div class="filter-group">
              <label for="book-checkout">Check-out</label>
              <input type="date" id="book-checkout" required aria-label="Booking check-out date">
            </div>
            <div class="filter-group">
              <label for="guests">Guests</label>
              <input type="number" id="guests" min="1" value="1" required aria-label="Number of guests">
            </div>
            <div class="filter-group">
              <label>Payment Method</label>
              <div class="payment-methods" role="radiogroup" aria-label="Select payment method">
                <div class="payment-method" data-method="credit" tabindex="0" role="radio" aria-checked="false">Credit Card</div>
                <div class="payment-method" data-method="bank" tabindex="0" role="radio" aria-checked="false">Bank Transfer</div>
                <div class="payment-method" data-method="ewallet" tabindex="0" role="radio" aria-checked="false">E-Wallet</div>
              </div>
            </div>
            <div class="filter-group">
              <label><input type="checkbox" id="insurance" aria-label="Add insurance"> Add Insurance (+10%)</label>
            </div>
            <div class="cost-breakdown hidden" id="cost-breakdown">
              <h3>Cost Breakdown</h3>
              <div class="cost-line"><span>Rental</span><span id="base-cost"></span></div>
              <div class="cost-line"><span>Service Fee</span><span id="service-cost"></span></div>
              <div class="cost-line"><span>Insurance</span><span id="insurance-cost"></span></div>
              <div class="cost-line total"><span>Total</span><span id="total-cost"></span></div>
            </div>
            <p class="escrow-info">Payments are secured via our escrow system until check-in.</p>
            <button type="submit" class="btn btn-primary"><span class="material-icons">book</span>Confirm Booking</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Profile Page -->
    <section id="profile" class="section page fade-in hidden">
      <h1>User Profile</h1>
      <div class="grid-2">
        <div class="card p-lg">
          <h2>Account Info</h2>
          <p>Name: Jane Doe</p>
          <p>Email: jane@example.com</p>
          <p>Loyalty Points: <span class="loyalty-badge">150</span></p>
          <button class="btn btn-outline mt-sm">Edit Profile</button>
        </div>
        <div class="card p-lg">
          <h2>Messages</h2>
          <div class="chat-window" id="chatWindow" aria-live="polite">
            <div class="chat-message sent">Is the apartment available?</div>
            <div class="chat-message received">Yes, it's available!</div>
          </div>
          <input type="text" id="chatInput" placeholder="Type a message..." aria-label="Chat input">
          <button class="btn btn-primary mt-sm" onclick="sendMessage()">Send</button>
        </div>
      </div>
      <h2 class="mt-lg">Booking History</h2>
      <div class="grid grid-auto" id="booking-history">
        <div class="card p-md">
          <h3>Luxury Sky Residence</h3>
          <p>Check-in: 2025-06-01</p>
          <p>Check-out: 2025-06-07</p>
          <p>Total: $17,500</p>
        </div>
        <div class="card p-md">
          <h3>Cozy Urban Studio</h3>
          <p>Check-in: 2025-07-01</p>
          <p>Check-out: 2025-07-15</p>
          <p>Total: $21,000</p>
        </div>
      </div>
      <h2 class="mt-lg">Notifications</h2>
      <div class="card p-md">
        <p>Reminder: Check-in for Luxury Sky Residence in 2 days.</p>
      </div>
    </section>

    <!-- Support Page -->
    <section id="support" class="section page fade-in hidden">
      <h1>Customer Support</h1>
      <div class="grid-3">
        <div class="card p-md">
          <h2>Live Chat</h2>
          <button class="btn btn-primary" onclick="openChat()">Start Chat</button>
        </div>
        <div class="card p-md">
          <h2>Email</h2>
          <p><a href="mailto:support@eliterent.com">support@eliterent.com</a></p>
        </div>
        <div class="card p-md">
          <h2>Phone</h2>
          <p><a href="tel:+180035483">+1-800-ELITE</a></p>
        </div>
      </div>
    </section>
  </main>

  <!-- Chatbox -->
  <button class="message-btn" id="messageBtn" aria-label="Open chat"><span class="material-icons">chat</span></button>
  <div class="chatbox" id="chatbox">
    <div class="chat-header">Customer Support</div>
    <div class="chat-body" id="chatBody" aria-live="polite">
      <div class="chat-message system">Welcome! How can we assist you today?</div>
    </div>
    <div class="chat-input">
      <input type="text" id="supportChatInput" placeholder="Type a message..." aria-label="Support chat input">
      <button onclick="sendSupportMessage()" aria-label="Send message">Send</button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-center p-lg" style="background: var(--text-primary); color: white;">
    <p>© 2025 EliteRent. All rights reserved.</p>
  </footer>

  <script>
    // Mock Data
    const apartments = [
      {
        id: 1,
        title: 'Luxury Sky Residence',
        price: 2500,
        location: 'Downtown',
        bedrooms: 2,
        sqft: 850,
        type: '2br',
        amenities: ['pool', 'gym', 'wifi', 'parking', 'ac'],
        images: [
          'https://source.unsplash.com/800x600/?apartment,modern',
          'https://source.unsplash.com/400x300/?bedroom',
          'https://source.unsplash.com/400x300/?kitchen',
          'https://source.unsplash.com/400x300/?living-room'
        ],
        description: 'Modern apartment with city views, gym, and 24/7 security.',
        reviews: [
          { user: 'Jane Smith', comment: 'Fantastic place with great amenities!', rating: 5 },
          { user: 'Michael Lee', comment: 'Loved the view and service!', rating: 4 }
        ],
        status: 'available'
      },
      {
        id: 2,
        title: 'Cozy Urban Studio',
        price: 1500,
        location: 'Midtown',
        bedrooms: 0,
        sqft: 400,
        type: 'studio',
        amenities: ['wifi', 'ac', 'laundry'],
        images: [
          'https://source.unsplash.com/800x600/?apartment,studio',
          'https://source.unsplash.com/400x300/?living-room',
          'https://source.unsplash.com/400x300/?bathroom'
        ],
        description: 'Compact studio perfect for young professionals.',
        reviews: [
          { user: 'John Doe', comment: 'Great location, very clean!', rating: 4 },
          { user: 'Sarah Johnson', comment: 'Perfect for a solo traveler.', rating: 5 }
        ],
        status: 'booked'
      }
    ];

    // SPA Routing
    const pages = document.querySelectorAll('.page');
    const navLinks = document.querySelectorAll('.nav-link');

    function showPage(pageId) {
      pages.forEach(page => page.classList.toggle('hidden', page.id !== pageId));
      navLinks.forEach(link => link.classList.toggle('is-active', link.dataset.page === pageId));
      loadDynamicContent(pageId);
      window.scrollTo(0, 0);
    }

    navLinks.forEach(link => {
      link.addEventListener('click', () => showPage(link.dataset.page));
    });

    window.addEventListener('load', () => showPage('home'));

    function navigateToDetail(id) {
      localStorage.setItem('selectedApartmentId', id);
      showPage('apartment');
    }

    // Dynamic Content Loading
    function loadDynamicContent(pageId) {
      switch (pageId) {
        case 'search':
          renderSearchResults();
          break;
        case 'apartment':
          renderApartmentDetails();
          break;
      }
    }

    // Fade-in Animation
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.1 });

    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

    // Search and Filter
    const searchForm = document.querySelector('.search-form');
    const searchResults = document.getElementById('searchResults');
    const radiusSlider = document.getElementById('radiusSlider');
    const radiusValue = document.getElementById('radiusValue');
    const priceSlider = document.getElementById('priceSlider');
    const priceValue = document.getElementById('priceValue');

    radiusSlider.addEventListener('input', () => {
      radiusValue.textContent = radiusSlider.value;
    });

    priceSlider.addEventListener('input', () => {
      priceValue.textContent = priceSlider.value;
    });

    searchForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const location = document.querySelector('#quick-location')?.value.toLowerCase() || '';
      const price = parseInt(priceSlider.value);
      const amenities = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.value);
      const type = document.querySelector('#apartment-type').value;

      const results = apartments.filter(apartment => {
        return (
          (!location || apartment.location.toLowerCase().includes(location)) &&
          apartment.price <= price &&
          (!amenities.length || amenities.every(amenity => apartment.amenities.includes(amenity))) &&
          (!type || apartment.type === type)
        );
      });

      searchResults.innerHTML = results.map(apartment => `
        <figure class="property-card">
          <img src="${apartment.images[0]}" alt="${apartment.title}" loading="lazy">
          <figcaption>
            <h3>${apartment.title} <span class="material-icons verified-icon" title="Verified Owner">verified</span></h3>
            <div class="property-details">
              <span class="price">$${apartment.price}/month</span>
              <span class="location"><i class="material-icons">location_on</i> ${apartment.location}</span>
            </div>
            <div class="property-features">
              <span><i class="material-icons">hotel</i> ${apartment.bedrooms || 'Studio'} BR</span>
              <span><i class="material-icons">square_foot</i> ${apartment.sqft} sqft</span>
            </div>
            <blockquote>
              <p>"${apartment.reviews[0]?.comment || 'Great place!'}"</p>
              <footer>- ${apartment.reviews[0]?.user || 'Guest'} <span class="material-icons report-icon" tabindex="0" onclick="reportReview()" title="Report Review">report</span></footer>
            </blockquote>
          </figcaption>
          <details>
            <summary>More Details</summary>
            <p>${apartment.description}</p>
            <button class="btn btn-primary" onclick="navigateToDetail(${apartment.id})">View Details</button>
          </details>
        </figure>
      `).join('');
    });

    // Calendar
    function renderCalendar(containerId) {
      const calendar = document.getElementById(containerId);
      const days = Array(35).fill().map((_, i) => ({
        day: i + 1,
        status: Math.random() > 0.3 ? 'available' : 'booked'
      }));

      calendar.innerHTML = days.map(day => `
        <div class="calendar-day ${day.status}" role="gridcell" aria-label="${day.status} on day ${day.day}">${day.day}</div>
      `).join('');
    }
    renderCalendar('searchCalendar');

    // Map Simulation
    function drawMap(canvasId) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#e2e8f0';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.fillStyle = '#10b981';
      ctx.beginPath();
      ctx.arc(canvas.width / 2, canvas.height / 2, 20, 0, Math.PI * 2);
      ctx.fill();
      ctx.fillStyle = '#3b82f6';
      ctx.fillRect(canvas.width / 2 - 10, canvas.height / 2 - 40, 20, 20);
    }
    drawMap('searchMap');
    drawMap('apartmentMap');

    // Apartment Details
    function renderApartmentDetails() {
      const id = parseInt(localStorage.getItem('selectedApartmentId'));
      const apartment = apartments.find(a => a.id === id);
      if (!apartment) return;

      document.getElementById('apartment-title').textContent = apartment.title;
      document.getElementById('apartment-price').textContent = `$${apartment.price}/month`;
      document.getElementById('apartment-location').textContent = apartment.location;
      document.getElementById('apartment-amenities').textContent = apartment.amenities.join(', ');
      
      const reviewsContainer = document.getElementById('apartment-reviews');
      reviewsContainer.innerHTML = apartment.reviews.map(review => `
        <blockquote>
          <p>"${review.comment}"</p>
          <footer>- ${review.user} <span class="material-icons report-icon" tabindex="0" onclick="reportReview()" title="Report Review">report</span></footer>
        </blockquote>
      `).join('');
    }

    // Booking Form
    const bookingForm = document.querySelector('.booking-form');
    bookingForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const checkin = document.getElementById('book-checkin').value;
      const checkout = document.getElementById('book-checkout').value;
      const guests = document.getElementById('guests').value;
      const insurance = document.getElementById('insurance').checked;
      const id = parseInt(localStorage.getItem('selectedApartmentId'));
      const apartment = apartments.find(a => a.id === id);

      if (!checkin || !checkout) {
        alert('Please select check-in and check-out dates.');
        return;
      }

      const days = Math.ceil((new Date(checkout) - new Date(checkin)) / (1000 * 60 * 60 * 24));
      if (days <= 0) {
        alert('Check-out date must be after check-in date.');
        return;
      }

      const baseCost = apartment.price * days;
      const serviceFee = baseCost * 0.05;
      const insuranceFee = insurance ? baseCost * 0.1 : 0;
      const total = baseCost + serviceFee + insuranceFee;

      document.getElementById('base-cost').textContent = `$${baseCost.toLocaleString()}`;
      document.getElementById('service-cost').textContent = `$${serviceFee.toLocaleString()}`;
      document.getElementById('insurance-cost').textContent = `$${insuranceFee.toLocaleString()}`;
      document.getElementById('total-cost').textContent = `$${total.toLocaleString()}`;
      document.getElementById('cost-breakdown').classList.remove('hidden');

      alert(`Booking confirmed for ${guests} guest(s)! Check your email for details.`);
    });

    // Payment Method Selection
    document.querySelectorAll('.payment-method').forEach(method => {
      method.addEventListener('click', () => {
        document.querySelectorAll('.payment-method').forEach(m => {
          m.classList.remove('selected');
          m.setAttribute('aria-checked', 'false');
        });
        method.classList.add('selected');
        method.setAttribute('aria-checked', 'true');
      });
      method.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          method.click();
        }
      });
    });

    // Chat System
    function sendMessage() {
      const chatInput = document.getElementById('chatInput');
      const chatWindow = document.getElementById('chatWindow');
      if (chatInput.value.trim()) {
        chatWindow.innerHTML += `
          <div class="chat-message sent">${chatInput.value}</div>
        `;
        chatInput.value = '';
        chatWindow.scrollTop = chatWindow.scrollHeight;
        setTimeout(() => {
          chatWindow.innerHTML += `
            <div class="chat-message received">Thank you for your message! We'll respond shortly.</div>
          `;
          chatWindow.scrollTop = chatWindow.scrollHeight;
        }, 1000);
      }
    }

    // Support Chat
    function sendSupportMessage() {
      const chatInput = document.getElementById('supportChatInput');
      const chatBody = document.getElementById('chatBody');
      if (chatInput.value.trim()) {
        chatBody.innerHTML += `
          <div class="chat-message user"><span>${chatInput.value}</span></div>
        `;
        chatInput.value = '';
        chatBody.scrollTop = chatBody.scrollHeight;
        setTimeout(() => {
          chatBody.innerHTML += `
            <div class="chat-message system"><span>Our team will assist you shortly.</span></div>
          `;
          chatBody.scrollTop = chatBody.scrollHeight;
        }, 1000);
      }
    }

    document.getElementById('supportChatInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        sendSupportMessage();
      }
    });

    // Report Review
    function reportReview() {
      alert('Review reported. Our team will review it shortly.');
    }

    // Open Chat
    function openChat() {
      const chatbox = document.getElementById('chatbox');
      chatbox.style.display = 'flex';
      document.getElementById('supportChatInput').focus();
    }

    document.getElementById('messageBtn').addEventListener('click', () => {
      const chatbox = document.getElementById('chatbox');
      chatbox.style.display = chatbox.style.display === 'flex' ? 'none' : 'flex';
    });
  </script>
</body>
</html>