<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LuxuryStay - Dashboard dan Manajemen Apartemen Premium.">
    <meta name="theme-color" content="#2563eb">
    <title>LuxuryStay | Dashboard Aplikasi</title>

    <!-- Ikon Online Gratis: Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Favicon PNG (memenuhi syarat tidak SVG) -->
    <link rel="icon"
        href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPhJREFUOE9jZKAQMFKon2FcgAlqZmHKAFNTU4MCzc3NHEgKCwvjCcnJyQ1ACyA2AAlASUAyDAwMMgAFDAwMpoAKGJgYRICyMDAwAEqBAkzAxMAgCTGBeBiYGBLIxMDAAOgCArAAyQMoAQLIShAUSBgoPGiAxLCRgg+I/pOAAVT///8zMHy8/39DTAwQkM2AAWiAAZiVlRVAiYGBgeHs5OSYgYGBgUGIiYnRxcCAgIAzgcXExNjAIsL078//DAwMEAASXEyRLHCIZGH4M0yAU5GRcQxDEyMjdTMyMhxyZ2c39ZmZmbGNz8/f4Ts7OxF7ABmJsYFRSdHCAAAAAElFTkSuQmCC">

    <style>
        /* Layer 0: Reset dan Variabel CSS Global */
        :root {
            /* Skema Warna Utama */
            --color-primary: #2563eb;
            /* Biru modern */
            --color-primary-hover: #1d4ed8;
            /* Biru lebih gelap */
            --color-secondary: #4ade80;
            /* Hijau aksen */
            --color-secondary-hover: #22c55e;
            --color-background: #f3f4f6;
            /* Latar belakang abu-abu muda (Tailwind gray-100) */
            --color-surface: #ffffff;
            /* Permukaan card, modal */
            --color-text: #1f2937;
            /* Teks utama (Tailwind gray-800) */
            --color-text-muted: #6b7280;
            /* Teks sekunder (Tailwind gray-500) */
            --color-text-on-dark: #e5e7eb;
            /* Teks terang di atas latar gelap (misal sidebar) */
            --color-border: #e5e7eb;
            /* Border halus (Tailwind gray-200) */
            --color-sidebar-bg: #111827;
            /* Latar sidebar gelap (Tailwind gray-900) */
            --color-sidebar-link-hover-bg: rgba(255, 255, 255, 0.05);
            --color-overlay: rgba(17, 24, 39, 0.85);
            /* Overlay (Tailwind gray-900 dengan alpha) */
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-warning: #f59e0b;
            --color-info: #3b82f6;

            /* Tipografi */
            --font-family-base: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            --font-family-heading: 'Poppins', var(--font-family-base);
            --font-size-base: 1rem;
            /* 16px */
            --font-size-xs: 0.75rem;
            /* 12px */
            --font-size-sm: 0.875rem;
            /* 14px */
            --font-size-lg: 1.125rem;
            /* 18px */
            --font-size-xl: 1.25rem;
            /* 20px */
            --font-size-xxl: 1.5rem;
            /* 24px */
            --font-size-xxxl: 2.25rem;
            /* 36px */
            --line-height-base: 1.6;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            --font-weight-bold: 700;

            /* Spasi dan Layout */
            --spacing-base: 1rem;
            /* 16px */
            --spacing-xs: calc(var(--spacing-base) * 0.25);
            /* 4px */
            --spacing-sm: calc(var(--spacing-base) * 0.5);
            /* 8px */
            --spacing-md: var(--spacing-base);
            /* 16px */
            --spacing-lg: calc(var(--spacing-base) * 1.5);
            /* 24px */
            --spacing-xl: calc(var(--spacing-base) * 2);
            /* 32px */
            --spacing-xxl: calc(var(--spacing-base) * 3);
            /* 48px */

            --container-max-width: 1280px;
            --header-height: 60px;
            --sidebar-width: 260px;
            --sidebar-width-collapsed: 80px;
            /* Untuk mode sidebar terlipat (future) */

            /* Border dan Shadow */
            --border-radius-sm: 0.25rem;
            /* 4px */
            --border-radius-md: 0.375rem;
            /* 6px */
            --border-radius-lg: 0.5rem;
            /* 8px */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);

            /* Transisi */
            --transition-base: all 0.2s ease-in-out;
            --transition-sidebar: transform 0.3s ease-in-out, width 0.3s ease-in-out;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            font-size: var(--font-size-base);
        }

        body {
            font-family: var(--font-family-base);
            line-height: var(--line-height-base);
            color: var(--color-text);
            background-color: var(--color-background);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
            /* Mencegah scroll horizontal karena sidebar */
        }

        /* Layer 1: Gaya Dasar HTML Elemen */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: var(--font-family-heading);
            font-weight: var(--font-weight-semibold);
            line-height: 1.3;
            margin-bottom: var(--spacing-sm);
            color: var(--color-text);
            /* Default color, can be overridden */
        }

        h1 {
            font-size: var(--font-size-xxxl);
        }

        h2 {
            font-size: var(--font-size-xxl);
        }

        h3 {
            font-size: var(--font-size-xl);
        }

        h4 {
            font-size: var(--font-size-lg);
        }

        p {
            margin-bottom: var(--spacing-md);
        }

        a {
            color: var(--color-primary);
            text-decoration: none;
            transition: var(--transition-base);
        }

        a:hover {
            color: var(--color-primary-hover);
            text-decoration: none;
        }

        img,
        video {
            max-width: 100%;
            height: auto;
            display: block;
        }

        ul,
        ol {
            list-style: none;
        }

        button,
        input,
        select,
        textarea {
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            color: inherit;
        }

        button {
            cursor: pointer;
            border: none;
            background-color: transparent;
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-md);
            transition: var(--transition-base);
        }

        /* Layer 2: Utilities (Kelas Pembantu) */
        .container {
            width: 100%;
            max-width: var(--container-max-width);
            margin-left: auto;
            margin-right: auto;
            padding-left: var(--spacing-lg);
            padding-right: var(--spacing-lg);
        }

        .text-center {
            text-align: center;
        }

        .text-muted {
            color: var(--color-text-muted);
        }

        .mb-0 {
            margin-bottom: 0 !important;
        }

        .mb-xs {
            margin-bottom: var(--spacing-xs) !important;
        }

        .mb-sm {
            margin-bottom: var(--spacing-sm) !important;
        }

        .mb-md {
            margin-bottom: var(--spacing-md) !important;
        }

        .mb-lg {
            margin-bottom: var(--spacing-lg) !important;
        }

        .mt-sm {
            margin-top: var(--spacing-sm) !important;
        }

        .mt-md {
            margin-top: var(--spacing-md) !important;
        }

        .mt-lg {
            margin-top: var(--spacing-lg) !important;
        }

        .py-sm {
            padding-top: var(--spacing-sm);
            padding-bottom: var(--spacing-sm);
        }

        .py-md {
            padding-top: var(--spacing-md);
            padding-bottom: var(--spacing-md);
        }

        .py-lg {
            padding-top: var(--spacing-lg);
            padding-bottom: var(--spacing-lg);
        }

        .py-xl {
            padding-top: var(--spacing-xl);
            padding-bottom: var(--spacing-xl);
        }

        .py-xxl {
            padding-top: var(--spacing-xxl);
            padding-bottom: var(--spacing-xxl);
        }

        .d-flex {
            display: flex;
        }

        .d-grid {
            display: grid;
        }

        .align-items-center {
            align-items: center;
        }

        .justify-content-between {
            justify-content: space-between;
        }

        .justify-content-center {
            justify-content: center;
        }

        .justify-content-end {
            justify-content: flex-end;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .flex-column {
            flex-direction: column;
        }

        .flex-grow-1 {
            flex-grow: 1;
        }

        .gap-xs {
            gap: var(--spacing-xs);
        }

        .gap-sm {
            gap: var(--spacing-sm);
        }

        .gap-md {
            gap: var(--spacing-md);
        }

        .gap-lg {
            gap: var(--spacing-lg);
        }

        .w-100 {
            width: 100%;
        }

        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            margin: -1px;
            padding: 0;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            border: 0;
        }

        /* Layer 3: Komponen UI */
        /* Tombol */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            font-weight: var(--font-weight-medium);
            text-align: center;
            vertical-align: middle;
            user-select: none;
            border: 1px solid transparent;
            padding: calc(var(--spacing-sm) + 2px) var(--spacing-md);
            font-size: var(--font-size-base);
            line-height: 1.5;
            border-radius: var(--border-radius-md);
        }

        .btn i {
            line-height: 1;
        }

        .btn-primary {
            color: var(--color-surface);
            background-color: var(--color-primary);
            border-color: var(--color-primary);
        }

        .btn-primary:hover {
            background-color: var(--color-primary-hover);
            border-color: var(--color-primary-hover);
            text-decoration: none;
        }

        .btn-secondary {
            color: var(--color-surface);
            background-color: var(--color-secondary);
            border-color: var(--color-secondary);
        }

        .btn-secondary:hover {
            background-color: var(--color-secondary-hover);
            border-color: var(--color-secondary-hover);
            text-decoration: none;
        }

        .btn-danger {
            color: var(--color-surface);
            background-color: var(--color-danger);
            border-color: var(--color-danger);
        }

        .btn-danger:hover {
            background-color: #d93333;
            border-color: #d93333;
            text-decoration: none;
        }

        .btn-outline-primary {
            color: var(--color-primary);
            background-color: transparent;
            border-color: var(--color-primary);
        }

        .btn-outline-primary:hover {
            color: var(--color-surface);
            background-color: var(--color-primary);
            text-decoration: none;
        }

        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-sm);
        }

        .btn-lg {
            padding: var(--spacing-md) var(--spacing-lg);
            font-size: var(--font-size-lg);
        }

        /* Card */
        .card {
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s ease, transform 0.2s ease;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-3px);
        }

        .card-header {
            padding: var(--spacing-md) var(--spacing-lg);
            border-bottom: 1px solid var(--color-border);
            background-color: #f9fafb;
        }

        .card-header h3,
        .card-header h4 {
            margin-bottom: 0;
            font-size: var(--font-size-lg);
        }

        .card-body {
            padding: var(--spacing-lg);
            flex-grow: 1;
        }

        .card-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            border-top: 1px solid var(--color-border);
            background-color: #f9fafb;
        }

        .card-title {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-semibold);
            margin-bottom: var(--spacing-sm);
        }

        .card-text {
            color: var(--color-text-muted);
            font-size: var(--font-size-base);
            margin-bottom: var(--spacing-md);
        }

        .card-img-top {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .card table {
            width: 100%;
            border-collapse: collapse;
            margin-top: var(--spacing-md);
        }

        .card th,
        .card td {
            text-align: left;
            padding: var(--spacing-sm);
            border-bottom: 1px solid var(--color-border);
        }

        .card th {
            background-color: #f9fafb;
            font-weight: var(--font-weight-semibold);
        }

        .card details summary {
            cursor: pointer;
            font-weight: var(--font-weight-medium);
            padding: var(--spacing-sm) 0;
            color: var(--color-primary);
        }

        .card details summary:hover {
            color: var(--color-primary-hover);
        }

        .card figure {
            margin: 0;
        }

        .card figcaption {
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
            background-color: #f9fafb;
            border-top: 1px solid var(--color-border);
        }

        /* Form */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-group label {
            display: block;
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--spacing-xs);
        }

        .form-control {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-base);
            line-height: var(--line-height-base);
            color: var(--color-text);
            background-color: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius-md);
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-control:focus {
            border-color: var(--color-primary);
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }


        /* Layer 4: Struktur Layout Aplikasi (Shell) */
        .app-shell {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .app-sidebar {
            width: var(--sidebar-width);
            background-color: var(--color-sidebar-bg);
            color: var(--color-text-on-dark);
            padding: var(--spacing-lg) 0;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            overflow-y: auto;
            z-index: 1100;
            transition: var(--transition-sidebar);
            display: flex;
            flex-direction: column;
        }

        .sidebar-logo-area {
            padding: 0 var(--spacing-lg) var(--spacing-lg) var(--spacing-lg);
            text-align: center;
            margin-bottom: var(--spacing-md);
        }

        .sidebar-logo {
            font-family: var(--font-family-heading);
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            text-decoration: none;
        }

        .sidebar-logo i {
            margin-right: var(--spacing-sm);
        }

        .sidebar-logo:hover {
            color: var(--color-primary-hover);
        }

        .sidebar-profile {
            padding: 0 var(--spacing-lg) var(--spacing-lg) var(--spacing-lg);
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: var(--spacing-md);
        }

        .sidebar-profile-img {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto var(--spacing-sm) auto;
            border: 2px solid var(--color-primary);
        }

        .sidebar-profile-name {
            font-weight: var(--font-weight-semibold);
            font-size: var(--font-size-base);
            margin-bottom: var(--spacing-xs);
            color: var(--color-surface);
        }

        .sidebar-profile-role {
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
        }

        .sidebar-nav {
            flex-grow: 1;
        }

        .sidebar-nav-menu {
            padding: 0;
            margin: 0;
        }

        .sidebar-nav-link {
            display: flex;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            color: #d1d5db;
            /* gray-300 */
            font-weight: var(--font-weight-medium);
            font-size: var(--font-size-sm);
            transition: background-color 0.2s ease, color 0.2s ease;
            text-decoration: none;
            gap: var(--spacing-md);
        }

        .sidebar-nav-link:hover {
            background-color: var(--color-sidebar-link-hover-bg);
            color: var(--color-surface);
            text-decoration: none;
        }

        .sidebar-nav-link.active {
            background-color: var(--color-primary);
            color: var(--color-surface);
            font-weight: var(--font-weight-semibold);
            border-left: 4px solid var(--color-secondary);
            padding-left: calc(var(--spacing-lg) - 4px);
        }

        .sidebar-nav-link .nav-icon {
            width: 20px;
            text-align: center;
            font-size: var(--font-size-lg);
        }

        /* App Main Wrapper (Header Atas + Konten + Footer) */
        .app-main-wrapper {
            flex-grow: 1;
            padding-left: var(--sidebar-width);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            transition: padding-left 0.3s ease-in-out;
        }

        /* State untuk sidebar tersembunyi (mobile) */
        body.sidebar-hidden .app-main-wrapper {
            padding-left: 0;
        }

        body.sidebar-hidden .app-sidebar {
            transform: translateX(-100%);
        }

        /* Header Atas (Navigasi utama horizontal jika diperlukan, atau kontrol) */
        .app-header {
            height: var(--header-height);
            background-color: var(--color-surface);
            padding: 0 var(--spacing-lg);
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .sidebar-toggle,
        .nav-toggle {
            /* nav-toggle untuk header atas (lama) */
            font-size: var(--font-size-xl);
            color: var(--color-text);
            background: none;
            border: none;
            cursor: pointer;
            padding: var(--spacing-sm);
        }

        .sidebar-toggle {
            display: none;
            /* Default tersembunyi, muncul di mobile */
        }

        .header-page-title {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
        }

        /* Navigasi Header Atas (dari kode lama, jika masih dipakai) */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        .nav-brand {
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            font-size: var(--font-size-xl);
            text-decoration: none;
        }

        .nav-brand:hover {
            color: var(--color-primary-hover);
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
        }

        .nav-link {
            color: var(--color-text);
            font-weight: var(--font-weight-medium);
            padding: var(--spacing-sm) var(--spacing-md);
            border-radius: var(--border-radius-sm);
            text-decoration: none;
            position: relative;
        }

        .nav-link:hover,
        .nav-link.active-header {
            color: var(--color-primary);
            background-color: rgba(37, 99, 235, 0.1);
            text-decoration: none;
        }

        .nav-link.active-header::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: var(--spacing-md);
            right: var(--spacing-md);
            height: 2px;
            background-color: var(--color-primary);
        }


        /* Main Content Area */
        .main-content {
            padding: var(--spacing-lg);
            flex-grow: 1;
        }

        /* Footer Aplikasi */
        .app-footer {
            background-color: var(--color-surface);
            color: var(--color-text-muted);
            padding: var(--spacing-md) var(--spacing-lg);
            text-align: center;
            font-size: var(--font-size-sm);
            border-top: 1px solid var(--color-border);
        }

        .app-footer a {
            color: var(--color-primary);
        }

        .app-footer a:hover {
            color: var(--color-primary-hover);
        }

        /* Layer 5: Gaya Spesifik Halaman */
        /* Header Konten Halaman */
        .page-content-header {
            margin-bottom: var(--spacing-lg);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .page-content-title {
            font-size: var(--font-size-xxxl);
            color: var(--color-text);
            margin-bottom: var(--spacing-xs);
        }

        .page-content-subtitle {
            font-size: var(--font-size-lg);
            color: var(--color-text-muted);
            margin-bottom: 0;
        }

        /* Dashboard: Statistik Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: var(--spacing-lg);
        }

        .stat-card {
            padding: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-lg);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-card-icon {
            font-size: 2.5rem;
            padding: var(--spacing-md);
            border-radius: 50%;
            color: var(--color-surface);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
        }

        .stat-card-info .value {
            font-size: var(--font-size-xxl);
            font-weight: var(--font-weight-bold);
            color: var(--color-text);
            line-height: 1.2;
        }

        .stat-card-info .label {
            font-size: var(--font-size-base);
            color: var(--color-text-muted);
        }

        .stat-card.booking-active .stat-card-icon {
            background-color: var(--color-primary);
        }

        .stat-card.payment-pending .stat-card-icon {
            background-color: var(--color-warning);
        }

        .stat-card.maintenance-request .stat-card-icon {
            background-color: var(--color-danger);
        }

        .stat-card.property-saved .stat-card-icon {
            background-color: var(--color-secondary);
        }

        /* Dashboard: Apartemen Listing Card */
        .apartments-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }

        .apartment-card .card-img-top {
            height: 220px;
            transition: transform 0.3s ease;
        }

        .apartment-card:hover .card-img-top {
            transform: scale(1.05);
        }

        .apartment-card .card-body {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .apartment-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: var(--font-size-sm);
            color: var(--color-text-muted);
            margin-bottom: var(--spacing-sm);
            flex-wrap: wrap;
        }

        .apartment-details span {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-xs);
            margin-right: var(--spacing-sm);
            margin-bottom: var(--spacing-xs);
        }

        .apartment-price {
            font-size: var(--font-size-lg);
            font-weight: var(--font-weight-bold);
            color: var(--color-primary);
            margin-bottom: var(--spacing-md);
        }

        .apartment-price .period {
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-normal);
            color: var(--color-text-muted);
        }

        /* Halaman Galeri (Gaya dari kode lama, disesuaikan) */
        .page-header-legacy {
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        /* Untuk bedakan dengan page-content-header */
        .page-title-legacy {
            font-size: var(--font-size-xxxl);
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
        }

        .page-description-legacy {
            font-size: var(--font-size-lg);
            color: var(--color-text-muted);
            max-width: 700px;
            margin: 0 auto var(--spacing-lg) auto;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing-lg);
        }

        .gallery-item {
            position: relative;
            border-radius: var(--border-radius-md);
            overflow: hidden;
            cursor: pointer;
            box-shadow: var(--shadow-md);
            transition: var(--transition-base);
            background-color: var(--color-surface);
        }

        .gallery-item:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .gallery-item:focus-visible {
            outline: 2px solid var(--color-primary);
            outline-offset: 2px;
        }

        .gallery-img {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
            transition: transform 0.4s ease;
        }

        .gallery-item:hover .gallery-img {
            transform: scale(1.1);
        }

        .gallery-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: var(--spacing-md);
            background: linear-gradient(0deg, rgba(0, 0, 0, 0.8) 0%, rgba(0, 0, 0, 0.6) 50%, transparent 100%);
            color: white;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .gallery-item:hover .gallery-caption,
        .gallery-item:focus-visible .gallery-caption {
            opacity: 1;
            transform: translateY(0);
        }

        .gallery-caption h3 {
            font-size: var(--font-size-lg);
            margin-bottom: var(--spacing-xs);
            color: white;
            font-weight: var(--font-weight-semibold);
        }

        .gallery-caption p {
            font-size: var(--font-size-sm);
            margin-bottom: 0;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Lightbox (dari kode lama) */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--color-overlay);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: var(--spacing-md);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .lightbox.active {
            display: flex;
            opacity: 1;
        }

        .lightbox-content {
            position: relative;
            max-width: 90vw;
            max-height: 90vh;
            background-color: var(--color-surface);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
        }

        .lightbox.active .lightbox-content {
            transform: scale(1);
        }

        .lightbox-img {
            display: block;
            max-width: 100%;
            max-height: calc(90vh - 40px);
            object-fit: contain;
        }

        .lightbox-close {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            font-size: var(--font-size-xl);
            color: var(--color-text-muted);
            background: none;
            border: none;
            padding: var(--spacing-xs);
            line-height: 1;
            z-index: 2010;
            cursor: pointer;
        }

        .lightbox-close:hover {
            color: var(--color-danger);
        }

        /* Admin Card Grid (dari kode lama, untuk halaman /admin) */
        .admin-card-grid,
        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--spacing-lg);
        }

        .admin-card .card-body,
        .recommendation-card .card-body {
            padding: var(--spacing-md);
        }

        .admin-card figure img {
            width: 100%;
            height: auto;
            object-fit: contain;
            border-bottom: 1px solid var(--color-border);
        }


        /* Layer 6: Responsif Desain */
        @media (max-width: 992px) {

            /* Tablet dan di bawahnya */
            .app-sidebar {
                transform: translateX(-100%);
                /* Sembunyikan sidebar */
                box-shadow: var(--shadow-lg);
            }

            .app-sidebar.open {
                transform: translateX(0);
            }

            .app-main-wrapper {
                padding-left: 0;
                /* Konten mengisi penuh */
            }

            .sidebar-toggle {
                display: block;
                /* Tampilkan tombol hamburger untuk sidebar */
            }

            .nav-menu {
                /* Menu header atas lama */
                display: none;
                position: absolute;
                top: var(--header-height);
                left: 0;
                right: 0;
                background-color: var(--color-surface);
                flex-direction: column;
                align-items: stretch;
                padding: var(--spacing-md);
                box-shadow: var(--shadow-md);
                border-top: 1px solid var(--color-border);
                z-index: 999;
            }

            .nav-menu.active {
                display: flex;
            }

            /* Untuk menu header atas lama jika di-toggle */
            .nav-link {
                padding: var(--spacing-md);
                text-align: left;
                width: 100%;
            }

            .nav-link.active-header::after {
                bottom: auto;
                top: 50%;
                transform: translateY(-50%);
                left: var(--spacing-sm);
                right: auto;
                height: 70%;
                width: 3px;
            }

            .nav-toggle {
                display: block;
            }

            /* Untuk menu header atas lama */

            .stats-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }

            .apartments-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            .page-content-title {
                font-size: var(--font-size-xxl);
            }

            .page-content-subtitle {
                font-size: var(--font-size-base);
            }
        }

        @media (max-width: 768px) {

            /* Mobile besar */
            :root {
                --font-size-base: 0.9375rem;
                /* 15px */
                --header-height: 56px;
            }

            .container,
            .main-content {
                padding-left: var(--spacing-md);
                padding-right: var(--spacing-md);
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .apartments-grid {
                grid-template-columns: 1fr;
            }

            .gallery-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: var(--spacing-md);
            }

            .admin-card-grid,
            .recommendation-grid {
                grid-template-columns: 1fr;
            }

            .page-title-legacy {
                font-size: var(--font-size-xxl);
            }

            .page-description-legacy {
                font-size: var(--font-size-base);
            }
        }

        @media (max-width: 480px) {

            /* Mobile kecil */
            .gallery-grid {
                grid-template-columns: 1fr;
            }

            .gallery-item:hover .gallery-img,
            .gallery-item:hover {
                transform: none;
            }

            .apartment-card .card-img-top {
                height: 180px;
            }

            .apartment-details span {
                margin-right: var(--spacing-xs);
                font-size: var(--font-size-xs);
            }

            .apartment-price {
                font-size: var(--font-size-lg);
            }

            .page-content-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>

<body>
    <div class="app-shell">
        <!-- Sidebar Aplikasi -->
        <aside class="app-sidebar" id="app-sidebar" role="complementary" aria-label="Navigasi Utama Aplikasi">
            <div class="sidebar-logo-area">
                <a href="/dashboard" class="sidebar-logo spa-link" aria-label="Beranda Dashboard LuxuryStay">
                    <i class="fas fa-building"></i> LuxuryStay
                </a>
            </div>
            <div class="sidebar-profile">
                <img src="https://i.pravatar.cc/150?u=admin-luxurystay" alt="Foto profil pengguna"
                    class="sidebar-profile-img">
                <p class="sidebar-profile-name">Admin LuxuryStay</p>
                <p class="sidebar-profile-role">Administrator</p>
            </div>
            <nav class="sidebar-nav" aria-label="Menu Sidebar">
                <ul class="sidebar-nav-menu" role="menu">
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/dashboard" role="menuitem"><i
                                class="fas fa-tachometer-alt nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Dashboard</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/profile" role="menuitem"><i
                                class="fas fa-user-circle nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Profil</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/apartments" role="menuitem"><i
                                class="fas fa-city nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Apartemen</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/bookings" role="menuitem"><i
                                class="fas fa-calendar-check nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Booking</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/favorites" role="menuitem"><i
                                class="fas fa-heart nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Favorit</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/payments" role="menuitem"><i
                                class="fas fa-credit-card nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Pembayaran</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/maintenance" role="menuitem"><i
                                class="fas fa-tools nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Maintenance</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/messages" role="menuitem"><i
                                class="fas fa-envelope nav-icon" aria-hidden="true"></i> <span
                                class="nav-text">Pesan</span></a></li>
                    <hr style="border-color: rgba(255,255,255,0.1); margin: var(--spacing-md) var(--spacing-lg);">
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/" role="menuitem"><i
                                class="fas fa-home nav-icon" aria-hidden="true"></i> <span class="nav-text">Beranda
                                Publik</span></a></li>
                    <li role="none"><a class="sidebar-nav-link spa-link" href="/gallery" role="menuitem"><i
                                class="fas fa-images nav-icon" aria-hidden="true"></i> <span class="nav-text">Galeri
                                Publik</span></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Wrapper Konten Utama -->
        <div class="app-main-wrapper">
            <!-- Header Atas Aplikasi -->
            <header class="app-header" role="banner">
                <button class="sidebar-toggle" id="sidebar-toggle-btn" aria-controls="app-sidebar" aria-expanded="false"
                    aria-label="Toggle navigasi sidebar">
                    <i class="fas fa-bars" aria-hidden="true"></i>
                </button>
                <div id="header-page-title-container" class="header-page-title">Selamat Datang</div>

                <!-- Navigasi header atas (opsional, jika perlu selain sidebar) -->
                <nav class="navbar" aria-label="Navigasi Tambahan">
                    <a href="/" class="nav-brand visually-hidden" aria-label="Beranda LuxuryStay">LuxuryStay</a>
                    <button class="nav-toggle visually-hidden" id="nav-toggle-main-header"
                        aria-controls="nav-menu-main-header" aria-expanded="false" aria-label="Toggle navigasi utama">
                        <i class="fas fa-ellipsis-v" aria-hidden="true"></i>
                    </button>
                    <ul class="nav-menu" id="nav-menu-main-header" role="menubar">
                        <!-- Item menu header atas bisa ditambahkan di sini jika perlu -->
                        <!-- Contoh:
                        <li role="none"><a class="nav-link spa-link" href="/settings" role="menuitem">Pengaturan</a></li>
                        <li role="none"><a class="nav-link" href="#" id="logout-button" role="menuitem">Keluar</a></li>
                         -->
                    </ul>
                </nav>
            </header>

            <!-- Konten Utama (dimuat oleh JS) -->
            <main id="app-content" class="main-content" role="main" aria-live="polite">
                <!-- Konten halaman akan dimuat di sini -->
            </main>

            <!-- Footer Aplikasi -->
            <footer class="app-footer" role="contentinfo">
                <div class="container">
                    <p>Â© <span id="current-year"></span> LuxuryStay. Semua hak dilindungi.</p>
                    <p>Didesain dengan <i class="fas fa-heart" style="color: var(--color-danger);"
                            aria-hidden="true"></i> oleh Tim Kreatif Kami</p>
                </div>
            </footer>
        </div>
    </div>

    <!-- Lightbox Structure (global) -->
    <div class="lightbox" id="app-lightbox" aria-hidden="true" role="dialog" aria-modal="true"
        aria-labelledby="lightbox-title-desc">
        <div class="lightbox-content">
            <button class="lightbox-close" aria-label="Tutup pratinjau gambar">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
            <img src="" class="lightbox-img" alt="Pratinjau gambar diperbesar" id="lightbox-image">
            <p id="lightbox-title-desc" class="visually-hidden">Pratinjau Gambar Diperbesar</p>
        </div>
    </div>

    <script>
        // Layer 0: Utilitas Umum dan Konfigurasi Aplikasi
        const AppConfig = {
            appName: "LuxuryStay",
            defaultTitle: "Dashboard Aplikasi",
            user: {
                name: "Admin LuxuryStay",
                role: "Administrator",
                avatar: "https://i.pravatar.cc/150?u=admin-luxurystay"
            },
            // Data dummy untuk statistik dashboard
            dashboardStats: [
                { id: 'booking-active', label: 'Booking Aktif', value: 12, icon: 'fa-calendar-check', unit: '', color: 'var(--color-primary)' },
                { id: 'payment-pending', label: 'Pembayaran Tertunda', value: 3, icon: 'fa-file-invoice-dollar', unit: '', color: 'var(--color-warning)' },
                { id: 'maintenance-request', label: 'Permintaan Maintenance', value: 5, icon: 'fa-tools', unit: '', color: 'var(--color-danger)' },
                { id: 'property-saved', label: 'Properti Disimpan', value: 8, icon: 'fa-heart', unit: '', color: 'var(--color-secondary)' }
            ],
            // Data dummy untuk listing apartemen
            apartmentsData: [
                { id: 1, name: "Skyline Suite Type A", image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", beds: 2, baths: 2, area: 120, price: 25000000, period: "bulan", location: "Pusat Kota Jakarta" },
                { id: 2, name: "Ocean View Residence", image: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", beds: 3, baths: 2.5, area: 150, price: 35000000, period: "bulan", location: "Pantai Indah Kapuk" },
                { id: 3, name: "Garden Terrace Apartment", image: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", beds: 1, baths: 1, area: 80, price: 15000000, period: "bulan", location: "Kebayoran Baru" },
                { id: 4, name: "Modern Loft Central Park", image: "https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", beds: 2, baths: 1.5, area: 100, price: 20000000, period: "bulan", location: "Jakarta Barat" }
            ],
            // Data untuk halaman galeri lama
            galleryDataLegacy: [
                { src: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=600', alt: 'Apartemen modern dengan interior cerah', title: 'Suite Keluarga Luas', desc: 'Pemandangan kota dari balkon pribadi.' },
                { src: 'https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=600', alt: 'Dapur mewah dengan peralatan stainless steel', title: 'Dapur Gourmet', desc: 'Dilengkapi peralatan modern.' },
                { src: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=600', alt: 'Ruang tamu elegan dengan sofa nyaman', title: 'Ruang Tamu Elegan', desc: 'Desain kontemporer dan nyaman.' },
                { src: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=600', alt: 'Eksterior gedung apartemen modern', title: 'Fasad Menawan', desc: 'Arsitektur modern dan ikonik.' },
            ]
        };

        const Utils = {
            sanitizeHTML: (str) => {
                const temp = document.createElement('div');
                temp.textContent = str;
                return temp.innerHTML;
            },
            createElement: (tag, attributes = {}, children = []) => {
                const element = document.createElement(tag);
                for (const key in attributes) {
                    if (key === 'style' && typeof attributes[key] === 'object') {
                        for (const styleProp in attributes[key]) {
                            element.style[styleProp] = attributes[key][styleProp];
                        }
                    } else {
                        element.setAttribute(key, attributes[key]);
                    }
                }
                children.forEach(child => {
                    if (typeof child === 'string') {
                        element.appendChild(document.createTextNode(child));
                    } else if (child) { // Pastikan child tidak null atau undefined
                        element.appendChild(child);
                    }
                });
                return element;
            },
            formatCurrency: (amount, currency = 'IDR') => {
                return new Intl.NumberFormat('id-ID', { style: 'currency', currency: currency, minimumFractionDigits: 0 }).format(amount);
            }
        };

        // Layer 1: Manajer UI (Sidebar, Lightbox, Navigasi Header Atas)
        class UIManager {
            constructor() {
                // Sidebar
                this.sidebar = document.getElementById('app-sidebar');
                this.sidebarToggleBtn = document.getElementById('sidebar-toggle-btn');
                this.sidebarOpen = false;

                // Lightbox
                this.lightbox = document.getElementById('app-lightbox');
                this.lightboxImg = document.getElementById('lightbox-image');
                this.lightboxCloseBtn = this.lightbox.querySelector('.lightbox-close');

                // Navigasi Header Atas (jika ada)
                this.navToggleMainHeader = document.getElementById('nav-toggle-main-header'); // Untuk menu header atas (lama)
                this.navMenuMainHeader = document.getElementById('nav-menu-main-header');     // Untuk menu header atas (lama)
                this.isNavMenuMainHeaderOpen = false;

                this.init();
            }

            init() {
                // Sidebar events
                if (this.sidebarToggleBtn && this.sidebar) {
                    this.sidebarToggleBtn.addEventListener('click', () => this.toggleSidebar());
                }
                // Close sidebar if clicking outside on mobile overlay (optional)
                document.addEventListener('click', (event) => {
                    if (window.innerWidth < 992 && this.sidebarOpen && !this.sidebar.contains(event.target) && !this.sidebarToggleBtn.contains(event.target)) {
                        this.closeSidebar();
                    }
                });


                // Lightbox events
                if (this.lightbox && this.lightboxCloseBtn && this.lightboxImg) {
                    this.lightboxCloseBtn.addEventListener('click', () => this.closeLightbox());
                    this.lightbox.addEventListener('click', (e) => {
                        if (e.target === this.lightbox) this.closeLightbox();
                    });
                }
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && this.lightbox && this.lightbox.classList.contains('active')) {
                        this.closeLightbox();
                    }
                });

                // Navigasi Header Atas (lama)
                if (this.navToggleMainHeader && this.navMenuMainHeader) {
                    this.navToggleMainHeader.addEventListener('click', () => this.toggleNavMenuMainHeader());
                }
            }

            // Sidebar methods
            toggleSidebar() {
                this.sidebarOpen = !this.sidebarOpen;
                this.sidebar.classList.toggle('open', this.sidebarOpen);
                document.body.classList.toggle('sidebar-hidden', !this.sidebarOpen);
                this.sidebarToggleBtn.setAttribute('aria-expanded', this.sidebarOpen.toString());
                const icon = this.sidebarToggleBtn.querySelector('i');
                icon.classList.toggle('fa-bars', !this.sidebarOpen);
                icon.classList.toggle('fa-times', this.sidebarOpen);
            }
            openSidebar() {
                if (!this.sidebarOpen) this.toggleSidebar();
            }
            closeSidebar() {
                if (this.sidebarOpen) this.toggleSidebar();
            }
            updateActiveSidebarLink(path) {
                if (!this.sidebar) return;
                const links = this.sidebar.querySelectorAll('.sidebar-nav-link');
                links.forEach(link => {
                    const linkPath = new URL(link.href).pathname;
                    if (linkPath === path || (path.startsWith(linkPath) && linkPath !== '/')) {
                        link.classList.add('active');
                        link.setAttribute('aria-current', 'page');
                    } else {
                        link.classList.remove('active');
                        link.removeAttribute('aria-current');
                    }
                });
            }

            // Lightbox methods
            openLightbox(src, alt) {
                if (!this.lightbox || !this.lightboxImg) return;
                this.lightboxImg.src = src;
                this.lightboxImg.alt = alt || "Gambar diperbesar";
                this.lightbox.classList.add('active');
                this.lightbox.setAttribute('aria-hidden', 'false');
                document.body.style.overflow = 'hidden';
                this.lightboxCloseBtn.focus();
            }
            closeLightbox() {
                if (!this.lightbox || !this.lightboxImg) return;
                this.lightbox.classList.remove('active');
                this.lightbox.setAttribute('aria-hidden', 'true');
                document.body.style.overflow = '';
                this.lightboxImg.src = "";
                this.lightboxImg.alt = "";
            }

            // Navigasi Header Atas (lama)
            toggleNavMenuMainHeader() {
                this.isNavMenuMainHeaderOpen = !this.isNavMenuMainHeaderOpen;
                this.navMenuMainHeader.classList.toggle('active', this.isNavMenuMainHeaderOpen);
                this.navToggleMainHeader.setAttribute('aria-expanded', this.isNavMenuMainHeaderOpen.toString());
                const icon = this.navToggleMainHeader.querySelector('i');
                icon.classList.toggle('fa-ellipsis-v', !this.isNavMenuMainHeaderOpen);
                icon.classList.toggle('fa-times', this.isNavMenuMainHeaderOpen);
            }
            closeNavMenuMainHeader() {
                if (this.isNavMenuMainHeaderOpen) {
                    this.isNavMenuMainHeaderOpen = false;
                    this.navMenuMainHeader.classList.remove('active');
                    this.navToggleMainHeader.setAttribute('aria-expanded', 'false');
                    const icon = this.navToggleMainHeader.querySelector('i');
                    icon.classList.remove('fa-times');
                    icon.classList.add('fa-ellipsis-v');
                }
            }
            updateActiveHeaderLink(path) { // Untuk header navigasi atas (lama)
                if (!this.navMenuMainHeader) return;
                const links = this.navMenuMainHeader.querySelectorAll('.nav-link');
                links.forEach(link => {
                    const linkPath = new URL(link.href).pathname;
                    if (linkPath === path) {
                        link.classList.add('active-header');
                        link.setAttribute('aria-current', 'page');
                    } else {
                        link.classList.remove('active-header');
                        link.removeAttribute('aria-current');
                    }
                });
            }
        }

        // Layer 2: Renderer Konten Halaman
        class PageRenderer {
            constructor(contentAreaId, headerTitleContainerId) {
                this.contentArea = document.getElementById(contentAreaId);
                this.headerTitleContainer = document.getElementById(headerTitleContainerId);
                if (!this.contentArea) throw new Error(`Area konten dengan ID '${contentAreaId}' tidak ditemukan.`);
                if (!this.headerTitleContainer) console.warn(`Kontainer judul header dengan ID '${headerTitleContainerId}' tidak ditemukan.`);
            }

            render(pageConfig) {
                this.contentArea.innerHTML = ''; // Bersihkan konten lama
                const pageElement = pageConfig.generator();
                this.contentArea.appendChild(pageElement);
                this.contentArea.setAttribute('data-page', pageConfig.id);
                document.title = `${AppConfig.appName} | ${pageConfig.title}`;
                if (this.headerTitleContainer) {
                    this.headerTitleContainer.textContent = pageConfig.title;
                }
                window.scrollTo(0, 0);

                // Inisialisasi spesifik halaman (misalnya, galeri)
                if (pageConfig.id === 'gallery' || pageConfig.id === 'gallery-legacy') { // 'gallery-legacy' untuk halaman galeri lama
                    const galleryGrid = this.contentArea.querySelector('.gallery-grid');
                    if (galleryGrid) {
                        galleryGrid.addEventListener('click', (e) => {
                            const galleryItem = e.target.closest('.gallery-item');
                            if (galleryItem) {
                                const img = galleryItem.querySelector('.gallery-img');
                                const captionTitle = galleryItem.querySelector('.gallery-caption h3');
                                let altText = "Pratinjau gambar: ";
                                if (captionTitle) altText += captionTitle.textContent;
                                else altText += img.alt || "Gambar";
                                window.uiManager.openLightbox(img.src, altText);
                            }
                        });
                    }
                }
            }

            // ----- Generator Halaman untuk Sidebar Aplikasi -----
            static createDashboardPage() {
                const pageWrapper = Utils.createElement('div');

                // Header Halaman
                const pageHeader = Utils.createElement('div', { class: 'page-content-header' }, [
                    Utils.createElement('div', {}, [
                        Utils.createElement('h1', { class: 'page-content-title mb-xs' }, ['Dashboard Utama']),
                        Utils.createElement('p', { class: 'page-content-subtitle text-muted' }, ['Ringkasan aktivitas dan statistik properti Anda.'])
                    ]),
                    Utils.createElement('div', {}, [
                        Utils.createElement('button', { class: 'btn btn-primary' }, [Utils.createElement('i', { class: 'fas fa-plus', 'aria-hidden': 'true' }), 'Tambah Properti Baru'])
                    ])
                ]);
                pageWrapper.appendChild(pageHeader);

                // Grid Statistik
                const statsGrid = Utils.createElement('div', { class: 'stats-grid mb-lg' });
                AppConfig.dashboardStats.forEach(stat => {
                    const statCard = Utils.createElement('div', { class: `card stat-card ${stat.id}` }, [
                        Utils.createElement('div', { class: 'stat-card-icon', style: { backgroundColor: stat.color } }, [Utils.createElement('i', { class: `fas ${stat.icon}`, 'aria-hidden': 'true' })]),
                        Utils.createElement('div', { class: 'stat-card-info' }, [
                            Utils.createElement('div', { class: 'value' }, [stat.value.toString(), Utils.createElement('span', { class: 'text-muted', style: { fontSize: 'var(--font-size-sm)', marginLeft: 'var(--spacing-xs)' } }, [stat.unit])]),
                            Utils.createElement('div', { class: 'label' }, [stat.label])
                        ])
                    ]);
                    statsGrid.appendChild(statCard);
                });
                pageWrapper.appendChild(statsGrid);

                // Daftar Apartemen Terbaru
                pageWrapper.appendChild(Utils.createElement('h2', { class: 'mb-md mt-lg' }, ['Apartemen Terbaru']));
                const apartmentsGrid = Utils.createElement('div', { class: 'apartments-grid' });
                AppConfig.apartmentsData.slice(0, 4).forEach(apt => { // Ambil 4 teratas
                    const apartmentCard = Utils.createElement('div', { class: 'card apartment-card' }, [
                        Utils.createElement('img', { src: apt.image, alt: `Foto ${apt.name}`, class: 'card-img-top', loading: 'lazy' }),
                        Utils.createElement('div', { class: 'card-body' }, [
                            Utils.createElement('h3', { class: 'card-title' }, [apt.name]),
                            Utils.createElement('p', { class: 'text-muted mb-sm', style: { fontSize: 'var(--font-size-sm)' } }, [Utils.createElement('i', { class: 'fas fa-map-marker-alt', style: { marginRight: 'var(--spacing-xs)' } }), apt.location]),
                            Utils.createElement('div', { class: 'apartment-details' }, [
                                Utils.createElement('span', {}, [Utils.createElement('i', { class: 'fas fa-bed', 'aria-hidden': 'true' }), `${apt.beds} KT`]),
                                Utils.createElement('span', {}, [Utils.createElement('i', { class: 'fas fa-bath', 'aria-hidden': 'true' }), `${apt.baths} KM`]),
                                Utils.createElement('span', {}, [Utils.createElement('i', { class: 'fas fa-ruler-combined', 'aria-hidden': 'true' }), `${apt.area} mÂ²`])
                            ]),
                            Utils.createElement('div', { class: 'apartment-price' }, [
                                Utils.formatCurrency(apt.price),
                                Utils.createElement('span', { class: 'period' }, [` / ${apt.period}`])
                            ]),
                            Utils.createElement('button', { class: 'btn btn-sm btn-outline-primary w-100 spa-link', 'data-path': `/apartments/${apt.id}` }, ['Lihat Detail'])
                        ])
                    ]);
                    apartmentsGrid.appendChild(apartmentCard);
                });
                pageWrapper.appendChild(apartmentsGrid);

                return pageWrapper;
            }

            static createGenericPage(title, contentText = "Konten untuk halaman ini sedang dalam pengembangan.") {
                return () => {
                    const pageWrapper = Utils.createElement('div');
                    const pageHeader = Utils.createElement('div', { class: 'page-content-header' }, [
                        Utils.createElement('div', {}, [
                            Utils.createElement('h1', { class: 'page-content-title mb-xs' }, [title]),
                            Utils.createElement('p', { class: 'page-content-subtitle text-muted' }, [`Kelola ${title.toLowerCase()} Anda di sini.`])
                        ])
                    ]);
                    pageWrapper.appendChild(pageHeader);
                    pageWrapper.appendChild(Utils.createElement('div', { class: 'card' }, [
                        Utils.createElement('div', { class: 'card-body' }, [
                            Utils.createElement('p', {}, [contentText])
                        ])
                    ]));
                    return pageWrapper;
                };
            }

            // ----- Generator Halaman dari Kode Lama (Publik/Galeri) -----
            static createHomePageLegacy() { // Halaman Beranda publik lama
                const element = Utils.createElement('div', { class: 'container py-xxl' });
                element.innerHTML = `
                    <div class="text-center">
                        <h1 class="page-title-legacy">Selamat Datang di LuxuryStay</h1>
                        <p class="page-description-legacy">Temukan apartemen premium impian Anda dengan fasilitas terbaik dan lokasi strategis. Kami menawarkan pengalaman tinggal yang tak terlupakan.</p>
                        <a href="/gallery" class="btn btn-primary btn-lg spa-link">Lihat Galeri Kami</a>
                        <a href="/contact" class="btn btn-secondary btn-lg spa-link" style="margin-left: var(--spacing-sm);">Hubungi Kami</a>
                    </div>
                    <div class="mt-lg py-xl" style="text-align: left;">
                        <h2>Mengapa Memilih Kami?</h2>
                        <ul style="list-style-type: disc; padding-left: var(--spacing-lg);">
                            <li class="mb-sm">Desain interior mewah dan modern.</li>
                            <li class="mb-sm">Fasilitas lengkap: kolam renang, gym, keamanan 24 jam.</li>
                            <li class="mb-sm">Lokasi prima di pusat kota.</li>
                            <li class="mb-sm">Pelayanan pelanggan yang responsif dan profesional.</li>
                        </ul>
                    </div>
                `;
                return element;
            }

            static createGalleryPageLegacy() { // Halaman Galeri publik lama
                const element = Utils.createElement('div', { class: 'container py-xl' });
                let galleryItemsHTML = '';
                AppConfig.galleryDataLegacy.forEach(item => {
                    galleryItemsHTML += `
                        <div class="gallery-item" tabindex="0" role="button" aria-label="Lihat gambar ${Utils.sanitizeHTML(item.title)} lebih detail">
                            <img src="${Utils.sanitizeHTML(item.src)}" class="gallery-img" alt="${Utils.sanitizeHTML(item.alt)}" loading="lazy">
                            <div class="gallery-caption">
                                <h3>${Utils.sanitizeHTML(item.title)}</h3>
                                <p>${Utils.sanitizeHTML(item.desc)}</p>
                            </div>
                        </div>
                    `;
                });
                element.innerHTML = `
                    <div class="page-header-legacy">
                        <h1 class="page-title-legacy">Galeri Apartemen Kami</h1>
                        <p class="page-description-legacy">Jelajahi koleksi foto apartemen premium kami. Setiap sudut dirancang untuk kenyamanan dan kemewahan Anda.</p>
                    </div>
                    <div class="gallery-grid">
                        ${galleryItemsHTML}
                    </div>
                `;
                return element;
            }

            static createAdminPageLegacy() { // Halaman Admin lama (contoh data tanaman)
                const element = Utils.createElement('div', { class: 'container py-xl' });
                const adminCardData = [
                    { imgSrc: "https://images.unsplash.com/photo-1521791136064-7986c2920216?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", imgAlt: "Grafik analisis data", caption: "Panel Kontrol Utama", plantList: ['Acacia', 'Convallaria', 'Angelica'] },
                    { imgSrc: "https://images.unsplash.com/photo-1556761175-5973dc0f32e7?ixlib=rb-4.0.3&q=80&fm=jpg&crop=entropy&cs=tinysrgb&w=400&fit=max", imgAlt: "Tim sedang berdiskusi", caption: "Manajemen Pengguna", plantList: ['Dahlia', 'Echinacea', 'Freesia'] },
                ];
                let cardsHTML = '';
                adminCardData.forEach(cardData => {
                    let tableRowsHTML = cardData.plantList.map(plant => `<tr><td><a href="#" class="list__link plant-link" data-plant-name="${Utils.sanitizeHTML(plant)}">${Utils.sanitizeHTML(plant)}</a></td></tr>`).join('');
                    cardsHTML += `
                        <div class="card admin-card">
                            <figure><img src="${Utils.sanitizeHTML(cardData.imgSrc)}" alt="${Utils.sanitizeHTML(cardData.imgAlt)}" loading="lazy"><figcaption>${Utils.sanitizeHTML(cardData.caption)}</figcaption></figure>
                            <div class="card-body"><details><summary>Detail Informasi Tanaman (Contoh)</summary><table><thead><tr><th><b>Nama Tanaman</b></th></tr></thead><tbody>${tableRowsHTML}</tbody></table></details></div>
                        </div>`;
                });
                element.innerHTML = `
                    <div class="page-header-legacy"><h1 class="page-title-legacy">Dashboard Admin (Legacy)</h1><p class="page-description-legacy">Area kontrol dan manajemen data aplikasi (Contoh Tanaman).</p></div>
                    <div class="admin-card-grid">${cardsHTML}</div>`;
                element.addEventListener('click', function (event) {
                    if (event.target.classList.contains('plant-link')) { event.preventDefault(); alert(`Informasi untuk tanaman "${event.target.dataset.plantName}" akan ditampilkan.`); }
                });
                return element;
            }

            static createRecommendationsPageLegacy() { // Halaman Rekomendasi lama
                const element = Utils.createElement('div', { class: 'container py-xl' });
                const recommendationData = [
                    { href: "#", imgSrc: "https://images.unsplash.com/photo-1506744038136-46273834b3fb?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400", alt: "Pemandangan alam", title: "Desain Alam Terbuka", desc: "Integrasi alam untuk ketenangan." },
                    { href: "#", imgSrc: "https://images.unsplash.com/photo-1464983953574-0892a716854b?ixlib=rb-4.0.3&q=85&fm=jpg&crop=entropy&cs=srgb&w=400", alt: "Interior minimalis", title: "Interior Minimalis", desc: "Kesederhanaan elegan." },
                ];
                let cardsHTML = recommendationData.map(rec => `
                    <div class="card recommendation-card">
                        <a href="${Utils.sanitizeHTML(rec.href)}" class="spa-link" aria-label="Lihat detail ${Utils.sanitizeHTML(rec.title)}"><img src="${Utils.sanitizeHTML(rec.imgSrc)}" class="card-img-top" alt="${Utils.sanitizeHTML(rec.alt)}" loading="lazy"></a>
                        <div class="card-body"><h3 class="card-title">${Utils.sanitizeHTML(rec.title)}</h3><p class="card-text">${Utils.sanitizeHTML(rec.desc)}</p><a href="${Utils.sanitizeHTML(rec.href)}" class="btn btn-sm btn-primary spa-link">Pelajari</a></div>
                    </div>`).join('');
                element.innerHTML = `
                    <div class="page-header-legacy"><h1 class="page-title-legacy">Rekomendasi Desain UI</h1><p class="page-description-legacy">Inspirasi desain antarmuka pengguna (UI) modern.</p></div>
                    <div class="recommendation-grid">${cardsHTML}</div>`;
                return element;
            }

            static createAboutPageLegacy() { // Halaman Tentang Kami lama
                const element = Utils.createElement('div', { class: 'container py-xl' });
                element.innerHTML = `
                    <div class="page-header-legacy"><h1 class="page-title-legacy">Tentang LuxuryStay</h1><p class="page-description-legacy">Kami berdedikasi menyediakan pengalaman menginap tak tertandingi.</p></div>
                    <div style="max-width: 800px; margin: 0 auto;"><h2>Visi Kami</h2><p>Menjadi pilihan utama akomodasi mewah.</p><h2>Misi Kami</h2><ul style="list-style-type: disc; padding-left: var(--spacing-lg);"><li class="mb-sm">Properti berkualitas tinggi.</li><li class="mb-sm">Pelayanan pelanggan prima.</li></ul></div>`;
                return element;
            }

            static createContactPageLegacy() { // Halaman Kontak lama
                const element = Utils.createElement('div', { class: 'container py-xl' });
                element.innerHTML = `
                    <div class="page-header-legacy"><h1 class="page-title-legacy">Hubungi Kami</h1><p class="page-description-legacy">Kami senang mendengar dari Anda!</p></div>
                    <div class="d-flex flex-wrap" style="gap: var(--spacing-xl); justify-content: space-around;">
                        <div style="flex: 1; min-width: 300px;">
                            <h2>Informasi Kontak</h2>
                            <p><i class="fas fa-map-marker-alt" style="margin-right: var(--spacing-sm); color: var(--color-primary);"></i> Jl. Kemewahan No. 123</p>
                            <p><i class="fas fa-phone" style="margin-right: var(--spacing-sm); color: var(--color-primary);"></i> (021) 555-0101</p>
                        </div>
                        <div style="flex: 1.5; min-width: 300px;">
                            <h2>Kirim Pesan</h2>
                            <form id="contact-form-legacy">
                                <div class="form-group"><label for="contact-name-legacy" class="form-label">Nama:</label><input type="text" id="contact-name-legacy" class="form-control" required></div>
                                <div class="form-group"><label for="contact-email-legacy" class="form-label">Email:</label><input type="email" id="contact-email-legacy" class="form-control" required></div>
                                <div class="form-group"><label for="contact-message-legacy" class="form-label">Pesan:</label><textarea id="contact-message-legacy" class="form-control" rows="4" required></textarea></div>
                                <button type="submit" class="btn btn-primary">Kirim Pesan</button>
                            </form>
                        </div>
                    </div>`;
                const form = element.querySelector('#contact-form-legacy');
                if (form) {
                    form.addEventListener('submit', (e) => {
                        e.preventDefault();
                        alert(`Pesan dari ${Utils.sanitizeHTML(e.target.elements[0].value)} 'dikirim' (simulasi).`);
                        form.reset();
                    });
                }
                return element;
            }


            static createNotFoundPage() { // Halaman 404
                const element = Utils.createElement('div', { class: 'container py-xxl text-center' });
                element.innerHTML = `
                    <h1 class="page-content-title" style="font-size: 5rem; color: var(--color-danger);"><i class="fas fa-exclamation-triangle"></i> 404</h1>
                    <h2 style="font-size: var(--font-size-xxl);">Halaman Tidak Ditemukan</h2>
                    <p class="page-description-legacy">Maaf, halaman yang Anda cari tidak dapat ditemukan. Mungkin URL salah ketik atau halaman telah dipindahkan.</p>
                    <a href="/dashboard" class="btn btn-primary spa-link">Kembali ke Dashboard</a>
                `;
                return element;
            }
        }

        // Layer 3: Router SPA
        class Router {
            constructor(routes, pageRenderer, uiManager) {
                this.routes = routes;
                this.pageRenderer = pageRenderer;
                this.uiManager = uiManager;
                this.init();
            }

            init() {
                window.addEventListener('popstate', (event) => this.handleRouteChange(event.state ? event.state.path : window.location.pathname));
                document.addEventListener('DOMContentLoaded', () => {
                    this.handleRouteChange(window.location.pathname);
                    this.setupLinkInterception();
                });
            }

            setupLinkInterception() {
                document.body.addEventListener('click', (e) => {
                    const link = e.target.closest('a.spa-link');
                    if (link && link.href) {
                        e.preventDefault();
                        const targetPath = new URL(link.href).pathname;
                        // Jika link memiliki data-path, gunakan itu (berguna untuk tombol yang berperilaku seperti link)
                        const pathFromData = link.dataset.path;
                        this.navigateTo(pathFromData || targetPath);
                    }
                });
            }

            navigateTo(path) {
                if (window.location.pathname !== path) {
                    window.history.pushState({ path }, '', path);
                }
                this.handleRouteChange(path);
                // Tutup sidebar jika terbuka (khususnya di mobile setelah klik link)
                if (window.innerWidth < 992) {
                    this.uiManager.closeSidebar();
                }
                this.uiManager.closeNavMenuMainHeader(); // Tutup menu header atas jika ada
            }

            handleRouteChange(path) {
                const routeConfig = this.routes[path] || this.routes['/404'] || { title: 'Halaman Tidak Ditemukan', generator: PageRenderer.createNotFoundPage, id: 'not-found' };
                this.pageRenderer.render(routeConfig);
                this.uiManager.updateActiveSidebarLink(path);
                this.uiManager.updateActiveHeaderLink(path); // Untuk navigasi header atas (lama)
            }
        }

        // Layer 4: Inisialisasi Aplikasi
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('current-year').textContent = new Date().getFullYear();

            // Inisialisasi UIManager global
            window.uiManager = new UIManager();

            const pageRenderer = new PageRenderer('app-content', 'header-page-title-container');

            const appRoutes = {
                // Rute Sidebar Aplikasi Baru
                '/dashboard': { title: 'Dashboard', generator: PageRenderer.createDashboardPage, id: 'dashboard' },
                '/profile': { title: 'Profil Pengguna', generator: PageRenderer.createGenericPage("Profil Pengguna", "Kelola informasi profil dan pengaturan akun Anda."), id: 'profile' },
                '/apartments': { title: 'Manajemen Apartemen', generator: PageRenderer.createGenericPage("Manajemen Apartemen", "Lihat, tambah, edit, atau hapus daftar apartemen."), id: 'apartments' },
                '/bookings': { title: 'Manajemen Booking', generator: PageRenderer.createGenericPage("Manajemen Booking", "Pantau dan kelola semua pesanan apartemen."), id: 'bookings' },
                '/favorites': { title: 'Apartemen Favorit', generator: PageRenderer.createGenericPage("Apartemen Favorit", "Lihat daftar apartemen yang telah Anda tandai sebagai favorit."), id: 'favorites' },
                '/payments': { title: 'Riwayat Pembayaran', generator: PageRenderer.createGenericPage("Riwayat Pembayaran", "Lacak semua transaksi dan status pembayaran."), id: 'payments' },
                '/maintenance': { title: 'Permintaan Maintenance', generator: PageRenderer.createGenericPage("Permintaan Maintenance", "Kelola permintaan perbaikan dan jadwal maintenance."), id: 'maintenance' },
                '/messages': { title: 'Pusat Pesan', generator: PageRenderer.createGenericPage("Pusat Pesan", "Lihat dan balas pesan dari pengguna atau sistem."), id: 'messages' },

                // Rute dari Aplikasi Lama (jika masih dipertahankan)
                '/': { title: 'Beranda Publik', generator: PageRenderer.createHomePageLegacy, id: 'home-legacy' },
                '/gallery': { title: 'Galeri Publik', generator: PageRenderer.createGalleryPageLegacy, id: 'gallery-legacy' },
                '/admin': { title: 'Admin (Legacy)', generator: PageRenderer.createAdminPageLegacy, id: 'admin-legacy' }, // Halaman admin lama dengan data tanaman
                '/recommendations': { title: 'Rekomendasi UI (Legacy)', generator: PageRenderer.createRecommendationsPageLegacy, id: 'recommendations-legacy' },
                '/about': { title: 'Tentang Kami (Legacy)', generator: PageRenderer.createAboutPageLegacy, id: 'about-legacy' },
                '/contact': { title: 'Kontak (Legacy)', generator: PageRenderer.createContactPageLegacy, id: 'contact-legacy' },

                // Fallback
                '/404': { title: 'Halaman Tidak Ditemukan', generator: PageRenderer.createNotFoundPage, id: 'not-found' }
            };

            new Router(appRoutes, pageRenderer, window.uiManager);

            // Set default state sidebar berdasarkan ukuran layar
            if (window.innerWidth >= 992) {
                window.uiManager.openSidebar();
            } else {
                window.uiManager.closeSidebar(); // atau document.body.classList.add('sidebar-hidden');
            }

            console.log(`${AppConfig.appName} SPA berhasil dimuat. Selamat datang, ${AppConfig.user.name}!`);
        });

    </script>
</body>

</html>