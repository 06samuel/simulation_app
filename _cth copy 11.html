<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Green Valley - Dashboard Sewa Apartemen Modern</title>
    <meta name="description"
        content="Platform lengkap untuk manajemen dan pencarian sewa apartemen. Dashboard modern, notifikasi interaktif, dan listing properti yang elegan.">
    <meta name="keywords"
        content="apartemen, sewa, rental, properti, dashboard, notifikasi, booking, manajemen apartemen, vanilla js, spa">
    <meta name="author" content="Green Valley Revitalized Team">
    <meta property="og:title" content="Green Valley - Platform Sewa Apartemen Modern">
    <meta property="og:description"
        content="Temukan dan kelola apartemen impian Anda dengan mudah melalui platform modern kami.">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/6366f1/ffffff?text=Green Valley">
    <meta property="og:url" content="https://Green Valley.id"> <!-- Ganti dengan URL Anda -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Preconnect untuk sumber daya eksternal -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Progressive Web App (PWA) -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png"> <!-- Pastikan path icon benar -->

    <!-- Favicon (menggunakan Google Favicon service sebagai contoh, atau host sendiri) -->
    <link rel="icon" type="image/png" sizes="32x32"
        href="https://www.google.com/s2/favicons?domain=Green Valley.id&sz=32">
    <link rel="icon" type="image/png" sizes="16x16"
        href="https://www.google.com/s2/favicons?domain=Green Valley.id&sz=16">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Icons (Bootstrap Icons) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <style>
        /* style.css */
        /* --- Variabel Global dan Reset --- */
        :root {
            /* Warna Inti */
            --primary-color: #6366f1;
            /* Indigo */
            --primary-hover-color: #4f46e5;
            --primary-focus-ring: rgba(99, 102, 241, 0.3);
            --primary-text-color: #ffffff;
            --primary-color-rgb: 99, 102, 241;

            --secondary-color: #10b981;
            /* Emerald */
            --secondary-hover-color: #059669;
            --secondary-text-color: #ffffff;
            --secondary-color-rgb: 16, 185, 129;

            --accent-color: #f59e0b;
            /* Amber */
            --accent-hover-color: #d97706;
            --accent-text-color: #1f2937;
            --accent-color-rgb: 245, 158, 11;

            /* Warna Netral */
            --neutral-bg-color: #f9fafb;
            /* Sangat terang, hampir putih */
            --neutral-light-bg-color: #ffffff;
            /* Putih untuk card, modal */
            --neutral-text-color: #1f2937;
            /* Abu-abu gelap untuk teks */
            --neutral-subtle-text-color: #6b7280;
            /* Abu-abu lebih terang */
            --neutral-border-color: #e5e7eb;
            --neutral-divider-color: #f3f4f6;

            /* Warna Status */
            --success-color: #22c55e;
            --warning-color: #facc15;
            --danger-color: #ef4444;
            --info-color: #3b82f6;

            /* Tipografi */
            --font-family-sans: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-size-base: clamp(0.9rem, 0.875rem + 0.2vw, 1rem);
            /* Responsif */
            --font-size-sm: calc(var(--font-size-base) * 0.875);
            --font-size-lg: calc(var(--font-size-base) * 1.125);
            --font-size-xl: calc(var(--font-size-base) * 1.25);
            --font-size-2xl: calc(var(--font-size-base) * 1.5);
            --font-size-3xl: calc(var(--font-size-base) * 1.875);

            /* Ketinggian Baris */
            --line-height-base: 1.6;
            --line-height-heading: 1.25;
            --line-height-tight: 1.1;

            /* Jarak */
            --spacing-unit: 0.25rem;
            /* 4px */
            --spacing-xs: calc(var(--spacing-unit) * 2);
            /* 8px */
            --spacing-sm: calc(var(--spacing-unit) * 3);
            /* 12px */
            --spacing-md: calc(var(--spacing-unit) * 4);
            /* 16px */
            --spacing-lg: calc(var(--spacing-unit) * 6);
            /* 24px */
            --spacing-xl: calc(var(--spacing-unit) * 8);
            /* 32px */
            --spacing-2xl: calc(var(--spacing-unit) * 12);
            /* 48px */

            /* Radius Border */
            --border-radius-sm: 0.25rem;
            --border-radius-md: 0.5rem;
            --border-radius-lg: 0.75rem;
            --border-radius-xl: 1rem;
            --border-radius-full: 9999px;

            /* Bayangan */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);

            /* Layout */
            --sidebar-width: 260px;
            --sidebar-width-collapsed: 80px;
            --header-height: 70px;
            --content-max-width: 1440px;
            --sidebar-bg-color: #1f2937;
            /* Abu-abu gelap untuk sidebar */
            --sidebar-text-color: #e5e7eb;
            --sidebar-hover-bg: #374151;
            --sidebar-active-bg: var(--primary-color);
            --sidebar-active-text: var(--primary-text-color);

            /* Transisi */
            --transition-duration-fast: 0.15s;
            --transition-duration-base: 0.25s;
            --transition-duration-slow: 0.4s;
            --transition-timing-ease: cubic-bezier(0.4, 0, 0.2, 1);

            /* Z-index */
            --z-index-dropdown: 1000;
            --z-index-sticky: 1020;
            --z-index-modal-backdrop: 1040;
            --z-index-modal: 1050;
            --z-index-sidebar: 1030;
            --z-index-header: 1010;
            --z-index-toast: 1100;
            --z-index-preloader: 9999;
        }

        /* Dark mode (Jika diperlukan, bisa ditambahkan logic JS untuk toggle manual) */
        @media (prefers-color-scheme: dark) {
            :root {
                --neutral-bg-color: #111827;
                /* Abu-abu sangat gelap */
                --neutral-light-bg-color: #1f2937;
                /* Abu-abu gelap untuk card */
                --neutral-text-color: #f3f4f6;
                /* Putih keabuan */
                --neutral-subtle-text-color: #9ca3af;
                --neutral-border-color: #374151;
                --neutral-divider-color: #4b5563;

                --sidebar-bg-color: #0f172a;
                /* Lebih gelap lagi */
                --sidebar-text-color: #cbd5e1;
                --sidebar-hover-bg: #1e293b;
            }
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            font-size: var(--font-size-base);
            line-height: var(--line-height-base);
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            scroll-behavior: smooth;
            height: 100%;
        }

        body {
            font-family: var(--font-family-sans);
            color: var(--neutral-text-color);
            background-color: var(--neutral-bg-color);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            /* Memastikan body mengisi tinggi viewport */
            overflow-x: hidden;
            /* Mencegah scroll horizontal */
            transition: background-color var(--transition-duration-base) var(--transition-timing-ease),
                color var(--transition-duration-base) var(--transition-timing-ease);
        }

        img,
        picture,
        video,
        canvas {
            max-width: 100%;
            height: auto;
            display: block;
        }

        input,
        button,
        textarea,
        select {
            font: inherit;
            color: inherit;
            border-radius: var(--border-radius-md);
        }

        button {
            cursor: pointer;
            background: none;
            border: none;
        }

        a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color var(--transition-duration-fast) var(--transition-timing-ease);
        }

        a:hover {
            color: var(--primary-hover-color);
            text-decoration: underline;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-weight: 700;
            line-height: var(--line-height-heading);
            margin-bottom: var(--spacing-md);
            color: var(--neutral-text-color);
        }

        h1 {
            font-size: var(--font-size-3xl);
        }

        h2 {
            font-size: var(--font-size-2xl);
        }

        h3 {
            font-size: var(--font-size-xl);
        }

        h4 {
            font-size: var(--font-size-lg);
        }

        p {
            margin-bottom: var(--spacing-md);
            line-height: var(--line-height-base);
        }

        ul,
        ol {
            list-style: none;
            padding-left: 0;
        }

        :focus-visible {
            outline: 2px solid var(--primary-focus-ring);
            outline-offset: 2px;
            border-radius: var(--border-radius-sm);
        }

        /* Aksesibilitas */
        .sr-only {
            /* Untuk menyembunyikan elemen secara visual tapi tetap terbaca screen reader */
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* --- Preloader --- */
        .app-preloader {
            position: fixed;
            inset: 0;
            background-color: var(--neutral-bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: var(--z-index-preloader);
            opacity: 1;
            transition: opacity var(--transition-duration-slow) var(--transition-timing-ease);
        }

        .app-preloader.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .app-preloader .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid var(--neutral-border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: var(--spacing-lg);
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .app-preloader p {
            font-size: var(--font-size-lg);
            color: var(--neutral-subtle-text-color);
        }


        /* --- Shell Utama Aplikasi --- */
        .app-shell {
            display: flex;
            min-height: 100vh;
            position: relative;
            /* Untuk positioning sidebar absolut di mobile */
        }

        /* --- Sidebar Navigasi --- */
        .app-sidebar {
            width: var(--sidebar-width);
            background-color: var(--sidebar-bg-color);
            color: var(--sidebar-text-color);
            padding: var(--spacing-lg) 0;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            /* Mencegah sidebar menyusut */
            transition: width var(--transition-duration-base) var(--transition-timing-ease),
                transform var(--transition-duration-base) var(--transition-timing-ease);
            z-index: var(--z-index-sidebar);
            box-shadow: var(--shadow-lg);
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 var(--spacing-lg) var(--spacing-lg);
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            /* Garis pemisah halus */
            margin-bottom: var(--spacing-md);
        }

        .brand-logo {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            font-size: var(--font-size-xl);
            font-weight: 700;
            color: var(--primary-text-color);
            /* Warna teks brand */
            text-decoration: none;
        }

        .brand-logo i {
            font-size: var(--font-size-2xl);
            color: var(--primary-color);
            /* Icon brand dengan warna primer */
        }

        .brand-logo:hover {
            color: var(--primary-text-color);
            text-decoration: none;
        }

        .sidebar-nav {
            flex-grow: 1;
        }

        .nav-list {
            margin-top: var(--spacing-md);
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: var(--spacing-md) var(--spacing-lg);
            color: var(--sidebar-text-color);
            font-weight: 500;
            text-decoration: none;
            border-left: 3px solid transparent;
            transition: background-color var(--transition-duration-fast) var(--transition-timing-ease),
                color var(--transition-duration-fast) var(--transition-timing-ease),
                border-left-color var(--transition-duration-fast) var(--transition-timing-ease);
        }

        .nav-link i {
            margin-right: var(--spacing-md);
            font-size: var(--font-size-lg);
            width: 24px;
            /* Jaga alignment ikon */
            text-align: center;
            transition: transform var(--transition-duration-fast) var(--transition-timing-ease);
        }

        .nav-link:hover,
        .nav-link:focus {
            background-color: var(--sidebar-hover-bg);
            color: var(--primary-text-color);
            text-decoration: none;
        }

        .nav-link.active {
            background-color: var(--sidebar-active-bg);
            color: var(--sidebar-active-text);
            border-left-color: var(--accent-color);
            /* Aksen warna aktif */
            font-weight: 600;
        }

        .nav-link.active i {
            transform: scale(1.1);
        }

        .nav-link .badge {
            margin-left: auto;
            background-color: var(--danger-color);
            color: var(--primary-text-color);
            font-size: var(--font-size-sm);
            padding: calc(var(--spacing-xs) / 2) var(--spacing-xs);
            border-radius: var(--border-radius-full);
            font-weight: 600;
        }

        .sidebar-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .logout-link:hover {
            color: var(--danger-color);
        }

        /* Sidebar Collapsed State */
        .app-shell.sidebar-collapsed .app-sidebar {
            width: var(--sidebar-width-collapsed);
        }

        .app-shell.sidebar-collapsed .app-sidebar .brand-logo span,
        .app-shell.sidebar-collapsed .app-sidebar .nav-link span,
        .app-shell.sidebar-collapsed .app-sidebar .sidebar-close-btn {
            display: none;
            /* Sembunyikan teks saat collapsed */
        }

        .app-shell.sidebar-collapsed .app-sidebar .brand-logo i {
            margin-right: 0;
        }

        .app-shell.sidebar-collapsed .app-sidebar .nav-link {
            justify-content: center;
        }

        .app-shell.sidebar-collapsed .app-sidebar .nav-link i {
            margin-right: 0;
            font-size: var(--font-size-xl);
            /* Icon sedikit lebih besar saat collapsed */
        }

        .app-shell.sidebar-collapsed .app-sidebar .nav-link .badge {
            position: absolute;
            top: var(--spacing-sm);
            right: var(--spacing-sm);
            padding: 2px 4px;
            font-size: calc(var(--font-size-sm) * 0.8);
        }

        .sidebar-close-btn {
            /* Tombol close di dalam sidebar, hanya visible di mobile */
            display: none;
            color: var(--sidebar-text-color);
        }


        /* --- Kontainer Utama Aplikasi --- */
        .app-main-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            transition: margin-left var(--transition-duration-base) var(--transition-timing-ease);
            overflow-x: hidden;
            /* Mencegah konten overflow menyebabkan scroll di body */
        }

        /* --- Header Aplikasi --- */
        .app-header {
            height: var(--header-height);
            background-color: var(--neutral-light-bg-color);
            border-bottom: 1px solid var(--neutral-border-color);
            display: flex;
            align-items: center;
            padding: 0 var(--spacing-lg);
            position: sticky;
            /* Header tetap di atas saat scroll */
            top: 0;
            z-index: var(--z-index-header);
            box-shadow: var(--shadow-sm);
        }

        .sidebar-toggle-btn {
            margin-right: var(--spacing-md);
        }

        .header-title {
            font-size: var(--font-size-xl);
            font-weight: 600;
            color: var(--neutral-text-color);
        }

        .header-actions {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        #app-search {
            padding: var(--spacing-sm) var(--spacing-md);
            padding-left: calc(var(--spacing-md) + var(--spacing-lg));
            /* Ruang untuk ikon */
            border: 1px solid var(--neutral-border-color);
            border-radius: var(--border-radius-full);
            /* Search bar rounded */
            min-width: 250px;
            background-color: var(--neutral-bg-color);
            transition: all var(--transition-duration-fast) var(--transition-timing-ease);
        }

        #app-search:focus {
            border-color: var(--primary-color);
            background-color: var(--neutral-light-bg-color);
            box-shadow: 0 0 0 2px var(--primary-focus-ring);
            outline: none;
        }

        .search-icon {
            position: absolute;
            left: var(--spacing-md);
            color: var(--neutral-subtle-text-color);
            font-size: var(--font-size-base);
            pointer-events: none;
            /* Agar ikon tidak menghalangi klik input */
        }

        .icon-button {
            color: var(--neutral-subtle-text-color);
            padding: var(--spacing-sm);
            border-radius: var(--border-radius-full);
            /* Tombol ikon bulat */
            position: relative;
            /* Untuk notification dot */
            transition: background-color var(--transition-duration-fast) var(--transition-timing-ease),
                color var(--transition-duration-fast) var(--transition-timing-ease);
        }

        .icon-button:hover,
        .icon-button:focus {
            background-color: var(--neutral-divider-color);
            color: var(--neutral-text-color);
        }

        .icon-button i {
            font-size: var(--font-size-xl);
            display: block;
            /* Menghilangkan spasi bawah ikon */
        }

        .notification-dot {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 8px;
            height: 8px;
            background-color: var(--danger-color);
            border-radius: 50%;
            border: 1px solid var(--neutral-light-bg-color);
            /* Border agar kontras */
        }

        .user-profile-dropdown {
            position: relative;
        }

        .user-avatar-button img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--neutral-border-color);
            transition: border-color var(--transition-duration-fast) var(--transition-timing-ease);
        }

        .user-avatar-button:hover img,
        .user-avatar-button[aria-expanded="true"] img {
            border-color: var(--primary-color);
        }

        .dropdown-menu {
            position: absolute;
            top: calc(100% + var(--spacing-sm));
            /* Posisi di bawah tombol avatar */
            right: 0;
            background-color: var(--neutral-light-bg-color);
            border: 1px solid var(--neutral-border-color);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            min-width: 220px;
            z-index: var(--z-index-dropdown);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity var(--transition-duration-fast) var(--transition-timing-ease),
                visibility var(--transition-duration-fast) var(--transition-timing-ease),
                transform var(--transition-duration-fast) var(--transition-timing-ease);
        }

        .user-profile-dropdown[data-open="true"] .dropdown-menu {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-header {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--neutral-divider-color);
        }

        .dropdown-header span {
            display: block;
        }

        #user-menu-name {
            font-weight: 600;
            color: var(--neutral-text-color);
        }

        #user-menu-email {
            font-size: var(--font-size-sm);
            color: var(--neutral-subtle-text-color);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            color: var(--neutral-text-color);
            font-size: var(--font-size-base);
            text-decoration: none;
        }

        .dropdown-item i {
            margin-right: var(--spacing-sm);
            color: var(--neutral-subtle-text-color);
            width: 20px;
            text-align: center;
        }

        .dropdown-item:hover,
        .dropdown-item:focus {
            background-color: var(--neutral-divider-color);
            color: var(--primary-color);
            text-decoration: none;
        }

        .dropdown-item:hover i,
        .dropdown-item:focus i {
            color: var(--primary-color);
        }

        .dropdown-divider {
            height: 1px;
            background-color: var(--neutral-divider-color);
            margin: var(--spacing-xs) 0;
            border: none;
        }

        /* --- Konten Utama --- */
        .app-content {
            flex-grow: 1;
            padding: var(--spacing-lg);
            overflow-y: auto;
            /* Konten bisa scroll jika lebih panjang */
        }

        .page-container {
            /* Wrapper untuk setiap halaman */
            max-width: var(--content-max-width);
            margin: 0 auto;
        }

        .page-header {
            /* Header di dalam konten halaman */
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--neutral-divider-color);
        }

        .page-header h1 {
            margin-bottom: var(--spacing-xs);
        }

        .page-header p {
            color: var(--neutral-subtle-text-color);
            font-size: var(--font-size-lg);
            margin-bottom: 0;
        }

        /* Komponen Kartu (Card) */
        .card {
            background-color: var(--neutral-light-bg-color);
            border: 1px solid var(--neutral-border-color);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            transition: box-shadow var(--transition-duration-base) var(--transition-timing-ease);
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
        }

        .card-header {
            padding-bottom: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--neutral-divider-color);
        }

        .card-header h3 {
            margin-bottom: 0;
        }

        .card-title {
            font-size: var(--font-size-xl);
            font-weight: 600;
        }

        .card-body {
            /* style body kartu */
        }

        .card-footer {
            padding-top: var(--spacing-md);
            margin-top: var(--spacing-md);
            border-top: 1px solid var(--neutral-divider-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
        }

        /* Grid System (Contoh Sederhana) */
        .grid-container {
            display: grid;
            gap: var(--spacing-lg);
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, minmax(0, 1fr));
        }

        .grid-cols-4 {
            grid-template-columns: repeat(4, minmax(0, 1fr));
        }

        @media (max-width: 1024px) {
            .lg-grid-cols-2 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .lg-grid-cols-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }
        }

        @media (max-width: 768px) {
            .md-grid-cols-1 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .grid-cols-3,
            .grid-cols-4,
            .lg-grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
                /* Stack di mobile */
            }

            .grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
                /* Stack di mobile */
            }
        }


        /* Tombol (Button) */
        .btn {
            display: inline-flex;
            /* Agar ikon dan teks sejajar */
            align-items: center;
            justify-content: center;
            padding: var(--spacing-sm) var(--spacing-md);
            font-weight: 500;
            font-size: var(--font-size-base);
            border-radius: var(--border-radius-md);
            border: 1px solid transparent;
            cursor: pointer;
            text-align: center;
            text-decoration: none;
            transition: all var(--transition-duration-fast) var(--transition-timing-ease);
            white-space: nowrap;
            /* Mencegah teks tombol wrap */
        }

        .btn i {
            margin-right: var(--spacing-xs);
        }

        .btn.btn-sm {
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-sm);
        }

        .btn.btn-lg {
            padding: var(--spacing-md) var(--spacing-lg);
            font-size: var(--font-size-lg);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--primary-text-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover,
        .btn-primary:focus {
            background-color: var(--primary-hover-color);
            border-color: var(--primary-hover-color);
            color: var(--primary-text-color);
            text-decoration: none;
            box-shadow: 0 0 0 3px var(--primary-focus-ring);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--secondary-text-color);
            border-color: var(--secondary-color);
        }

        .btn-secondary:hover,
        .btn-secondary:focus {
            background-color: var(--secondary-hover-color);
            border-color: var(--secondary-hover-color);
            color: var(--secondary-text-color);
            text-decoration: none;
            box-shadow: 0 0 0 3px rgba(var(--secondary-color-rgb), 0.3);
        }

        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-outline-primary:hover,
        .btn-outline-primary:focus {
            background-color: var(--primary-color);
            color: var(--primary-text-color);
            box-shadow: 0 0 0 3px var(--primary-focus-ring);
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: var(--primary-text-color);
            border-color: var(--danger-color);
        }

        .btn-danger:hover,
        .btn-danger:focus {
            background-color: darken(var(--danger-color), 10%);
            border-color: darken(var(--danger-color), 10%);
            color: var(--primary-text-color);
            box-shadow: 0 0 0 3px rgba(var(--danger-color-rgb), 0.3);
        }


        /* Form Input */
        .form-group {
            margin-bottom: var(--spacing-md);
        }

        .form-label {
            display: block;
            font-weight: 500;
            margin-bottom: var(--spacing-xs);
            color: var(--neutral-text-color);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-base);
            line-height: var(--line-height-base);
            color: var(--neutral-text-color);
            background-color: var(--neutral-light-bg-color);
            background-clip: padding-box;
            border: 1px solid var(--neutral-border-color);
            border-radius: var(--border-radius-md);
            transition: border-color var(--transition-duration-fast) ease-in-out, box-shadow var(--transition-duration-fast) ease-in-out;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: 0;
            box-shadow: 0 0 0 0.2rem var(--primary-focus-ring);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* --- Footer Aplikasi --- */
        .app-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            background-color: var(--neutral-light-bg-color);
            border-top: 1px solid var(--neutral-border-color);
            text-align: center;
            font-size: var(--font-size-sm);
            color: var(--neutral-subtle-text-color);
            margin-top: auto;
            /* Mendorong footer ke bawah jika konten pendek */
        }

        .app-footer p {
            margin-bottom: 0;
        }

        /* --- Notifikasi Toast --- */
        .toast-notifications-container {
            position: fixed;
            top: calc(var(--header-height) + var(--spacing-md));
            right: var(--spacing-md);
            z-index: var(--z-index-toast);
            display: flex;
            flex-direction: column;
            gap: var(--spacing-sm);
            max-width: 350px;
        }

        .toast-notification {
            background-color: var(--neutral-light-bg-color);
            color: var(--neutral-text-color);
            padding: var(--spacing-md) var(--spacing-lg);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: flex-start;
            /* Untuk ikon dan teks */
            gap: var(--spacing-sm);
            opacity: 0;
            transform: translateX(100%);
            animation: toastInRight var(--transition-duration-base) var(--transition-timing-ease) forwards,
                toastOut var(--transition-duration-base) var(--transition-timing-ease) 5s forwards;
            /* Auto dismiss */
            border-left: 4px solid var(--info-color);
            /* Default */
        }

        .toast-notification.success {
            border-left-color: var(--success-color);
        }

        .toast-notification.warning {
            border-left-color: var(--warning-color);
        }

        .toast-notification.danger {
            border-left-color: var(--danger-color);
        }

        .toast-notification.info {
            border-left-color: var(--info-color);
        }

        .toast-notification i {
            /* Ikon di toast */
            font-size: var(--font-size-xl);
            margin-top: 2px;
            /* Alignment vertikal ikon */
        }

        .toast-notification.success i {
            color: var(--success-color);
        }

        .toast-notification.warning i {
            color: var(--warning-color);
        }

        .toast-notification.danger i {
            color: var(--danger-color);
        }

        .toast-notification.info i {
            color: var(--info-color);
        }

        .toast-content {
            flex-grow: 1;
        }

        .toast-title {
            font-weight: 600;
            margin-bottom: var(--spacing-xs);
        }

        .toast-message {
            font-size: var(--font-size-sm);
            line-height: 1.4;
        }

        .toast-close-btn {
            margin-left: var(--spacing-md);
            color: var(--neutral-subtle-text-color);
            align-self: flex-start;
            /* Posisikan di atas kanan */
            padding: 0;
            /* Tombol ikon kecil */
        }

        .toast-close-btn:hover {
            color: var(--neutral-text-color);
        }

        @keyframes toastInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes toastOut {
            90% {
                opacity: 1;
                transform: translateX(0);
            }

            100% {
                opacity: 0;
                transform: translateX(100%);
            }
        }

        /* --- Modal --- */
        .app-modal {
            position: fixed;
            inset: 0;
            /* top, right, bottom, left = 0 */
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: var(--z-index-modal);
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-duration-base) var(--transition-timing-ease),
                visibility var(--transition-duration-base) var(--transition-timing-ease);
        }

        .app-modal[hidden] {
            display: none !important;
        }

        /* Important untuk override display flex */
        .app-modal.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.6);
            /* Latar belakang semi-transparan */
            backdrop-filter: blur(5px);
            /* Efek glassmorphism halus */
            -webkit-backdrop-filter: blur(5px);
            z-index: var(--z-index-modal-backdrop);
        }

        .modal-content {
            background-color: var(--neutral-light-bg-color);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-xl);
            width: 90%;
            max-width: 600px;
            /* Lebar maksimal modal */
            max-height: 90vh;
            /* Tinggi maksimal modal */
            display: flex;
            flex-direction: column;
            position: relative;
            /* Untuk z-index di atas overlay */
            z-index: var(--z-index-modal);
            transform: scale(0.95);
            transition: transform var(--transition-duration-base) var(--transition-timing-ease);
        }

        .app-modal.open .modal-content {
            transform: scale(1);
        }

        .modal-header {
            padding: var(--spacing-lg);
            border-bottom: 1px solid var(--neutral-divider-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title-text {
            font-size: var(--font-size-xl);
            font-weight: 600;
            margin-bottom: 0;
        }

        .modal-close-btn {
            color: var(--neutral-subtle-text-color);
        }

        .modal-close-btn:hover {
            color: var(--danger-color);
            /* Aksen merah saat hover tutup */
        }

        .modal-body {
            padding: var(--spacing-lg);
            overflow-y: auto;
            /* Konten modal bisa scroll */
            flex-grow: 1;
        }

        .modal-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            border-top: 1px solid var(--neutral-divider-color);
            display: flex;
            justify-content: flex-end;
            gap: var(--spacing-sm);
            background-color: var(--neutral-bg-color);
            /* Footer modal sedikit beda */
            border-bottom-left-radius: var(--border-radius-xl);
            border-bottom-right-radius: var(--border-radius-xl);
        }

        /* --- Placeholder Elemen (Contoh) --- */
        .placeholder-glow .placeholder {
            background-color: var(--neutral-divider-color);
            animation: placeholder-glow 1.5s ease-in-out infinite;
        }

        @keyframes placeholder-glow {
            50% {
                opacity: 0.6;
            }
        }

        .placeholder {
            display: inline-block;
            min-height: 1em;
            cursor: wait;
            background-color: var(--neutral-divider-color);
            border-radius: var(--border-radius-sm);
        }

        .placeholder.h-20 {
            height: 20px;
        }

        .placeholder.w-100 {
            width: 100%;
        }

        .placeholder.w-75 {
            width: 75%;
        }

        .placeholder.w-50 {
            width: 50%;
        }


        /* --- Responsivitas --- */
        @media (max-width: 992px) {

            /* Tablet dan di bawahnya */
            .app-sidebar {
                position: fixed;
                /* Sidebar jadi overlay di mobile/tablet */
                left: 0;
                top: 0;
                bottom: 0;
                height: 100vh;
                transform: translateX(-100%);
                /* Sembunyikan sidebar di luar layar */
            }

            .app-shell:not(.sidebar-collapsed) .app-sidebar {
                /* Saat sidebar terbuka */
                transform: translateX(0);
                box-shadow: var(--shadow-xl);
                /* Bayangan lebih kuat saat overlay */
            }

            .app-shell.sidebar-collapsed .app-main-container {
                margin-left: 0;
                /* Konten utama full width saat sidebar collapsed */
            }

            .app-main-container {
                margin-left: 0 !important;
                /* Override inline style dari JS */
            }

            .sidebar-close-btn {
                display: block;
                /* Tampilkan tombol close di sidebar */
            }

            #app-search {
                min-width: 180px;
                /* Perkecil search bar */
            }
        }

        @media (max-width: 768px) {

            /* Mobile */
            :root {
                --sidebar-width: 280px;
                /* Sidebar sedikit lebih lebar di mobile saat terbuka */
                --header-height: 60px;
            }

            .header-actions .search-container {
                display: none;
                /* Sembunyikan search bar di header mobile (bisa dipindah ke tempat lain) */
            }

            .app-content {
                padding: var(--spacing-md);
            }

            .grid-cols-2,
            .grid-cols-3,
            .grid-cols-4,
            .lg-grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
                /* Semua grid jadi 1 kolom */
            }

            .modal-content {
                width: 95%;
                max-height: 95vh;
            }

            .toast-notifications-container {
                width: calc(100% - (2 * var(--spacing-md)));
                max-width: none;
                left: var(--spacing-md);
                right: var(--spacing-md);
                top: var(--spacing-sm);
                /* Toast di bawah header di mobile */
            }
        }

        @media (max-width: 480px) {

            /* Smaller Mobile */
            .header-title {
                font-size: var(--font-size-lg);
                /* Perkecil judul header */
            }

            .icon-button i {
                font-size: var(--font-size-lg);
                /* Perkecil ikon header */
            }

            .user-avatar-button img {
                width: 32px;
                height: 32px;
            }

            .dropdown-menu {
                min-width: 180px;
            }
        }
    </style>

    <!-- Critical CSS (disarankan di-inline untuk performa TTFP, namun untuk kemudahan diletakkan di style.css) -->
</head>

<body>
    <div id="app-shell" class="app-shell">
        <!-- Preloader / Splash Screen Awal -->
        <div id="app-preloader" class="app-preloader">
            <div class="spinner"></div>
            <p>Memuat Green Valley...</p>
        </div>

        <!-- Sidebar Navigasi -->
        <aside id="app-sidebar" class="app-sidebar" aria-label="Navigasi Utama">
            <div class="sidebar-header">
                <a href="#dashboard" class="brand-logo" aria-label="Beranda Green Valley">
                    <i class="bi bi-buildings-fill"></i>
                    <span>Green Valley</span>
                </a>
                <button id="sidebar-close-btn" class="icon-button sidebar-close-btn" aria-label="Tutup Sidebar">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li><a href="#dashboard" class="nav-link active" data-page="dashboard"><i
                                class="bi bi-grid-1x2-fill"></i> <span>Dashboard</span></a></li>
                    <li><a href="#listings" class="nav-link" data-page="listings"><i class="bi bi-list-task"></i>
                            <span>Listing Apartemen</span></a></li>
                    <li><a href="#bookings" class="nav-link" data-page="bookings"><i
                                class="bi bi-calendar-check-fill"></i> <span>Pemesanan Saya</span></a></li>
                    <li><a href="#messages" class="nav-link" data-page="messages"><i class="bi bi-chat-dots-fill"></i>
                            <span>Pesan</span> <span class="badge">3</span></a></li>
                    <li><a href="#profile" class="nav-link" data-page="profile"><i class="bi bi-person-circle"></i>
                            <span>Profil Saya</span></a></li>
                    <li><a href="#settings" class="nav-link" data-page="settings"><i class="bi bi-gear-fill"></i>
                            <span>Pengaturan</span></a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="#logout" id="logout-button" class="nav-link logout-link"><i class="bi bi-box-arrow-right"></i>
                    <span>Keluar</span></a>
            </div>
        </aside>

        <!-- Kontainer Utama Aplikasi -->
        <div id="app-main-container" class="app-main-container">
            <!-- Header Aplikasi -->
            <header id="app-header" class="app-header">
                <button id="sidebar-toggle-btn" class="icon-button sidebar-toggle-btn" aria-label="Buka Sidebar">
                    <i class="bi bi-list"></i>
                </button>
                <div class="header-title" id="page-title">Dashboard</div>
                <div class="header-actions">
                    <div class="search-container">
                        <input type="search" id="app-search" placeholder="Cari apartemen..."
                            aria-label="Cari apartemen">
                        <i class="bi bi-search search-icon"></i>
                    </div>
                    <button class="icon-button" aria-label="Notifikasi" id="notification-btn">
                        <i class="bi bi-bell-fill"></i>
                        <span class="notification-dot"></span>
                    </button>
                    <div class="user-profile-dropdown">
                        <button id="user-menu-btn" class="user-avatar-button" aria-label="Menu Pengguna"
                            aria-haspopup="true" aria-expanded="false">
                            <img src="https://i.pravatar.cc/40?u=pengguna123" alt="Avatar Pengguna"
                                id="user-avatar-img">
                        </button>
                        <div id="user-menu-dropdown" class="dropdown-menu" role="menu" aria-labelledby="user-menu-btn">
                            <div class="dropdown-header">
                                <span id="user-menu-name">Nama Pengguna</span>
                                <span id="user-menu-email">email@pengguna.com</span>
                            </div>
                            <a href="#profile" role="menuitem" class="dropdown-item" data-page="profile"><i
                                    class="bi bi-person-fill"></i> Profil</a>
                            <a href="#settings" role="menuitem" class="dropdown-item" data-page="settings"><i
                                    class="bi bi-gear"></i> Pengaturan Akun</a>
                            <hr class="dropdown-divider">
                            <a href="#logout" role="menuitem" class="dropdown-item logout-link"><i
                                    class="bi bi-box-arrow-left"></i> Keluar</a>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Konten Utama (SPA View) -->
            <main id="app-content" class="app-content" role="main">
                <!-- Konten halaman akan dimuat di sini oleh JavaScript -->
            </main>

            <!-- Footer Aplikasi (Contoh Sederhana) -->
            <footer id="app-footer" class="app-footer">
                <p>© <span id="current-year"></span> Green Valley. Semua hak cipta dilindungi.</p>
            </footer>
        </div>

        <!-- Container untuk Notifikasi Toast -->
        <div id="toast-notifications-container" class="toast-notifications-container" aria-live="assertive"
            aria-atomic="true"></div>

        <!-- Modal (Contoh Struktur) -->
        <div id="app-modal" class="app-modal" role="dialog" aria-modal="true" aria-labelledby="modal-title" hidden>
            <div class="modal-overlay" data-close-modal></div>
            <div class="modal-content">
                <header class="modal-header">
                    <h2 id="modal-title" class="modal-title-text">Judul Modal</h2>
                    <button class="icon-button modal-close-btn" data-close-modal aria-label="Tutup Modal">
                        <i class="bi bi-x-lg"></i>
                    </button>
                </header>
                <section id="modal-body" class="modal-body">
                    <!-- Konten modal akan dimuat di sini -->
                </section>
                <footer id="modal-footer" class="modal-footer">
                    <!-- Tombol aksi modal akan dimuat di sini -->
                </footer>
            </div>
        </div>

    </div> <!-- Akhir dari #app-shell -->

    <script>
        // app.js

        /**
         * Green Valley SPA - Vanilla JavaScript
         * Berkas ini berisi logika utama untuk aplikasi single page Green Valley.
         * Termasuk routing, rendering konten, manajemen state sederhana, dan interaksi UI.
         */

        const App = (() => {
            'use strict';

            // === Konfigurasi dan State Aplikasi ===
            const appConfig = {
                defaultPage: 'dashboard',
                appName: 'Green Valley',
                preloaderTimeout: 500, // ms, untuk simulasi loading
            };

            const appState = {
                currentPage: null,
                user: {
                    name: 'Pengguna Guest',
                    email: 'guest@Green Valley.id',
                    avatar: 'https://i.pravatar.cc/40?u=guest', // Avatar default
                    isLoggedIn: false, // Contoh state login
                },
                sidebarOpen: window.innerWidth > 992, // Sidebar terbuka default di desktop
                notifications: [], // Array untuk notifikasi
                theme: localStorage.getItem('appTheme') || 'light', // light, dark, system
            };

            // === Cache Elemen DOM ===
            // Menggunakan objek untuk mengelompokkan elemen DOM agar lebih terorganisir
            const DOMElements = {
                shell: document.getElementById('app-shell'),
                preloader: document.getElementById('app-preloader'),
                sidebar: document.getElementById('app-sidebar'),
                sidebarToggleBtn: document.getElementById('sidebar-toggle-btn'),
                sidebarCloseBtn: document.getElementById('sidebar-close-btn'),
                mainContainer: document.getElementById('app-main-container'),
                content: document.getElementById('app-content'),
                pageTitle: document.getElementById('page-title'),
                navLinks: document.querySelectorAll('.nav-link'),
                userMenuBtn: document.getElementById('user-menu-btn'),
                userMenuDropdown: document.getElementById('user-menu-dropdown'),
                userAvatarImg: document.getElementById('user-avatar-img'),
                userMenuName: document.getElementById('user-menu-name'),
                userMenuEmail: document.getElementById('user-menu-email'),
                logoutButtons: document.querySelectorAll('.logout-link'),
                currentYearSpan: document.getElementById('current-year'),
                toastContainer: document.getElementById('toast-notifications-container'),
                modal: document.getElementById('app-modal'),
                modalOverlay: document.querySelector('.modal-overlay'),
                modalContent: document.querySelector('.modal-content'),
                modalTitle: document.getElementById('modal-title'),
                modalBody: document.getElementById('modal-body'),
                modalFooter: document.getElementById('modal-footer'),
                modalCloseBtns: document.querySelectorAll('[data-close-modal]'),
                notificationBtn: document.getElementById('notification-btn'),
            };

            // === Fungsi Utilitas ===
            const Utils = {
                /**
                 * Membersihkan string HTML untuk mencegah XSS sederhana.
                 * @param {string} str String input.
                 * @returns {string} String yang sudah dibersihkan.
                 */
                sanitizeHTML: (str) => {
                    const temp = document.createElement('div');
                    temp.textContent = str;
                    return temp.innerHTML;
                },

                /**
                 * Membuat elemen DOM dengan atribut dan konten.
                 * @param {string} tag - Nama tag HTML.
                 * @param {object} [attributes={}] - Objek atribut.
                 * @param {string|Node|Array<Node|string>} [content=''] - Konten elemen.
                 * @returns {HTMLElement} Elemen yang dibuat.
                 */
                createElement: (tag, attributes = {}, content = '') => {
                    const el = document.createElement(tag);
                    for (const key in attributes) {
                        el.setAttribute(key, attributes[key]);
                    }
                    if (Array.isArray(content)) {
                        content.forEach(item => {
                            if (item instanceof Node) el.appendChild(item);
                            else el.appendChild(document.createTextNode(item));
                        });
                    } else if (content instanceof Node) {
                        el.appendChild(content);
                    } else {
                        el.innerHTML = content; // Gunakan dengan hati-hati, idealnya content sudah di-sanitize
                    }
                    return el;
                },

                /**
                 * Delegasi event.
                 * @param {HTMLElement} parentElement - Elemen induk.
                 * @param {string} selector - Selector untuk elemen target.
                 * @param {string} eventType - Jenis event.
                 * @param {function} handler - Fungsi handler.
                 */
                delegateEvent: (parentElement, selector, eventType, handler) => {
                    parentElement.addEventListener(eventType, (event) => {
                        if (event.target && event.target.matches(selector)) {
                            handler(event);
                        }
                    });
                }
            };

            // === Logika Sidebar ===
            const Sidebar = (() => {
                function toggleSidebar(forceOpen) {
                    const open = typeof forceOpen === 'boolean' ? forceOpen : !appState.sidebarOpen;
                    DOMElements.shell.classList.toggle('sidebar-collapsed', !open);
                    appState.sidebarOpen = open;
                    // Sesuaikan margin konten utama jika sidebar tidak overlay (desktop)
                    if (window.innerWidth > 992) {
                        DOMElements.mainContainer.style.marginLeft = open ? 'var(--sidebar-width)' : 'var(--sidebar-width-collapsed)';
                    } else {
                        DOMElements.mainContainer.style.marginLeft = '0'; // Selalu 0 di mobile
                    }
                }

                function handleResize() {
                    const isDesktop = window.innerWidth > 992;
                    if (isDesktop && !appState.sidebarOpen) { // Jika di desktop dan sidebar harusnya collapsed
                        // toggleSidebar(false); // Pastikan state konsisten
                    } else if (!isDesktop) { // Jika di mobile/tablet
                        toggleSidebar(false); // Selalu tutup sidebar saat resize ke mobile
                    }
                    // Update margin main container berdasarkan state sidebar saat ini dan ukuran window
                    if (isDesktop) {
                        DOMElements.mainContainer.style.marginLeft = appState.sidebarOpen ? 'var(--sidebar-width)' : 'var(--sidebar-width-collapsed)';
                    } else {
                        DOMElements.mainContainer.style.marginLeft = '0';
                    }
                }

                function init() {
                    DOMElements.sidebarToggleBtn.addEventListener('click', () => toggleSidebar());
                    DOMElements.sidebarCloseBtn.addEventListener('click', () => toggleSidebar(false)); // Tombol close di sidebar
                    window.addEventListener('resize', handleResize);

                    // Inisialisasi state sidebar & margin
                    if (window.innerWidth <= 992) {
                        appState.sidebarOpen = false; // Default collapsed di mobile
                    }
                    toggleSidebar(appState.sidebarOpen); // Terapkan state awal
                }
                return { init, toggle: toggleSidebar };
            })();


            // === Logika Menu Pengguna ===
            const UserMenu = (() => {
                function toggleMenu() {
                    const isOpen = DOMElements.userMenuDropdown.parentElement.getAttribute('data-open') === 'true';
                    DOMElements.userMenuDropdown.parentElement.setAttribute('data-open', !isOpen);
                    DOMElements.userMenuBtn.setAttribute('aria-expanded', !isOpen);
                }

                function updateUserInfo() {
                    DOMElements.userAvatarImg.src = appState.user.avatar;
                    DOMElements.userAvatarImg.alt = `Avatar ${appState.user.name}`;
                    DOMElements.userMenuName.textContent = appState.user.name;
                    DOMElements.userMenuEmail.textContent = appState.user.email;
                }

                function init() {
                    updateUserInfo(); // Panggil saat inisiasi
                    DOMElements.userMenuBtn.addEventListener('click', toggleMenu);
                    // Sembunyikan dropdown jika klik di luar
                    document.addEventListener('click', (event) => {
                        if (!DOMElements.userMenuBtn.contains(event.target) && !DOMElements.userMenuDropdown.contains(event.target)) {
                            if (DOMElements.userMenuDropdown.parentElement.getAttribute('data-open') === 'true') {
                                toggleMenu();
                            }
                        }
                    });
                }
                return { init, updateUserInfo };
            })();

            // === Sistem Notifikasi Toast ===
            const Toast = (() => {
                /**
                 * Menampilkan notifikasi toast.
                 * @param {string} message - Pesan notifikasi.
                 * @param {string} [type='info'] - Jenis notifikasi (success, warning, danger, info).
                 * @param {string} [title='Notifikasi'] - Judul notifikasi.
                 * @param {number} [duration=5000] - Durasi tampil (ms). 0 untuk tidak auto-dismiss.
                 */
                function show(message, type = 'info', title = 'Notifikasi', duration = 5000) {
                    const toastId = `toast-${Date.now()}`;
                    const iconClass = {
                        success: 'bi-check-circle-fill',
                        warning: 'bi-exclamation-triangle-fill',
                        danger: 'bi-x-octagon-fill',
                        info: 'bi-info-circle-fill'
                    }[type];

                    const toastEl = Utils.createElement('div', { class: `toast-notification ${type}`, id: toastId, role: 'alert', 'aria-live': 'assertive' });

                    const iconEl = Utils.createElement('i', { class: `bi ${iconClass}` });

                    const contentEl = Utils.createElement('div', { class: 'toast-content' });
                    const titleEl = Utils.createElement('div', { class: 'toast-title' }, Utils.sanitizeHTML(title));
                    const messageEl = Utils.createElement('div', { class: 'toast-message' }, Utils.sanitizeHTML(message));
                    contentEl.append(titleEl, messageEl);

                    const closeBtn = Utils.createElement('button', { class: 'icon-button toast-close-btn', 'aria-label': 'Tutup notifikasi' });
                    closeBtn.innerHTML = '<i class="bi bi-x-lg"></i>';
                    closeBtn.addEventListener('click', () => dismiss(toastId));

                    toastEl.append(iconEl, contentEl, closeBtn);
                    DOMElements.toastContainer.appendChild(toastEl);

                    // Memicu animasi masuk
                    requestAnimationFrame(() => {
                        toastEl.style.opacity = '1';
                        toastEl.style.transform = 'translateX(0)';
                    });


                    if (duration > 0) {
                        setTimeout(() => dismiss(toastId), duration);
                    }
                }

                function dismiss(toastId) {
                    const toastEl = document.getElementById(toastId);
                    if (toastEl) {
                        toastEl.style.opacity = '0';
                        toastEl.style.transform = 'translateX(100%)';
                        toastEl.addEventListener('transitionend', () => {
                            if (toastEl.parentNode) toastEl.parentNode.removeChild(toastEl);
                        }, { once: true });
                    }
                }
                return { show };
            })();

            // === Sistem Modal ===
            const Modal = (() => {
                /**
                 * Membuka modal.
                 * @param {string} title - Judul modal.
                 * @param {string|Node} content - Konten HTML atau Node untuk body modal.
                 * @param {Array<object>} [actions=[]] - Array objek tombol (misal: {text: 'OK', class: 'btn-primary', handler: () => {}})
                 */
                function open(title, content, actions = []) {
                    DOMElements.modalTitle.textContent = title;

                    DOMElements.modalBody.innerHTML = ''; // Kosongkan body
                    if (typeof content === 'string') {
                        DOMElements.modalBody.innerHTML = content; // Hati-hati XSS jika content dari user
                    } else if (content instanceof Node) {
                        DOMElements.modalBody.appendChild(content);
                    }

                    DOMElements.modalFooter.innerHTML = ''; // Kosongkan footer
                    actions.forEach(action => {
                        const btn = Utils.createElement('button', { class: `btn ${action.class || 'btn-primary'}` }, action.text);
                        btn.addEventListener('click', () => {
                            if (action.handler) action.handler();
                            if (action.closesModal !== false) close(); // Tutup modal defaultnya
                        });
                        DOMElements.modalFooter.appendChild(btn);
                    });
                    if (actions.length === 0) { // Jika tidak ada action, tambahkan tombol tutup default
                        const closeBtn = Utils.createElement('button', { class: 'btn btn-outline-primary' }, 'Tutup');
                        closeBtn.addEventListener('click', close);
                        DOMElements.modalFooter.appendChild(closeBtn);
                    }


                    DOMElements.modal.removeAttribute('hidden');
                    // Force reflow untuk transisi
                    void DOMElements.modal.offsetWidth;
                    DOMElements.modal.classList.add('open');
                    document.body.style.overflow = 'hidden'; // Mencegah scroll background
                }

                function close() {
                    DOMElements.modal.classList.remove('open');
                    DOMElements.modal.addEventListener('transitionend', () => {
                        DOMElements.modal.setAttribute('hidden', true);
                        document.body.style.overflow = ''; // Kembalikan scroll background
                    }, { once: true });
                }

                function init() {
                    DOMElements.modalCloseBtns.forEach(btn => btn.addEventListener('click', close));
                    DOMElements.modalOverlay.addEventListener('click', close); // Tutup saat klik overlay

                    // Tutup dengan tombol Escape
                    document.addEventListener('keydown', (event) => {
                        if (event.key === 'Escape' && DOMElements.modal.classList.contains('open')) {
                            close();
                        }
                    });
                }
                return { init, open, close };
            })();

            // === Router dan Rendering Halaman ===
            const Router = (() => {
                const routes = {
                    'dashboard': { title: 'Dashboard', render: renderDashboardPage, icon: 'bi-grid-1x2-fill' },
                    'listings': { title: 'Listing Apartemen', render: renderListingsPage, icon: 'bi-list-task' },
                    'bookings': { title: 'Pemesanan Saya', render: renderBookingsPage, icon: 'bi-calendar-check-fill' },
                    'messages': { title: 'Pesan', render: renderMessagesPage, icon: 'bi-chat-dots-fill' },
                    'profile': { title: 'Profil Saya', render: renderProfilePage, icon: 'bi-person-circle' },
                    'settings': { title: 'Pengaturan', render: renderSettingsPage, icon: 'bi-gear-fill' },
                    // 'logout': { title: 'Keluar', action: handleLogout } // Bisa ditangani langsung
                };

                function renderNotFoundPage() {
                    const pageWrapper = Utils.createElement('div', { class: 'page-container text-center' });
                    pageWrapper.innerHTML = `
                <i class="bi bi-emoji-frown" style="font-size: 5rem; color: var(--primary-color); margin-bottom: var(--spacing-lg);"></i>
                <h1>404 - Halaman Tidak Ditemukan</h1>
                <p>Maaf, halaman yang Anda cari tidak ada atau telah dipindahkan.</p>
                <a href="#dashboard" class="btn btn-primary"><i class="bi bi-house-door-fill"></i> Kembali ke Dashboard</a>
            `;
                    return pageWrapper;
                }

                function loadPage(pageId) {
                    appState.currentPage = pageId;
                    const route = routes[pageId] || { title: 'Error 404', render: renderNotFoundPage };

                    DOMElements.content.innerHTML = ''; // Kosongkan konten lama
                    // Tambahkan efek loading sederhana
                    const loadingIndicator = Utils.createElement('div', { class: 'placeholder-glow', style: 'padding: var(--spacing-xl); text-align: center;' });
                    loadingIndicator.innerHTML = `
                <span class="placeholder h-20 w-50" style="margin-bottom: var(--spacing-md);"></span>
                <span class="placeholder w-100" style="margin-bottom: var(--spacing-sm);"></span>
                <span class="placeholder w-75"></span>`;
                    DOMElements.content.appendChild(loadingIndicator);

                    // Simulasi network delay untuk loading
                    setTimeout(() => {
                        DOMElements.content.innerHTML = ''; // Hapus loading indicator
                        const pageContent = route.render();
                        DOMElements.content.appendChild(pageContent);
                        DOMElements.pageTitle.textContent = route.title;
                        document.title = `${route.title} - ${appConfig.appName}`;
                        updateActiveNavLink(pageId);
                    }, 200); // Penundaan kecil untuk UX
                }

                function updateActiveNavLink(pageId) {
                    DOMElements.navLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('data-page') === pageId) {
                            link.classList.add('active');
                        }
                    });
                }

                function handleHashChange() {
                    const hash = window.location.hash.substring(1) || appConfig.defaultPage;
                    if (hash === 'logout') {
                        handleLogout();
                        window.location.hash = appConfig.defaultPage; // Redirect ke dashboard setelah logout
                    } else {
                        loadPage(hash);
                    }
                }

                function init() {
                    DOMElements.navLinks.forEach(link => {
                        link.addEventListener('click', (e) => {
                            // Untuk mobile, tutup sidebar setelah klik navigasi
                            if (window.innerWidth <= 992 && appState.sidebarOpen) {
                                Sidebar.toggle(false);
                            }
                            // Biarkan default behavior (mengubah hash) terjadi
                        });
                    });

                    window.addEventListener('hashchange', handleHashChange);
                    handleHashChange(); // Muat halaman awal berdasarkan hash
                }
                return { init, loadPage };
            })();

            // === Fungsi Render untuk Setiap Halaman ===
            // Ini adalah tempat Anda mendefinisikan konten untuk setiap halaman.
            // Saya akan memberikan contoh untuk beberapa halaman.

            function renderDashboardPage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                pageWrapper.innerHTML = `
            <div class="page-header">
                <h1>Selamat Datang, ${Utils.sanitizeHTML(appState.user.name)}!</h1>
                <p>Ini adalah ringkasan aktivitas Anda di Green Valley.</p>
            </div>
            
            <div class="grid-container lg-grid-cols-2 grid-cols-4" style="margin-bottom: var(--spacing-xl);">
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-building-check" style="font-size: 2.5rem; color: var(--primary-color); margin-bottom: var(--spacing-sm);"></i>
                        <h3 class="card-title" style="font-size: var(--font-size-2xl); margin-bottom: var(--spacing-xs);">12</h3>
                        <p style="color: var(--neutral-subtle-text-color); margin-bottom:0;">Apartemen Tersedia</p>
                    </div>
                </div>
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-calendar2-event-fill" style="font-size: 2.5rem; color: var(--secondary-color); margin-bottom: var(--spacing-sm);"></i>
                        <h3 class="card-title" style="font-size: var(--font-size-2xl); margin-bottom: var(--spacing-xs);">3</h3>
                        <p style="color: var(--neutral-subtle-text-color); margin-bottom:0;">Pemesanan Aktif</p>
                    </div>
                </div>
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-envelope-fill" style="font-size: 2.5rem; color: var(--accent-color); margin-bottom: var(--spacing-sm);"></i>
                        <h3 class="card-title" style="font-size: var(--font-size-2xl); margin-bottom: var(--spacing-xs);">5</h3>
                        <p style="color: var(--neutral-subtle-text-color); margin-bottom:0;">Pesan Belum Dibaca</p>
                    </div>
                </div>
                <div class="card text-center">
                    <div class="card-body">
                        <i class="bi bi-wallet2" style="font-size: 2.5rem; color: var(--info-color); margin-bottom: var(--spacing-sm);"></i>
                        <h3 class="card-title" style="font-size: var(--font-size-2xl); margin-bottom: var(--spacing-xs);">Rp 1.5Jt</h3>
                        <p style="color: var(--neutral-subtle-text-color); margin-bottom:0;">Tagihan Bulan Ini</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Notifikasi Terbaru</h3>
                </div>
                <div class="card-body">
                    <ul id="dashboard-notifications" class="list-unstyled">
                        <li style="padding: var(--spacing-sm) 0; border-bottom: 1px solid var(--neutral-divider-color);">
                            <i class="bi bi-info-circle-fill text-info"></i> Pembaruan sistem akan dilakukan malam ini.
                        </li>
                        <li style="padding: var(--spacing-sm) 0; border-bottom: 1px solid var(--neutral-divider-color);">
                            <i class="bi bi-check-circle-fill text-success"></i> Pembayaran tagihan apartemen Cendana berhasil.
                        </li>
                        <li style="padding: var(--spacing-sm) 0;">
                            <i class="bi bi-exclamation-triangle-fill text-warning"></i> Ada 1 unit apartemen favorit Anda yang akan segera habis masa sewanya.
                        </li>
                    </ul>
                </div>
            </div>
        `;
                // Contoh interaksi:
                const statsCards = pageWrapper.querySelectorAll('.grid-container .card');
                statsCards.forEach(card => {
                    card.style.cursor = 'pointer';
                    card.addEventListener('click', () => {
                        Toast.show(`Anda mengklik kartu: ${card.querySelector('p').textContent}`, 'info', 'Info Kartu');
                    });
                });
                return pageWrapper;
            }

            function renderListingsPage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                let listingsHTML = `
            <div class="page-header">
                <h1>Listing Apartemen</h1>
                <p>Temukan apartemen impian Anda di sini.</p>
            </div>
            <div class="action-bar" style="margin-bottom: var(--spacing-lg); display:flex; justify-content:space-between; align-items:center;">
                 <input type="search" id="listing-search" class="form-control" placeholder="Cari berdasarkan nama atau lokasi..." style="max-width: 300px;">
                 <button id="add-listing-btn" class="btn btn-primary"><i class="bi bi-plus-circle-fill"></i> Tambah Listing Baru</button>
            </div>
            <div id="listing-cards-container" class="grid-container grid-cols-1 md-grid-cols-1 lg-grid-cols-2">
        `;

                // Data contoh listing (dalam aplikasi nyata, ini dari API)
                const sampleListings = [
                    { id: 1, name: 'Apartemen Sudirman Park', location: 'Jakarta Pusat', price: 'Rp 8.000.000/bulan', beds: 2, baths: 1, area: 60, image: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60', available: true },
                    { id: 2, name: 'Green Bay Pluit', location: 'Jakarta Utara', price: 'Rp 5.500.000/bulan', beds: 1, baths: 1, area: 45, image: 'https://images.unsplash.com/photo-1616047006789-b7af5afb8c20?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8M3x8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60', available: false },
                    { id: 3, name: 'Bassura City Apartment', location: 'Jakarta Timur', price: 'Rp 4.000.000/bulan', beds: 2, baths: 1, area: 50, image: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=500&q=60', available: true },
                ];

                sampleListings.forEach(apt => {
                    listingsHTML += `
                <div class="card listing-card" data-id="${apt.id}">
                    <img src="${Utils.sanitizeHTML(apt.image)}" alt="${Utils.sanitizeHTML(apt.name)}" style="width:100%; height: 200px; object-fit:cover; border-top-left-radius: var(--border-radius-lg); border-top-right-radius: var(--border-radius-lg);">
                    <div class="card-body">
                        <h3 class="card-title">${Utils.sanitizeHTML(apt.name)}</h3>
                        <p style="color: var(--neutral-subtle-text-color); font-size: var(--font-size-sm); margin-bottom: var(--spacing-sm);"><i class="bi bi-geo-alt-fill"></i> ${Utils.sanitizeHTML(apt.location)}</p>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-md); font-size: var(--font-size-sm);">
                            <span><i class="bi bi-door-open-fill"></i> ${apt.beds} KT</span>
                            <span><i class="bi bi-droplet-half"></i> ${apt.baths} KM</span>
                            <span><i class="bi bi-rulers"></i> ${apt.area} m²</span>
                        </div>
                        <p style="font-size: var(--font-size-lg); font-weight: 600; color: var(--secondary-color); margin-bottom: var(--spacing-md);">${Utils.sanitizeHTML(apt.price)}</p>
                        ${apt.available ? '<span class="badge bg-success" style="background-color: var(--success-color); color: white; padding: var(--spacing-xs) var(--spacing-sm);">Tersedia</span>' : '<span class="badge bg-danger" style="background-color: var(--danger-color); color: white; padding: var(--spacing-xs) var(--spacing-sm);">Tidak Tersedia</span>'}
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-sm btn-outline-primary view-details-btn"><i class="bi bi-eye-fill"></i> Detail</button>
                        <button class="btn btn-sm btn-primary book-now-btn" ${!apt.available ? 'disabled' : ''}><i class="bi bi-calendar-plus-fill"></i> Pesan</button>
                    </div>
                </div>
            `;
                });
                listingsHTML += `</div>`; // Akhir dari listing-cards-container
                pageWrapper.innerHTML = listingsHTML;

                // Interaksi untuk halaman listing
                Utils.delegateEvent(pageWrapper, '.view-details-btn', 'click', (event) => {
                    const card = event.target.closest('.listing-card');
                    const aptId = card.dataset.id;
                    const apt = sampleListings.find(a => a.id == aptId);
                    Modal.open(`Detail: ${apt.name}`,
                        `<img src="${apt.image}" alt="${apt.name}" style="width:100%; max-height: 250px; object-fit:cover; border-radius: var(--border-radius-md); margin-bottom: var(--spacing-md);"/>
                 <p><strong>Lokasi:</strong> ${apt.location}</p>
                 <p><strong>Harga:</strong> ${apt.price}</p>
                 <p><strong>Detail:</strong> ${apt.beds} Kamar Tidur, ${apt.baths} Kamar Mandi, Luas ${apt.area} m²</p>
                 <p>Fasilitas: Kolam renang, gym, parkir, keamanan 24 jam.</p>`,
                        [
                            { text: 'Pesan Sekarang', class: 'btn-primary', handler: () => Toast.show(`Proses pemesanan untuk ${apt.name} dimulai.`, 'info'), closesModal: apt.available },
                            { text: 'Tutup', class: 'btn-outline-primary', handler: () => { }, closesModal: true }
                        ]
                    );
                });

                Utils.delegateEvent(pageWrapper, '.book-now-btn', 'click', (event) => {
                    const card = event.target.closest('.listing-card');
                    const aptId = card.dataset.id;
                    const apt = sampleListings.find(a => a.id == aptId);
                    Toast.show(`Anda telah memilih untuk memesan ${apt.name}.`, 'success', 'Pemesanan');
                });

                pageWrapper.querySelector('#add-listing-btn').addEventListener('click', () => {
                    Toast.show('Fungsi tambah listing belum diimplementasikan.', 'info', 'Informasi');
                });

                return pageWrapper;
            }

            function renderBookingsPage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                pageWrapper.innerHTML = `
            <div class="page-header">
                <h1>Pemesanan Saya</h1>
                <p>Lihat riwayat dan status pemesanan apartemen Anda.</p>
            </div>
            <div class="card">
                <div class="card-body">
                    <p>Tidak ada pemesanan aktif saat ini.</p>
                    <a href="#listings" class="btn btn-primary"><i class="bi bi-search"></i> Cari Apartemen</a>
                </div>
            </div>
        `;
                return pageWrapper;
            }

            function renderMessagesPage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                pageWrapper.innerHTML = `
            <div class="page-header">
                <h1>Pesan</h1>
                <p>Komunikasi dengan pemilik atau pengelola apartemen.</p>
            </div>
            <div class="card">
                <div class="card-body" style="text-align:center;">
                    <i class="bi bi-chat-quote-fill" style="font-size: 4rem; color: var(--primary-color); margin-bottom: var(--spacing-md);"></i>
                    <p>Anda belum memiliki pesan.</p>
                    <p class="text-muted" style="font-size: var(--font-size-sm);">Fitur pesan akan segera tersedia.</p>
                </div>
            </div>
        `;
                return pageWrapper;
            }

            function renderProfilePage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                pageWrapper.innerHTML = `
            <div class="page-header">
                <h1>Profil Saya</h1>
                <p>Kelola informasi akun dan preferensi Anda.</p>
            </div>
            <div class="card">
                <div class="card-body">
                    <form id="profile-form">
                        <div style="text-align: center; margin-bottom: var(--spacing-lg);">
                            <img src="${Utils.sanitizeHTML(appState.user.avatar)}" alt="Avatar Pengguna" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 3px solid var(--primary-color); margin-bottom: var(--spacing-sm);">
                            <button type="button" class="btn btn-sm btn-outline-primary"><i class="bi bi-pencil-square"></i> Ganti Foto</button>
                        </div>
                        <div class="form-group">
                            <label for="profile-name" class="form-label">Nama Lengkap</label>
                            <input type="text" id="profile-name" class="form-control" value="${Utils.sanitizeHTML(appState.user.name)}" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-email" class="form-label">Alamat Email</label>
                            <input type="email" id="profile-email" class="form-control" value="${Utils.sanitizeHTML(appState.user.email)}" required>
                        </div>
                        <div class="form-group">
                            <label for="profile-phone" class="form-label">Nomor Telepon</label>
                            <input type="tel" id="profile-phone" class="form-control" placeholder="Contoh: 081234567890">
                        </div>
                        <div class="form-group">
                            <label for="profile-password" class="form-label">Kata Sandi Baru (opsional)</label>
                            <input type="password" id="profile-password" class="form-control" placeholder="Masukkan kata sandi baru jika ingin mengubah">
                        </div>
                        <button type="submit" class="btn btn-primary"><i class="bi bi-save-fill"></i> Simpan Perubahan</button>
                    </form>
                </div>
            </div>
        `;
                const profileForm = pageWrapper.querySelector('#profile-form');
                profileForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const newName = profileForm.querySelector('#profile-name').value;
                    const newEmail = profileForm.querySelector('#profile-email').value;

                    // Update state (simulasi)
                    appState.user.name = newName;
                    appState.user.email = newEmail;
                    UserMenu.updateUserInfo(); // Update tampilan di header

                    Toast.show('Profil berhasil diperbarui!', 'success', 'Sukses');
                });
                return pageWrapper;
            }

            function renderSettingsPage() {
                const pageWrapper = Utils.createElement('div', { class: 'page-container' });
                pageWrapper.innerHTML = `
            <div class="page-header">
                <h1>Pengaturan Aplikasi</h1>
                <p>Sesuaikan preferensi tampilan dan notifikasi aplikasi.</p>
            </div>
            <div class="card">
                <div class="card-header"><h3 class="card-title">Tema Tampilan</h3></div>
                <div class="card-body">
                    <p>Pilih tema tampilan aplikasi Anda:</p>
                    <div class="form-group">
                        <select id="theme-selector" class="form-control" style="max-width: 250px;">
                            <option value="light" ${appState.theme === 'light' ? 'selected' : ''}>Terang (Light)</option>
                            <option value="dark" ${appState.theme === 'dark' ? 'selected' : ''}>Gelap (Dark)</option>
                            <option value="system" ${appState.theme === 'system' ? 'selected' : ''}>Sesuai Sistem</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="card">
                <div class="card-header"><h3 class="card-title">Notifikasi</h3></div>
                <div class="card-body">
                    <div class="form-check form-switch"> <!-- Contoh toggle switch, perlu styling tambahan jika ingin custom -->
                        <input class="form-check-input" type="checkbox" role="switch" id="email-notifications" checked>
                        <label class="form-check-label" for="email-notifications">Notifikasi Email untuk Pemesanan Baru</label>
                    </div>
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" role="switch" id="push-notifications">
                        <label class="form-check-label" for="push-notifications">Notifikasi Push untuk Pesan Penting</label>
                    </div>
                </div>
                <div class="card-footer">
                    <button class="btn btn-primary"><i class="bi bi-save"></i> Simpan Pengaturan</button>
                </div>
            </div>
        `;

                const themeSelector = pageWrapper.querySelector('#theme-selector');
                themeSelector.addEventListener('change', (e) => {
                    setTheme(e.target.value);
                    Toast.show(`Tema diubah menjadi ${e.target.options[e.target.selectedIndex].text}`, 'info', 'Perubahan Tema');
                });
                return pageWrapper;
            }

            // === Logika Autentikasi Sederhana (Contoh) ===
            function handleLogout() {
                // Simulasi logout
                appState.user = { name: 'Pengguna Guest', email: 'guest@Green Valley.id', avatar: 'https://i.pravatar.cc/40?u=guest', isLoggedIn: false };
                UserMenu.updateUserInfo();
                Toast.show('Anda telah berhasil keluar.', 'success', 'Logout Berhasil');
                // Di aplikasi nyata, Anda akan membersihkan token, dll.
                // Redirect ke halaman login jika ada, atau dashboard untuk guest
                window.location.hash = appConfig.defaultPage;
            }

            // === Fungsi Tema ===
            function applyTheme(theme) {
                document.documentElement.classList.remove('theme-light', 'theme-dark');
                if (theme === 'light') {
                    document.documentElement.classList.add('theme-light');
                } else if (theme === 'dark') {
                    document.documentElement.classList.add('theme-dark');
                } else { // system
                    // Hapus kelas eksplisit, biarkan @media (prefers-color-scheme) bekerja
                }
                // Perbarui warna meta theme-color jika perlu
                const themeColorMeta = document.querySelector('meta[name="theme-color"]');
                if (themeColorMeta) {
                    if (theme === 'dark') {
                        themeColorMeta.content = getComputedStyle(document.documentElement).getPropertyValue('--neutral-bg-color').trim() || '#111827';
                    } else { // light atau system (default ke light)
                        themeColorMeta.content = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim() || '#6366f1';
                    }
                }
            }

            function setTheme(theme) {
                appState.theme = theme;
                localStorage.setItem('appTheme', theme);
                applyTheme(theme);
            }

            // === Inisialisasi Aplikasi ===
            function init() {
                // Update tahun di footer
                if (DOMElements.currentYearSpan) {
                    DOMElements.currentYearSpan.textContent = new Date().getFullYear();
                }

                // Inisialisasi tema
                applyTheme(appState.theme);

                // Inisialisasi komponen UI
                Sidebar.init();
                UserMenu.init();
                Modal.init();
                Router.init(); // Router harus diinisialisasi terakhir setelah semua siap

                // Atur event listener untuk tombol logout
                DOMElements.logoutButtons.forEach(button => {
                    button.addEventListener('click', (e) => {
                        e.preventDefault();
                        handleLogout();
                    });
                });

                // Listener untuk tombol notifikasi (contoh)
                if (DOMElements.notificationBtn) {
                    DOMElements.notificationBtn.addEventListener('click', () => {
                        Toast.show('Tidak ada notifikasi baru saat ini.', 'info', 'Notifikasi');
                        DOMElements.notificationBtn.querySelector('.notification-dot')?.remove(); // Hilangkan dot jika ada
                    });
                }

                // Sembunyikan preloader setelah inisialisasi
                setTimeout(() => {
                    if (DOMElements.preloader) DOMElements.preloader.classList.add('hidden');
                }, appConfig.preloaderTimeout);

                console.log(`${appConfig.appName} SPA berhasil diinisialisasi.`);
            }

            // === Event Listener Global ===
            document.addEventListener('DOMContentLoaded', init);

            // === Ekspor API Publik (jika ada) ===
            // Untuk aplikasi ini, semua bersifat internal.
            // Jika ingin expose fungsi, misal App.showToast(), bisa di-return di sini.
            return {
                showToast: Toast.show,
                openModal: Modal.open,
                closeModal: Modal.close,
                // Dapat menambahkan fungsi lain yang ingin diakses dari luar modul
                // misalnya dari console untuk debugging: App.getState()
                getState: () => JSON.parse(JSON.stringify(appState)) // deep copy untuk read-only
            };

        })();

        // Jika menggunakan PWA dengan Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js') // Sesuaikan path jika sw.js tidak di root
                    .then(registration => {
                        console.log('ServiceWorker terdaftar dengan scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('Pendaftaran ServiceWorker gagal:', error);
                    });
            });
        }// sw.js - Service Worker Sederhana

        const CACHE_NAME = 'Green Valley-cache-v1';
        const urlsToCache = [
            '/',
            '/index.html',
            '/style.css',
            '/app.js',
            '/manifest.json',
            // Tambahkan path ke ikon-ikon Anda di sini
            '/icons/icon-192x192.png',
            // Tambahkan font atau aset penting lainnya jika ada yang di-host lokal
            'https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css',
            'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap'
            // Jangan cache API eksternal yang sering berubah atau dinamis di sini secara default
        ];

        // Instalasi Service Worker: Cache aset dasar
        self.addEventListener('install', event => {
            event.waitUntil(
                caches.open(CACHE_NAME)
                    .then(cache => {
                        console.log('Cache dibuka, menambahkan aset dasar ke cache');
                        return cache.addAll(urlsToCache.map(url => new Request(url, { mode: 'no-cors' })));
                    })
                    .catch(error => {
                        console.error('Gagal menambahkan aset ke cache saat instalasi:', error);
                    })
            );
        });

        // Aktivasi Service Worker: Hapus cache lama
        self.addEventListener('activate', event => {
            event.waitUntil(
                caches.keys().then(cacheNames => {
                    return Promise.all(
                        cacheNames.map(cacheName => {
                            if (cacheName !== CACHE_NAME) {
                                console.log('Service Worker: menghapus cache lama', cacheName);
                                return caches.delete(cacheName);
                            }
                        })
                    );
                })
            );
            return self.clients.claim(); // Ambil kontrol halaman yang tidak terkontrol segera
        });

        // Fetch Event: Menyajikan aset dari cache jika tersedia (Cache First Strategy)
        self.addEventListener('fetch', event => {
            // Hanya tangani request GET
            if (event.request.method !== 'GET') {
                return;
            }

            event.respondWith(
                caches.match(event.request)
                    .then(response => {
                        // Jika aset ditemukan di cache, kembalikan dari cache
                        if (response) {
                            return response;
                        }

                        // Jika tidak ada di cache, coba ambil dari network
                        return fetch(event.request.clone()).then( // Clone request karena stream hanya bisa dibaca sekali
                            networkResponse => {
                                // Jika gagal fetch dari network (offline atau error), jangan cache error response
                                if (!networkResponse || networkResponse.status !== 200 || networkResponse.type !== 'basic' && networkResponse.type !== 'cors') {
                                    return networkResponse;
                                }

                                // Jika berhasil, cache respons dan kembalikan
                                // Ini berguna untuk aset yang tidak di-precache tapi diakses kemudian
                                const responseToCache = networkResponse.clone(); // Clone lagi untuk cache
                                caches.open(CACHE_NAME)
                                    .then(cache => {
                                        cache.put(event.request, responseToCache);
                                    });
                                return networkResponse;
                            }
                        ).catch(error => {
                            // Tangani error fetch (misalnya, saat offline dan tidak ada di cache)
                            console.error('Fetch gagal; mengembalikan offline page jika ada atau error:', error);
                            // Anda bisa mengembalikan halaman offline kustom di sini jika ada
                            // return caches.match('/offline.html'); 
                        });
                    })
            );
        });
    </script>
</body>

</html>