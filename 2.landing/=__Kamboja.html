<!DOCTYPE html>
<html lang="id" data-theme="light">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
  <meta name="description"
    content="Green Valley - Platform manajemen properti sewa modern dengan fitur lengkap untuk pemilik dan pengelola properti di Indonesia. Kelola unit, lacak penyewa, dan optimalkan keuangan dalam satu dasbor intuitif dan elegan." />
  <meta name="keywords"
    content="Manajemen Properti Sewa, Apartemen, Penyewa, Dasbor Admin, Pemesanan Digital, Tur Virtual, Sistem Pembayaran Online, Green Valley, Properti Teknologi" />
  <meta name="author" content="Tim Green Valley" />
  <meta name="robots" content="index, follow" />
  <title>Green Valley - Manajemen Properti Sewa Modern</title>

  <!-- Favicon (PNG Base64 - Menggantikan SVG untuk memenuhi permintaan) -->
  <link rel="icon"
    href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARKSURBVHhe7ZxLbxxVFMfXG03NqJs2p9Nhd5dSmqZNaFNmNGkjqgq1RaP9AyoqIpLI7gLFByuiCCoKxIcooqKCH1AgLygqCAqi+AOIL7J7xT6gKFZk7+zM3HPmPs4/M5N252T3XHNMVW/ySQnZnXO+c/4553d2GgBHR0c5ODjQYDAYP3LkyPq1ep1uNhuNRoM0Ta/XG2L75XL5P4L/qRZXU6q55gohhL6+PnPnzp2hUCgQBEEcx3Nzc/kPAv+xFleTrqlmWyCE6urq5OTkRCaTiWEYURQlhBBxHMdxxHBcXV39PzH8z1ZcTbqlmq0AARFCrFarzs7OxGIxHMfFYrFGozGKomg2m8XjcZPJZHR0dPzPTD+1xXVN1VxdXb2/v18cxyuVSuT3gEwmw3EcQRBBEHiex3GcUgohhBDCOI6O4wghsCwLz/OaprGsiuM4juPxfPbsWQzD5HI5AOC6Lkop9/f39ff3y7LsiqJoGCYIAgB0XQehLQCgKAqaprEsy3Nzc9bV1XFcXzAYFAgEAChL03QURfF9nz171vb2drFYTBRFLcsCVVUF8Dzf9wKAOI7xPM/zPABAURSSJAFSgiAIgiAIALquIwiyLAtFUUVR9Pv9qdVqURSGYQAAURSGYTQajQBQFPv7+xRFEUREKpUKBoOCwWB+vx8A8Pl8iKIIIYy5XC6bzQIAKIoSiqLruiRJwjAMy7JcLpfNZtPpdAAAfX19lFLq+/uT04PrugCA3++Pcb1ejwAAhmGMxWL4vo8QwsTDIklyUeP8sDgcDkEcFwqF8DwPCIFpmiAIlmVZljVNkwDhOM5ms3NychKDYQCAGIZxV0EAYRiGIQQAIATCMExTlOd5x3E0TSMIglBKURRpmqIoSlEUlmVxXNd1KQDhcDgyZpEgCAzDsCwLlmWaptNqtSwWi729vdvbm06nc7vdURRljDkIAgihOI40TdM0TVEUtVotTdPM8zzPMzE4AKCuaZoKz/PValUQBKlUimVZgBBCGIbRaDRBEARBECzLYlpYlqVpGkVRURRPp1NN0zRNhRAOhwMA3nvXdd0wjEwm02g0qKurS5KkMAzbtm19fb1cLhMAEATh8Xho08bFxTFNk6apEALGGGOMrutpmlIp8jyXUurlcpmWZWVZpmkKAFEUgWd5XdfDMAxDCIQQxhjHMaVUxhjHcVmWURSJaRoAwHEcBEEhhK7rUkrH4zFJltd1uVyOEALDMAzDCCGCIJBKpUwmc11XYRgGAAzDYFkWhiGEQNM0WZbDMAzDkCTJC/o881zXbdv2PM9pmgghPM/zPG8Yxp/P/g+K0yFMM00TCMEwDFmWlFIkSc4x74UQvu9/Pvv/oDqgQG3sPzOId/3C8F9M/h/mH8Y4jo7j6LouFArpdDpRFOfn5yUlJWloaFAURTUaDZmD1zRNJpOJv78/SZIxxiAIURTFcRxFUZRS6XQ6kiQxTZMAgiDneT5N0wghv/76KwCwWq3IZLK5uTnLslwuR5YlSRKGYSwWw/M8TdOaplEUhTAMWZZjWRbHcZIkURTlOA7DMAghuVyONM3Dw8PeffddQRBcLpfBYDAajdI0XZblcrncbreVSiXT6RRDkE6nMxgMHMf55ZdfLpfLpmkqCALf9wAAVVWJcRxFUZxzHhgMBkEQTdNgmubxeFAUpVQqUavVHMdBELx58+bc3BwpFWOMruuyLGscx+M4giD8+uuvTNMkhCDLsvf39+Pj49vb2xsbG7IsOzo6IggyDKMrCH5xcdEwjOd5WZb9/PPP8zyvKAqKoiQIWZY1TXt7e1mWJUmSlJQUAMBzPO7u7kophBDbtvPz8zzPcyyLsSybzWZFUbz66qtcLpfL5ZDL5eXl5bIsW6vVgiBgWRZGkkwmx3EcQRD9/f0IISRJQhCEIAjHcfb393d2dtJ0nWVZmqYVRcHn8+F5XpVKaZpOEATDMAghCCGIooiiaDabyWQSSZLruvM8D4LguroaBEFUKhWTydTr9TAMK5VKoVDIdDrNZrNBELBarRBCzPOEQNf1LMvXarXm5mYIIU3THMcRBGFjY4OQjLIsi8fjKIoSBKHdbkeSJDzPA8/znudzXZfneRRFTdNBEARBcH19neM4pRRCCIIgCBKGYTAYLJfLuq6LpmnHcTQae56nYRhhGKfTiSiKNE0TiqIkSba3t1FKpVKpdDodz/M0TeM4ztTUVABAKpVCCCGEcRxBEFQqFU3ThBBSSmEYouu6rutpmlKpFINBADAM8zwnCEJKKRRFBEFIkqSUCsdxCCHP8xBCiqLo9/upVLJaraqrq3EcDwQCBCEcDisUCvP5fBRFsSwLkSRBEARBEARBEEI0Gg1FURSGobhL8f9A5tG/AW7355M8+V3+AAAAAElFTkSuQmCC" />

  <!-- Font Awesome (Permintaan ikon online gratis) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Google Fonts (Inter) -->
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    as="style" onload="this.rel='stylesheet'">
  <noscript>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet" />
  </noscript>

  <style>
    /* =================================
       1. TOKEN DESAIN MODERN & FANCY
    ================================= */
    :root {
      --color-primary-h: 214;
      --color-primary-s: 90%;
      /* Sedikit lebih vibrant */
      --color-primary-l: 58%;
      --color-primary: hsl(var(--color-primary-h), var(--color-primary-s), var(--color-primary-l));
      --color-primary-dark: hsl(var(--color-primary-h), 75%, 48%);
      --color-primary-light: hsl(var(--color-primary-h), 95%, 94%);
      --color-accent-h: 40;
      --color-accent-s: 95%;
      --color-accent-l: 60%;
      --color-accent: hsl(var(--color-accent-h), var(--color-accent-s), var(--color-accent-l));
      --color-success: hsl(145, 65%, 45%);
      --color-danger: hsl(0, 85%, 60%);
      --color-warning: hsl(45, 90%, 55%);
      --color-info: hsl(190, 80%, 55%);

      --color-bg: hsl(220, 30%, 97%);
      --color-bg-alt: hsl(0, 0%, 100%);
      --color-bg-sidebar: hsl(var(--color-primary-h), 70%, 38%);
      --color-text: hsl(220, 25%, 20%);
      --color-text-light: hsl(0, 0%, 100%);
      --color-muted: hsl(220, 15%, 55%);
      --color-border: hsl(220, 20%, 88%);
      --color-border-input: hsl(220, 15%, 75%);
      --color-focus: hsla(var(--color-primary-h), var(--color-primary-s), var(--color-primary-l), 0.3);

      /* Fancy Shadows */
      --shadow-xs: 0 1px 2px hsla(var(--color-primary-h), 30%, 50%, 0.03), 0 1px 3px hsla(var(--color-primary-h), 30%, 50%, 0.05);
      --shadow-sm: 0 2px 4px hsla(var(--color-primary-h), 30%, 50%, 0.04), 0 3px 6px hsla(var(--color-primary-h), 30%, 50%, 0.06);
      --shadow-md: 0 4px 8px hsla(var(--color-primary-h), 30%, 50%, 0.05), 0 6px 12px hsla(var(--color-primary-h), 30%, 50%, 0.07);
      --shadow-lg: 0 10px 20px hsla(var(--color-primary-h), 30%, 50%, 0.07), 0 12px 25px hsla(var(--color-primary-h), 30%, 50%, 0.1);
      --shadow-inset: inset 0 2px 4px hsla(0, 0%, 0%, 0.06);

      /* Skala Tipografi */
      --font-main: 'Inter', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      --font-xs: 0.8rem;
      /* 12.8px */
      --font-sm: 0.875rem;
      /* 14px */
      --font-base: 1rem;
      /* 16px */
      --font-md: 1.125rem;
      /* 18px */
      --font-lg: 1.375rem;
      /* 22px */
      --font-xl: 1.75rem;
      /* 28px */
      --font-display-sm: 2rem;
      /* 32px */
      --font-display-md: 2.5rem;
      /* 40px */
      --font-display-lg: 3rem;
      /* 48px */

      /* Skala Spasi */
      --space-1: 0.25rem;
      /* 4px */
      --space-2: 0.5rem;
      /* 8px */
      --space-3: 0.75rem;
      /* 12px */
      --space-4: 1rem;
      /* 16px */
      --space-5: 1.25rem;
      /* 20px */
      --space-6: 1.5rem;
      /* 24px */
      --space-8: 2rem;
      /* 32px */
      --space-10: 2.5rem;
      /* 40px */
      --space-12: 3rem;
      /* 48px */

      /* Radius & Transisi */
      --radius-xs: 0.25rem;
      --radius-sm: 0.375rem;
      --radius-md: 0.5rem;
      --radius-lg: 0.75rem;
      --radius-xl: 1rem;
      --radius-full: 9999px;

      --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);

      /* Ukuran Kontainer */
      --container-max-width: 1280px;
      --sidebar-width: 260px;
    }

    [data-theme="dark"] {
      --color-primary-l: 62%;
      --color-primary-dark: hsl(var(--color-primary-h), 80%, 52%);
      --color-primary-light: hsl(var(--color-primary-h), 60%, 25%);

      --color-bg: hsl(220, 28%, 12%);
      --color-bg-alt: hsl(220, 25%, 18%);
      --color-bg-sidebar: hsl(var(--color-primary-h), 50%, 22%);
      --color-text: hsl(210, 40%, 95%);
      --color-muted: hsl(215, 20%, 70%);
      --color-border: hsl(217, 25%, 28%);
      --color-border-input: hsl(217, 20%, 40%);
      --color-focus: hsla(var(--color-primary-h), var(--color-primary-s), var(--color-primary-l), 0.25);

      --shadow-xs: 0 1px 2px hsla(0, 0%, 0%, 0.1), 0 1px 3px hsla(0, 0%, 0%, 0.15);
      --shadow-sm: 0 2px 4px hsla(0, 0%, 0%, 0.12), 0 3px 6px hsla(0, 0%, 0%, 0.18);
      --shadow-md: 0 4px 8px hsla(0, 0%, 0%, 0.15), 0 6px 12px hsla(0, 0%, 0%, 0.2);
      --shadow-lg: 0 10px 20px hsla(0, 0%, 0%, 0.2), 0 12px 25px hsla(0, 0%, 0%, 0.25);
    }

    /* =======================
       2. RESET & DASAR
    ======================== */
    *,
    *::before,
    *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    html {
      font-size: 100%;
      /* 16px */
      scroll-behavior: smooth;
      height: 100%;
    }

    body {
      font-family: var(--font-main);
      background-color: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
      transition: background-color var(--transition-normal), color var(--transition-normal);
      min-height: 100%;
      display: flex;
      flex-direction: column;
    }

    a {
      color: var(--color-primary);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    a:hover,
    a:focus {
      color: var(--color-primary-dark);
      outline: none;
      /* Penanganan focus state yang lebih baik di elemen spesifik */
    }

    img,
    picture,
    video,
    canvas {
      /* SVG dihapus dari daftar ini karena permintaan */
      display: block;
      max-width: 100%;
    }

    button,
    input,
    select,
    textarea {
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      color: inherit;
    }

    /* =======================
       3. UTILITAS LAYOUT & STYLE
    ======================== */
    .container {
      width: 100%;
      max-width: var(--container-max-width);
      margin-left: auto;
      margin-right: auto;
      padding-left: var(--space-4);
      padding-right: var(--space-4);
    }

    .d-flex {
      display: flex !important;
    }

    .d-grid {
      display: grid !important;
    }

    .d-block {
      display: block !important;
    }

    .d-none {
      display: none !important;
    }

    .flex-column {
      flex-direction: column !important;
    }

    .flex-wrap {
      flex-wrap: wrap !important;
    }

    .justify-content-start {
      justify-content: flex-start !important;
    }

    .justify-content-end {
      justify-content: flex-end !important;
    }

    .justify-content-center {
      justify-content: center !important;
    }

    .justify-content-between {
      justify-content: space-between !important;
    }

    .justify-content-around {
      justify-content: space-around !important;
    }

    .align-items-start {
      align-items: flex-start !important;
    }

    .align-items-end {
      align-items: flex-end !important;
    }

    .align-items-center {
      align-items: center !important;
    }

    .align-items-stretch {
      align-items: stretch !important;
    }

    .gap-1 {
      gap: var(--space-1);
    }

    .gap-2 {
      gap: var(--space-2);
    }

    .gap-3 {
      gap: var(--space-3);
    }

    .gap-4 {
      gap: var(--space-4);
    }

    .gap-5 {
      gap: var(--space-5);
    }

    .gap-6 {
      gap: var(--space-6);
    }

    .text-center {
      text-align: center !important;
    }

    .text-left {
      text-align: left !important;
    }

    .text-right {
      text-align: right !important;
    }

    .text-primary {
      color: var(--color-primary) !important;
    }

    .text-muted {
      color: var(--color-muted) !important;
    }

    .text-light {
      color: var(--color-text-light) !important;
    }

    .fw-300 {
      font-weight: 300 !important;
    }

    .fw-400 {
      font-weight: 400 !important;
    }

    .fw-500 {
      font-weight: 500 !important;
    }

    .fw-600 {
      font-weight: 600 !important;
    }

    .fw-700 {
      font-weight: 700 !important;
    }

    .fw-800 {
      font-weight: 800 !important;
    }

    .fs-xs {
      font-size: var(--font-xs) !important;
    }

    .fs-sm {
      font-size: var(--font-sm) !important;
    }

    .fs-base {
      font-size: var(--font-base) !important;
    }

    .fs-md {
      font-size: var(--font-md) !important;
    }

    .fs-lg {
      font-size: var(--font-lg) !important;
    }

    .fs-xl {
      font-size: var(--font-xl) !important;
    }

    .fs-display-sm {
      font-size: var(--font-display-sm) !important;
    }

    .fs-display-md {
      font-size: var(--font-display-md) !important;
    }

    .fs-display-lg {
      font-size: var(--font-display-lg) !important;
    }

    .p-1 {
      padding: var(--space-1) !important;
    }

    .py-1 {
      padding-top: var(--space-1) !important;
      padding-bottom: var(--space-1) !important;
    }

    .px-1 {
      padding-left: var(--space-1) !important;
      padding-right: var(--space-1) !important;
    }

    .p-2 {
      padding: var(--space-2) !important;
    }

    .py-2 {
      padding-top: var(--space-2) !important;
      padding-bottom: var(--space-2) !important;
    }

    .px-2 {
      padding-left: var(--space-2) !important;
      padding-right: var(--space-2) !important;
    }

    .p-3 {
      padding: var(--space-3) !important;
    }

    .py-3 {
      padding-top: var(--space-3) !important;
      padding-bottom: var(--space-3) !important;
    }

    .px-3 {
      padding-left: var(--space-3) !important;
      padding-right: var(--space-3) !important;
    }

    .p-4 {
      padding: var(--space-4) !important;
    }

    .py-4 {
      padding-top: var(--space-4) !important;
      padding-bottom: var(--space-4) !important;
    }

    .px-4 {
      padding-left: var(--space-4) !important;
      padding-right: var(--space-4) !important;
    }

    .p-5 {
      padding: var(--space-5) !important;
    }

    .py-5 {
      padding-top: var(--space-5) !important;
      padding-bottom: var(--space-5) !important;
    }

    .px-5 {
      padding-left: var(--space-5) !important;
      padding-right: var(--space-5) !important;
    }

    .p-6 {
      padding: var(--space-6) !important;
    }

    .py-6 {
      padding-top: var(--space-6) !important;
      padding-bottom: var(--space-6) !important;
    }

    .px-6 {
      padding-left: var(--space-6) !important;
      padding-right: var(--space-6) !important;
    }

    .m-1 {
      margin: var(--space-1) !important;
    }

    .my-1 {
      margin-top: var(--space-1) !important;
      margin-bottom: var(--space-1) !important;
    }

    .mx-1 {
      margin-left: var(--space-1) !important;
      margin-right: var(--space-1) !important;
    }

    .m-2 {
      margin: var(--space-2) !important;
    }

    .my-2 {
      margin-top: var(--space-2) !important;
      margin-bottom: var(--space-2) !important;
    }

    .mx-2 {
      margin-left: var(--space-2) !important;
      margin-right: var(--space-2) !important;
    }

    .m-3 {
      margin: var(--space-3) !important;
    }

    .my-3 {
      margin-top: var(--space-3) !important;
      margin-bottom: var(--space-3) !important;
    }

    .mx-3 {
      margin-left: var(--space-3) !important;
      margin-right: var(--space-3) !important;
    }

    .m-4 {
      margin: var(--space-4) !important;
    }

    .my-4 {
      margin-top: var(--space-4) !important;
      margin-bottom: var(--space-4) !important;
    }

    .mx-4 {
      margin-left: var(--space-4) !important;
      margin-right: var(--space-4) !important;
    }

    .m-5 {
      margin: var(--space-5) !important;
    }

    .my-5 {
      margin-top: var(--space-5) !important;
      margin-bottom: var(--space-5) !important;
    }

    .mx-5 {
      margin-left: var(--space-5) !important;
      margin-right: var(--space-5) !important;
    }

    .m-6 {
      margin: var(--space-6) !important;
    }

    .my-6 {
      margin-top: var(--space-6) !important;
      margin-bottom: var(--space-6) !important;
    }

    .mx-6 {
      margin-left: var(--space-6) !important;
      margin-right: var(--space-6) !important;
    }

    .mt-auto {
      margin-top: auto !important;
    }

    .w-100 {
      width: 100% !important;
    }

    .section {
      padding-top: var(--space-8);
      padding-bottom: var(--space-8);
    }

    .section-title {
      font-size: var(--font-display-sm);
      font-weight: var(--fw-700);
      margin-bottom: var(--space-2);
      color: var(--color-text);
    }

    .section-subtitle {
      font-size: var(--font-md);
      color: var(--color-muted);
      margin-bottom: var(--space-6);
      max-width: 600px;
      /* Batasi lebar subtitle agar mudah dibaca */
    }

    .section-title.text-center+.section-subtitle {
      margin-left: auto;
      margin-right: auto;
    }

    /* =======================
       4. KOMPONEN UMUM
    ======================== */
    .card {
      background-color: var(--color-bg-alt);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      padding: var(--space-6);
      transition: var(--transition-normal);
      border: 1px solid var(--color-border);
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .card-header {
      font-size: var(--font-lg);
      font-weight: var(--fw-600);
      padding-bottom: var(--space-4);
      margin-bottom: var(--space-4);
      border-bottom: 1px solid var(--color-border);
      color: var(--color-text);
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
      padding: var(--space-3) var(--space-5);
      font-weight: var(--fw-500);
      font-size: var(--font-sm);
      border: 1px solid transparent;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: var(--transition-fast);
      text-align: center;
      white-space: nowrap;
      user-select: none;
      /* Mencegah seleksi teks pada tombol */
    }

    .btn i {
      font-size: 1.1em;
      /* Buat ikon sedikit lebih besar dari teks */
    }

    .btn:focus-visible {
      outline: 2px solid var(--color-focus);
      outline-offset: 2px;
    }

    .btn:disabled,
    .btn.disabled {
      opacity: 0.65;
      cursor: not-allowed;
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: var(--color-text-light);
      border-color: var(--color-primary);
    }

    .btn-primary:hover:not(:disabled) {
      background-color: var(--color-primary-dark);
      border-color: var(--color-primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .btn-outline-primary {
      background-color: transparent;
      border-color: var(--color-primary);
      color: var(--color-primary);
    }

    .btn-outline-primary:hover:not(:disabled) {
      background-color: var(--color-primary);
      color: var(--color-text-light);
    }

    .btn-danger {
      background-color: var(--color-danger);
      color: var(--color-text-light);
      border-color: var(--color-danger);
    }

    .btn-danger:hover:not(:disabled) {
      background-color: hsl(0, 80%, 50%);
      border-color: hsl(0, 80%, 50%);
      transform: translateY(-2px);
      box-shadow: var(--shadow-sm);
    }

    .btn-sm {
      padding: var(--space-2) var(--space-3);
      font-size: var(--font-xs);
    }

    .btn-lg {
      padding: var(--space-4) var(--space-6);
      font-size: var(--font-base);
    }

    .form-group {
      margin-bottom: var(--space-4);
    }

    .form-group label {
      display: block;
      margin-bottom: var(--space-2);
      font-weight: var(--fw-500);
      font-size: var(--font-sm);
      color: var(--color-text);
    }

    .form-control,
    .form-select {
      display: block;
      width: 100%;
      padding: var(--space-3) var(--space-4);
      font-size: var(--font-base);
      font-weight: var(--fw-400);
      line-height: 1.5;
      color: var(--color-text);
      background-color: var(--color-bg-alt);
      background-clip: padding-box;
      border: 1px solid var(--color-border-input);
      appearance: none;
      /* Hapus tampilan default OS */
      border-radius: var(--radius-md);
      transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
    }

    .form-control:focus,
    .form-select:focus {
      border-color: var(--color-primary);
      outline: 0;
      box-shadow: 0 0 0 0.2rem var(--color-focus);
    }

    .form-control::placeholder {
      color: var(--color-muted);
      opacity: 0.8;
    }

    .form-error {
      display: none;
      /* Akan ditampilkan oleh JS */
      width: 100%;
      margin-top: var(--space-1);
      font-size: var(--font-xs);
      color: var(--color-danger);
    }

    .form-control.is-invalid,
    .form-select.is-invalid {
      border-color: var(--color-danger);
    }

    .form-control.is-invalid:focus,
    .form-select.is-invalid:focus {
      box-shadow: 0 0 0 0.2rem hsla(0, 85%, 60%, 0.25);
    }

    .is-invalid~.form-error {
      display: block;
    }

    .badge {
      display: inline-block;
      padding: var(--space-1) var(--space-2);
      font-size: var(--font-xs);
      font-weight: var(--fw-600);
      line-height: 1;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: var(--radius-sm);
    }

    .badge-success {
      background-color: var(--color-success);
      color: var(--color-text-light);
    }

    .badge-danger {
      background-color: var(--color-danger);
      color: var(--color-text-light);
    }

    .badge-warning {
      background-color: var(--color-warning);
      color: var(--color-text);
    }

    .badge-info {
      background-color: var(--color-info);
      color: var(--color-text-light);
    }

    .badge-primary {
      background-color: var(--color-primary);
      color: var(--color-text-light);
    }

    .badge-secondary {
      background-color: var(--color-muted);
      color: var(--color-text-light);
    }

    /* =======================
       5. STRUKTUR UTAMA
    ======================== */
    .app-wrapper {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* HEADER */
    .app-header {
      background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
      color: var(--color-text-light);
      padding: var(--space-4) 0;
      box-shadow: var(--shadow-md);
      position: sticky;
      /* Membuat header tetap di atas saat scroll */
      top: 0;
      z-index: 1000;
    }

    .app-header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-logo {
      font-size: var(--font-lg);
      font-weight: var(--fw-700);
      color: var(--color-text-light);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }

    .header-logo i {
      font-size: 1.5em;
      /* Ikon logo lebih besar */
    }

    .theme-toggle {
      background: transparent;
      color: var(--color-text-light);
      border: 1px solid hsla(0, 0%, 100%, 0.5);
      padding: var(--space-2) var(--space-3);
    }

    .theme-toggle:hover {
      background: hsla(0, 0%, 100%, 0.1);
      border-color: var(--color-text-light);
    }

    /* DASHBOARD LAYOUT (SIDEBAR + MAIN CONTENT) */
    .dashboard-layout {
      display: flex;
      flex-grow: 1;
      /* Agar mengisi sisa tinggi viewport */
    }

    /* SIDEBAR */
    .sidebar {
      background-color: var(--color-bg-sidebar);
      color: var(--color-text-light);
      width: var(--sidebar-width);
      height: calc(100vh - (var(--space-4) * 2 + 1.5em * 1.6 + var(--space-4)));
      /* 100vh - tinggi header */
      position: sticky;
      top: calc(var(--space-4) * 2 + 1.5em * 1.6 + var(--space-4));
      /* Tinggi header */
      left: 0;
      padding: var(--space-6) var(--space-4);
      overflow-y: auto;
      transition: width var(--transition-normal);
      z-index: 999;
      display: flex;
      flex-direction: column;
    }

    .sidebar-logo {
      font-size: var(--font-xl);
      font-weight: var(--fw-700);
      color: var(--color-text-light);
      text-align: center;
      margin-bottom: var(--space-6);
      padding-bottom: var(--space-4);
      border-bottom: 1px solid hsla(0, 0%, 100%, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-2);
    }

    .sidebar-nav ul {
      list-style: none;
    }

    .sidebar-nav li {
      margin: var(--space-1) 0;
    }

    .sidebar-nav a {
      color: hsla(0, 0%, 100%, 0.8);
      display: flex;
      align-items: center;
      gap: var(--space-3);
      padding: var(--space-3) var(--space-4);
      border-radius: var(--radius-md);
      transition: background-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
      font-weight: var(--fw-500);
    }

    .sidebar-nav a i {
      width: 20px;
      /* Lebar tetap untuk ikon agar teks sejajar */
      text-align: center;
      font-size: 1.1em;
    }

    .sidebar-nav a:hover,
    .sidebar-nav a.active {
      background-color: hsla(var(--color-primary-h), var(--color-primary-s), var(--color-primary-l), 0.9);
      color: var(--color-text-light);
      transform: translateX(5px);
      box-shadow: var(--shadow-sm);
    }

    .sidebar-nav a.logout-btn:hover {
      background-color: hsla(0, 70%, 50%, 0.8);
    }

    .sidebar-footer {
      margin-top: auto;
      padding-top: var(--space-4);
      border-top: 1px solid hsla(0, 0%, 100%, 0.1);
      font-size: var(--font-xs);
      color: hsla(0, 0%, 100%, 0.6);
      text-align: center;
    }

    /* MAIN CONTENT AREA */
    .main-content {
      flex: 1;
      padding: var(--space-6);
      background-color: var(--color-bg);
      overflow-y: auto;
      /* Jika konten lebih panjang dari layar */
    }

    /* Sembunyikan semua section konten SPA secara default */
    .content-section {
      display: none;
      animation: fadeIn 0.5s ease-out forwards;
    }

    .content-section.active {
      display: block;
    }

    /* FOOTER */
    .app-footer {
      background-color: var(--color-bg-alt);
      color: var(--color-muted);
      text-align: center;
      padding: var(--space-6) var(--space-4);
      border-top: 1px solid var(--color-border);
      margin-top: auto;
      /* Mendorong footer ke bawah jika konten pendek */
    }

    .app-footer p {
      margin-bottom: var(--space-1);
      font-size: var(--font-sm);
    }

    .app-footer a {
      color: var(--color-primary);
      font-weight: var(--fw-500);
    }

    /* =======================
       6. FITUR SPESIFIK
    ======================== */
    /* HERO SECTION (Khusus Halaman Beranda) */
    .hero-section {
      background: linear-gradient(135deg, var(--color-primary-light) 0%, var(--color-primary) 100%);
      color: var(--color-text);
      /* Teks gelap di background terang */
      padding: var(--space-10) var(--space-6);
      border-radius: var(--radius-xl);
      margin-bottom: var(--space-8);
      box-shadow: var(--shadow-lg);
      display: flex;
      /* Untuk penempatan konten jika ada gambar nanti */
      align-items: center;
    }

    .hero-content {
      max-width: 700px;
    }

    .hero-title {
      font-size: var(--font-display-md);
      font-weight: var(--fw-800);
      margin-bottom: var(--space-4);
      line-height: 1.2;
      color: var(--color-primary-dark);
      /* Teks judul lebih gelap agar kontras */
    }

    [data-theme="dark"] .hero-title {
      color: var(--color-text-light);
    }

    [data-theme="dark"] .hero-section {
      background: linear-gradient(135deg, var(--color-bg-sidebar) 0%, var(--color-primary-dark) 100%);
      color: var(--color-text-light);
    }

    .hero-desc {
      font-size: var(--font-md);
      margin-bottom: var(--space-6);
      color: hsl(var(--color-primary-h), 30%, 40%);
      line-height: 1.7;
    }

    [data-theme="dark"] .hero-desc {
      color: hsla(0, 0%, 100%, 0.8);
    }

    .hero-buttons .btn {
      padding: var(--space-3) var(--space-6);
      font-size: var(--font-base);
    }

    .hero-buttons .btn-primary {
      /* Tombol utama di Hero */
      background-color: var(--color-primary-dark);
      border-color: var(--color-primary-dark);
      color: var(--color-text-light);
    }

    .hero-buttons .btn-primary:hover {
      background-color: hsl(var(--color-primary-h), 75%, 40%);
      border-color: hsl(var(--color-primary-h), 75%, 40%);
    }

    .hero-buttons .btn-outline {
      /* Tombol sekunder di Hero */
      border-color: var(--color-primary-dark);
      color: var(--color-primary-dark);
    }

    .hero-buttons .btn-outline:hover {
      background-color: var(--color-primary-dark);
      color: var(--color-text-light);
    }

    [data-theme="dark"] .hero-buttons .btn-outline {
      border-color: var(--color-text-light);
      color: var(--color-text-light);
    }

    [data-theme="dark"] .hero-buttons .btn-outline:hover {
      background-color: var(--color-text-light);
      color: var(--color-primary-dark);
    }


    /* FEATURE TABS (Navigasi dalam section, misal Pembayaran) */
    .feature-tabs {
      display: flex;
      gap: var(--space-2);
      /* Jarak antar tab lebih kecil */
      flex-wrap: wrap;
      margin-bottom: var(--space-6);
      border-bottom: 2px solid var(--color-border);
    }

    .feature-tab {
      padding: var(--space-3) var(--space-5);
      background-color: transparent;
      border: none;
      border-bottom: 3px solid transparent;
      /* Indikator aktif di bawah */
      border-radius: var(--radius-sm) var(--radius-sm) 0 0;
      /* Sudut atas rounded */
      font-weight: var(--fw-600);
      font-size: var(--font-base);
      color: var(--color-muted);
      cursor: pointer;
      transition: var(--transition-fast);
      margin-bottom: -2px;
      /* Agar border bawah menyatu dengan border container */
    }

    .feature-tab:hover {
      color: var(--color-primary);
    }

    .feature-tab.active {
      color: var(--color-primary);
      border-bottom-color: var(--color-primary);
    }

    .feature-tab-content {
      display: none;
      animation: fadeIn 0.3s ease-out forwards;
    }

    .feature-tab-content.active {
      display: block;
    }

    /* PAYMENT METHODS (di section Pembayaran) */
    .payment-methods {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: var(--space-4);
      margin-bottom: var(--space-6);
    }

    .payment-method {
      border: 2px solid var(--color-border);
      padding: var(--space-4);
      border-radius: var(--radius-lg);
      text-align: center;
      cursor: pointer;
      transition: var(--transition-fast);
      background-color: var(--color-bg-alt);
    }

    .payment-method:hover {
      border-color: var(--color-accent);
      transform: translateY(-3px);
      box-shadow: var(--shadow-sm);
    }

    .payment-method.active {
      border-color: var(--color-primary);
      background-color: var(--color-primary-light);
      box-shadow: 0 0 0 2px var(--color-primary), var(--shadow-sm);
      transform: scale(1.03);
    }

    .payment-method i {
      font-size: var(--font-display-sm);
      margin-bottom: var(--space-2);
      color: var(--color-primary);
    }

    .payment-method p {
      font-weight: var(--fw-500);
      font-size: var(--font-sm);
      margin-top: var(--space-2);
    }

    /* CHAT BOX */
    .chat-container {
      display: flex;
      flex-direction: column;
      height: 500px;
      /* Tinggi tetap untuk chat */
      border: 1px solid var(--color-border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      /* Agar chat-box dan chat-input tidak keluar */
      background-color: var(--color-bg-alt);
      box-shadow: var(--shadow-md);
    }

    .chat-box {
      flex-grow: 1;
      padding: var(--space-4);
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: var(--space-3);
    }

    .chat-message {
      padding: var(--space-2) var(--space-4);
      border-radius: var(--radius-lg);
      max-width: 75%;
      word-wrap: break-word;
      /* Pecah kata jika terlalu panjang */
      line-height: 1.4;
      box-shadow: var(--shadow-xs);
    }

    .chat-message.user {
      /* Pesan dari pengguna aplikasi (misal admin) */
      background-color: var(--color-primary);
      color: var(--color-text-light);
      align-self: flex-end;
      border-bottom-right-radius: var(--radius-xs);
      /* Fancy bubble tail */
    }

    .chat-message.other {
      /* Pesan dari pihak lain (misal penyewa) */
      background-color: var(--color-bg);
      /* Sedikit beda dari background chat-box */
      color: var(--color-text);
      align-self: flex-start;
      border: 1px solid var(--color-border);
      border-bottom-left-radius: var(--radius-xs);
    }

    .chat-message-meta {
      font-size: var(--font-xs);
      color: hsla(0, 0%, 100%, 0.7);
      margin-top: var(--space-1);
      text-align: right;
    }

    .chat-message.other .chat-message-meta {
      color: var(--color-muted);
      text-align: left;
    }

    .chat-input-form {
      display: flex;
      gap: var(--space-2);
      padding: var(--space-4);
      border-top: 1px solid var(--color-border);
      background-color: var(--color-bg-alt);
    }

    .chat-input-form input[type="text"] {
      flex-grow: 1;
    }

    /* REVIEW CARD */
    .review-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: var(--space-6);
    }

    .review-card {
      display: flex;
      flex-direction: column;
    }

    .review-card .card-header {
      /* Overwrite card-header umum jika perlu */
      font-size: var(--font-md);
      /* Lebih kecil untuk review */
    }

    .review-author {
      display: flex;
      align-items: center;
      gap: var(--space-3);
      margin-bottom: var(--space-3);
    }

    .review-author-avatar {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-full);
      background-color: var(--color-primary-light);
      color: var(--color-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: var(--fw-600);
      font-size: var(--font-lg);
    }

    .review-author-name {
      font-weight: var(--fw-600);
    }

    .review-rating .fa-star {
      color: var(--color-warning);
    }

    .review-rating .fa-star.empty {
      color: var(--color-border);
    }

    .review-text {
      font-size: var(--font-sm);
      color: var(--color-muted);
      line-height: 1.7;
      margin-top: var(--space-3);
      flex-grow: 1;
      /* Agar teks mengisi ruang */
    }

    .review-date {
      font-size: var(--font-xs);
      color: var(--color-muted);
      margin-top: var(--space-4);
      text-align: right;
    }

    /* VIRTUAL TOUR */
    .virtual-tour-container {
      background-color: hsl(0, 0%, 8%);
      /* Background gelap untuk imersi */
      border-radius: var(--radius-lg);
      padding: var(--space-2);
      aspect-ratio: 16 / 9;
      /* Proporsi umum video/gambar panorama */
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow-lg);
    }

    .virtual-tour-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* Atau 'contain' tergantung gambar */
      border-radius: var(--radius-md);
      /* Sedikit radius di dalam container */
      transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
    }

    .virtual-tour-controls {
      position: absolute;
      bottom: var(--space-4);
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: var(--space-3);
      background-color: hsla(0, 0%, 0%, 0.6);
      padding: var(--space-2) var(--space-4);
      border-radius: var(--radius-full);
    }

    .virtual-tour-controls button {
      background: transparent;
      color: var(--color-text-light);
      border: none;
      font-size: var(--font-lg);
      padding: var(--space-1) var(--space-2);
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .virtual-tour-controls button:hover {
      color: var(--color-accent);
      transform: scale(1.1);
    }

    .virtual-tour-image.zoomed {
      transform: scale(1.2);
      /* Contoh efek zoom */
    }

    /* STATS CARDS (Contoh di Beranda) */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: var(--space-6);
      margin-bottom: var(--space-8);
    }

    .stat-card {
      background-color: var(--color-bg-alt);
      border-radius: var(--radius-lg);
      padding: var(--space-5);
      box-shadow: var(--shadow-md);
      display: flex;
      align-items: center;
      gap: var(--space-4);
      border-left: 5px solid var(--color-primary);
      /* Aksen warna */
      transition: var(--transition-normal);
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .stat-card-icon {
      font-size: var(--font-display-sm);
      color: var(--color-primary);
      background-color: var(--color-primary-light);
      width: 60px;
      height: 60px;
      border-radius: var(--radius-md);
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }

    .stat-card-info .stat-value {
      font-size: var(--font-xl);
      font-weight: var(--fw-700);
      color: var(--color-text);
      display: block;
    }

    .stat-card-info .stat-label {
      font-size: var(--font-sm);
      color: var(--color-muted);
    }

    .stat-card.success .stat-card-icon {
      background-color: hsl(145, 65%, 92%);
      color: var(--color-success);
    }

    .stat-card.success {
      border-left-color: var(--color-success);
    }

    .stat-card.warning .stat-card-icon {
      background-color: hsl(45, 90%, 92%);
      color: var(--color-warning);
    }

    .stat-card.warning {
      border-left-color: var(--color-warning);
    }

    .stat-card.info .stat-card-icon {
      background-color: hsl(190, 80%, 92%);
      color: var(--color-info);
    }

    .stat-card.info {
      border-left-color: var(--color-info);
    }


    /* MODAL (Pop-up) */
    .modal {
      display: none;
      /* Default tersembunyi */
      position: fixed;
      z-index: 1050;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.6);
      /* Latar belakang semi-transparan */
      animation: fadeInModalBackground 0.3s ease-out;
    }

    .modal-dialog {
      position: relative;
      margin: var(--space-8) auto;
      max-width: 600px;
      /* Lebar modal */
      background-color: var(--color-bg-alt);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      animation: slideInModal 0.4s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-4) var(--space-6);
      border-bottom: 1px solid var(--color-border);
    }

    .modal-title {
      font-size: var(--font-lg);
      font-weight: var(--fw-600);
    }

    .modal-close-btn {
      background: none;
      border: none;
      font-size: var(--font-xl);
      color: var(--color-muted);
      cursor: pointer;
      padding: var(--space-1);
      line-height: 1;
    }

    .modal-close-btn:hover {
      color: var(--color-danger);
    }

    .modal-body {
      padding: var(--space-6);
      overflow-y: auto;
      /* Jika konten modal panjang */
      flex-grow: 1;
    }

    .modal-footer {
      padding: var(--space-4) var(--space-6);
      border-top: 1px solid var(--color-border);
      display: flex;
      justify-content: flex-end;
      gap: var(--space-3);
    }

    /* TOAST NOTIFICATION */
    .toast-notification {
      position: fixed;
      bottom: var(--space-6);
      right: var(--space-6);
      background-color: var(--color-text);
      color: var(--color-bg);
      padding: var(--space-3) var(--space-5);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-lg);
      z-index: 1100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(20px);
      transition: opacity var(--transition-normal), visibility var(--transition-normal), transform var(--transition-normal);
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .toast-notification.show {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .toast-notification.success {
      background-color: var(--color-success);
      color: var(--color-text-light);
    }

    .toast-notification.error {
      background-color: var(--color-danger);
      color: var(--color-text-light);
    }

    .toast-notification.info {
      background-color: var(--color-info);
      color: var(--color-text-light);
    }

    .toast-notification.warning {
      background-color: var(--color-warning);
      color: var(--color-text);
    }

    .toast-notification i {
      font-size: var(--font-md);
    }


    /* STATUS BAR ONLINE/OFFLINE (Simulasi) */
    .status-bar {
      padding: var(--space-2) var(--space-4);
      font-size: var(--font-sm);
      text-align: center;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      transition: background-color var(--transition-normal), color var(--transition-normal);
    }

    .status-bar.online {
      background-color: var(--color-success);
      color: var(--color-text-light);
    }

    .status-bar.offline {
      background-color: var(--color-warning);
      color: var(--color-text);
    }

    /* =======================
       7. ANIMASI & EFEK
    ======================== */
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .fade-in-up {
      animation: fadeInUp 0.6s ease-out forwards;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInModalBackground {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes slideInModal {
      from {
        opacity: 0.5;
        transform: translateY(-50px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Preferensi Pengguna untuk Mengurangi Gerakan */
    @media (prefers-reduced-motion: reduce) {

      *,
      *::before,
      *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }

      .fade-in-up,
      .content-section,
      .modal-dialog,
      .toast-notification {
        animation: none !important;
      }
    }

    /* Lazy load gambar (jika digunakan) */
    img.lazy {
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    img.lazy.loaded {
      opacity: 1;
    }

    /* =======================
       8. RESPONSIVITAS
    ======================== */
    @media (max-width: 992px) {

      /* Tablet dan di bawahnya */
      :root {
        --sidebar-width: 220px;
      }

      .hero-title {
        font-size: var(--font-display-sm);
      }

      .hero-desc {
        font-size: var(--font-base);
      }
    }

    @media (max-width: 768px) {

      /* Mobile */
      .dashboard-layout {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        height: auto;
        /* Tinggi otomatis di mobile */
        position: static;
        /* Tidak sticky di mobile */
        box-shadow: var(--shadow-md);
        /* Tambah shadow jika terpisah */
        padding-top: var(--space-4);
        padding-bottom: var(--space-4);
      }

      .sidebar-logo {
        margin-bottom: var(--space-4);
        font-size: var(--font-lg);
      }

      .sidebar-nav ul {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }

      .sidebar-nav a {
        padding: var(--space-2) var(--space-3);
        font-size: var(--font-sm);
      }

      .sidebar-footer {
        display: none;
        /* Sembunyikan footer sidebar di mobile untuk ruang */
      }

      .main-content {
        padding: var(--space-4);
      }

      .section {
        padding-top: var(--space-6);
        padding-bottom: var(--space-6);
      }

      .section-title {
        font-size: var(--font-xl);
      }

      .section-subtitle {
        font-size: var(--font-sm);
        margin-bottom: var(--space-4);
      }

      .hero-section {
        padding: var(--space-6) var(--space-4);
      }

      .hero-title {
        font-size: var(--font-xl);
      }

      .hero-desc {
        font-size: var(--font-sm);
      }

      .hero-buttons {
        flex-direction: column;
        align-items: stretch;
      }

      .hero-buttons .btn {
        width: 100%;
      }

      .feature-tabs {
        justify-content: center;
      }

      .feature-tab {
        font-size: var(--font-sm);
        padding: var(--space-2) var(--space-3);
      }

      .payment-methods {
        grid-template-columns: 1fr;
      }

      /* Satu kolom di mobile */
      .chat-container {
        height: 400px;
      }

      /* Kurangi tinggi chat di mobile */
      .modal-dialog {
        margin: var(--space-4) auto;
        max-width: calc(100% - var(--space-8));
      }
    }

    @media (max-width: 480px) {

      /* Perangkat sangat kecil */
      .app-header .container {
        flex-direction: column;
        gap: var(--space-2);
      }

      .theme-toggle {
        width: 100%;
      }

      /* Tombol tema full width */
      .card {
        padding: var(--space-4);
      }

      .btn {
        padding: var(--space-2) var(--space-4);
        font-size: var(--font-sm);
      }

      .form-control,
      .form-select {
        padding: var(--space-2) var(--space-3);
        font-size: var(--font-sm);
      }
    }
  </style>
</head>

<body>
  <div class="app-wrapper">
    <!-- STATUS BAR KONEKSI (Simulasi) -->
    <div id="connectionStatusBar" class="status-bar" role="status" aria-live="polite">Memeriksa koneksi...</div>

    <!-- HEADER APLIKASI -->
    <header class="app-header" role="banner">
      <div class="container">
        <a href="#beranda" class="header-logo" aria-label="Green Valley - Kembali ke Beranda">
          <i class="fas fa-leaf"></i> <!-- Contoh ikon baru yang lebih fancy -->
          <span>Green Valley</span>
        </a>
        <button id="themeToggleBtn" class="btn btn-sm theme-toggle" aria-label="Alihkan Mode Gelap/Terang">
          <i class="fas fa-moon"></i> <span>Mode Gelap</span>
        </button>
      </div>
    </header>

    <!-- LAYOUT UTAMA: SIDEBAR + KONTEN -->
    <div class="dashboard-layout">
      <!-- SIDEBAR NAVIGASI -->
      <aside class="sidebar" aria-label="Menu Navigasi Utama">
        <a href="#beranda" class="sidebar-logo">
          <i class="fas fa-tachometer-alt"></i>
          <span>Dasbor</span>
        </a>
        <nav class="sidebar-nav" aria-label="Navigasi Aplikasi">
          <ul>
            <li><a href="#beranda" class="nav-link active" data-section="beranda"><i class="fas fa-home"></i>
                Beranda</a></li>
            <li><a href="#penyewa" class="nav-link" data-section="penyewa"><i class="fas fa-users"></i> Penyewa</a></li>
            <li><a href="#unit" class="nav-link" data-section="unit"><i class="fas fa-building"></i> Unit Properti</a>
            </li>
            <li><a href="#pembayaran" class="nav-link" data-section="pembayaran"><i class="fas fa-credit-card"></i>
                Pembayaran</a></li>
            <li><a href="#komunikasi" class="nav-link" data-section="komunikasi"><i class="fas fa-comments"></i>
                Komunikasi</a></li>
            <li><a href="#laporan" class="nav-link" data-section="laporan"><i class="fas fa-chart-line"></i> Laporan</a>
            </li>
            <li><a href="#pengaturan" class="nav-link" data-section="pengaturan"><i class="fas fa-cog"></i>
                Pengaturan</a></li>
          </ul>
        </nav>
        <div class="sidebar-footer">
          <button id="logoutButton" class="btn btn-sm btn-danger w-100"><i class="fas fa-sign-out-alt"></i>
            Keluar</button>
        </div>
      </aside>

      <!-- KONTEN UTAMA (SPA) -->
      <main id="mainAppContent" class="main-content" role="main" tabindex="-1">

        <!-- Bagian: BERANDA -->
        <section id="beranda" class="content-section active">
          <div class="hero-section fade-in-up">
            <div class="hero-content">
              <h1 class="hero-title">Kelola Properti Anda, Lebih Cerdas dan Efisien</h1>
              <p class="hero-desc">
                Green Valley menyediakan platform manajemen properti sewa yang intuitif dan lengkap. Monitor penyewa,
                lacak kontrak, optimalkan keuangan, dan nikmati kemudahan digital dalam satu dasbor elegan.
              </p>
              <div class="hero-buttons d-flex gap-3 flex-wrap">
                <button class="btn btn-primary btn-lg" onclick="App.utils.openModal('addTenantModal')"><i
                    class="fas fa-user-plus"></i> Tambah Penyewa Baru</button>
                <button class="btn btn-outline btn-lg" onclick="App.utils.openModal('addUnitModal')"><i
                    class="fas fa-plus-circle"></i> Tambah Unit Properti</button>
              </div>
            </div>
          </div>

          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-card-icon"><i class="fas fa-building"></i></div>
              <div class="stat-card-info">
                <span id="totalUnitsStat" class="stat-value">0</span>
                <span class="stat-label">Total Unit Terdaftar</span>
              </div>
            </div>
            <div class="stat-card success">
              <div class="stat-card-icon"><i class="fas fa-house-user"></i></div>
              <div class="stat-card-info">
                <span id="rentedUnitsStat" class="stat-value">0</span>
                <span class="stat-label">Unit Tersewa</span>
              </div>
            </div>
            <div class="stat-card warning">
              <div class="stat-card-icon"><i class="fas fa-house-chimney-medical"></i></div>
              <div class="stat-card-info">
                <span id="vacantUnitsStat" class="stat-value">0</span>
                <span class="stat-label">Unit Tersedia</span>
              </div>
            </div>
            <div class="stat-card info">
              <div class="stat-card-icon"><i class="fas fa-user-friends"></i></div>
              <div class="stat-card-info">
                <span id="totalTenantsStat" class="stat-value">0</span>
                <span class="stat-label">Total Penyewa Aktif</span>
              </div>
            </div>
          </div>

          <h2 class="section-title mt-6">Akses Cepat Fitur Unggulan</h2>
          <div class="feature-tabs">
            <button class="feature-tab active" data-tab-target="#fiturPembayaranCepat">
              <i class="fas fa-money-check-dollar"></i> Pembayaran
            </button>
            <button class="feature-tab" data-tab-target="#fiturChatLangsung">
              <i class="fas fa-headset"></i> Dukungan
            </button>
            <button class="feature-tab" data-tab-target="#fiturTurVirtualCepat">
              <i class="fas fa-vr-cardboard"></i> Tur Virtual
            </button>
          </div>

          <div id="fiturPembayaranCepat" class="feature-tab-content active card">
            <h3 class="card-header">Proses Pembayaran Instan</h3>
            <p class="text-muted mb-4">Mudahkan penyewa melakukan pembayaran tagihan sewa secara online melalui berbagai
              metode terpercaya.</p>
            <a href="#pembayaran" class="btn btn-primary nav-link" data-section="pembayaran"><i
                class="fas fa-arrow-right"></i> Kelola Pembayaran</a>
          </div>
          <div id="fiturChatLangsung" class="feature-tab-content card">
            <h3 class="card-header">Hubungi Tim Dukungan</h3>
            <p class="text-muted mb-4">Ada pertanyaan atau butuh bantuan? Tim dukungan kami siap membantu Anda.</p>
            <a href="#komunikasi" class="btn btn-primary nav-link" data-section="komunikasi"><i
                class="fas fa-paper-plane"></i> Mulai Percakapan</a>
          </div>
          <div id="fiturTurVirtualCepat" class="feature-tab-content card">
            <h3 class="card-header">Lihat Unit Secara Virtual</h3>
            <p class="text-muted mb-4">Tawarkan pengalaman impresif kepada calon penyewa dengan fitur tur virtual 360°
              unit properti Anda.</p>
            <a href="#unit" class="btn btn-primary nav-link" data-section="unit"><i class="fas fa-eye"></i> Jelajahi
              Unit (Contoh)</a>
          </div>

        </section>

        <!-- Bagian: PENYEWA -->
        <section id="penyewa" class="content-section">
          <h1 class="section-title">Manajemen Penyewa</h1>
          <p class="section-subtitle">Kelola data penyewa, kontrak, dan riwayat pembayaran dengan mudah.</p>
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <span>Daftar Penyewa</span>
              <button class="btn btn-sm btn-primary" onclick="App.utils.openModal('addTenantModal')"><i
                  class="fas fa-user-plus"></i> Tambah Penyewa</button>
            </div>
            <div id="tenantListContainer" class="py-4">
              <p class="text-center text-muted">Belum ada data penyewa. Silakan tambahkan penyewa baru.</p>
              <!-- Daftar penyewa akan dirender di sini oleh JavaScript -->
            </div>
          </div>
        </section>

        <!-- Bagian: UNIT PROPERTI -->
        <section id="unit" class="content-section">
          <h1 class="section-title">Manajemen Unit Properti</h1>
          <p class="section-subtitle">Atur detail unit, status ketersediaan, dan fasilitas.</p>
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <span>Daftar Unit</span>
              <button class="btn btn-sm btn-primary" onclick="App.utils.openModal('addUnitModal')"><i
                  class="fas fa-plus-circle"></i> Tambah Unit</button>
            </div>
            <div id="unitListContainer" class="py-4">
              <p class="text-center text-muted">Belum ada data unit. Silakan tambahkan unit baru.</p>
              <!-- Daftar unit akan dirender di sini oleh JavaScript -->
            </div>
          </div>

          <div class="mt-6">
            <h2 class="section-title fs-lg">Contoh Tur Virtual Unit</h2>
            <p class="section-subtitle fs-sm">Jelajahi contoh unit apartemen secara detail sebelum diimplementasikan
              pada unit Anda.</p>
            <div class="virtual-tour-container">
              <img
                src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60"
                alt="Contoh Tur Virtual Interior Apartemen" id="virtualTourImage"
                class="virtual-tour-image lazy loaded">
              <div class="virtual-tour-controls">
                <button id="tourPrevBtn" aria-label="Gambar Sebelumnya Tur Virtual"><i
                    class="fas fa-chevron-left"></i></button>
                <button id="tourZoomBtn" aria-label="Perbesar/Perkecil Gambar Tur Virtual"><i
                    class="fas fa-search-plus"></i></button>
                <button id="tourNextBtn" aria-label="Gambar Berikutnya Tur Virtual"><i
                    class="fas fa-chevron-right"></i></button>
              </div>
            </div>
          </div>
        </section>

        <!-- Bagian: PEMBAYARAN -->
        <section id="pembayaran" class="content-section">
          <h1 class="section-title">Sistem Pembayaran Digital</h1>
          <p class="section-subtitle">Lakukan dan lacak pembayaran secara aman dan cepat melalui platform kami. Semua
            transaksi dilindungi.</p>

          <div class="feature-tabs">
            <button class="feature-tab active" data-tab-target="#tabBuatPembayaran">Buat Pembayaran</button>
            <button class="feature-tab" data-tab-target="#tabRiwayatPembayaran">Riwayat Pembayaran</button>
          </div>

          <div id="tabBuatPembayaran" class="feature-tab-content active">
            <div class="card">
              <h3 class="card-header">Formulir Pembayaran Baru</h3>
              <p class="text-muted mb-4">Pilih metode pembayaran dan isi detail yang diperlukan.</p>
              <div class="payment-methods">
                <div class="payment-method active" data-method="bank_transfer" role="button" tabindex="0"
                  aria-pressed="true">
                  <i class="fas fa-university"></i>
                  <p>Transfer Bank</p>
                </div>
                <div class="payment-method" data-method="qris" role="button" tabindex="0" aria-pressed="false">
                  <i class="fas fa-qrcode"></i>
                  <p>QRIS</p>
                </div>
                <div class="payment-method" data-method="e_wallet" role="button" tabindex="0" aria-pressed="false">
                  <i class="fas fa-wallet"></i>
                  <p>E-Wallet</p>
                </div>
                <div class="payment-method" data-method="credit_card" role="button" tabindex="0" aria-pressed="false">
                  <i class="fas fa-credit-card"></i>
                  <p>Kartu Kredit</p>
                </div>
              </div>
              <form id="paymentForm" novalidate>
                <div class="form-group">
                  <label for="paymentTenantId">Pilih Penyewa</label>
                  <select id="paymentTenantId" name="tenantId" class="form-select" required
                    aria-describedby="paymentTenantIdError">
                    <option value="">-- Pilih ID Penyewa --</option>
                    <!-- Opsi penyewa akan diisi oleh JavaScript -->
                  </select>
                  <small id="paymentTenantIdError" class="form-error" role="alert"></small>
                </div>
                <div class="form-group">
                  <label for="paymentAmount">Jumlah Pembayaran (IDR)</label>
                  <input type="number" id="paymentAmount" name="amount" class="form-control"
                    placeholder="Contoh: 5000000" required min="10000" aria-describedby="paymentAmountError">
                  <small id="paymentAmountError" class="form-error" role="alert"></small>
                </div>
                <div class="form-group">
                  <label for="paymentDate">Tanggal Pembayaran</label>
                  <input type="date" id="paymentDate" name="date" class="form-control" required
                    aria-describedby="paymentDateError">
                  <small id="paymentDateError" class="form-error" role="alert"></small>
                </div>
                <div class="form-group">
                  <label for="paymentNotes">Catatan (Opsional)</label>
                  <textarea id="paymentNotes" name="notes" class="form-control" rows="3"
                    placeholder="Misalnya: Pembayaran sewa bulan Januari"></textarea>
                </div>
                <button type="submit" class="btn btn-primary btn-lg w-100"><i class="fas fa-paper-plane"></i> Kirim
                  Pembayaran</button>
              </form>
            </div>
          </div>

          <div id="tabRiwayatPembayaran" class="feature-tab-content">
            <div class="card">
              <h3 class="card-header">Riwayat Transaksi Pembayaran</h3>
              <div id="paymentHistoryContainer" class="py-4">
                <p class="text-center text-muted">Belum ada riwayat pembayaran.</p>
                <!-- Riwayat pembayaran akan dirender di sini -->
              </div>
            </div>
          </div>
        </section>

        <!-- Bagian: KOMUNIKASI (Chat) -->
        <section id="komunikasi" class="content-section">
          <h1 class="section-title">Pusat Komunikasi</h1>
          <p class="section-subtitle">Berinteraksi langsung dengan penyewa atau tim dukungan melalui fitur chat
            terintegrasi.</p>

          <div class="card">
            <h3 class="card-header">Chat Langsung dengan Penyewa (Simulasi)</h3>
            <div class="chat-container">
              <div id="chatBoxMessages" class="chat-box" aria-live="polite">
                <div class="chat-message other">
                  <p>Halo Admin, saya ingin bertanya mengenai perpanjangan sewa.</p>
                  <span class="chat-message-meta">Siti Aminah - 10:30</span>
                </div>
                <!-- Pesan akan ditambahkan di sini oleh JavaScript -->
              </div>
              <form id="chatForm" class="chat-input-form" novalidate>
                <input type="text" id="chatMessageInput" class="form-control" placeholder="Ketik pesan Anda di sini..."
                  required aria-label="Input Pesan Chat" aria-describedby="chatMessageError">
                <button type="submit" class="btn btn-primary"><i class="fas fa-paper-plane"></i> Kirim</button>
              </form>
            </div>
            <small id="chatMessageError" class="form-error px-4 pb-2" role="alert"></small>
            <!-- Error di luar form agar tidak ikut flex -->
          </div>

          <div class="card mt-6">
            <h3 class="card-header">Ulasan & Testimoni Penyewa</h3>
            <p class="text-muted mb-4">Lihat apa kata penyewa tentang properti dan layanan Anda.</p>
            <div id="reviewListContainer" class="review-grid">
              <!-- Contoh Ulasan Statis -->
              <div class="review-card card"> <!-- Tambahkan class card agar styling konsisten -->
                <div class="review-author">
                  <div class="review-author-avatar"><span>BG</span></div>
                  <div>
                    <div class="review-author-name">Budi Gunawan <span class="badge badge-success">Terverifikasi</span>
                    </div>
                    <div class="review-rating fs-sm">
                      <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                        class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                    </div>
                  </div>
                </div>
                <p class="review-text">"Unitnya sangat nyaman dan bersih. Lokasi strategis dan fasilitasnya lengkap.
                  Pelayanan dari pengelola juga sangat responsif. Sangat direkomendasikan!"</p>
                <div class="review-date">2 hari yang lalu</div>
              </div>
              <div class="review-card card">
                <div class="review-author">
                  <div class="review-author-avatar"
                    style="background-color: var(--color-accent); color: var(--color-text-light);"><span>RA</span></div>
                  <div>
                    <div class="review-author-name">Rina Amelia</div>
                    <div class="review-rating fs-sm">
                      <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i
                        class="fas fa-star"></i><i class="fas fa-star empty"></i>
                    </div>
                  </div>
                </div>
                <p class="review-text">"Pengalaman tinggal di sini cukup baik. Beberapa fasilitas perlu ditingkatkan,
                  tapi secara keseluruhan memuaskan untuk harganya."</p>
                <div class="review-date">1 minggu yang lalu</div>
              </div>
              <!-- Ulasan lain akan dirender di sini -->
            </div>
            <p id="noReviewsMessage" class="text-center text-muted py-4 d-none">Belum ada ulasan.</p>
          </div>
        </section>

        <!-- Bagian: LAPORAN -->
        <section id="laporan" class="content-section">
          <h1 class="section-title">Analitik & Laporan</h1>
          <p class="section-subtitle">Dapatkan wawasan mendalam mengenai kinerja properti Anda melalui laporan yang
            komprehensif.</p>
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <span>Ringkasan Laporan</span>
              <button id="exportDataBtn" class="btn btn-sm btn-outline-primary"><i class="fas fa-download"></i> Ekspor
                Data CSV</button>
            </div>
            <div class="p-4">
              <p class="text-center text-muted">
                <i class="fas fa-chart-pie fa-3x text-primary mb-3"></i><br>
                Fitur laporan dan analitik sedang dalam pengembangan.<br> Nantikan pembaruan selanjutnya untuk
                visualisasi data keuangan, okupansi, dan performa penyewa.
              </p>
            </div>
          </div>
        </section>

        <!-- Bagian: PENGATURAN -->
        <section id="pengaturan" class="content-section">
          <h1 class="section-title">Pengaturan Aplikasi</h1>
          <p class="section-subtitle">Kustomisasi preferensi aplikasi, profil Anda, dan pengaturan notifikasi.</p>
          <div class="card">
            <div class="card-header">Preferensi Tampilan</div>
            <div class="p-4">
              <div class="form-group">
                <label for="themeSelector">Tema Aplikasi</label>
                <select id="themeSelector" class="form-select">
                  <option value="light">Terang (Light Mode)</option>
                  <option value="dark">Gelap (Dark Mode)</option>
                  <option value="system">Sistem Default</option>
                </select>
              </div>
              <p class="text-muted fs-sm">Pilih tema tampilan yang paling nyaman untuk Anda.</p>
            </div>
          </div>
          <div class="card mt-5">
            <div class="card-header">Pengaturan Notifikasi (Contoh)</div>
            <div class="p-4">
              <div class="form-group">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" id="notifEmail" checked>
                  <label class="form-check-label" for="notifEmail">
                    Notifikasi Email untuk Pembayaran Baru
                  </label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="" id="notifApp">
                  <label class="form-check-label" for="notifApp">
                    Notifikasi Dalam Aplikasi untuk Pesan Baru
                  </label>
                </div>
              </div>
              <p class="text-muted fs-sm">Style untuk .form-check belum dibuat, ini hanya placeholder struktur.</p>
            </div>
          </div>
        </section>

      </main>
    </div>

    <!-- FOOTER APLIKASI -->
    <footer class="app-footer" role="contentinfo">
      <div class="container">
        <p>&copy; <span id="currentYear"></span> Green Valley Property Management. Hak Cipta Dilindungi Undang-Undang.
        </p>
        <p>Didesain dan dikembangkan dengan <i class="fas fa-heart text-danger"></i> oleh Tim Green Valley untuk
          ekosistem properti digital Indonesia.</p>
        <p><a href="#privasi">Kebijakan Privasi</a> | <a href="#syarat">Syarat & Ketentuan</a></p>
      </div>
    </footer>
  </div>

  <!-- MODAL: TAMBAH PENYEWA -->
  <div id="addTenantModal" class="modal" aria-labelledby="addTenantModalTitle" aria-hidden="true" role="dialog">
    <div class="modal-dialog">
      <div class="modal-header">
        <h5 class="modal-title" id="addTenantModalTitle">Tambah Penyewa Baru</h5>
        <button type="button" class="modal-close-btn" data-dismiss-modal="addTenantModal" aria-label="Tutup">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="addTenantForm" novalidate>
        <div class="modal-body">
          <div class="form-group">
            <label for="tenantName">Nama Lengkap Penyewa</label>
            <input type="text" id="tenantName" name="name" class="form-control" required>
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="tenantEmail">Alamat Email</label>
            <input type="email" id="tenantEmail" name="email" class="form-control" required>
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="tenantPhone">Nomor Telepon</label>
            <input type="tel" id="tenantPhone" name="phone" class="form-control" required placeholder="+6281234567890">
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="tenantUnitId">Unit yang Disewa</label>
            <select id="tenantUnitId" name="unitId" class="form-select" required>
              <option value="">-- Pilih Unit --</option>
              <!-- Opsi unit akan diisi JavaScript -->
            </select>
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="tenantRentAmount">Jumlah Sewa Bulanan (IDR)</label>
            <input type="number" id="tenantRentAmount" name="rentAmount" class="form-control" required min="0">
            <small class="form-error"></small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-primary" data-dismiss-modal="addTenantModal">Batal</button>
          <button type="submit" class="btn btn-primary">Simpan Penyewa</button>
        </div>
      </form>
    </div>
  </div>

  <!-- MODAL: TAMBAH UNIT -->
  <div id="addUnitModal" class="modal" aria-labelledby="addUnitModalTitle" aria-hidden="true" role="dialog">
    <div class="modal-dialog">
      <div class="modal-header">
        <h5 class="modal-title" id="addUnitModalTitle">Tambah Unit Properti Baru</h5>
        <button type="button" class="modal-close-btn" data-dismiss-modal="addUnitModal" aria-label="Tutup">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form id="addUnitForm" novalidate>
        <div class="modal-body">
          <div class="form-group">
            <label for="unitName">Nama/Nomor Unit</label>
            <input type="text" id="unitName" name="name" class="form-control" required
              placeholder="Contoh: Tower A No. 101">
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="unitType">Tipe Unit</label>
            <select id="unitType" name="type" class="form-select" required>
              <option value="">-- Pilih Tipe --</option>
              <option value="Studio">Studio</option>
              <option value="1BR">1 Kamar Tidur (1BR)</option>
              <option value="2BR">2 Kamar Tidur (2BR)</option>
              <option value="3BR">3 Kamar Tidur (3BR)</option>
              <option value="Lainnya">Lainnya</option>
            </select>
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="unitStatus">Status Unit</label>
            <select id="unitStatus" name="status" class="form-select" required>
              <option value="Tersedia">Tersedia</option>
              <option value="Tersewa">Tersewa</option>
              <option value="Perbaikan">Dalam Perbaikan</option>
            </select>
            <small class="form-error"></small>
          </div>
          <div class="form-group">
            <label for="unitPrice">Harga Sewa per Bulan (IDR)</label>
            <input type="number" id="unitPrice" name="price" class="form-control" required min="0">
            <small class="form-error"></small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-outline-primary" data-dismiss-modal="addUnitModal">Batal</button>
          <button type="submit" class="btn btn-primary">Simpan Unit</button>
        </div>
      </form>
    </div>
  </div>

  <!-- TOAST NOTIFICATION CONTAINER -->
  <div id="toastContainer" class="toast-notification" role="alert" aria-live="assertive">
    <i id="toastIcon" class="fas"></i>
    <span id="toastMessage">Pesan notifikasi.</span>
  </div>

  <script>
    // Namespace utama aplikasi untuk menghindari polusi global scope
    const App = {
      config: {
        defaultTheme: 'light',
        virtualTourImages: [ // Contoh gambar untuk tur virtual
          'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60',
          'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60',
          'https://images.unsplash.com/photo-1616046229478-9901c5536a45?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8YXBhcnRtZW50JTIwaW50ZXJpb3J8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=800&q=60'
        ],
        currentTourImageIndex: 0,
        toastDisplayTime: 4000, // 4 detik
      },
      state: {
        theme: 'light',
        tenants: [], // Data penyewa akan disimpan di sini
        units: [],   // Data unit properti
        payments: [], // Data pembayaran
        chatMessages: [ // Contoh pesan awal untuk chat
          { sender: 'Siti Aminah', text: 'Halo Admin, saya ingin bertanya mengenai perpanjangan sewa.', time: '10:30', type: 'other' }
        ],
        activeSection: 'beranda', // Bagian aktif saat ini
        isOnline: navigator.onLine,
        modalOpen: null, // ID modal yang sedang terbuka
      },
      elements: {}, // Cache untuk elemen DOM yang sering diakses

      // Modul Utilitas
      utils: {
        // Fungsi pembantu untuk query selector
        $: (selector, parent = document) => parent.querySelector(selector),
        $$: (selector, parent = document) => parent.querySelectorAll(selector),

        // Fungsi untuk menampilkan notifikasi toast
        showToast: (message, type = 'info', duration = App.config.toastDisplayTime) => {
          const toast = App.elements.toastContainer;
          const toastIcon = App.elements.toastIcon;
          const toastMessage = App.elements.toastMessage;

          if (!toast || !toastIcon || !toastMessage) {
            console.error("Elemen toast tidak ditemukan.");
            return;
          }

          toastMessage.textContent = message;
          toast.className = 'toast-notification'; // Reset class
          toast.classList.add(type); // Tambah class type (success, error, warning, info)

          // Set ikon berdasarkan tipe
          const icons = {
            success: 'fa-check-circle',
            error: 'fa-times-circle',
            warning: 'fa-exclamation-triangle',
            info: 'fa-info-circle'
          };
          toastIcon.className = `fas ${icons[type] || icons.info}`;

          toast.classList.add('show');

          // Sembunyikan toast setelah durasi tertentu
          setTimeout(() => {
            toast.classList.remove('show');
          }, duration);
        },

        // Fungsi untuk validasi field tunggal
        validateField: (inputElement, rules) => {
          const errorElement = App.utils.$(`small.form-error`, inputElement.parentElement);
          let isValid = true;
          let errorMessage = '';

          inputElement.classList.remove('is-invalid');
          if (errorElement) errorElement.textContent = '';

          const value = inputElement.value.trim();

          if (rules.required && !value) {
            isValid = false;
            errorMessage = rules.messages?.required || 'Kolom ini wajib diisi.';
          } else if (rules.minLength && value.length < rules.minLength) {
            isValid = false;
            errorMessage = rules.messages?.minLength || `Minimal ${rules.minLength} karakter.`;
          } else if (rules.pattern && !rules.pattern.test(value)) {
            isValid = false;
            errorMessage = rules.messages?.pattern || 'Format tidak valid.';
          } else if (rules.type === 'email' && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value) && value) {
            isValid = false;
            errorMessage = rules.messages?.email || 'Format email tidak valid.';
          } else if (rules.min && inputElement.type === 'number' && parseFloat(value) < rules.min) {
            isValid = false;
            errorMessage = rules.messages?.min || `Nilai minimal adalah ${rules.min}.`;
          }


          if (!isValid) {
            inputElement.classList.add('is-invalid');
            if (errorElement) errorElement.textContent = errorMessage;
          }
          return isValid;
        },

        // Fungsi untuk validasi seluruh form
        validateForm: (formElement) => {
          let isFormValid = true;
          App.utils.$$('input[required], select[required], textarea[required]', formElement).forEach(input => {
            // Ambil aturan validasi dari data-* attributes atau definisikan di sini
            const rules = {
              required: true, // Semua yang punya atribut required
              minLength: input.dataset.minLength ? parseInt(input.dataset.minLength) : undefined,
              pattern: input.pattern ? new RegExp(input.pattern) : undefined,
              type: input.type,
              min: input.min ? parseFloat(input.min) : undefined,
              messages: {
                required: input.dataset.msgRequired || 'Kolom ini wajib diisi.',
                // tambahkan pesan custom lain jika perlu
              }
            };
            if (!App.utils.validateField(input, rules)) {
              isFormValid = false;
            }
          });
          return isFormValid;
        },

        // Fungsi untuk membuka modal
        openModal: (modalId) => {
          const modal = App.utils.$(`#${modalId}`);
          if (modal) {
            App.state.modalOpen = modalId;
            modal.style.display = 'flex'; // Menggunakan flex untuk centering jika modal-dialog diatur demikian
            modal.setAttribute('aria-hidden', 'false');
            App.utils.$('body').style.overflow = 'hidden'; // Mencegah scroll background
            const firstFocusableElement = App.utils.$('input, select, button, textarea, [tabindex]:not([tabindex="-1"])', modal);
            if (firstFocusableElement) firstFocusableElement.focus();
          }
        },

        // Fungsi untuk menutup modal
        closeModal: (modalId) => {
          const modal = App.utils.$(`#${modalId}`);
          if (modal) {
            App.state.modalOpen = null;
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
            App.utils.$('body').style.overflow = 'auto';
          }
        },

        // Fungsi untuk menghasilkan ID unik (sederhana)
        generateId: (prefix = 'id') => {
          return `${prefix}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
        },

        // Format mata uang IDR
        formatCurrency: (amount) => {
          return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);
        },

        // Format tanggal
        formatDate: (dateString) => {
          if (!dateString) return '-';
          const date = new Date(dateString);
          return date.toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' });
        }
      },

      // Modul Tema
      theme: {
        init: () => {
          const storedTheme = localStorage.getItem('greenValleyTheme') || App.config.defaultTheme;
          App.theme.set(storedTheme);
          App.elements.themeToggleBtn.addEventListener('click', App.theme.toggle);

          const themeSelector = App.elements.themeSelector;
          if (themeSelector) {
            themeSelector.value = storedTheme;
            themeSelector.addEventListener('change', (e) => App.theme.set(e.target.value));
          }

          // Listener untuk perubahan preferensi sistem
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
            if (App.state.theme === 'system') {
              App.theme.apply(e.matches ? 'dark' : 'light');
            }
          });
        },
        apply: (themeName) => {
          document.documentElement.setAttribute('data-theme', themeName);
          const themeIcon = App.utils.$('i', App.elements.themeToggleBtn);
          const themeText = App.utils.$('span', App.elements.themeToggleBtn);
          if (themeName === 'dark') {
            if (themeIcon) themeIcon.className = 'fas fa-sun';
            if (themeText) themeText.textContent = 'Mode Terang';
          } else {
            if (themeIcon) themeIcon.className = 'fas fa-moon';
            if (themeText) themeText.textContent = 'Mode Gelap';
          }
        },
        set: (themeName) => {
          App.state.theme = themeName;
          if (themeName === 'system') {
            const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            App.theme.apply(systemPrefersDark ? 'dark' : 'light');
          } else {
            App.theme.apply(themeName);
          }
          localStorage.setItem('greenValleyTheme', themeName);
          if (App.elements.themeSelector) App.elements.themeSelector.value = themeName;
        },
        toggle: () => {
          const currentAppliedTheme = document.documentElement.getAttribute('data-theme');
          const newTheme = currentAppliedTheme === 'dark' ? 'light' : 'dark';
          App.theme.set(newTheme); // Ini akan update state, apply, dan localStorage
        }
      },

      // Modul Navigasi SPA
      navigation: {
        init: () => {
          App.utils.$$('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
              e.preventDefault();
              const sectionId = link.getAttribute('href').substring(1); // atau link.dataset.section
              App.navigation.navigateTo(sectionId);
            });
          });
          // Tangani navigasi awal berdasarkan hash atau default
          const initialSection = window.location.hash ? window.location.hash.substring(1) : 'beranda';
          App.navigation.navigateTo(initialSection);

          // Listener untuk tombol back/forward browser
          window.addEventListener('popstate', () => {
            const sectionId = window.location.hash ? window.location.hash.substring(1) : 'beranda';
            App.navigation.navigateTo(sectionId, false); // false agar tidak update history lagi
          });
        },
        navigateTo: (sectionId, updateHistory = true) => {
          if (!sectionId || sectionId === App.state.activeSection && App.utils.$(`#${sectionId}.content-section.active`)) {
            // Jika sectionId kosong atau sudah aktif, jangan lakukan apa-apa
            // kecuali jika section aktif tapi tidak visible (kasus reload halaman dengan hash)
            if (sectionId && !App.utils.$(`#${sectionId}.content-section.active`)) {
              // lanjut ke proses aktivasi
            } else {
              App.utils.$(`#${App.state.activeSection}`).classList.add('active'); // Pastikan section default aktif
              return;
            }
          }

          // Sembunyikan section yang aktif sebelumnya
          if (App.state.activeSection && App.utils.$(`#${App.state.activeSection}`)) {
            App.utils.$(`#${App.state.activeSection}`).classList.remove('active');
          }

          // Tampilkan section baru
          const newSectionElement = App.utils.$(`#${sectionId}`);
          if (newSectionElement) {
            newSectionElement.classList.add('active');
            App.state.activeSection = sectionId;

            // Update link navigasi aktif di sidebar
            App.utils.$$('.sidebar-nav .nav-link').forEach(nav => nav.classList.remove('active'));
            const activeNavLink = App.utils.$(`.sidebar-nav .nav-link[href="#${sectionId}"]`);
            if (activeNavLink) activeNavLink.classList.add('active');

            // Update judul halaman
            const pageTitle = activeNavLink ? activeNavLink.textContent.trim() : 'Dasbor';
            document.title = `Green Valley - ${pageTitle}`;

            // Fokus ke konten utama untuk aksesibilitas
            App.elements.mainAppContent.focus();

            if (updateHistory) {
              window.history.pushState({ section: sectionId }, pageTitle, `#${sectionId}`);
            }
            // Panggil fungsi render spesifik jika ada
            if (typeof App.render[sectionId] === 'function') {
              App.render[sectionId]();
            }
            App.render.updateStats(); // Selalu update stats saat navigasi

          } else {
            console.warn(`Section dengan ID "${sectionId}" tidak ditemukan. Kembali ke Beranda.`);
            App.navigation.navigateTo('beranda'); // Fallback ke beranda jika section tidak ada
          }
        }
      },

      // Modul Tab (untuk fitur di dalam section)
      tabs: {
        init: () => {
          App.utils.$$('.feature-tabs').forEach(tabContainer => {
            const tabButtons = App.utils.$$('.feature-tab', tabContainer);
            const tabContents = App.utils.$$('.feature-tab-content', tabContainer.parentElement); // Konten ada di luar .feature-tabs

            tabButtons.forEach(button => {
              button.addEventListener('click', () => {
                // Hapus aktif dari semua tombol dan konten
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));

                // Aktifkan tombol dan konten yang diklik
                button.classList.add('active');
                const targetContentId = button.dataset.tabTarget;
                const targetContentElement = App.utils.$(targetContentId);
                if (targetContentElement) {
                  targetContentElement.classList.add('active');
                }
              });
            });
          });
        }
      },

      // Modul untuk Data (CRUD sederhana)
      data: {
        // Penyewa
        addTenant: (tenantData) => {
          const newTenant = { id: App.utils.generateId('T'), status: 'Aktif', ...tenantData };
          App.state.tenants.push(newTenant);
          App.render.tenants(); // Re-render daftar penyewa
          App.render.populateTenantOptions(); // Update dropdown di form pembayaran
          App.utils.showToast('Penyewa baru berhasil ditambahkan.', 'success');
          return newTenant;
        },
        // Unit
        addUnit: (unitData) => {
          const newUnit = { id: App.utils.generateId('U'), ...unitData };
          App.state.units.push(newUnit);
          App.render.units(); // Re-render daftar unit
          App.render.populateUnitOptions(); // Update dropdown di form tambah penyewa
          App.utils.showToast('Unit properti berhasil ditambahkan.', 'success');
          return newUnit;
        },
        // Pembayaran
        addPayment: (paymentData) => {
          const newPayment = { id: App.utils.generateId('P'), ...paymentData };
          App.state.payments.push(newPayment);
          App.render.payments(); // Re-render riwayat pembayaran
          App.utils.showToast('Pembayaran berhasil dicatat.', 'success');
          return newPayment;
        },
        // Fungsi untuk mengambil data dari localStorage (jika ada)
        load: () => {
          const storedTenants = localStorage.getItem('greenValleyTenants');
          if (storedTenants) App.state.tenants = JSON.parse(storedTenants);

          const storedUnits = localStorage.getItem('greenValleyUnits');
          if (storedUnits) App.state.units = JSON.parse(storedUnits);

          const storedPayments = localStorage.getItem('greenValleyPayments');
          if (storedPayments) App.state.payments = JSON.parse(storedPayments);
        },
        // Fungsi untuk menyimpan data ke localStorage
        save: () => {
          localStorage.setItem('greenValleyTenants', JSON.stringify(App.state.tenants));
          localStorage.setItem('greenValleyUnits', JSON.stringify(App.state.units));
          localStorage.setItem('greenValleyPayments', JSON.stringify(App.state.payments));
        }
      },

      // Modul untuk merender berbagai bagian UI
      render: {
        // Beranda (Update Statistik)
        beranda: () => {
          App.render.updateStats();
        },
        updateStats: () => {
          if (App.elements.totalUnitsStat) App.elements.totalUnitsStat.textContent = App.state.units.length;
          if (App.elements.rentedUnitsStat) App.elements.rentedUnitsStat.textContent = App.state.units.filter(u => u.status === 'Tersewa').length;
          if (App.elements.vacantUnitsStat) App.elements.vacantUnitsStat.textContent = App.state.units.filter(u => u.status === 'Tersedia').length;
          if (App.elements.totalTenantsStat) App.elements.totalTenantsStat.textContent = App.state.tenants.filter(t => t.status === 'Aktif').length;
        },

        // Penyewa
        tenants: () => {
          const container = App.elements.tenantListContainer;
          if (!container) return;

          if (App.state.tenants.length === 0) {
            container.innerHTML = `<p class="text-center text-muted py-5"><i class="fas fa-users-slash fa-3x mb-3"></i><br>Belum ada data penyewa. <br>Silakan tambahkan penyewa baru melalui tombol di atas.</p>`;
            return;
          }

          let html = `<div class="table-responsive"><table class="table" style="width:100%; border-collapse: collapse;">
            <thead><tr>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Nama</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Email</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Telepon</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Unit</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Sewa/Bln</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Status</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Aksi</th>
            </tr></thead><tbody>`;

          App.state.tenants.forEach(tenant => {
            const unit = App.state.units.find(u => u.id === tenant.unitId);
            html += `
              <tr style="border-bottom: 1px solid var(--color-border);">
                <td style="padding:var(--space-3);">${tenant.name}</td>
                <td style="padding:var(--space-3);">${tenant.email}</td>
                <td style="padding:var(--space-3);">${tenant.phone}</td>
                <td style="padding:var(--space-3);">${unit ? unit.name : '-'}</td>
                <td style="padding:var(--space-3);">${App.utils.formatCurrency(tenant.rentAmount)}</td>
                <td style="padding:var(--space-3);"><span class="badge ${tenant.status === 'Aktif' ? 'badge-success' : 'badge-warning'}">${tenant.status}</span></td>
                <td style="padding:var(--space-3);">
                  <button class="btn btn-sm btn-outline-primary" onclick="App.handlers.editTenant('${tenant.id}')" aria-label="Edit ${tenant.name}"><i class="fas fa-edit"></i></button>
                  <button class="btn btn-sm btn-danger" onclick="App.handlers.deleteTenant('${tenant.id}')" aria-label="Hapus ${tenant.name}"><i class="fas fa-trash-alt"></i></button>
                </td>
              </tr>`;
          });
          html += `</tbody></table></div>`;
          container.innerHTML = html;
          App.data.save(); // Simpan perubahan ke localStorage
        },
        populateTenantOptions: () => {
          const selectElement = App.elements.paymentTenantId;
          if (!selectElement) return;
          selectElement.innerHTML = `<option value="">-- Pilih ID Penyewa --</option>`; // Reset
          App.state.tenants.filter(t => t.status === 'Aktif').forEach(tenant => {
            const option = document.createElement('option');
            option.value = tenant.id;
            option.textContent = `${tenant.name} (${tenant.id})`;
            selectElement.appendChild(option);
          });
        },

        // Unit
        units: () => {
          const container = App.elements.unitListContainer;
          if (!container) return;

          if (App.state.units.length === 0) {
            container.innerHTML = `<p class="text-center text-muted py-5"><i class="fas fa-door-closed fa-3x mb-3"></i><br>Belum ada data unit properti. <br>Silakan tambahkan unit baru.</p>`;
            return;
          }

          let html = `<div class="table-responsive"><table class="table" style="width:100%; border-collapse: collapse;">
            <thead><tr>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Nama Unit</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Tipe</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Harga Sewa/Bln</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Status</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Penyewa</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Aksi</th>
            </tr></thead><tbody>`;

          App.state.units.forEach(unit => {
            const tenant = App.state.tenants.find(t => t.unitId === unit.id && t.status === 'Aktif');
            let statusClass = '';
            if (unit.status === 'Tersedia') statusClass = 'badge-success';
            else if (unit.status === 'Tersewa') statusClass = 'badge-info';
            else if (unit.status === 'Perbaikan') statusClass = 'badge-warning';
            else statusClass = 'badge-secondary';

            html += `
              <tr style="border-bottom: 1px solid var(--color-border);">
                <td style="padding:var(--space-3);">${unit.name}</td>
                <td style="padding:var(--space-3);">${unit.type}</td>
                <td style="padding:var(--space-3);">${App.utils.formatCurrency(unit.price)}</td>
                <td style="padding:var(--space-3);"><span class="badge ${statusClass}">${unit.status}</span></td>
                <td style="padding:var(--space-3);">${tenant ? tenant.name : (unit.status === 'Tersewa' ? '<em>Tidak diketahui</em>' : '-')}</td>
                <td style="padding:var(--space-3);">
                  <button class="btn btn-sm btn-outline-primary" onclick="App.handlers.editUnit('${unit.id}')" aria-label="Edit ${unit.name}"><i class="fas fa-edit"></i></button>
                  <button class="btn btn-sm btn-danger" onclick="App.handlers.deleteUnit('${unit.id}')" aria-label="Hapus ${unit.name}"><i class="fas fa-trash-alt"></i></button>
                </td>
              </tr>`;
          });
          html += `</tbody></table></div>`;
          container.innerHTML = html;
          App.data.save(); // Simpan perubahan ke localStorage
        },
        populateUnitOptions: () => {
          const selectElement = App.elements.tenantUnitId;
          if (!selectElement) return;
          selectElement.innerHTML = `<option value="">-- Pilih Unit --</option>`; // Reset
          App.state.units.filter(u => u.status === 'Tersedia').forEach(unit => { // Hanya unit tersedia
            const option = document.createElement('option');
            option.value = unit.id;
            option.textContent = `${unit.name} (${unit.type}) - ${App.utils.formatCurrency(unit.price)}`;
            selectElement.appendChild(option);
          });
        },

        // Pembayaran
        payments: () => {
          const container = App.elements.paymentHistoryContainer;
          if (!container) return;

          if (App.state.payments.length === 0) {
            container.innerHTML = `<p class="text-center text-muted py-5"><i class="fas fa-file-invoice-dollar fa-3x mb-3"></i><br>Belum ada riwayat pembayaran.</p>`;
            return;
          }

          let html = `<div class="table-responsive"><table class="table" style="width:100%; border-collapse: collapse;">
            <thead><tr>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Tanggal</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">ID Penyewa</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Nama Penyewa</th>
              <th style="padding:var(--space-3); text-align:right; border-bottom: 2px solid var(--color-border);">Jumlah</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Metode</th>
              <th style="padding:var(--space-3); text-align:left; border-bottom: 2px solid var(--color-border);">Catatan</th>
            </tr></thead><tbody>`;

          App.state.payments.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(payment => { // Urutkan terbaru dulu
            const tenant = App.state.tenants.find(t => t.id === payment.tenantId);
            html += `
              <tr style="border-bottom: 1px solid var(--color-border);">
                <td style="padding:var(--space-3);">${App.utils.formatDate(payment.date)}</td>
                <td style="padding:var(--space-3);">${payment.tenantId}</td>
                <td style="padding:var(--space-3);">${tenant ? tenant.name : 'N/A'}</td>
                <td style="padding:var(--space-3); text-align:right;">${App.utils.formatCurrency(payment.amount)}</td>
                <td style="padding:var(--space-3);">${payment.method || 'N/A'}</td>
                <td style="padding:var(--space-3);">${payment.notes || '-'}</td>
              </tr>`;
          });
          html += `</tbody></table></div>`;
          container.innerHTML = html;
          App.data.save();
        },

        // Komunikasi (Chat)
        chatMessages: () => {
          const chatBox = App.elements.chatBoxMessages;
          if (!chatBox) return;
          chatBox.innerHTML = ''; // Bersihkan pesan lama
          App.state.chatMessages.forEach(msg => {
            const messageEl = document.createElement('div');
            messageEl.classList.add('chat-message', msg.type === 'user' ? 'user' : 'other');

            const textEl = document.createElement('p');
            textEl.textContent = msg.text;
            messageEl.appendChild(textEl);

            const metaEl = document.createElement('span');
            metaEl.classList.add('chat-message-meta');
            metaEl.textContent = `${msg.sender} - ${msg.time}`;
            messageEl.appendChild(metaEl);

            chatBox.appendChild(messageEl);
          });
          // Scroll ke pesan terbaru
          chatBox.scrollTop = chatBox.scrollHeight;
        },

        // Virtual Tour
        virtualTour: () => {
          const imgElement = App.elements.virtualTourImage;
          if (imgElement) {
            imgElement.src = App.config.virtualTourImages[App.config.currentTourImageIndex];
            imgElement.alt = `Tur Virtual - Gambar ${App.config.currentTourImageIndex + 1}`;
          }
        }
      },

      // Modul untuk menangani event dan interaksi pengguna
      handlers: {
        init: () => {
          // Penanganan form
          App.elements.paymentForm?.addEventListener('submit', App.handlers.submitPaymentForm);
          App.elements.chatForm?.addEventListener('submit', App.handlers.submitChatForm);
          App.elements.addTenantForm?.addEventListener('submit', App.handlers.submitAddTenantForm);
          App.elements.addUnitForm?.addEventListener('submit', App.handlers.submitAddUnitForm);

          // Penanganan modal
          App.utils.$$('[data-dismiss-modal]').forEach(btn => {
            btn.addEventListener('click', () => App.utils.closeModal(btn.dataset.dismissModal));
          });
          App.utils.$$('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => { // Tutup modal jika klik di luar dialog
              if (e.target === modal) App.utils.closeModal(modal.id);
            });
          });
          document.addEventListener('keydown', (e) => { // Tutup modal dengan tombol Escape
            if (e.key === 'Escape' && App.state.modalOpen) {
              App.utils.closeModal(App.state.modalOpen);
            }
          });

          // Penanganan pemilihan metode pembayaran
          App.utils.$$('.payment-method').forEach(method => {
            method.addEventListener('click', (e) => {
              App.utils.$$('.payment-method').forEach(el => {
                el.classList.remove('active');
                el.setAttribute('aria-pressed', 'false');
              });
              e.currentTarget.classList.add('active');
              e.currentTarget.setAttribute('aria-pressed', 'true');
              // Simpan metode terpilih jika perlu, misal di state atau input hidden
            });
            // Aksesibilitas keyboard untuk payment method
            method.addEventListener('keydown', (e) => {
              if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                method.click();
              }
            });
          });

          // Penanganan tur virtual
          App.elements.tourPrevBtn?.addEventListener('click', App.handlers.prevTourImage);
          App.elements.tourNextBtn?.addEventListener('click', App.handlers.nextTourImage);
          App.elements.tourZoomBtn?.addEventListener('click', App.handlers.toggleZoomTourImage);

          // Penanganan logout
          App.elements.logoutButton?.addEventListener('click', App.handlers.logout);

          // Penanganan Ekspor Data
          App.elements.exportDataBtn?.addEventListener('click', App.handlers.exportData);

          // Penanganan status koneksi
          window.addEventListener('online', () => App.handlers.updateConnectionStatus(true));
          window.addEventListener('offline', () => App.handlers.updateConnectionStatus(false));
          App.handlers.updateConnectionStatus(App.state.isOnline); // Set status awal
        },

        submitPaymentForm: (e) => {
          e.preventDefault();
          const form = e.target;
          if (App.utils.validateForm(form)) {
            const formData = new FormData(form);
            const paymentData = {
              tenantId: formData.get('tenantId'),
              amount: parseFloat(formData.get('amount')),
              date: formData.get('date'),
              notes: formData.get('notes'),
              method: App.utils.$('.payment-method.active')?.dataset.method || 'Tidak Diketahui'
            };
            App.data.addPayment(paymentData);
            form.reset();
            App.utils.$$('.payment-method').forEach((el, idx) => { // Reset pilihan metode pembayaran
              el.classList.toggle('active', idx === 0);
              el.setAttribute('aria-pressed', idx === 0 ? 'true' : 'false');
            });
          } else {
            App.utils.showToast('Harap perbaiki error pada form sebelum mengirim.', 'warning');
          }
        },

        submitChatForm: (e) => {
          e.preventDefault();
          const input = App.elements.chatMessageInput;
          const messageText = input.value.trim();
          if (App.utils.validateField(input, { required: true, messages: { required: "Pesan tidak boleh kosong." } })) {
            const newMessage = {
              sender: 'Admin', // Atau nama pengguna yang login
              text: messageText,
              time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }),
              type: 'user'
            };
            App.state.chatMessages.push(newMessage);
            App.render.chatMessages();
            input.value = '';
            input.focus();

            // Simulasi balasan otomatis setelah beberapa saat
            setTimeout(() => {
              const reply = {
                sender: 'Sistem (Bot)',
                text: `Terima kasih atas pesan Anda: "${messageText.substring(0, 20)}...". Kami akan segera merespons.`,
                time: new Date().toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' }),
                type: 'other'
              };
              App.state.chatMessages.push(reply);
              App.render.chatMessages();
            }, 1500);

          }
        },

        submitAddTenantForm: (e) => {
          e.preventDefault();
          const form = e.target;
          if (App.utils.validateForm(form)) {
            const formData = new FormData(form);
            const tenantData = {
              name: formData.get('name'),
              email: formData.get('email'),
              phone: formData.get('phone'),
              unitId: formData.get('unitId'),
              rentAmount: parseFloat(formData.get('rentAmount'))
            };
            App.data.addTenant(tenantData);
            form.reset();
            App.utils.closeModal('addTenantModal');
          } else {
            App.utils.showToast('Harap perbaiki error pada form sebelum menyimpan.', 'warning');
          }
        },

        submitAddUnitForm: (e) => {
          e.preventDefault();
          const form = e.target;
          if (App.utils.validateForm(form)) {
            const formData = new FormData(form);
            const unitData = {
              name: formData.get('name'),
              type: formData.get('type'),
              status: formData.get('status'),
              price: parseFloat(formData.get('price'))
            };
            App.data.addUnit(unitData);
            form.reset();
            App.utils.closeModal('addUnitModal');
          } else {
            App.utils.showToast('Harap perbaiki error pada form sebelum menyimpan.', 'warning');
          }
        },

        // Handler untuk CRUD (Edit, Delete) - contoh dasar
        editTenant: (tenantId) => {
          const tenant = App.state.tenants.find(t => t.id === tenantId);
          if (!tenant) {
            App.utils.showToast('Penyewa tidak ditemukan.', 'error');
            return;
          }
          // Isi form modal dengan data tenant, lalu buka modal
          // Contoh: App.utils.$('#tenantName', App.elements.addTenantForm).value = tenant.name; ... (dst)
          // App.utils.openModal('addTenantModal'); // Mungkin perlu modal edit terpisah atau adaptasi modal tambah
          App.utils.showToast(`Fitur edit untuk ${tenant.name} belum diimplementasikan sepenuhnya.`, 'info');
        },
        deleteTenant: (tenantId) => {
          const tenant = App.state.tenants.find(t => t.id === tenantId);
          if (tenant && confirm(`Apakah Anda yakin ingin menghapus penyewa "${tenant.name}"?`)) {
            App.state.tenants = App.state.tenants.filter(t => t.id !== tenantId);
            App.render.tenants();
            App.render.populateTenantOptions();
            App.utils.showToast(`Penyewa "${tenant.name}" berhasil dihapus.`, 'success');
          }
        },
        editUnit: (unitId) => {
          const unit = App.state.units.find(u => u.id === unitId);
          if (!unit) { App.utils.showToast('Unit tidak ditemukan.', 'error'); return; }
          App.utils.showToast(`Fitur edit untuk unit "${unit.name}" belum diimplementasikan.`, 'info');
        },
        deleteUnit: (unitId) => {
          const unit = App.state.units.find(u => u.id === unitId);
          if (unit && confirm(`Apakah Anda yakin ingin menghapus unit "${unit.name}"?`)) {
            // Cek apakah unit sedang disewa
            const isRented = App.state.tenants.some(t => t.unitId === unitId && t.status === 'Aktif');
            if (isRented) {
              App.utils.showToast(`Unit "${unit.name}" tidak dapat dihapus karena sedang disewa.`, 'warning');
              return;
            }
            App.state.units = App.state.units.filter(u => u.id !== unitId);
            App.render.units();
            App.render.populateUnitOptions();
            App.utils.showToast(`Unit "${unit.name}" berhasil dihapus.`, 'success');
          }
        },

        // Tur Virtual
        prevTourImage: () => {
          App.config.currentTourImageIndex = (App.config.currentTourImageIndex - 1 + App.config.virtualTourImages.length) % App.config.virtualTourImages.length;
          App.render.virtualTour();
        },
        nextTourImage: () => {
          App.config.currentTourImageIndex = (App.config.currentTourImageIndex + 1) % App.config.virtualTourImages.length;
          App.render.virtualTour();
        },
        toggleZoomTourImage: () => {
          App.elements.virtualTourImage?.classList.toggle('zoomed');
          const zoomIcon = App.utils.$('i', App.elements.tourZoomBtn);
          if (zoomIcon) {
            zoomIcon.className = App.elements.virtualTourImage.classList.contains('zoomed') ? 'fas fa-search-minus' : 'fas fa-search-plus';
          }
        },

        // Logout
        logout: () => {
          if (confirm("Apakah Anda yakin ingin keluar dari aplikasi Green Valley?")) {
            App.utils.showToast("Anda telah berhasil keluar.", "success");
            // Di aplikasi nyata, ini akan menghapus token sesi, cookie, dll.
            // Untuk SPA sederhana ini, kita bisa simulasi reset state atau redirect.
            // window.location.href = "halaman_login.html"; // Jika ada halaman login
            // Reset state sederhana:
            App.state.tenants = [];
            App.state.units = [];
            App.state.payments = [];
            App.data.save(); // Simpan state kosong
            App.navigation.navigateTo('beranda'); // Kembali ke beranda setelah logout
            App.utils.showToast("Sesi telah direset. Silakan login kembali (simulasi).", "info", 6000);
          }
        },

        // Ekspor Data
        exportData: () => {
          // Gabungkan data penyewa dan unit (contoh sederhana)
          let csvContent = "data:text/csv;charset=utf-8,";
          csvContent += "Tipe Data,ID,Nama,Email,Telepon,Unit Disewa,Harga Sewa,Status\n"; // Header CSV

          App.state.tenants.forEach(tenant => {
            const unit = App.state.units.find(u => u.id === tenant.unitId);
            const row = [
              "Penyewa",
              tenant.id,
              `"${tenant.name}"`, // Kutip untuk nama dengan spasi
              tenant.email,
              tenant.phone,
              `"${unit ? unit.name : '-'}"`,
              tenant.rentAmount,
              tenant.status
            ].join(",");
            csvContent += row + "\n";
          });

          csvContent += "\nID Unit,Nama Unit,Tipe,Harga Sewa,Status\n"; // Header untuk unit
          App.state.units.forEach(unit => {
            const row = [
              unit.id,
              `"${unit.name}"`,
              unit.type,
              unit.price,
              unit.status
            ].join(",");
            csvContent += row + "\n";
          });

          const encodedUri = encodeURI(csvContent);
          const link = document.createElement("a");
          link.setAttribute("href", encodedUri);
          link.setAttribute("download", "green_valley_data.csv");
          document.body.appendChild(link); // Diperlukan untuk Firefox
          link.click();
          document.body.removeChild(link);
          App.utils.showToast("Data berhasil diekspor sebagai CSV.", "success");
        },

        // Status Koneksi
        updateConnectionStatus: (isOnline) => {
          App.state.isOnline = isOnline;
          const statusBar = App.elements.connectionStatusBar;
          if (statusBar) {
            if (isOnline) {
              statusBar.textContent = "Koneksi internet terhubung (Online)";
              statusBar.className = 'status-bar online';
            } else {
              statusBar.textContent = "Koneksi internet terputus (Offline)";
              statusBar.className = 'status-bar offline';
            }
          }
        }
      },

      // Fungsi inisialisasi utama aplikasi
      init: () => {
        // Cache elemen DOM utama
        App.elements = {
          themeToggleBtn: App.utils.$('#themeToggleBtn'),
          themeSelector: App.utils.$('#themeSelector'),
          mainAppContent: App.utils.$('#mainAppContent'),
          logoutButton: App.utils.$('#logoutButton'),
          exportDataBtn: App.utils.$('#exportDataBtn'),
          currentYear: App.utils.$('#currentYear'),
          // Stats
          totalUnitsStat: App.utils.$('#totalUnitsStat'),
          rentedUnitsStat: App.utils.$('#rentedUnitsStat'),
          vacantUnitsStat: App.utils.$('#vacantUnitsStat'),
          totalTenantsStat: App.utils.$('#totalTenantsStat'),
          // Form
          paymentForm: App.utils.$('#paymentForm'),
          chatForm: App.utils.$('#chatForm'),
          addTenantForm: App.utils.$('#addTenantForm'),
          addUnitForm: App.utils.$('#addUnitForm'),
          // Container List
          tenantListContainer: App.utils.$('#tenantListContainer'),
          unitListContainer: App.utils.$('#unitListContainer'),
          paymentHistoryContainer: App.utils.$('#paymentHistoryContainer'),
          // Chat
          chatBoxMessages: App.utils.$('#chatBoxMessages'),
          chatMessageInput: App.utils.$('#chatMessageInput'),
          // Modal Inputs (contoh)
          tenantUnitId: App.utils.$('#tenantUnitId'), // select di form tambah penyewa
          paymentTenantId: App.utils.$('#paymentTenantId'), // select di form pembayaran
          // Tur Virtual
          virtualTourImage: App.utils.$('#virtualTourImage'),
          tourPrevBtn: App.utils.$('#tourPrevBtn'),
          tourNextBtn: App.utils.$('#tourNextBtn'),
          tourZoomBtn: App.utils.$('#tourZoomBtn'),
          // Toast & Status Bar
          toastContainer: App.utils.$('#toastContainer'),
          toastIcon: App.utils.$('#toastIcon', App.utils.$('#toastContainer')),
          toastMessage: App.utils.$('#toastMessage', App.utils.$('#toastContainer')),
          connectionStatusBar: App.utils.$('#connectionStatusBar'),
        };

        // Muat data dari localStorage
        App.data.load();

        // Inisialisasi modul-modul
        App.theme.init();
        App.navigation.init();
        App.tabs.init();
        App.handlers.init();

        // Render awal data
        App.render.tenants();
        App.render.units();
        App.render.payments();
        App.render.chatMessages();
        App.render.virtualTour();
        App.render.updateStats(); // Panggil setelah data dimuat
        App.render.populateTenantOptions();
        App.render.populateUnitOptions();


        if (App.elements.currentYear) {
          App.elements.currentYear.textContent = new Date().getFullYear();
        }

        console.log("Aplikasi Green Valley berhasil diinisialisasi.");
        App.utils.showToast("Selamat datang di Green Valley!", "info");
      }
    };

    // Jalankan aplikasi setelah DOM sepenuhnya dimuat
    document.addEventListener('DOMContentLoaded', App.init);

  </script>
</body>

</html>