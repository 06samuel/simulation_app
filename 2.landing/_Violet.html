<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Green Valley - Solusi Rental Apartemen Modern</title>
  <!-- Favicon (ganti dengan favicon Anda jika perlu) -->
  <link rel="icon" href="https://img.icons8.com/fluency/48/000000/building.png" type="image/png">

  <!-- Font Awesome (Ikon) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Flatpickr (Kalender) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@700&display=swap"
    rel="stylesheet">

  <style>
    /* === VARIABLE CSS === */
    :root {
      --primary-color: #0D6EFD;
      /* Biru utama Bootstrap yang sedikit dimodifikasi */
      --primary-color-darker: #0A58CA;
      --secondary-color: #6c757d;
      /* Abu-abu sekunder */
      --success-color: #198754;
      --warning-color: #ffc107;
      --danger-color: #dc3545;
      --light-color: #f8f9fa;
      --dark-color: #212529;
      --text-color: #343a40;
      --text-muted-color: #6c757d;
      --background-color: #f0f2f5;
      /* Latar belakang utama aplikasi */
      --surface-color: #ffffff;
      /* Latar belakang untuk card, modal, dll. */

      --font-primary: 'Poppins', sans-serif;
      --font-display: 'Playfair Display', serif;

      --border-radius-sm: 0.25rem;
      /* 4px */
      --border-radius-md: 0.5rem;
      /* 8px */
      --border-radius-lg: 0.75rem;
      /* 12px */
      --border-radius-xl: 1rem;
      /* 16px */
      --border-radius-circle: 50%;

      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05), 0 1px 2px rgba(0, 0, 0, 0.03);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.07), 0 2px 4px -1px rgba(0, 0, 0, 0.04);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.07), 0 10px 10px -5px rgba(0, 0, 0, 0.04);

      --transition-fast: all 0.2s ease-in-out;
      --transition-medium: all 0.3s ease-in-out;
      --transition-slow: all 0.5s ease-in-out;

      --container-max-width: 1200px;
      --spacing-unit: 1rem;
      /* 16px */
    }

    /* === RESET & DASAR === */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      scroll-behavior: smooth;
      font-size: 100%;
      /* 16px */
    }

    body {
      font-family: var(--font-primary);
      background-color: var(--background-color);
      color: var(--text-color);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      overflow-x: hidden;
      /* Mencegah scroll horizontal yang tidak diinginkan */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* Pembungkus utama untuk konten SPA */
    #app-shell {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    /* Kontainer utama untuk konten yang berubah */
    main#app-content {
      flex-grow: 1;
      padding: calc(var(--spacing-unit) * 1.5) 0;
      /* 24px top/bottom padding */
      opacity: 0;
      /* Untuk transisi halaman */
      transform: translateY(20px);
      /* Untuk transisi halaman */
      transition: opacity 0.4s ease-out, transform 0.4s ease-out;
      will-change: opacity, transform;
      /* Optimasi transisi */
    }

    main#app-content.loaded {
      opacity: 1;
      transform: translateY(0);
    }

    .container {
      width: 90%;
      max-width: var(--container-max-width);
      margin-left: auto;
      margin-right: auto;
      padding-left: var(--spacing-unit);
      padding-right: var(--spacing-unit);
    }

    /* === UTILITAS === */
    .text-primary {
      color: var(--primary-color) !important;
    }

    .text-success {
      color: var(--success-color) !important;
    }

    .text-warning {
      color: var(--warning-color) !important;
    }

    .text-danger {
      color: var(--danger-color) !important;
    }

    .text-muted {
      color: var(--text-muted-color) !important;
    }

    .bg-primary {
      background-color: var(--primary-color) !important;
    }

    .bg-light {
      background-color: var(--light-color) !important;
    }

    .bg-surface {
      background-color: var(--surface-color) !important;
    }

    .fw-bold {
      font-weight: 700 !important;
    }

    .fw-semibold {
      font-weight: 600 !important;
    }

    .fw-medium {
      font-weight: 500 !important;
    }

    .d-none {
      display: none !important;
    }

    .d-block {
      display: block !important;
    }

    .d-flex {
      display: flex !important;
    }

    .justify-content-between {
      justify-content: space-between !important;
    }

    .align-items-center {
      align-items: center !important;
    }

    .mb-1 {
      margin-bottom: calc(var(--spacing-unit) * 0.25) !important;
    }

    .mb-2 {
      margin-bottom: calc(var(--spacing-unit) * 0.5) !important;
    }

    .mb-3 {
      margin-bottom: var(--spacing-unit) !important;
    }

    .mb-4 {
      margin-bottom: calc(var(--spacing-unit) * 1.5) !important;
    }

    .mb-5 {
      margin-bottom: calc(var(--spacing-unit) * 3) !important;
    }

    .mt-1 {
      margin-top: calc(var(--spacing-unit) * 0.25) !important;
    }

    .mt-2 {
      margin-top: calc(var(--spacing-unit) * 0.5) !important;
    }

    .mt-3 {
      margin-top: var(--spacing-unit) !important;
    }

    .mt-4 {
      margin-top: calc(var(--spacing-unit) * 1.5) !important;
    }

    .mt-5 {
      margin-top: calc(var(--spacing-unit) * 3) !important;
    }

    .ms-2 {
      margin-left: calc(var(--spacing-unit) * 0.5) !important;
    }

    .me-2 {
      margin-right: calc(var(--spacing-unit) * 0.5) !important;
    }

    .me-3 {
      margin-right: var(--spacing-unit) !important;
    }

    .p-1 {
      padding: calc(var(--spacing-unit) * 0.25) !important;
    }

    .p-2 {
      padding: calc(var(--spacing-unit) * 0.5) !important;
    }

    .p-3 {
      padding: var(--spacing-unit) !important;
    }

    .p-4 {
      padding: calc(var(--spacing-unit) * 1.5) !important;
    }

    .p-5 {
      padding: calc(var(--spacing-unit) * 3) !important;
    }

    .text-center {
      text-align: center !important;
    }

    .rounded {
      border-radius: var(--border-radius-md) !important;
    }

    .rounded-lg {
      border-radius: var(--border-radius-lg) !important;
    }

    .rounded-circle {
      border-radius: var(--border-radius-circle) !important;
    }

    .shadow-sm {
      box-shadow: var(--shadow-sm) !important;
    }

    .shadow-md {
      box-shadow: var(--shadow-md) !important;
    }

    .shadow-lg {
      box-shadow: var(--shadow-lg) !important;
    }

    .img-fluid {
      max-width: 100%;
      height: auto;
    }

    .w-100 {
      width: 100% !important;
    }

    .visually-hidden {
      position: absolute !important;
      width: 1px !important;
      height: 1px !important;
      padding: 0 !important;
      margin: -1px !important;
      overflow: hidden !important;
      clip: rect(0, 0, 0, 0) !important;
      white-space: nowrap !important;
      border: 0 !important;
    }

    /* === HEADER / NAVBAR === */
    .app-header {
      background-color: var(--surface-color);
      box-shadow: var(--shadow-md);
      padding: calc(var(--spacing-unit) * 0.75) 0;
      position: sticky;
      top: 0;
      z-index: 1000;
      transition: var(--transition-medium);
    }

    .app-header.scrolled {
      box-shadow: var(--shadow-lg);
      padding: calc(var(--spacing-unit) * 0.5) 0;
    }

    .navbar-brand {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: var(--dark-color);
      transition: var(--transition-fast);
    }

    .navbar-brand:hover {
      opacity: 0.8;
    }

    .navbar-brand__logo {
      width: 40px;
      height: 40px;
      margin-right: calc(var(--spacing-unit) * 0.75);
      border-radius: var(--border-radius-circle);
      object-fit: cover;
      transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    .navbar-brand:hover .navbar-brand__logo {
      transform: rotate(10deg) scale(1.1);
    }

    .navbar-brand__name {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 700;
    }

    .nav-links {
      list-style: none;
      display: flex;
      align-items: center;
    }

    .nav-links li {
      margin-left: calc(var(--spacing-unit) * 1.25);
    }

    .nav-links a {
      text-decoration: none;
      color: var(--text-color);
      font-weight: 500;
      padding: calc(var(--spacing-unit) * 0.5) calc(var(--spacing-unit) * 0.75);
      border-radius: var(--border-radius-sm);
      position: relative;
      transition: var(--transition-fast);
    }

    .nav-links a .fa-fw {
      width: 1.25em;
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background-color: var(--primary-color);
      transition: width 0.3s ease-out;
    }

    .nav-links a:hover,
    .nav-links a.active {
      color: var(--primary-color);
    }

    .nav-links a:hover::after,
    .nav-links a.active::after {
      width: 70%;
    }

    .navbar-page-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-color);
      letter-spacing: 0.5px;
      opacity: 0;
      animation: fadeInRightSlight 0.8s 0.3s forwards;
    }

    .mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 1.8rem;
      color: var(--dark-color);
      cursor: pointer;
      padding: calc(var(--spacing-unit) * 0.25);
      z-index: 1001;
    }

    /* === KOMPONEN UMUM === */
    .button {
      display: inline-block;
      padding: calc(var(--spacing-unit) * 0.6) calc(var(--spacing-unit) * 1.2);
      font-size: 0.95rem;
      font-weight: 600;
      text-decoration: none;
      border: none;
      border-radius: var(--border-radius-md);
      cursor: pointer;
      transition: var(--transition-medium);
      box-shadow: var(--shadow-sm);
      text-align: center;
    }

    .button-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-color-darker));
      color: var(--surface-color);
    }

    .button-primary:hover,
    .button-primary:focus {
      background: linear-gradient(135deg, var(--primary-color-darker), var(--primary-color));
      transform: translateY(-2px) scale(1.03);
      box-shadow: var(--shadow-lg);
      outline: none;
    }

    .button-secondary {
      background-color: var(--secondary-color);
      color: var(--surface-color);
    }

    .button-secondary:hover,
    .button-secondary:focus {
      background-color: #5a6268;
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
      outline: none;
    }

    .card {
      background-color: var(--surface-color);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
      padding: calc(var(--spacing-unit) * 1.5);
      transition: var(--transition-medium);
      overflow: hidden;
    }

    .card:hover {
      box-shadow: var(--shadow-xl);
      transform: translateY(-5px);
    }

    .card-title {
      font-family: var(--font-display);
      font-size: 1.5rem;
      margin-bottom: calc(var(--spacing-unit) * 0.75);
      color: var(--primary-color);
    }

    .form-group {
      margin-bottom: var(--spacing-unit);
    }

    .form-label {
      display: block;
      font-weight: 500;
      margin-bottom: calc(var(--spacing-unit) * 0.3);
      color: var(--text-color);
    }

    .form-control {
      width: 100%;
      padding: calc(var(--spacing-unit) * 0.6) var(--spacing-unit);
      font-size: 0.95rem;
      border: 1px solid #ced4da;
      border-radius: var(--border-radius-sm);
      transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
      background-color: var(--surface-color);
      color: var(--text-color);
    }

    .form-control::placeholder {
      color: var(--text-muted-color);
      opacity: 0.7;
    }

    .form-control:focus {
      border-color: var(--primary-color);
      outline: 0;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }

    .form-control.is-invalid {
      border-color: var(--danger-color);
    }

    .form-control.is-invalid:focus {
      box-shadow: 0 0 0 .2rem rgba(220, 53, 69, .25);
    }

    .invalid-feedback {
      display: none;
      width: 100%;
      margin-top: .25rem;
      font-size: .875em;
      color: var(--danger-color);
    }

    .form-control.is-invalid~.invalid-feedback,
    .was-validated .form-control:invalid~.invalid-feedback {
      display: block;
    }

    .was-validated :invalid~.invalid-feedback,
    .was-validated :invalid.form-control {
      display: block;
    }

    .was-validated .form-control:invalid {
      border-color: var(--danger-color);
    }

    .alert {
      padding: var(--spacing-unit);
      margin-bottom: var(--spacing-unit);
      border: 1px solid transparent;
      border-radius: var(--border-radius-sm);
    }

    .alert-success {
      color: #0f5132;
      background-color: #d1e7dd;
      border-color: #badbcc;
    }

    .alert-danger {
      color: #842029;
      background-color: #f8d7da;
      border-color: #f5c2c7;
    }

    /* === BAGIAN SPESIFIK HALAMAN (CONTOH) === */
    .hero-section {
      background: linear-gradient(rgba(13, 110, 253, 0.7), rgba(10, 88, 202, 0.85)), url('https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?auto=format&fit=crop&w=1200&q=80') no-repeat center center/cover;
      color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 5) 0;
      text-align: center;
      border-radius: 0 0 var(--border-radius-xl) var(--border-radius-xl);
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .hero-section__title {
      font-family: var(--font-display);
      font-size: 3rem;
      margin-bottom: var(--spacing-unit);
      animation: fadeInUpSlight 1s ease-out;
    }

    .hero-section__subtitle {
      font-size: 1.25rem;
      margin-bottom: calc(var(--spacing-unit) * 1.5);
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
      animation: fadeInUpSlight 1s 0.2s ease-out backwards;
    }

    .hero-section .button {
      animation: zoomIn 0.8s 0.5s ease-out backwards;
    }

    .main-layout {
      display: grid;
      grid-template-columns: 1fr;
      gap: calc(var(--spacing-unit) * 1.5);
    }

    .main-content-area {
      background-color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 1.5);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
    }

    .sidebar-area {
      background-color: var(--light-color);
      padding: calc(var(--spacing-unit) * 1.5);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-sm);
    }

    .sidebar-area h5,
    .sidebar-area h6 {
      color: var(--primary-color);
      margin-bottom: var(--spacing-unit);
      font-weight: 600;
    }

    .sidebar-nav-list {
      list-style: none;
      margin-bottom: calc(var(--spacing-unit) * 1.5);
    }

    .sidebar-nav-list li a {
      display: block;
      padding: calc(var(--spacing-unit) * 0.5) 0;
      color: var(--text-color);
      text-decoration: none;
      transition: var(--transition-fast);
      border-left: 3px solid transparent;
      padding-left: var(--spacing-unit);
    }

    .sidebar-nav-list li a:hover,
    .sidebar-nav-list li a.active {
      color: var(--primary-color);
      font-weight: 500;
      border-left-color: var(--primary-color);
      background-color: rgba(13, 110, 253, 0.05);
    }

    .sidebar-nav-list li a i.fa-fw {
      margin-right: calc(var(--spacing-unit) * 0.5);
      width: 1.25em;
      text-align: center;
    }

    .widget {
      background-color: var(--surface-color);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      padding: var(--spacing-unit);
      margin-bottom: var(--spacing-unit);
      transition: var(--transition-medium);
    }

    .widget:hover {
      box-shadow: var(--shadow-lg);
    }

    .widget h6 {
      margin-bottom: calc(var(--spacing-unit) * 0.75);
      display: flex;
      align-items: center;
      font-size: 1rem;
    }

    .widget h6 i {
      margin-right: calc(var(--spacing-unit) * 0.5);
      color: var(--primary-color);
    }

    /* Flatpickr Customization */
    .flatpickr-calendar {
      font-family: var(--font-primary);
      background: var(--surface-color);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-lg);
      width: 100% !important;
      /* Make it full width in widget */
    }

    .flatpickr-months .flatpickr-month {
      color: var(--primary-color);
      fill: var(--primary-color);
    }

    .flatpickr-months .flatpickr-prev-month:hover svg,
    .flatpickr-months .flatpickr-next-month:hover svg {
      fill: var(--primary-color-darker);
    }

    .flatpickr-weekday {
      color: var(--text-muted-color);
      font-weight: 500;
    }

    .flatpickr-day {
      color: var(--text-color);
    }

    .flatpickr-day.today {
      border-color: var(--primary-color);
      color: var(--primary-color);
    }

    .flatpickr-day.selected,
    .flatpickr-day.startRange,
    .flatpickr-day.endRange,
    .flatpickr-day.selected.inRange,
    .flatpickr-day.startRange.inRange,
    .flatpickr-day.endRange.inRange,
    .flatpickr-day.selected:focus,
    .flatpickr-day.startRange:focus,
    .flatpickr-day.endRange:focus,
    .flatpickr-day.selected:hover,
    .flatpickr-day.startRange:hover,
    .flatpickr-day.endRange:hover,
    .flatpickr-day.selected.prevMonthDay,
    .flatpickr-day.startRange.prevMonthDay,
    .flatpickr-day.endRange.prevMonthDay,
    .flatpickr-day.selected.nextMonthDay,
    .flatpickr-day.startRange.nextMonthDay,
    .flatpickr-day.endRange.nextMonthDay {
      background: var(--primary-color);
      border-color: var(--primary-color);
      color: var(--surface-color);
    }

    .flatpickr-day:hover {
      background: rgba(13, 110, 253, 0.1);
    }

    /* Styling untuk tabel */
    .table-responsive {
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
    }

    .fancy-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: calc(var(--spacing-unit) * 1.5);
      background-color: var(--surface-color);
      box-shadow: var(--shadow-sm);
      border-radius: var(--border-radius-md);
      overflow: hidden;
    }

    .fancy-table th,
    .fancy-table td {
      padding: calc(var(--spacing-unit) * 0.75) var(--spacing-unit);
      text-align: left;
      border-bottom: 1px solid #dee2e6;
      white-space: nowrap;
    }

    .fancy-table th {
      background-color: var(--primary-color);
      color: var(--surface-color);
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.85rem;
      letter-spacing: 0.5px;
    }

    .fancy-table tbody tr:nth-child(even) {
      background-color: var(--light-color);
    }

    .fancy-table tbody tr:hover {
      background-color: rgba(13, 110, 253, 0.1);
    }

    .badge {
      display: inline-block;
      padding: .35em .65em;
      font-size: .75em;
      font-weight: 700;
      line-height: 1;
      color: #fff;
      text-align: center;
      white-space: nowrap;
      vertical-align: baseline;
      border-radius: var(--border-radius-sm);
    }

    .badge-success {
      background-color: var(--success-color);
    }

    .badge-warning {
      background-color: var(--warning-color);
      color: var(--dark-color);
    }

    .badge-secondary {
      background-color: var(--secondary-color);
    }

    /* Chart Container */
    .chart-container {
      position: relative;
      width: 100%;
      max-width: 450px;
      min-height: 300px;
      margin: calc(var(--spacing-unit) * 1.5) auto;
      padding: var(--spacing-unit);
      background-color: var(--surface-color);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
    }

    #chartPenyewa {
      max-height: 350px;
    }

    /* === FOOTER === */
    .app-footer {
      background-color: var(--dark-color);
      color: var(--light-color);
      padding: calc(var(--spacing-unit) * 2.5) 0 calc(var(--spacing-unit) * 1.5) 0;
      margin-top: auto;
      font-size: 0.9rem;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: calc(var(--spacing-unit) * 1.5);
      margin-bottom: calc(var(--spacing-unit) * 1.5);
    }

    .footer-col h6 {
      color: var(--primary-color);
      font-weight: 600;
      margin-bottom: var(--spacing-unit);
      font-family: var(--font-display);
      font-size: 1.2rem;
    }

    .footer-col ul {
      list-style: none;
    }

    .footer-col ul li a {
      color: #adb5bd;
      text-decoration: none;
      transition: var(--transition-fast);
      display: inline-block;
      padding: calc(var(--spacing-unit) * 0.2) 0;
    }

    .footer-col ul li a:hover {
      color: var(--surface-color);
      transform: translateX(5px);
    }

    .footer-col ul li a i {
      margin-right: calc(var(--spacing-unit) * 0.3);
    }

    .footer-social-icons a {
      color: #adb5bd;
      font-size: 1.5rem;
      margin-right: var(--spacing-unit);
      transition: var(--transition-medium);
    }

    .footer-social-icons a:hover {
      color: var(--primary-color);
      transform: scale(1.2) rotate(5deg);
    }

    .footer-bottom {
      text-align: center;
      padding-top: calc(var(--spacing-unit) * 1.5);
      border-top: 1px solid #495057;
      font-size: 0.85rem;
      color: #6c757d;
    }

    .footer-bottom strong {
      color: var(--light-color);
    }

    /* === ANIMASI HALUS === */
    @keyframes fadeInUpSlight {
      from {
        opacity: 0;
        transform: translateY(15px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInRightSlight {
      from {
        opacity: 0;
        transform: translateX(15px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    @keyframes zoomIn {
      from {
        opacity: 0;
        transform: scale(0.8);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    /* Preloader / Splash Screen Sederhana */
    #preloader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--background-color);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
    }

    #preloader.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid var(--light-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .spinner-border {
      display: inline-block;
      width: 2rem;
      height: 2rem;
      vertical-align: text-bottom;
      border: .25em solid currentColor;
      border-right-color: transparent;
      border-radius: 50%;
      animation: spin .75s linear infinite;
    }

    .text-info {
      color: var(--primary-color);
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* === RESPONSIVITAS === */
    @media (min-width: 768px) {

      /* Tablet dan lebih besar */
      .main-layout {
        grid-template-columns: 2fr 1fr;
      }

      .main-layout.single-column {
        grid-template-columns: 1fr;
      }

      .main-layout.single-column .main-content-area {
        max-width: 900px;
        margin-left: auto;
        margin-right: auto;
      }
    }

    @media (max-width: 991px) {

      /* Di bawah Large Desktop */
      .navbar-page-title {
        display: none;
      }
    }

    @media (max-width: 767px) {

      /* Mobile */
      .nav-links {
        display: none;
        flex-direction: column;
        width: 100%;
        position: absolute;
        top: 100%;
        left: 0;
        background-color: var(--surface-color);
        box-shadow: var(--shadow-lg);
        padding: var(--spacing-unit) 0;
        border-top: 1px solid var(--light-color);
      }

      .nav-links.open {
        display: flex;
        animation: fadeInUpSlight 0.3s ease-out;
      }

      .nav-links li {
        margin-left: 0;
        width: 100%;
        text-align: center;
      }

      .nav-links a {
        padding: calc(var(--spacing-unit) * 0.75) var(--spacing-unit);
        display: block;
        border-bottom: 1px solid var(--light-color);
      }

      .nav-links li:last-child a {
        border-bottom: none;
      }

      .nav-links a:hover::after,
      .nav-links a.active::after {
        width: 0;
      }

      .nav-links a:hover,
      .nav-links a.active {
        background-color: rgba(13, 110, 253, 0.05);
      }

      .mobile-menu-toggle {
        display: block;
      }

      .hero-section__title {
        font-size: 2.2rem;
      }

      .hero-section__subtitle {
        font-size: 1rem;
      }

      .main-layout {
        grid-template-columns: 1fr;
      }

      .main-layout .sidebar-area {
        margin-top: var(--spacing-unit);
      }

      .footer-grid {
        grid-template-columns: 1fr;
        text-align: center;
      }

      .footer-col p,
      .footer-col ul {
        text-align: center;
      }

      .footer-col ul {
        padding-left: 0;
      }

      .footer-social-icons {
        text-align: center;
        margin-top: var(--spacing-unit);
      }

      .footer-social-icons a {
        margin: 0 calc(var(--spacing-unit) * 0.5);
      }

      .contact-form-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div id="preloader">
    <div class="spinner"></div>
  </div>

  <div id="app-shell">
    <!-- Header Aplikasi -->
    <header class="app-header" id="appHeader">
      <div class="container d-flex justify-content-between align-items-center">
        <a href="#/" class="navbar-brand spa-link">
          <img src="https://img.icons8.com/fluency/96/building.png" alt="Logo Green Valley" class="navbar-brand__logo"
            loading="lazy">
          <span class="navbar-brand__name">Green Valley</span>
        </a>

        <nav aria-label="Navigasi Utama">
          <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Buka Menu Navigasi" aria-expanded="false"
            aria-controls="navLinks">
            <i class="fas fa-bars"></i>
          </button>
          <ul class="nav-links" id="navLinks">
            <li><a href="#/" class="spa-link active" data-page="beranda"><i class="fas fa-home fa-fw"></i> Beranda</a>
            </li>
            <li><a href="#/tentang" class="spa-link" data-page="tentang"><i class="fas fa-info-circle fa-fw"></i>
                Tentang Kami</a></li>
            <li><a href="#/layanan" class="spa-link" data-page="layanan"><i class="fas fa-concierge-bell fa-fw"></i>
                Layanan</a></li>
            <li><a href="#/kontak" class="spa-link" data-page="kontak"><i class="fas fa-envelope fa-fw"></i> Kontak</a>
            </li>
          </ul>
        </nav>
        <span class="navbar-page-title d-none d-lg-block" id="navbarPageTitle">Solusi Rental Apartemen Modern</span>
      </div>
    </header>

    <!-- Konten Utama Aplikasi (Dirender oleh JavaScript) -->
    <main id="app-content" aria-live="polite">
      <!-- Konten halaman akan dimuat di sini -->
    </main>

    <!-- Footer Aplikasi -->
    <footer class="app-footer">
      <div class="container">
        <div class="footer-grid">
          <div class="footer-col">
            <h6>Green Valley</h6>
            <p class="text-muted" style="font-size: 0.85rem;">Menyediakan solusi manajemen rental apartemen yang modern,
              efisien, dan mudah digunakan untuk pengalaman terbaik Anda.</p>
          </div>
          <div class="footer-col">
            <h6>Navigasi Cepat</h6>
            <ul>
              <li><a href="#/" class="spa-link" data-page="beranda"><i class="fas fa-angle-right"></i> Beranda</a></li>
              <li><a href="#/tentang" class="spa-link" data-page="tentang"><i class="fas fa-angle-right"></i> Tentang
                  Kami</a></li>
              <li><a href="#/layanan" class="spa-link" data-page="layanan"><i class="fas fa-angle-right"></i>
                  Layanan</a></li>
              <li><a href="#/kontak" class="spa-link" data-page="kontak"><i class="fas fa-angle-right"></i> Hubungi
                  Kami</a></li>
              <li><a href="#/kebijakan-privasi" class="spa-link" data-page="kebijakan-privasi"><i
                    class="fas fa-angle-right"></i> Kebijakan Privasi</a></li>
            </ul>
          </div>
          <div class="footer-col">
            <h6>Hubungi Kami</h6>
            <ul class="list-unstyled">
              <li class="mb-2 d-flex align-items-center"><i class="fas fa-map-marker-alt me-2 text-primary"></i> Jl.
                Apartemen Indah No. 10, Jakarta Pusat</li>
              <li class="mb-2 d-flex align-items-center"><i class="fas fa-phone me-2 text-primary"></i> (021) 123-4567
              </li>
              <li class="mb-2 d-flex align-items-center"><i class="fas fa-envelope me-2 text-primary"></i>
                info@greenvalley.id</li>
            </ul>
            <div class="footer-social-icons mt-3">
              <a href="#" title="Instagram Green Valley" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-instagram"></i></a>
              <a href="#" title="Facebook Green Valley" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-facebook-f"></i></a>
              <a href="#" title="Twitter Green Valley" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-twitter"></i></a>
              <a href="#" title="LinkedIn Green Valley" target="_blank" rel="noopener noreferrer"><i
                  class="fab fa-linkedin-in"></i></a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <small>© <span id="currentYear"></span> <strong>Green Valley</strong>. Semua Hak Cipta Dilindungi
            Undang-Undang.</small>
        </div>
      </div>
    </footer>
  </div>

  <!-- Pustaka JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/id.js"></script>
  <!-- Lokal Flatpickr Bahasa Indonesia -->

  <script>
    // Namespace untuk aplikasi agar tidak mengotori global scope
    const GreenValleyApp = (() => {
      'use strict'; // Menerapkan strict mode untuk praktik terbaik

      // === STATE APLIKASI (MANAJEMEN STATE NATIVE) ===
      // Objek terpusat untuk menyimpan state aplikasi.
      // Memungkinkan data konsisten di seluruh aplikasi dan mudah di-debug.
      const state = {
        currentPage: null, // Menyimpan ID halaman yang sedang aktif
        pageTitleBase: "Green Valley", // Judul dasar untuk semua halaman
        dynamicPageTitles: { // Judul spesifik untuk setiap halaman
          "beranda": "Solusi Rental Apartemen Modern",
          "tentang": "Tentang Green Valley",
          "layanan": "Layanan Unggulan Kami",
          "kontak": "Hubungi Tim Green Valley",
          "kebijakan-privasi": "Kebijakan Privasi Green Valley",
          "dashboard": "Dashboard Utama Anda",
          "laporan": "Analisis Laporan Keuangan",
          "pengaturan": "Pengaturan Akun Green Valley",
          "promo": "Promosi Spesial Green Valley",
          "notFound": "Halaman Tidak Ditemukan"
        },
        chartInstance: null, // Menyimpan instance Chart.js agar bisa di-destroy saat pindah halaman
        weatherDataCache: null, // Cache sederhana untuk data cuaca
        weatherLastFetch: 0, // Timestamp terakhir fetch data cuaca
      };

      // === ELEMEN DOM YANG SERING DIGUNAKAN ===
      // Cache elemen DOM untuk performa lebih baik (mengurangi query DOM berulang).
      // Diinisialisasi dalam fungsi initDOM().
      let DOM = {};

      // Fungsi untuk mengambil nilai variabel CSS dari root
      const getCssVar = (varName) => getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
      const getCssVarNumber = (varName) => parseFloat(getCssVar(varName));

      // === TEMPLATE HALAMAN (VIEWS) ===
      // Setiap fungsi template mengembalikan string HTML untuk halaman tertentu.
      // Ini adalah bagian "View" dalam arsitektur modular (konseptual MVC/MVVM).
      // Menggunakan template literal untuk kemudahan penulisan HTML.
      const templates = {
        beranda: () => `
          <div class="hero-section">
            <div class="container">
              <h1 class="hero-section__title">Selamat Datang di Green Valley</h1>
              <p class="hero-section__subtitle">Platform manajemen rental apartemen Anda yang canggih, intuitif, dan dirancang untuk kemudahan serta efisiensi maksimal.</p>
              <a href="#/layanan" class="button button-primary spa-link">Jelajahi Layanan Kami <i class="fas fa-arrow-right ms-2"></i></a>
            </div>
          </div>

          <div class="container">
            <div class="main-layout">
              <section class="main-content-area" aria-labelledby="main-content-title">
                <div style="animation: fadeInUpSlight 1s ease-out;">
                    <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80"
                        alt="Pemandangan apartemen modern dengan interior mewah" class="img-fluid rounded-lg shadow-md mb-4" style="width:100%; max-height: 380px; object-fit: cover;" loading="lazy">
                    <h2 id="main-content-title" class="card-title" style="font-size: 1.8rem;">Kelola Properti Anda, Lebih Cerdas dan Mudah</h2>
                    <p class="text-muted mb-3">Platform <strong>Green Valley</strong> memberdayakan Anda untuk mengelola apartemen, penyewa, dan aspek finansial secara terpadu dan efisien. Nikmati kemudahan monitoring unit, laporan keuangan otomatis, dan komunikasi tanpa batas dengan penyewa, semuanya dalam satu aplikasi yang elegan dan responsif.</p>
                    <p class="mb-4">Dengan fitur notifikasi cerdas, dashboard analitik interaktif, dan laporan keuangan real-time, Anda dapat memfokuskan energi pada pertumbuhan bisnis properti Anda, sementara kami menangani kompleksitas administratif. Daftar sekarang dan rasakan transformasinya!</p>
                </div>
                
                <div class="main-video-container card p-0 mb-4 shadow-lg" style="animation: zoomIn 1s 0.2s ease-out backwards;">
                    <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: var(--border-radius-lg);">
                        <iframe src="https://www.youtube.com/embed/1La4QzGeaaQ?autoplay=0&modestbranding=1&rel=0&showinfo=0" title="Video Demo Green Valley"
                            style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen loading="lazy"></iframe>
                    </div>
                </div>

                <div style="animation: fadeInUpSlight 1s 0.4s ease-out backwards;">
                    <h4 class="mt-5 mb-3 fw-semibold"><i class="fas fa-users me-2 text-primary"></i>Data Penyewa Terkini (Contoh)</h4>
                    <div class="table-responsive">
                        <table class="fancy-table">
                        <thead>
                            <tr>
                            <th>Nama Penyewa</th>
                            <th>Status</th>
                            <th>Unit Apartemen</th>
                            <th>Tgl. Bergabung</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                            <td>Andi Wijaya Pratama</td>
                            <td><span class="badge badge-success">Aktif</span></td>
                            <td>Tower A - Unit 1201</td>
                            <td>15 Jan 2023</td>
                            </tr>
                            <tr>
                            <td>Siti Rahmawati</td>
                            <td><span class="badge badge-warning">Menunggu Pembayaran</span></td>
                            <td>Tower B - Unit 0305</td>
                            <td>01 Mar 2024</td>
                            </tr>
                            <tr>
                            <td>Budi Santoso Putra</td>
                            <td><span class="badge badge-secondary">Nonaktif</span></td>
                            <td>Tower C - Unit 0711</td>
                            <td>10 Agu 2022</td>
                            </tr>
                            <tr>
                            <td>Lina Chen</td>
                            <td><span class="badge badge-success">Aktif</span></td>
                            <td>Tower A - Unit 0502</td>
                            <td>20 Feb 2024</td>
                            </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
              </section>

              <aside class="sidebar-area" aria-label="Informasi Tambahan">
                <div style="animation: fadeInRightSlight 1s 0.3s ease-out backwards;">
                    <h5 class="fw-bold mb-3"><i class="fas fa-bars me-2 text-primary"></i>Menu Cepat</h5>
                    <ul class="sidebar-nav-list">
                    <li><a href="#/dashboard" class="spa-link" data-page="dashboard"><i class="fas fa-tachometer-alt fa-fw"></i> Dashboard Utama</a></li>
                    <li><a href="#/laporan" class="spa-link" data-page="laporan"><i class="fas fa-chart-line fa-fw"></i> Laporan Keuangan</a></li>
                    <li><a href="#/pengaturan" class="spa-link" data-page="pengaturan"><i class="fas fa-cog fa-fw"></i> Pengaturan Akun</a></li>
                    </ul>
                </div>

                <div class="widget" id="calendarWidget" style="animation: zoomIn 1s 0.5s ease-out backwards;">
                  <h6 class="fw-bold mb-2"><i class="fas fa-calendar-alt"></i> Kalender Interaktif</h6>
                  <input type="text" id="calendarInput" class="form-control d-none" placeholder="Pilih tanggal..." readonly>
                  <div id="flatpickr-container"></div> <!-- Container for inline calendar -->
                </div>

                <div class="widget" id="weatherWidget" style="animation: zoomIn 1s 0.7s ease-out backwards;">
                  <h6 class="fw-bold mb-2"><i class="fas fa-cloud-sun"></i> Info Cuaca (Jakarta)</h6>
                  <div id="weatherInfo" class="text-center">
                    <div class="spinner-border text-info" role="status" style="width:1.8rem;height:1.8rem; border-width: .2em;">
                      <span class="visually-hidden">Memuat data cuaca...</span>
                    </div>
                  </div>
                </div>
                
                <div class="widget chart-container" style="animation: zoomIn 1s 0.9s ease-out backwards;">
                     <h6 class="fw-bold mb-2 text-center"><i class="fas fa-chart-pie"></i> Komposisi Penyewa (Contoh)</h6>
                     <canvas id="chartPenyewa"></canvas>
                </div>

                <div class="ad-placeholder card text-center p-5 mt-4 bg-light" style="animation: fadeInUpSlight 1s 1.1s ease-out backwards;">
                  <i class="fas fa-bullhorn fa-3x text-primary mb-3"></i>
                  <h6 class="fw-bold">Promosi Spesial!</h6>
                  <p class="text-muted small">Dapatkan diskon 20% untuk layanan premium. Klik <a href="#/promo" class="text-primary spa-link" data-page="promo">di sini</a>!</p>
                </div>
              </aside>
            </div>
          </div>
        `,
        tentang: () => `
          <div class="container">
            <div class="main-layout single-column">
              <section class="main-content-area text-center" aria-labelledby="tentang-title">
                <i class="fas fa-building fa-4x text-primary mb-4" style="animation: zoomIn 1s ease-out;"></i>
                <h1 id="tentang-title" class="card-title" style="font-size: 2.5rem; animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">Tentang Green Valley</h1>
                <p class="lead text-muted mb-4" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">Misi kami adalah merevolusi cara pengelolaan properti rental melalui teknologi inovatif dan layanan pelanggan yang tak tertandingi.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: calc(var(--spacing-unit)*1.5); animation: fadeInUpSlight 0.8s 0.6s ease-out backwards; text-align:left;">
                    <div class="col">
                        <h4 class="fw-semibold text-primary"><i class="fas fa-lightbulb me-2"></i> Visi Kami</h4>
                        <p>Menjadi platform pilihan nomor satu bagi pemilik dan manajer properti di Asia Tenggara, dikenal karena keandalan, kemudahan penggunaan, dan kontribusi positif terhadap industri properti.</p>
                    </div>
                    <div class="col">
                        <h4 class="fw-semibold text-primary"><i class="fas fa-rocket me-2"></i> Misi Kami</h4>
                        <p>Memberikan solusi perangkat lunak yang komprehensif dan intuitif, didukung oleh analisis data canggih, untuk menyederhanakan operasi, meningkatkan profitabilitas, dan memperkaya pengalaman baik bagi pemilik maupun penyewa apartemen.</p>
                    </div>
                </div>

                <img src="https://images.unsplash.com/photo-1542744173-8e7e53415bb0?auto=format&fit=crop&w=1000&q=80" alt="Tim Green Valley sedang berdiskusi" class="img-fluid rounded-lg shadow-lg my-5" style="max-height: 400px; object-fit: cover; animation: zoomIn 1s 0.8s ease-out backwards;" loading="lazy">

                <h3 class="fw-semibold mt-5 mb-4" style="animation: fadeInUpSlight 0.8s 1s ease-out backwards;">Tim Inti Kami</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: calc(var(--spacing-unit)*1.5); animation: fadeInUpSlight 0.8s 1.2s ease-out backwards;">
                    ${[
            { name: 'Aisha Rahman', role: 'CEO & Founder', icon: 'user-tie', img: 'https://images.unsplash.com/photo-1494790108377-be9c29b29330?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80' },
            { name: 'Budi Setiawan', role: 'CTO', icon: 'laptop-code', img: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80' },
            { name: 'Citra Dewi', role: 'Head of Marketing', icon: 'bullhorn', img: 'https://images.unsplash.com/photo-1529626455594-4ff0802cfb7e?auto=format&fit=facearea&facepad=2&w=256&h=256&q=80' }
          ].map(member => `
                        <div class="card text-center p-3">
                            <img src="${member.img}" alt="Foto ${member.name}" class="rounded-circle shadow-sm mx-auto mb-3" style="width: 100px; height: 100px; object-fit: cover;" loading="lazy">
                            <h5 class="fw-semibold mb-1">${member.name}</h5>
                            <p class="text-primary small fw-medium"><i class="fas fa-${member.icon} me-1"></i>${member.role}</p>
                        </div>
                    `).join('')}
                </div>
              </section>
            </div>
          </div>
        `,
        layanan: () => `
          <div class="container">
            <div class="main-layout single-column">
              <section class="main-content-area text-center" aria-labelledby="layanan-title">
                <i class="fas fa-cogs fa-4x text-primary mb-4" style="animation: zoomIn 1s ease-out;"></i>
                <h1 id="layanan-title" class="card-title" style="font-size: 2.5rem; animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">Layanan Unggulan Green Valley</h1>
                <p class="lead text-muted mb-5" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">Kami menyediakan berbagai fitur canggih untuk membantu Anda mengelola properti dengan lebih efektif dan efisien.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: calc(var(--spacing-unit)*1.5); text-align: left; animation: fadeInUpSlight 0.8s 0.6s ease-out backwards;">
                  ${[
            { icon: 'tasks', title: 'Manajemen Unit Terpadu', desc: 'Lacak ketersediaan unit, data penyewa, dan histori sewa secara real-time. Atur jadwal pemeliharaan dan inspeksi dengan mudah.' },
            { icon: 'file-invoice-dollar', title: 'Penagihan Otomatis', desc: 'Sistem penagihan otomatis dengan pengingat pembayaran kepada penyewa. Integrasi dengan berbagai metode pembayaran online.' },
            { icon: 'chart-pie', title: 'Laporan Analitik Mendalam', desc: 'Dashboard interaktif dengan laporan keuangan, okupansi, dan performa properti. Dapatkan wawasan untuk pengambilan keputusan strategis.' },
            { icon: 'comments', title: 'Komunikasi Penyewa Efisien', desc: 'Portal khusus untuk penyewa mengajukan keluhan, permintaan layanan, dan melihat pengumuman. Komunikasi dua arah yang transparan.' },
            { icon: 'shield-alt', title: 'Keamanan Data Terjamin', desc: 'Perlindungan data penyewa dan properti dengan enkripsi standar industri. Backup data rutin untuk ketenangan pikiran.' },
            { icon: 'mobile-alt', title: 'Akses Mobile Responsif', desc: 'Kelola properti Anda kapan saja, di mana saja melalui platform web yang sepenuhnya responsif di perangkat mobile dan tablet.' }
          ].map(service => `
                    <div class="card p-4">
                        <div class="d-flex align-items-center mb-3">
                            <i class="fas fa-${service.icon} fa-2x text-primary me-3"></i>
                            <h4 class="fw-semibold mb-0" style="font-size: 1.2rem;">${service.title}</h4>
                        </div>
                        <p class="text-muted small">${service.desc}</p>
                    </div>
                  `).join('')}
                </div>
                <a href="#/kontak" class="button button-primary mt-5 spa-link" data-page="kontak" style="animation: zoomIn 0.8s 1s ease-out backwards;">Mulai Sekarang <i class="fas fa-rocket ms-2"></i></a>
              </section>
            </div>
          </div>
        `,
        kontak: () => `
          <div class="container">
            <div class="main-layout single-column">
              <section class="main-content-area" aria-labelledby="kontak-title">
                <div class="text-center mb-5">
                    <i class="fas fa-headset fa-4x text-primary mb-4" style="animation: zoomIn 1s ease-out;"></i>
                    <h1 id="kontak-title" class="card-title" style="font-size: 2.5rem; animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">Hubungi Tim Green Valley</h1>
                    <p class="lead text-muted" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">Kami siap membantu Anda! Isi formulir di bawah atau hubungi kami melalui detail kontak yang tersedia.</p>
                </div>

                <div class="contact-form-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: calc(var(--spacing-unit) * 2); animation: fadeInUpSlight 0.8s 0.6s ease-out backwards;">
                    <div class="card p-4">
                        <h4 class="fw-semibold mb-3"><i class="fas fa-paper-plane me-2 text-primary"></i>Kirim Pesan Cepat</h4>
                        <form id="contactForm" class="needs-validation" autocomplete="off" novalidate>
                        <div class="form-group">
                            <label for="namaKontak" class="form-label">Nama Lengkap Anda</label>
                            <input type="text" class="form-control" id="namaKontak" placeholder="Contoh: John Doe" required minlength="3" aria-describedby="namaKontakFeedback">
                            <div id="namaKontakFeedback" class="invalid-feedback">Nama wajib diisi (minimal 3 karakter).</div>
                        </div>
                        <div class="form-group">
                            <label for="emailKontak" class="form-label">Alamat Email</label>
                            <input type="email" class="form-control" id="emailKontak" placeholder="Contoh: john.doe@example.com" required pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$" aria-describedby="emailKontakFeedback">
                            <div id="emailKontakFeedback" class="invalid-feedback">Format email tidak valid.</div>
                        </div>
                        <div class="form-group">
                            <label for="subjekKontak" class="form-label">Subjek Pesan</label>
                            <input type="text" class="form-control" id="subjekKontak" placeholder="Contoh: Pertanyaan tentang layanan" required aria-describedby="subjekKontakFeedback">
                            <div id="subjekKontakFeedback" class="invalid-feedback">Subjek wajib diisi.</div>
                        </div>
                        <div class="form-group">
                            <label for="pesanKontak" class="form-label">Isi Pesan Anda</label>
                            <textarea class="form-control" id="pesanKontak" rows="5" placeholder="Tuliskan pertanyaan atau masukan Anda di sini..." required minlength="10" aria-describedby="pesanKontakFeedback"></textarea>
                            <div id="pesanKontakFeedback" class="invalid-feedback">Pesan wajib diisi (minimal 10 karakter).</div>
                        </div>
                        <button type="submit" class="button button-primary w-100"><i class="fas fa-paper-plane me-2"></i> Kirim Pesan</button>
                        </form>
                        <div id="formAlert" class="alert mt-3 d-none" role="alert"></div>
                    </div>
                    
                    <div class="card p-4">
                        <h4 class="fw-semibold mb-3"><i class="fas fa-info-circle me-2 text-primary"></i>Informasi Kontak Lainnya</h4>
                        <ul class="list-unstyled">
                            <li class="mb-3 d-flex align-items-start">
                                <i class="fas fa-map-marker-alt fa-fw fa-lg text-primary mt-1 me-3 flex-shrink-0"></i>
                                <div>
                                    <strong>Alamat Kantor:</strong><br>
                                    Jl. Apartemen Indah No. 10, Lantai 5<br>
                                    Jakarta Pusat, 10110, Indonesia
                                </div>
                            </li>
                            <li class="mb-3 d-flex align-items-start">
                                <i class="fas fa-phone fa-fw fa-lg text-primary mt-1 me-3 flex-shrink-0"></i>
                                <div>
                                    <strong>Telepon / WhatsApp:</strong><br>
                                    (021) 123-4567 / <a href="https://wa.me/6281234567890" class="text-primary" target="_blank" rel="noopener noreferrer">+62 812-3456-7890</a>
                                </div>
                            </li>
                            <li class="mb-3 d-flex align-items-start">
                                <i class="fas fa-envelope fa-fw fa-lg text-primary mt-1 me-3 flex-shrink-0"></i>
                                <div>
                                    <strong>Email:</strong><br>
                                    <a href="mailto:dukungan@greenvalley.id" class="text-primary">dukungan@greenvalley.id</a> (Dukungan)<br>
                                    <a href="mailto:sales@greenvalley.id" class="text-primary">sales@greenvalley.id</a> (Penjualan)
                                </div>
                            </li>
                            <li class="d-flex align-items-start">
                                <i class="fas fa-clock fa-fw fa-lg text-primary mt-1 me-3 flex-shrink-0"></i>
                                <div>
                                    <strong>Jam Operasional:</strong><br>
                                    Senin - Jumat: 08.00 - 17.00 WIB<br>
                                    Sabtu: 09.00 - 13.00 WIB (Dukungan Terbatas)
                                </div>
                            </li>
                        </ul>
                         <div class="mt-4">
                            <h5 class="fw-semibold mb-2">Ikuti Kami:</h5>
                            <div class="footer-social-icons">
                                <a href="#" title="Instagram" class="text-dark me-3"><i class="fab fa-instagram fa-lg"></i></a>
                                <a href="#" title="Facebook" class="text-dark me-3"><i class="fab fa-facebook-f fa-lg"></i></a>
                                <a href="#" title="Twitter" class="text-dark me-3"><i class="fab fa-twitter fa-lg"></i></a>
                                <a href="#" title="LinkedIn" class="text-dark"><i class="fab fa-linkedin-in fa-lg"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
              </section>
            </div>
          </div>
        `,
        kebijakanPrivasi: () => `
            <div class="container">
                <div class="main-layout single-column">
                    <section class="main-content-area" aria-labelledby="privasi-title">
                        <div class="text-center">
                             <i class="fas fa-user-secret fa-4x text-primary mb-4" style="animation: zoomIn 1s ease-out;"></i>
                            <h1 id="privasi-title" class="card-title" style="font-size: 2.5rem; animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">Kebijakan Privasi Green Valley</h1>
                            <p class="lead text-muted mb-5" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">Privasi Anda penting bagi kami. Kebijakan ini menjelaskan bagaimana kami mengumpulkan, menggunakan, dan melindungi informasi pribadi Anda.</p>
                        </div>

                        <div style="animation: fadeInUpSlight 0.8s 0.6s ease-out backwards; text-align:left;">
                            <h4 class="fw-semibold text-primary mt-4">1. Informasi yang Kami Kumpulkan</h4>
                            <p>Kami dapat mengumpulkan informasi pribadi seperti nama, alamat email, nomor telepon, detail properti, dan informasi pembayaran saat Anda menggunakan layanan kami, mendaftar akun, atau berinteraksi dengan platform kami.</p>

                            <h4 class="fw-semibold text-primary mt-4">2. Bagaimana Kami Menggunakan Informasi Anda</h4>
                            <p>Informasi Anda digunakan untuk:</p>
                            <ul>
                                <li>Menyediakan dan meningkatkan layanan kami.</li>
                                <li>Memproses transaksi dan mengelola akun Anda.</li>
                                <li>Berkomunikasi dengan Anda mengenai layanan, pembaruan, dan penawaran.</li>
                                <li>Menganalisis penggunaan platform untuk tujuan pengembangan.</li>
                                <li>Mematuhi kewajiban hukum.</li>
                            </ul>

                            <h4 class="fw-semibold text-primary mt-4">3. Pembagian Informasi</h4>
                            <p>Kami tidak menjual atau menyewakan informasi pribadi Anda kepada pihak ketiga. Kami dapat membagikan informasi dengan penyedia layanan tepercaya yang membantu kami mengoperasikan platform (misalnya, pemrosesan pembayaran), atau jika diwajibkan oleh hukum.</p>
                            
                            <h4 class="fw-semibold text-primary mt-4">4. Keamanan Data</h4>
                            <p>Kami menerapkan langkah-langkah keamanan teknis dan organisasi yang wajar untuk melindungi informasi pribadi Anda dari akses, penggunaan, atau pengungkapan yang tidak sah. Ini termasuk enkripsi data, kontrol akses, dan audit keamanan rutin.</p>

                            <h4 class="fw-semibold text-primary mt-4">5. Cookie dan Teknologi Pelacakan</h4>
                            <p>Platform kami menggunakan cookie dan teknologi serupa untuk meningkatkan pengalaman pengguna, menganalisis lalu lintas, dan mempersonalisasi konten. Anda dapat mengelola preferensi cookie melalui pengaturan browser Anda. Penggunaan platform kami menandakan persetujuan Anda terhadap penggunaan cookie ini.</p>

                            <h4 class="fw-semibold text-primary mt-4">6. Hak Anda</h4>
                            <p>Sesuai dengan hukum yang berlaku, Anda memiliki hak untuk mengakses, memperbaiki, atau meminta penghapusan informasi pribadi Anda yang kami simpan. Silakan hubungi kami melalui detail kontak yang tersedia untuk mengajukan permintaan terkait data Anda.</p>

                            <h4 class="fw-semibold text-primary mt-4">7. Perubahan Kebijakan Privasi</h4>
                            <p>Kami dapat memperbarui kebijakan privasi ini dari waktu ke waktu untuk mencerminkan perubahan dalam praktik kami atau persyaratan hukum. Perubahan signifikan akan diberitahukan melalui platform kami atau melalui email. Dianjurkan untuk meninjau kebijakan ini secara berkala.</p>

                            <h4 class="fw-semibold text-primary mt-4">8. Hubungi Kami</h4>
                            <p>Jika Anda memiliki pertanyaan atau kekhawatiran tentang kebijakan privasi ini atau praktik data kami, silakan hubungi Petugas Perlindungan Data kami di <a href="mailto:privasi@greenvalley.id" class="text-primary">privasi@greenvalley.id</a>.</p>
                            <p class="text-muted mt-3"><small>Terakhir diperbarui: ${new Date().toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}</small></p>
                        </div>
                    </section>
                </div>
            </div>
        `,
        // Halaman placeholder untuk link sidebar dan promo (menggunakan fungsi pembantu)
        dashboard: () => createPlaceholderPage("Dashboard Utama", "Selamat datang di dashboard Green Valley Anda. Fitur analitik dan ringkasan properti Anda akan segera tersedia di sini. Kami sedang bekerja keras untuk menyiapkannya!", "fa-tachometer-alt"),
        laporan: () => createPlaceholderPage("Laporan Keuangan", "Fitur analisis laporan keuangan mendalam Anda akan segera hadir. Pantau pendapatan, pengeluaran, dan profitabilitas properti Anda secara detail di sini.", "fa-chart-line"),
        pengaturan: () => createPlaceholderPage("Pengaturan Akun", "Kelola profil, preferensi notifikasi, dan pengaturan keamanan akun Green Valley Anda di halaman ini. Segera hadir!", "fa-cog"),
        promo: () => createPlaceholderPage("Promosi Spesial Green Valley", "Terima kasih atas minat Anda pada promosi kami! Detail penawaran eksklusif, diskon layanan, dan paket spesial akan segera kami tampilkan di sini. Nantikan kabar terbaru dari kami!", "fa-bullhorn"),
        notFound: () => `
          <div class="container text-center py-5">
            <i class="fas fa-exclamation-triangle fa-5x text-warning mb-4" style="animation: zoomIn 1s ease-out;"></i>
            <h1 class="display-4 fw-bold" style="animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">404 - Halaman Tidak Ditemukan</h1>
            <p class="lead text-muted mb-4" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">Maaf, halaman yang Anda cari tidak ada, mungkin telah dipindahkan, atau URL yang Anda masukkan salah.</p>
            <a href="#/" class="button button-primary spa-link" data-page="beranda" style="animation: zoomIn 0.8s 0.6s ease-out backwards;"><i class="fas fa-home me-2"></i> Kembali ke Beranda</a>
          </div>
        `
      };

      // Fungsi pembantu untuk membuat halaman placeholder secara dinamis.
      // Ini adalah contoh reusability dalam view.
      const createPlaceholderPage = (title, message, iconClass) => `
        <div class="container">
            <div class="main-layout single-column">
                <section class="main-content-area text-center py-5" aria-labelledby="placeholder-title-${title.toLowerCase().replace(/\s+/g, '-')}">
                    ${iconClass ? `<i class="fas ${iconClass} fa-4x text-primary mb-4" style="animation: zoomIn 1s ease-out;"></i>` : ''}
                    <h1 id="placeholder-title-${title.toLowerCase().replace(/\s+/g, '-')}" class="card-title" style="font-size: 2.5rem; animation: fadeInUpSlight 0.8s 0.2s ease-out backwards;">${title}</h1>
                    <p class="lead text-muted" style="animation: fadeInUpSlight 0.8s 0.4s ease-out backwards;">${message}</p>
                    <p class="text-muted mt-4" style="animation: fadeInUpSlight 0.8s 0.5s ease-out backwards;">Tim kami sedang bekerja keras untuk menghadirkan fitur ini secepatnya. Mohon bersabar dan terima kasih atas pengertian Anda.</p>
                    <a href="#/" class="button button-primary mt-4 spa-link" data-page="beranda" style="animation: zoomIn 0.8s 0.6s ease-out backwards;"><i class="fas fa-arrow-left me-2"></i> Kembali ke Beranda</a>
                </section>
            </div>
        </div>
      `;

      // === INISIALISASI ELEMEN DOM ===
      // Fungsi ini dipanggil sekali untuk mengisi objek DOM.
      const initDOM = () => {
        DOM.appShell = document.getElementById('app-shell');
        DOM.appContent = document.getElementById('app-content');
        DOM.allSpaLinks = document.querySelectorAll('a.spa-link'); // Semua link SPA
        DOM.navLinks = document.querySelectorAll('.app-header .nav-links a.spa-link');
        DOM.footerNavLinks = document.querySelectorAll('.app-footer ul li a.spa-link');
        DOM.mobileMenuToggle = document.getElementById('mobileMenuToggle');
        DOM.navLinksContainer = document.getElementById('navLinks');
        DOM.navbarPageTitle = document.getElementById('navbarPageTitle');
        DOM.appHeader = document.getElementById('appHeader');
        DOM.preloader = document.getElementById('preloader');
        DOM.currentYearSpan = document.getElementById('currentYear');
      };

      // === FUNGSI RENDER HALAMAN (CONTROLLER LOGIC) ===
      // Fungsi ini bertanggung jawab untuk menampilkan konten halaman yang sesuai.
      // Ini bagian dari "Controller" yang mengelola interaksi antara state, view, dan routing.
      const renderPage = (pageName) => {
        // Validasi: Pastikan appContent ada sebelum melanjutkan.
        if (!DOM.appContent) {
          console.error("Kesalahan Kritis: Elemen #app-content tidak ditemukan. Aplikasi tidak dapat merender halaman.");
          // Mungkin tampilkan pesan error fallback ke pengguna jika DOM utama gagal dimuat.
          document.body.innerHTML = '<div style="padding: 20px; text-align: center; font-family: sans-serif;"><h1>Terjadi Kesalahan Fatal</h1><p>Aplikasi tidak dapat dimuat. Silakan coba muat ulang halaman atau hubungi dukungan.</p></div>';
          return; // Hentikan eksekusi jika DOM utama tidak ada.
        }

        // Animasi keluar halaman lama (jika sudah ada konten)
        if (DOM.appContent.classList.contains('loaded')) {
          DOM.appContent.classList.remove('loaded');
        }

        // Hancurkan instance Chart.js lama jika ada (mencegah memory leak dan error rendering)
        if (state.chartInstance) {
          try {
            state.chartInstance.destroy();
            state.chartInstance = null; // Hapus referensi
          } catch (error) {
            console.warn("Gagal menghancurkan instance chart sebelumnya:", error);
          }
        }

        // Jeda singkat untuk efek transisi keluar sebelum memuat konten baru
        setTimeout(() => {
          // Pilih template berdasarkan pageName, atau template notFound jika tidak ada.
          const templateFunction = templates[pageName] || templates.notFound;
          try {
            DOM.appContent.innerHTML = templateFunction(); // Render HTML halaman baru
            // Peringatan: innerHTML bisa berisiko XSS jika konten template berasal dari input pengguna yang tidak disanitasi.
            // Di sini, template dikontrol developer, jadi risiko lebih rendah.
          } catch (error) {
            console.error(`Kesalahan saat merender template untuk halaman "${pageName}":`, error);
            // Fallback ke halaman error jika template gagal render
            DOM.appContent.innerHTML = templates.notFound();
            pageName = 'notFound'; // Update pageName agar state konsisten
          }

          state.currentPage = pageName; // Update state halaman saat ini
          updateActiveNavLink(pageName); // Tandai link navigasi yang aktif
          updatePageTitle(pageName); // Update judul dokumen dan header

          // Scroll ke atas halaman dengan halus
          window.scrollTo({ top: 0, behavior: 'smooth' });

          // Panggil fungsi inisialisasi komponen spesifik untuk halaman yang baru dirender
          if (pageName === 'beranda') initBerandaComponents();
          else if (pageName === 'kontak') initKontakForm();

          // Animasi masuk halaman baru
          // Timeout kecil diperlukan agar class 'loaded' ditambahkan setelah DOM update.
          setTimeout(() => {
            if (DOM.appContent) DOM.appContent.classList.add('loaded');
          }, 20); // Kurangi sedikit delay ini untuk responsivitas

        }, 250); // Durasi ini harus konsisten dengan transisi CSS
      };

      // === NAVIGASI & ROUTING (CONTROLLER LOGIC) ===
      // Fungsi ini menangani perubahan hash URL dan menentukan halaman mana yang harus dirender.
      // Ini adalah inti dari sistem routing SPA buatan sendiri.
      const router = () => {
        const hash = window.location.hash.substring(1); // Dapatkan path dari hash URL (tanpa '#')
        let route = (hash === '/' || hash === '') ? 'beranda' : hash.split('/')[1]; // Ambil bagian pertama path, default ke 'beranda'

        // Jika path adalah '#/' atau '#', maka itu adalah beranda
        if (!route || route === 'beranda' && hash !== '/beranda') {
          route = 'beranda';
        }

        // Validasi: Periksa apakah route yang diminta ada dalam daftar template.
        // Jika tidak, arahkan ke halaman 'notFound'.
        if (!templates[route]) {
          console.warn(`Route tidak ditemukan: "${route}". Mengarahkan ke halaman 404.`);
          route = 'notFound';
        }
        renderPage(route); // Panggil fungsi render untuk menampilkan halaman
      };

      // === FUNGSI UTILITAS & PEMBANTU (CONTROLLER/HELPER LOGIC) ===
      const updateActiveNavLink = (currentPage) => {
        // Hapus kelas 'active' dari semua link SPA
        DOM.allSpaLinks.forEach(link => link.classList.remove('active'));

        // Tambahkan kelas 'active' ke link yang sesuai dengan halaman saat ini
        DOM.allSpaLinks.forEach(link => {
          const linkPage = link.dataset.page; // Gunakan data-page untuk identifikasi
          if (linkPage === currentPage) {
            link.classList.add('active');
          }
        });
      };

      const updatePageTitle = (pageName) => {
        const dynamicTitle = state.dynamicPageTitles[pageName] || state.dynamicPageTitles.notFound;
        document.title = `${dynamicTitle} - ${state.pageTitleBase}`;

        if (DOM.navbarPageTitle) {
          DOM.navbarPageTitle.textContent = dynamicTitle;
          // Reset animasi untuk replay saat judul berubah (jika diperlukan)
          DOM.navbarPageTitle.style.animation = 'none';
          // eslint-disable-next-line no-unused-expressions
          DOM.navbarPageTitle.offsetHeight; /* Memicu reflow browser untuk mereset animasi */
          DOM.navbarPageTitle.style.animation = null;
        }
      };

      // Event handler untuk klik pada link SPA.
      // Menggunakan event delegation pada body untuk efisiensi.
      const handleNavLinkClick = (event) => {
        const link = event.target.closest('a.spa-link');
        if (link) {
          event.preventDefault(); // Mencegah navigasi default browser
          const newRouteHash = link.getAttribute('href');

          // Hanya ubah hash jika berbeda dari hash saat ini untuk menghindari reload yang tidak perlu.
          // Atau jika halaman yang dituju berbeda dari halaman saat ini (untuk kasus seperti klik link beranda saat di beranda)
          const targetPage = link.dataset.page || (newRouteHash.substring(2) || 'beranda');
          if (window.location.hash !== newRouteHash || state.currentPage !== targetPage) {
            window.location.hash = newRouteHash; // Perubahan hash akan memicu event 'hashchange' dan router
          }

          // Tutup menu mobile jika terbuka dan link di dalamnya diklik
          if (DOM.navLinksContainer.classList.contains('open')) {
            DOM.navLinksContainer.classList.remove('open');
            DOM.mobileMenuToggle.setAttribute('aria-expanded', 'false');
            DOM.mobileMenuToggle.innerHTML = '<i class="fas fa-bars"></i>';
          }
        }
      };

      const toggleMobileMenu = () => {
        const isOpen = DOM.navLinksContainer.classList.toggle('open');
        DOM.mobileMenuToggle.setAttribute('aria-expanded', isOpen.toString());
        DOM.mobileMenuToggle.innerHTML = isOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
      };

      // Efek header sticky dengan perubahan style saat scroll
      const handleHeaderScroll = () => {
        // Debounce sederhana untuk performa
        if (this.scrollTimeout) clearTimeout(this.scrollTimeout);
        this.scrollTimeout = setTimeout(() => {
          if (DOM.appHeader) { // Periksa DOM.appHeader ada
            if (window.scrollY > 50) {
              DOM.appHeader.classList.add('scrolled');
            } else {
              DOM.appHeader.classList.remove('scrolled');
            }
          }
        }, 50); //Jeda 50ms
      };

      const hidePreloader = () => {
        if (DOM.preloader) {
          DOM.preloader.classList.add('hidden');
          // Hapus elemen preloader dari DOM setelah transisi selesai untuk kebersihan
          DOM.preloader.addEventListener('transitionend', () => {
            if (DOM.preloader && DOM.preloader.parentNode) {
              DOM.preloader.parentNode.removeChild(DOM.preloader);
              DOM.preloader = null; // Hapus referensi DOM
            }
          }, { once: true }); // Event listener hanya dijalankan sekali
        }
      };

      // === INISIALISASI KOMPONEN SPESIFIK HALAMAN (CONTROLLER LOGIC) ===
      // Fungsi-fungsi ini dipanggil setelah halaman tertentu dirender.
      const initBerandaComponents = () => {
        const chartPenyewaCanvas = document.getElementById('chartPenyewa');
        if (chartPenyewaCanvas && typeof Chart !== 'undefined') {
          // Pastikan tidak ada instance chart lama yang aktif
          if (state.chartInstance) {
            state.chartInstance.destroy();
          }
          try {
            state.chartInstance = new Chart(chartPenyewaCanvas.getContext('2d'), {
              type: 'doughnut',
              data: {
                labels: ['Aktif', 'Menunggu Pembayaran', 'Nonaktif'],
                datasets: [{
                  data: [60, 25, 15], // Data contoh
                  backgroundColor: [getCssVar('--success-color'), getCssVar('--warning-color'), getCssVar('--secondary-color')],
                  borderColor: getCssVar('--surface-color'),
                  borderWidth: 3,
                  hoverOffset: 8
                }]
              },
              options: {
                responsive: true, maintainAspectRatio: false, cutout: '70%',
                plugins: {
                  legend: {
                    position: 'bottom',
                    labels: { font: { family: getCssVar('--font-primary'), size: 12 }, padding: 20, usePointStyle: true, pointStyle: 'circle' }
                  },
                  tooltip: {
                    backgroundColor: getCssVar('--dark-color'), titleFont: { family: getCssVar('--font-primary'), weight: 'bold' },
                    bodyFont: { family: getCssVar('--font-primary') }, padding: 10, cornerRadius: getCssVarNumber('--border-radius-sm'),
                    callbacks: { label: (context) => `${context.label || ''}: ${context.parsed || 0}%` }
                  }
                },
                animation: { animateScale: true, animateRotate: true, duration: 1200, easing: 'easeInOutQuart' }
              }
            });
          } catch (error) {
            console.error("Gagal menginisialisasi Chart.js:", error);
            chartPenyewaCanvas.parentElement.innerHTML = '<p class="text-danger text-center small">Gagal memuat chart.</p>';
          }
        } else if (!chartPenyewaCanvas) {
          console.warn("Elemen canvas #chartPenyewa tidak ditemukan di halaman Beranda.");
        } else if (typeof Chart === 'undefined') {
          console.warn("Chart.js tidak termuat. Chart tidak akan ditampilkan.");
          if (chartPenyewaCanvas) chartPenyewaCanvas.parentElement.innerHTML = '<p class="text-danger text-center small">Pustaka Chart.js tidak termuat.</p>';
        }


        const flatpickrContainer = document.getElementById('flatpickr-container');
        if (flatpickrContainer && typeof flatpickr !== 'undefined') {
          try {
            flatpickr(flatpickrContainer, {
              inline: true, dateFormat: "d-m-Y", locale: "id",
              monthSelectorType: "static", // "dropdown" atau "static"
              prevArrow: '<i class="fas fa-chevron-left"></i>',
              nextArrow: '<i class="fas fa-chevron-right"></i>',
            });
          } catch (error) {
            console.error("Gagal menginisialisasi Flatpickr:", error);
            flatpickrContainer.innerHTML = '<p class="text-danger text-center small">Gagal memuat kalender.</p>';
          }
        } else if (!flatpickrContainer) {
          console.warn("Elemen #flatpickr-container tidak ditemukan di halaman Beranda.");
        } else if (typeof flatpickr === 'undefined') {
          console.warn("Flatpickr tidak termuat. Kalender tidak akan ditampilkan.");
          if (flatpickrContainer) flatpickrContainer.innerHTML = '<p class="text-danger text-center small">Pustaka Flatpickr tidak termuat.</p>';
        }

        fetchWeather(); // Panggil fungsi untuk mengambil data cuaca
      };

      const initKontakForm = () => {
        const contactForm = document.getElementById('contactForm');
        const formAlert = document.getElementById('formAlert');

        if (contactForm && formAlert) {
          contactForm.addEventListener('submit', function (e) {
            e.preventDefault(); // Mencegah submit form tradisional
            e.stopPropagation();

            formAlert.className = 'alert mt-3 d-none'; // Reset alert
            formAlert.textContent = '';

            if (!this.checkValidity()) { // Validasi HTML5 bawaan
              this.classList.add('was-validated'); // Tampilkan feedback error Bootstrap-like
              formAlert.classList.remove('d-none');
              formAlert.classList.add('alert-danger');
              formAlert.innerHTML = '<i class="fas fa-exclamation-triangle me-2"></i>Harap perbaiki kesalahan pada formulir sebelum mengirim.';

              // Fokus ke field pertama yang error untuk UX yang lebih baik
              const firstInvalidField = this.querySelector(':invalid');
              if (firstInvalidField) firstInvalidField.focus();
              return;
            }

            // Simulasi pengiriman data (misalnya, ke API backend)
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            console.log('Data formulir yang (disimulasikan) dikirim:', data);
            // Di aplikasi nyata, di sini akan ada fetch() ke endpoint API.

            // Tampilkan pesan sukses
            formAlert.classList.remove('d-none', 'alert-danger');
            formAlert.classList.add('alert-success');
            formAlert.innerHTML = '<i class="fas fa-check-circle me-2"></i>Terima kasih! Pesan Anda telah berhasil dikirim. Kami akan segera menghubungi Anda.';

            this.reset(); // Kosongkan form
            this.classList.remove('was-validated'); // Hapus status validasi

            // Sembunyikan pesan sukses setelah beberapa detik
            setTimeout(() => {
              formAlert.classList.add('d-none');
            }, 7000);
          });
        } else {
          if (!contactForm) console.warn("Elemen form #contactForm tidak ditemukan di halaman Kontak.");
          if (!formAlert) console.warn("Elemen #formAlert tidak ditemukan di halaman Kontak.");
        }
      };

      // === API CALLS (Contoh: Cuaca dari Open-Meteo) ===
      // Fungsi ini mengambil data cuaca dari API publik.
      // Ini adalah contoh bagaimana modul JavaScript bisa berinteraksi dengan layanan eksternal.
      async function fetchWeather() {
        const weatherDiv = document.getElementById('weatherInfo');
        if (!weatherDiv) {
          console.warn("Elemen #weatherInfo tidak ditemukan, tidak dapat menampilkan cuaca.");
          return;
        }

        // Cache sederhana: jika data masih baru (kurang dari 30 menit), gunakan cache
        const CACHE_DURATION = 30 * 60 * 1000; // 30 menit
        if (state.weatherDataCache && (Date.now() - state.weatherLastFetch < CACHE_DURATION)) {
          console.info("Menggunakan data cuaca dari cache.");
          displayWeatherData(state.weatherDataCache, weatherDiv);
          return;
        }

        const lat = -6.2088; // Koordinat Jakarta
        const lon = 106.8456;
        const apiUrl = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}¤t_weather=true&timezone=Asia/Jakarta`;

        try {
          const response = await fetch(apiUrl, { mode: 'cors' }); // mode: 'cors' penting
          if (!response.ok) {
            // Tangani error HTTP (misal 404, 500)
            throw new Error(`Gagal mengambil data cuaca. Status: ${response.status} ${response.statusText}`);
          }
          const data = await response.json();

          if (data && data.current_weather) {
            state.weatherDataCache = data.current_weather; // Simpan ke cache
            state.weatherLastFetch = Date.now(); // Update timestamp fetch
            displayWeatherData(data.current_weather, weatherDiv);
          } else {
            throw new Error("Format data cuaca dari API tidak sesuai harapan.");
          }
        } catch (error) {
          console.error('Kesalahan saat mengambil data cuaca:', error);
          weatherDiv.innerHTML = `<span class="text-danger small" title="${error.message}"><i class="fas fa-exclamation-circle me-1"></i>Layanan cuaca tidak tersedia saat ini.</span>`;
        }
      }

      // Fungsi terpisah untuk menampilkan data cuaca (bagian dari View logic)
      function displayWeatherData(weatherData, weatherDiv) {
        const { temperature, windspeed, weathercode } = weatherData;
        const temp = Math.round(temperature);

        // Pemetaan WMO weather codes ke ikon Font Awesome (bisa diperluas)
        const wmoCodesIcons = {
          0: 'fa-sun', // Cerah
          1: 'fa-cloud-sun', 2: 'fa-cloud-sun', 3: 'fa-cloud', // Berawan sebagian, Berawan
          45: 'fa-smog', 48: 'fa-smog', // Kabut
          51: 'fa-cloud-rain', 53: 'fa-cloud-rain', 55: 'fa-cloud-rain', // Gerimis
          61: 'fa-cloud-showers-heavy', 63: 'fa-cloud-showers-heavy', 65: 'fa-cloud-showers-heavy', // Hujan
          80: 'fa-cloud-bolt', 81: 'fa-cloud-bolt', 82: 'fa-cloud-bolt', // Hujan badai ringan
          95: 'fa-bolt', // Badai Petir
          // Tambahkan kode lain jika perlu
        };
        const iconClass = wmoCodesIcons[weathercode] || 'fa-cloud'; // Default icon jika kode tidak ada

        weatherDiv.innerHTML = `
            <i class="fas ${iconClass} fa-3x mb-2" style="color: ${getCssVar('--primary-color')};"></i>
            <div class="fw-bold" style="font-size: 1.8rem;">${temp}°C</div>
            <div class="text-muted" style="font-size:0.9em;">Angin: ${windspeed} km/jam</div>
            <div class="text-muted small mt-1">Jakarta, Indonesia</div>
        `;
      }

      // === INISIALISASI APLIKASI ===
      // Fungsi utama yang dieksekusi saat DOM siap.
      // Mengatur event listener global dan memulai router.
      const init = () => {
        initDOM(); // Inisialisasi cache elemen DOM

        // Event listener untuk perubahan hash URL (inti SPA routing)
        window.addEventListener('hashchange', router);

        // Event listener untuk load awal halaman
        window.addEventListener('load', () => {
          router(); // Jalankan router untuk menentukan halaman awal
          hidePreloader(); // Sembunyikan preloader setelah konten awal dimuat
        }, { once: true }); // Hanya jalankan sekali

        // Event delegation untuk semua link SPA
        if (DOM.appShell) { // Pastikan appShell ada
          DOM.appShell.addEventListener('click', handleNavLinkClick);
        } else {
          console.error("Elemen #app-shell tidak ditemukan, event listener untuk link SPA tidak dapat ditambahkan.");
        }


        // Event listener untuk tombol menu mobile
        if (DOM.mobileMenuToggle) {
          DOM.mobileMenuToggle.addEventListener('click', toggleMobileMenu);
        } else {
          console.warn("Tombol menu mobile #mobileMenuToggle tidak ditemukan.");
        }

        // Event listener untuk efek scroll header
        window.addEventListener('scroll', handleHeaderScroll, { passive: true }); // passive: true untuk optimasi scroll

        // Update tahun copyright di footer
        if (DOM.currentYearSpan) {
          DOM.currentYearSpan.textContent = new Date().getFullYear();
        } else {
          console.warn("Elemen #currentYear di footer tidak ditemukan.");
        }

        console.info("Green Valley SPA Vanilla berhasil diinisialisasi. Aplikasi siap digunakan.");
        // Contoh "unit test" dasar (lebih ke sanity check di sini)
        runBasicTests();
      };

      // === FUNGSI TESTING DASAR (CONTOH) ===
      // Ini bukan unit test framework, hanya contoh bagaimana Anda bisa melakukan pengecekan dasar.
      // Untuk testing yang lebih serius, gunakan Jest, Mocha, dll.
      const runBasicTests = () => {
        console.groupCollapsed("Basic Sanity Tests");
        // Test 1: Cek apakah state awal benar
        console.assert(state.currentPage === null || typeof state.currentPage === 'string', "Test 1 Gagal: state.currentPage harus null atau string.");

        // Test 2: Cek apakah template beranda ada
        console.assert(typeof templates.beranda === 'function', "Test 2 Gagal: templates.beranda harus sebuah fungsi.");

        // Test 3: Cek apakah DOM utama ada setelah initDOM
        console.assert(DOM.appContent !== null && DOM.appContent !== undefined, "Test 3 Gagal: DOM.appContent tidak terdefinisi setelah initDOM.");

        // Test 4: Cek fungsi utilitas CSS Var
        const primaryColorTest = getCssVar('--primary-color');
        console.assert(primaryColorTest.startsWith('#') || primaryColorTest.startsWith('rgb'), `Test 4 Gagal: getCssVar('--primary-color') tidak mengembalikan warna valid. Dapat: ${primaryColorTest}`);

        console.info("Semua basic sanity tests selesai.");
        console.groupEnd();
      };

      // Publikasikan fungsi init agar bisa dipanggil dari luar IIFE
      return {
        init: init
        // Anda bisa mempublikasikan fungsi lain di sini jika perlu diakses dari luar (misal untuk debugging)
        // getState: () => JSON.parse(JSON.stringify(state)) // Deep copy untuk inspeksi state
      };
    })();

    // Jalankan inisialisasi aplikasi setelah DOM sepenuhnya dimuat
    document.addEventListener('DOMContentLoaded', GreenValleyApp.init);
  </script>
</body>

</html>