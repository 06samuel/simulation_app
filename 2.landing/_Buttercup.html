<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Jelajahi properti terbaik di Green Valley. Temukan rumah, apartemen, dan villa impian Anda dengan pengalaman modern dan desain yang memukau.">
    <meta name="keywords"
        content="properti, real estate, rumah dijual, apartemen, villa, green valley, properti mewah, investasi properti">
    <meta name="author" content="Green Valley Premier Properties">
    <meta name="theme-color" content="#10b981"> <!-- Warna tema utama untuk UI browser di mobile -->
    <title>Green Valley Properties - Properti Impian Anda Menanti</title>

    <!-- Favicon (Contoh menggunakan emoji teks sebagai pengganti SVG, idealnya file .ico atau .png) -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè°</text></svg>">
    <!-- Penjelasan: Permintaan melarang SVG. Favicon di atas adalah SVG.
         Jika benar-benar tidak boleh SVG, alternatifnya adalah file .ico, .png, atau data URI yang sangat terbatas.
         Untuk demo ini, saya akan biarkan yang ada atau ganti dengan emoji teks jika diperlukan.
         Namun, favicon modern seringkali SVG karena skalabilitasnya.
         Untuk mematuhi "tidak boleh SVG", kita bisa menggunakan:
    -->
    <!-- <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MEQ0QjREMzA2NzREMTFFQUJCNzNGRkQ2RDg3NEI0NDAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MEQ0QjREMzE2NzREMTFFQUJCNzNGRkQ2RDg3NEI0NDAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowRDRCNERDRTY3NEQxMUVBQkI3M0ZGRDZEODc0QjQ0MCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowRDRCNERDRjY3NEQxMUVBQkI3M0ZGRDZEODc0QjQ0MCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpHIJWMAAACPSURBVHjaYvz//z8DLsD8WqlGDBgwALEGjg3Q9H8P8g9M36cBAwYMsDEkIMNAIgYGht9gYqCAUXQkMM3FzJhEaGMQAWqgA5RCe2DIQGgHIsP//1g4GdgYFeXzMAlkZGRgeHgYkAUysrCwMDAwsTAx0UDFAAFGAKedFh0MDAwAAAAASUVORK5CYII="> -->
    <!-- Pilihan di atas adalah PNG base64 kecil berwarna hijau. Saya akan tetap memakai emoji untuk kesederhanaan jika tidak ada file fisik. -->

    <!-- Font Awesome Icons (CDN) - Diizinkan -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* --- Variabel CSS Global untuk Tema dan Desain Fancy --- */
        :root {
            --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            --font-secondary: 'Poppins', var(--font-primary);

            --color-primary: #10b981;
            /* Hijau Emerald Cerah */
            --color-primary-dark: #059669;
            --color-primary-light: #34d399;
            --color-secondary: #064e3b;
            /* Hijau Tua untuk Kontras atau Aksen Heading */
            --color-accent: #f59e0b;
            /* Kuning Keemasan untuk CTA */
            --color-accent-dark: #d97706;

            --text-light: #f9fafb;
            /* Teks untuk background gelap */
            --text-dark: #1f2937;
            /* Teks untuk background terang */
            --text-muted-light: #6b7280;
            --text-muted-dark: #9ca3af;

            --bg-light: #f7fafc;
            /* Background utama mode terang */
            --bg-light-alt: #ffffff;
            /* Background alternatif (mis. card) mode terang */
            --bg-dark: #111827;
            /* Background utama mode gelap */
            --bg-dark-alt: #1f2937;
            /* Background alternatif (mis. card) mode gelap */

            --border-light: #e5e7eb;
            --border-dark: #374151;

            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-fancy: 0px 8px 20px rgba(16, 185, 129, 0.2), 0px 4px 8px rgba(0, 0, 0, 0.08);

            --border-radius-sm: 0.25rem;
            /* 4px */
            --border-radius-md: 0.5rem;
            /* 8px */
            --border-radius-lg: 0.75rem;
            /* 12px */
            --border-radius-xl: 1rem;
            /* 16px */
            --border-radius-full: 9999px;

            --transition-speed-fast: 0.15s;
            --transition-speed-medium: 0.3s;
            --transition-speed-slow: 0.5s;
            --transition-timing-function: ease-in-out;

            --max-width-container: 1280px;
            --spacing-unit: 1rem;
            /* 16px */
        }

        /* --- Reset CSS yang Lebih Komprehensif dan Base Styles --- */
        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            /* Hilangkan highlight biru saat tap di mobile */
        }

        html {
            scroll-behavior: smooth;
            font-size: 100%;
            /* Umumnya 16px */
            -webkit-text-size-adjust: 100%;
            /* Mencegah pembesaran font otomatis di iOS */
        }

        body {
            font-family: var(--font-primary);
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--bg-light);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
            transition: background-color var(--transition-speed-medium) var(--transition-timing-function),
                color var(--transition-speed-medium) var(--transition-timing-function);
            min-height: 100vh;
            display: flex;
            /* Memastikan footer menempel di bawah jika konten pendek */
            flex-direction: column;
        }

        body.dark-mode {
            color: var(--text-light);
            background-color: var(--bg-dark);
        }

        /* --- Aturan Tipografi yang Lebih Fancy --- */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: var(--font-secondary);
            font-weight: 700;
            line-height: 1.3;
            margin-bottom: calc(var(--spacing-unit) * 0.75);
            color: var(--color-secondary);
        }

        body.dark-mode h1,
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4,
        body.dark-mode h5,
        body.dark-mode h6 {
            color: var(--color-primary-light);
        }

        h1 {
            font-size: 2.5rem;
        }

        /* 40px */
        h2 {
            font-size: 2rem;
        }

        /* 32px */
        h3 {
            font-size: 1.5rem;
        }

        /* 24px */
        h4 {
            font-size: 1.25rem;
        }

        /* 20px */
        p {
            margin-bottom: var(--spacing-unit);
        }

        @media (min-width: 768px) {
            h1 {
                font-size: 3.25rem;
            }

            /* 52px */
            h2 {
                font-size: 2.5rem;
            }

            /* 40px */
            h3 {
                font-size: 1.75rem;
            }

            /* 28px */
        }

        a {
            text-decoration: none;
            color: var(--color-primary);
            transition: color var(--transition-speed-fast) var(--transition-timing-function);
        }

        a:hover,
        a:focus-visible {
            /* Menggunakan focus-visible untuk aksesibilitas keyboard */
            color: var(--color-primary-dark);
            outline: 2px solid var(--color-accent);
            outline-offset: 2px;
        }

        body.dark-mode a {
            color: var(--color-primary-light);
        }

        body.dark-mode a:hover,
        body.dark-mode a:focus-visible {
            color: var(--text-light);
        }

        button,
        input,
        select,
        textarea {
            font-family: inherit;
            font-size: 1rem;
            border: 1px solid var(--border-light);
            border-radius: var(--border-radius-md);
            padding: calc(var(--spacing-unit) * 0.6) calc(var(--spacing-unit) * 0.8);
            transition: border-color var(--transition-speed-fast) var(--transition-timing-function),
                box-shadow var(--transition-speed-fast) var(--transition-timing-function);
        }

        body.dark-mode button,
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode textarea {
            background-color: var(--bg-dark-alt);
            border-color: var(--border-dark);
            color: var(--text-light);
        }

        input:focus,
        select:focus,
        textarea:focus,
        button:focus-visible {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }

        button:focus-visible {
            /* Khusus untuk button agar tidak selalu ada outline */
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.4);
        }

        img,
        video {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* --- Sistem Grid dan Flexbox Utilities yang Ditingkatkan --- */
        .container {
            width: 100%;
            max-width: var(--max-width-container);
            margin-left: auto;
            margin-right: auto;
            padding-left: var(--spacing-unit);
            padding-right: var(--spacing-unit);
        }

        .grid {
            display: grid;
            gap: calc(var(--spacing-unit) * 1.5);
        }

        .grid-auto-fit {
            grid-template-columns: repeat(auto-fit, minmax(min(100%, 280px), 1fr));
        }

        @media (min-width: 640px) {

            /* sm */
            .sm\:grid-cols-2 {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {

            /* md */
            .md\:grid-cols-2 {
                grid-template-columns: repeat(2, 1fr);
            }

            .md\:grid-cols-3 {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        @media (min-width: 1024px) {

            /* lg */
            .lg\:grid-cols-3 {
                grid-template-columns: repeat(3, 1fr);
            }

            .lg\:grid-cols-4 {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .flex {
            display: flex;
        }

        .flex-wrap {
            flex-wrap: wrap;
        }

        .flex-col {
            flex-direction: column;
        }

        .items-center {
            align-items: center;
        }

        .items-start {
            align-items: flex-start;
        }

        .items-end {
            align-items: flex-end;
        }

        .justify-center {
            justify-content: center;
        }

        .justify-between {
            justify-content: space-between;
        }

        .justify-around {
            justify-content: space-around;
        }

        .justify-start {
            justify-content: flex-start;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .gap-1 {
            gap: calc(var(--spacing-unit) * 0.25);
        }

        .gap-2 {
            gap: calc(var(--spacing-unit) * 0.5);
        }

        .gap-4 {
            gap: var(--spacing-unit);
        }

        .gap-6 {
            gap: calc(var(--spacing-unit) * 1.5);
        }

        .gap-8 {
            gap: calc(var(--spacing-unit) * 2);
        }

        /* --- Komponen UI yang Ditingkatkan --- */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: calc(var(--spacing-unit) * 0.75) calc(var(--spacing-unit) * 1.5);
            border-radius: var(--border-radius-md);
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            border: none;
            transition: background-color var(--transition-speed-fast) var(--transition-timing-function),
                transform var(--transition-speed-fast) var(--transition-timing-function),
                box-shadow var(--transition-speed-fast) var(--transition-timing-function);
            box-shadow: var(--shadow-sm);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn:active {
            transform: translateY(0px);
            box-shadow: var(--shadow-sm);
            /* Balik ke shadow lebih kecil saat active */
        }

        /* .btn:focus-visible diatur di global input/button focus */

        .btn--primary {
            background-color: var(--color-primary);
            color: var(--text-light);
        }

        .btn--primary:hover {
            background-color: var(--color-primary-dark);
        }

        body.dark-mode .btn--primary {
            background-color: var(--color-primary-light);
            color: var(--text-dark);
        }

        body.dark-mode .btn--primary:hover {
            background-color: var(--color-primary);
        }

        .btn--secondary {
            background-color: var(--bg-light-alt);
            color: var(--text-dark);
            border: 1px solid var(--border-light);
        }

        .btn--secondary:hover {
            background-color: #e9edf1;
        }

        /* sedikit lebih gelap dari bg-light-alt */
        body.dark-mode .btn--secondary {
            background-color: var(--bg-dark-alt);
            color: var(--text-light);
            border-color: var(--border-dark);
        }

        body.dark-mode .btn--secondary:hover {
            background-color: #374151;
        }

        /* sedikit lebih terang dari bg-dark-alt */

        .btn--accent {
            background-color: var(--color-accent);
            color: var(--text-light);
            /* Atau var(--text-dark) jika kuningnya sangat terang */
        }

        .btn--accent:hover {
            background-color: var(--color-accent-dark);
        }

        .btn--lg {
            padding: calc(var(--spacing-unit) * 0.9) calc(var(--spacing-unit) * 2);
            font-size: 1.1rem;
        }

        .btn--icon {
            padding: calc(var(--spacing-unit) * 0.5);
            min-width: auto;
        }

        .btn--icon i {
            font-size: 1.25rem;
        }

        .card {
            background-color: var(--bg-light-alt);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
            transition: transform var(--transition-speed-medium) var(--transition-timing-function),
                box-shadow var(--transition-speed-medium) var(--transition-timing-function);
            display: flex;
            flex-direction: column;
            cursor: pointer;
            /* Menandakan bisa diklik */
        }

        .card:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: var(--shadow-fancy);
        }

        body.dark-mode .card {
            background-color: var(--bg-dark-alt);
            /* Shadow di dark mode mungkin perlu penyesuaian, --shadow-md bisa jadi terlalu terang */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        body.dark-mode .card:hover {
            box-shadow: 0px 8px 20px rgba(16, 185, 129, 0.3), 0px 4px 8px rgba(0, 0, 0, 0.2);
        }

        .card__image-container {
            width: 100%;
            aspect-ratio: 16 / 10;
            overflow: hidden;
        }

        .card__image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform var(--transition-speed-slow) var(--transition-timing-function);
        }

        .card:hover .card__image {
            transform: scale(1.05);
        }

        .card__content {
            padding: var(--spacing-unit);
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .card__title {
            font-size: 1.25rem;
            /* Disesuaikan */
            margin-bottom: calc(var(--spacing-unit) * 0.5);
            color: var(--color-secondary);
            /* Fitur untuk memotong teks jika terlalu panjang */
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        body.dark-mode .card__title {
            color: var(--color-primary-light);
        }

        .card__price {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--color-primary);
            margin-bottom: calc(var(--spacing-unit) * 0.25);
        }

        body.dark-mode .card__price {
            color: var(--color-primary-light);
        }

        .card__location {
            font-size: 0.9rem;
            color: var(--text-muted-light);
            margin-bottom: var(--spacing-unit);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 0.25);
        }

        body.dark-mode .card__location {
            color: var(--text-muted-dark);
        }

        .card__footer {
            margin-top: auto;
            /* Mendorong footer ke bawah card */
            padding-top: var(--spacing-unit);
        }

        /* --- Navbar yang Lebih Fancy --- */
        .navbar {
            background-color: rgba(255, 255, 255, 0.85);
            /* Semi-transparan */
            backdrop-filter: blur(10px);
            /* Efek glassmorphism */
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: calc(var(--spacing-unit) * 0.75) 0;
            transition: background-color var(--transition-speed-medium) var(--transition-timing-function),
                box-shadow var(--transition-speed-medium) var(--transition-timing-function);
        }

        body.dark-mode .navbar {
            background-color: rgba(31, 41, 55, 0.85);
            /* Semi-transparan dark */
        }

        .navbar__container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .navbar__brand {
            font-size: 1.75rem;
            font-weight: 800;
            color: var(--color-secondary);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 0.5);
        }

        .navbar__brand i {
            color: var(--color-primary);
        }

        body.dark-mode .navbar__brand {
            color: var(--color-primary-light);
        }

        .nav__list {
            display: flex;
            gap: calc(var(--spacing-unit) * 0.5);
            list-style: none;
        }

        .nav__item a {
            padding: calc(var(--spacing-unit) * 0.5) var(--spacing-unit);
            border-radius: var(--border-radius-md);
            font-weight: 500;
            transition: background-color var(--transition-speed-fast) var(--transition-timing-function),
                color var(--transition-speed-fast) var(--transition-timing-function);
            color: var(--text-dark);
        }

        .nav__item a:hover,
        .nav__item a.active {
            /* Kelas 'active' akan ditambahkan oleh JavaScript */
            background-color: var(--color-primary);
            color: var(--text-light) !important;
            /* Penting untuk override default link color */
        }

        body.dark-mode .nav__item a {
            color: var(--text-light);
        }

        body.dark-mode .nav__item a:hover,
        body.dark-mode .nav__item a.active {
            background-color: var(--color-primary-light);
            color: var(--text-dark) !important;
        }

        .mobile-menu-button {
            /* Akan diatur oleh JS untuk muncul di mobile */
            display: none;
        }

        .mobile-nav {
            display: none;
            /* Defaultnya tersembunyi */
            flex-direction: column;
            position: absolute;
            top: 100%;
            /* Tepat di bawah navbar */
            left: 0;
            right: 0;
            background-color: var(--bg-light-alt);
            box-shadow: var(--shadow-lg);
            padding: var(--spacing-unit);
            border-bottom-left-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
            max-height: 0;
            overflow: hidden;
            opacity: 0;
            transform: translateY(-10px);
            transition: max-height var(--transition-speed-medium) ease-out,
                opacity var(--transition-speed-medium) ease-out,
                transform var(--transition-speed-medium) ease-out;
        }

        .mobile-nav.open {
            display: flex;
            max-height: 80vh;
            /* Batas tinggi menu mobile */
            opacity: 1;
            transform: translateY(0);
        }

        body.dark-mode .mobile-nav {
            background-color: var(--bg-dark-alt);
        }

        .mobile-nav .nav__item {
            width: 100%;
        }

        .mobile-nav .nav__item a {
            display: block;
            width: 100%;
            text-align: left;
            padding: var(--spacing-unit);
        }

        .mobile-nav .btn {
            width: 100%;
            margin-top: var(--spacing-unit);
        }


        /* --- Hero Section yang Lebih Dramatis --- */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80&blur=2') no-repeat center center;
            background-size: cover;
            min-height: 85vh;
            /* Lebih tinggi */
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            text-align: center;
            padding: calc(var(--spacing-unit) * 2) var(--spacing-unit);
            position: relative;
            /* Untuk elemen overlay jika diperlukan */
        }

        .hero::before {
            /* Overlay gradient halus tambahan */
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0) 50%);
            z-index: 1;
        }

        .hero__content {
            position: relative;
            /* Agar di atas overlay */
            z-index: 2;
            max-width: 800px;
        }

        .hero h1 {
            font-size: 3rem;
            /* Lebih besar */
            font-weight: 800;
            color: var(--text-light);
            margin-bottom: var(--spacing-unit);
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: calc(var(--spacing-unit) * 2);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
        }

        @media (min-width: 768px) {
            .hero h1 {
                font-size: 4.5rem;
            }

            .hero p {
                font-size: 1.5rem;
            }
        }

        .hero__form {
            background-color: rgba(255, 255, 255, 0.15);
            /* Efek kaca */
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: calc(var(--spacing-unit) * 1.5);
            border-radius: var(--border-radius-lg);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.18);
            display: grid;
            gap: var(--spacing-unit);
            margin-top: calc(var(--spacing-unit) * 2);
        }

        body.dark-mode .hero__form {
            background-color: rgba(17, 24, 39, 0.25);
            /* Dark glass */
            border-color: rgba(255, 255, 255, 0.1);
        }

        @media (min-width: 768px) {
            .hero__form {
                grid-template-columns: 1fr 1fr auto;
                /* Lokasi, Tipe, Tombol Cari */
                align-items: center;
            }
        }

        .hero__form input,
        .hero__form select {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            color: var(--text-dark);
            border: 1px solid transparent;
            /* Hilangkan border default, karena ada di .form-group */
        }

        body.dark-mode .hero__form input,
        body.dark-mode .hero__form select {
            background-color: rgba(31, 41, 55, 0.8);
            color: var(--text-light);
        }

        .hero__form input::placeholder {
            color: var(--text-muted-light);
        }

        body.dark-mode .hero__form input::placeholder {
            color: var(--text-muted-dark);
        }

        .hero__form .form-group {
            display: flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.8);
            /* Background untuk ikon dan input menyatu */
            border-radius: var(--border-radius-md);
            padding-left: var(--spacing-unit);
            border: 1px solid var(--border-light);
            /* Border untuk group */
        }

        body.dark-mode .hero__form .form-group {
            background-color: rgba(31, 41, 55, 0.8);
            border-color: var(--border-dark);
        }

        .hero__form .form-group i {
            color: var(--text-muted-light);
            margin-right: calc(var(--spacing-unit) * 0.5);
        }

        body.dark-mode .hero__form .form-group i {
            color: var(--text-muted-dark);
        }

        .hero__form .form-group input,
        .hero__form .form-group select {
            background-color: transparent;
            /* Input/select sekarang transparan di dalam .form-group */
            border: none;
            /* Border sudah di .form-group */
            padding-left: 0;
        }

        .hero__form .form-group input:focus,
        .hero__form .form-group select:focus {
            box-shadow: none;
            /* Hilangkan shadow focus karena group sudah punya styling */
        }

        .hero__form .form-group:focus-within {
            /* Styling group saat input di dalamnya fokus */
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }


        .hero__form .btn--primary {
            padding: calc(var(--spacing-unit) * 0.85) calc(var(--spacing-unit) * 2);
            /* Sedikit lebih besar */
            width: 100%;
        }

        @media (min-width: 768px) {
            .hero__form .btn--primary {
                width: auto;
            }
        }

        /* --- Section Styling --- */
        .section {
            padding-top: calc(var(--spacing-unit) * 3);
            padding-bottom: calc(var(--spacing-unit) * 3);
        }

        .section--highlight {
            background-color: var(--bg-light-alt);
        }

        body.dark-mode .section--highlight {
            background-color: var(--bg-dark-alt);
        }

        .section__header {
            text-align: center;
            margin-bottom: calc(var(--spacing-unit) * 2.5);
        }

        .section__title {
            font-size: 2.25rem;
            /* Lebih konsisten */
            margin-bottom: calc(var(--spacing-unit) * 0.5);
        }

        .section__subtitle {
            font-size: 1.1rem;
            color: var(--text-muted-light);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        body.dark-mode .section__subtitle {
            color: var(--text-muted-dark);
        }

        /* --- Footer yang Lebih Profesional --- */
        .footer {
            background-color: var(--color-secondary);
            /* Warna hijau tua */
            color: var(--text-light);
            padding: calc(var(--spacing-unit) * 3) 0;
            margin-top: auto;
            /* Memastikan footer menempel di bawah */
        }

        .footer a {
            color: var(--color-primary-light);
        }

        .footer a:hover {
            color: var(--text-light);
            text-decoration: underline;
        }

        .footer__grid {
            display: grid;
            gap: calc(var(--spacing-unit) * 2);
        }

        @media (min-width: 768px) {
            .footer__grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }
        }

        .footer__column h5 {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-bottom: var(--spacing-unit);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .footer__column ul {
            list-style: none;
        }

        .footer__column ul li {
            margin-bottom: calc(var(--spacing-unit) * 0.5);
        }

        .footer__socials {
            display: flex;
            gap: var(--spacing-unit);
        }

        .footer__socials a {
            font-size: 1.5rem;
        }

        .footer__bottom {
            text-align: center;
            margin-top: calc(var(--spacing-unit) * 2);
            padding-top: calc(var(--spacing-unit) * 1.5);
            border-top: 1px solid var(--border-dark);
            /* Garis pemisah halus */
            font-size: 0.9rem;
            color: var(--text-muted-dark);
            /* Tetap, karena background footer sudah gelap */
        }

        /* --- Animasi Halus dan Efek Visual --- */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .animate-fade-in {
            animation: fadeIn var(--transition-speed-slow) var(--transition-timing-function) both;
        }

        .animate-fade-in-up {
            animation: fadeInUp var(--transition-speed-slow) var(--transition-timing-function) both;
        }

        .animate-scale-in {
            animation: scaleIn var(--transition-speed-medium) var(--transition-timing-function) both;
        }

        /* Delay animasi untuk elemen berurutan */
        .stagger-animation>* {
            opacity: 0;
            /* Mulai tidak terlihat */
        }

        .stagger-animation.animate-children>* {
            animation: fadeInUp var(--transition-speed-slow) var(--transition-timing-function) forwards;
        }

        /* JavaScript akan menambahkan kelas .animate-children dan mengatur delay */

        /* --- Scrollbar Kustom yang Fancy (Opsional, tergantung dukungan browser) --- */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-light);
        }

        body.dark-mode ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--color-primary);
            border-radius: var(--border-radius-full);
            border: 2px solid var(--bg-light);
        }

        body.dark-mode ::-webkit-scrollbar-thumb {
            background: var(--color-primary-light);
            border-color: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-primary-dark);
        }

        body.dark-mode ::-webkit-scrollbar-thumb:hover {
            background: var(--color-primary);
        }

        /* Untuk Firefox, perlu: scrollbar-width: thin; scrollbar-color: var(--color-primary) var(--bg-light); */
        html {
            scrollbar-width: thin;
            scrollbar-color: var(--color-primary) var(--bg-light);
        }

        body.dark-mode html {
            scrollbar-color: var(--color-primary-light) var(--bg-dark);
        }


        /* --- Utilitas Aksesibilitas --- */
        .sr-only {
            /* Screen Reader Only */
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Focus visible global sudah diatur di atas */

        /* --- Utilitas Tambahan --- */
        .text-center {
            text-align: center;
        }

        .text-left {
            text-align: left;
        }

        .text-right {
            text-align: right;
        }

        .w-full {
            width: 100%;
        }

        .truncate {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Padding & Margin utils */
        .py-8 {
            padding-top: calc(var(--spacing-unit) * 2);
            padding-bottom: calc(var(--spacing-unit) * 2);
        }

        .py-12 {
            padding-top: calc(var(--spacing-unit) * 3);
            padding-bottom: calc(var(--spacing-unit) * 3);
        }

        .px-4 {
            padding-left: var(--spacing-unit);
            padding-right: var(--spacing-unit);
        }

        .mt-4 {
            margin-top: var(--spacing-unit);
        }

        .mt-8 {
            margin-top: calc(var(--spacing-unit) * 2);
        }

        .mb-4 {
            margin-bottom: var(--spacing-unit);
        }

        .mb-8 {
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .mr-2 {
            margin-right: calc(var(--spacing-unit) * 0.5);
        }

        /* Responsive Utilities */
        .hidden {
            display: none !important;
        }

        @media (max-width: 767px) {

            /* Mobile and smaller tablets */
            .md\:hidden {
                display: none !important;
            }
        }

        @media (min-width: 768px) {

            /* Medium devices (tablets) and up */
            .md\:block {
                display: block !important;
            }

            .md\:flex {
                display: flex !important;
            }

            .md\:grid {
                display: grid !important;
            }

            .hidden-md-up {
                display: none !important;
            }

            /* Untuk menyembunyikan di desktop */
        }

        /* Loading Spinner & Overlay */
        .loading-spinner-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
            -webkit-backdrop-filter: blur(3px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed-medium) ease, visibility 0s var(--transition-speed-medium) ease;
        }

        .loading-spinner-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition: opacity var(--transition-speed-medium) ease, visibility 0s ease;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 6px solid rgba(255, 255, 255, 0.3);
            border-top-color: var(--color-primary-light);
            /* Lebih kontras di overlay gelap */
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .initial-loader {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: fixed;
            /* Agar menutupi seluruh layar awal */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-light);
            color: var(--text-dark);
            z-index: 10000;
            /* Di atas segalanya */
        }

        body.dark-mode .initial-loader {
            background-color: var(--bg-dark);
            color: var(--text-light);
        }

        .initial-loader .spinner {
            border-color: rgba(0, 0, 0, 0.1);
            border-top-color: var(--color-primary);
        }

        body.dark-mode .initial-loader .spinner {
            border-color: rgba(255, 255, 255, 0.1);
            border-top-color: var(--color-primary-light);
        }

        .initial-loader p {
            margin-top: var(--spacing-unit);
            font-size: 1.1rem;
            font-weight: 500;
        }

        /* Specific Page Styles */
        .property-detail__image {
            width: 100%;
            max-height: 60vh;
            object-fit: cover;
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            margin-bottom: calc(var(--spacing-unit) * 2);
        }

        .property-detail__features {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: var(--spacing-unit);
            margin: calc(var(--spacing-unit) * 1.5) 0;
        }

        .property-detail__features li {
            background-color: var(--bg-light);
            /* Beda dari card biasa agar lebih menyatu */
            padding: var(--spacing-unit);
            border-radius: var(--border-radius-md);
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            gap: calc(var(--spacing-unit) * 0.5);
        }

        body.dark-mode .property-detail__features li {
            background-color: var(--bg-dark);
        }

        .property-detail__features i {
            color: var(--color-primary);
            font-size: 1.2rem;
        }

        .property-detail__agent-card {
            background-color: var(--bg-light);
            padding: calc(var(--spacing-unit) * 1.5);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            margin-top: calc(var(--spacing-unit) * 2);
        }

        body.dark-mode .property-detail__agent-card {
            background-color: var(--bg-dark);
        }

        .agent-card__avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: var(--spacing-unit);
            border: 3px solid var(--color-primary);
        }

        /* Styling untuk teks dari AI (prose-like) */
        .prose {
            color: var(--text-dark);
            max-width: 65ch;
            /* Lebar baca optimal */
        }

        .prose h4 {
            color: var(--color-secondary);
            font-size: 1.15rem;
            /* Sedikit lebih kecil dari h3 global */
            margin-top: 1.5em;
            margin-bottom: 0.5em;
        }

        .prose p,
        .prose ul,
        .prose ol {
            font-size: 1rem;
            line-height: 1.7;
            margin-bottom: 1em;
        }

        .prose ul,
        .prose ol {
            padding-left: 1.5em;
        }

        .prose li>p {
            margin-bottom: 0.5em;
        }

        /* Jarak antar paragraf dalam list item */
        .prose strong {
            font-weight: 600;
            color: var(--color-secondary);
        }

        .prose em {
            font-style: italic;
            color: var(--color-primary-dark);
        }

        .prose a {
            color: var(--color-primary);
            text-decoration: underline;
        }

        .prose a:hover {
            color: var(--color-primary-dark);
        }

        body.dark-mode .prose {
            color: var(--text-light);
        }

        body.dark-mode .prose h4 {
            color: var(--color-primary-light);
        }

        body.dark-mode .prose strong {
            color: var(--color-primary-light);
        }

        body.dark-mode .prose em {
            color: var(--color-primary-light);
            opacity: 0.9;
        }

        body.dark-mode .prose a {
            color: var(--color-primary-light);
        }

        body.dark-mode .prose a:hover {
            color: var(--text-light);
        }

        .max-w-none {
            max-width: none;
        }
    </style>
</head>

<body>
    <!-- Root element untuk aplikasi SPA -->
    <div id="app-root">
        <!-- Loader awal saat aplikasi pertama kali dimuat -->
        <div class="initial-loader">
            <div class="spinner"></div>
            <p>Memuat Green Valley Properties...</p>
        </div>
    </div>

    <!-- Overlay untuk loading state antar halaman/aksi -->
    <div id="loading-overlay" class="loading-spinner-overlay">
        <div class="spinner"></div>
    </div>

    <script type="module">
        // --- KONFIGURASI APLIKASI ---
        const CONFIG = {
            appName: "Green Valley Properties",
            defaultPath: '/', // Halaman default jika tidak ada hash
            apiBaseUrl: "https://mock-api.greenvalley.com", // Tidak digunakan secara nyata
            geminiApiKey: "YOUR_MOCK_API_KEY_HERE", // Tetap placeholder
            themeKey: 'greenValleyTheme' // Key untuk localStorage tema
        };

        // --- MOCK GOOGLE GEN AI SERVICE (Simulasi, seperti di kode asli) ---
        // (Kode MockGoogleGenAI dan geminiService dari kode Anda dimasukkan di sini,
        //  saya akan sedikit merapikannya untuk konsistensi)
        class MockGoogleGenAI {
            constructor(apiKey) {
                this.apiKey = apiKey;
                if (!this.apiKey || this.apiKey === "YOUR_MOCK_API_KEY_HERE") {
                    console.warn("Kunci API Mock Gemini tidak disetel atau menggunakan placeholder. Fitur AI akan menghasilkan teks default.");
                }
            }

            async generateContent({ prompt, propertyDetails = null }) {
                // Simulasi delay jaringan
                await new Promise(resolve => setTimeout(resolve, 400 + Math.random() * 600));

                let responseText = `Konten AI simulasi untuk prompt: "${String(prompt).substring(0, 50)}...".`;
                const lowerPrompt = String(prompt).toLowerCase();

                if (lowerPrompt.includes("deskripsi listing properti")) {
                    const prop = propertyDetails || {};
                    const tipe = prop.type || 'properti menawan';
                    const lokasi = prop.location || 'lokasi strategis';
                    const kamar = prop.beds || 'beberapa';
                    const mandi = prop.baths || 'beberapa';
                    const luas = prop.area || 'yang lapang';
                    const harga = prop.price ? `Rp ${prop.price.toLocaleString('id-ID')}` : 'harga menarik';
                    const fasilitas = prop.amenities?.slice(0, 3).join(', ') || 'berbagai fasilitas modern'; // Ambil 3 fasilitas pertama

                    responseText = `
                        <h4>‚ú® <strong>${tipe.charAt(0).toUpperCase() + tipe.slice(1)} Impian Anda di ${lokasi}!</strong> ‚ú®</h4>
                        <p>Selamat datang di ${tipe} eksklusif ini, sebuah mahakarya arsitektur yang menawarkan perpaduan sempurna antara kemewahan kontemporer dan kenyamanan hunian. Terletak strategis di jantung ${lokasi}, properti ini adalah oasis kedamaian di tengah hiruk pikuk kota, atau surga ketenangan di destinasi pilihan.</p>
                        <p>Dengan <strong>${kamar} kamar tidur</strong> yang dirancang elegan dan <strong>${mandi} kamar mandi</strong> berfasilitas premium, setiap sudut properti ini memancarkan kualitas dan perhatian terhadap detail. Ruang utama seluas <strong>${luas} m¬≤</strong> menyediakan area yang lapang untuk aktivitas keluarga dan menjamu tamu dengan gaya.</p>
                        <p>Nikmati beragam fasilitas unggulan termasuk: <em>${fasilitas}${prop.amenities && prop.amenities.length > 3 ? ', dan masih banyak lagi' : ''}</em>. Semua keistimewaan ini dapat menjadi milik Anda dengan penawaran ${harga}.</p>
                        <p>Jangan lewatkan kesempatan langka untuk memiliki properti idaman ini. Hubungi kami sekarang untuk mengatur jadwal kunjungan eksklusif dan biarkan tim profesional kami membantu Anda mewujudkan impian properti Anda bersama Green Valley!</p>
                    `;
                } else if (lowerPrompt.includes("slogan iklan")) {
                    const slogans = [
                        "Green Valley: Membangun Masa Depan, Satu Rumah Impian.",
                        "Di Green Valley, Setiap Properti Adalah Permata.",
                        "Green Valley: Investasi Cerdas, Kehidupan Berkualitas.",
                        "Wujudkan Hunian Ideal Anda Bersama Green Valley Properties."
                    ];
                    responseText = slogans[Math.floor(Math.random() * slogans.length)];
                } else if (lowerPrompt.includes("tips membeli properti")) {
                    responseText = `
                        <h5>Tips Cerdas Membeli Properti dari Green Valley:</h5>
                        <ul>
                            <li><strong>Definisikan Kebutuhan & Anggaran:</strong> Pahami apa yang Anda cari dan berapa kemampuan finansial Anda secara realistis.</li>
                            <li><strong>Riset Lokasi Mendalam:</strong> Pertimbangkan aksesibilitas, fasilitas umum, potensi pertumbuhan, dan keamanan lingkungan.</li>
                            <li><strong>Gunakan Jasa Agen Terpercaya:</strong> Agen profesional seperti di Green Valley dapat menghemat waktu, tenaga, dan memberikan saran ahli.</li>
                            <li><strong>Inspeksi Properti Secara Teliti:</strong> Periksa kondisi fisik bangunan, legalitas dokumen, dan potensi biaya tersembunyi.</li>
                            <li><strong>Jangan Terburu-buru:</strong> Pembelian properti adalah keputusan besar. Ambil waktu Anda untuk mempertimbangkan semua aspek.</li>
                        </ul>
                    `;
                } else if (lowerPrompt.includes("visi dan misi")) {
                    responseText = `
                        <h4>Visi Kami</h4>
                        <p>Menjadi perusahaan properti terdepan dan paling tepercaya di Indonesia, dikenal karena inovasi, integritas, dan komitmen kami dalam menciptakan nilai berkelanjutan bagi klien, mitra, dan masyarakat.</p>
                        <h4>Misi Kami</h4>
                        <ul>
                            <li>Menyediakan solusi properti yang komprehensif dan personal, melebihi ekspektasi klien melalui layanan berkualitas tinggi.</li>
                            <li>Mengembangkan dan memasarkan properti inovatif yang meningkatkan kualitas hidup dan memberikan investasi optimal.</li>
                            <li>Membangun hubungan jangka panjang yang didasarkan pada kepercayaan, profesionalisme, dan transparansi.</li>
                            <li>Berkontribusi positif terhadap pengembangan komunitas dan lingkungan di mana kami beroperasi.</li>
                        </ul>
                    `;
                }
                return { text: () => responseText };
            }
        }
        const geminiService = {
            ai: new MockGoogleGenAI(CONFIG.geminiApiKey),
            generateText: async (prompt, propertyDetails = null) => {
                try {
                    const result = await geminiService.ai.generateContent({ prompt, propertyDetails });
                    return result.text();
                } catch (error) {
                    console.error("Kesalahan saat menghasilkan teks dari Mock Gemini:", error);
                    return "<p class='text-red-500'>Maaf, terjadi kesalahan saat menghasilkan konten. Silakan coba lagi nanti.</p>";
                }
            }
        };


        // --- MANAJEMEN STATE APLIKASI ---
        let appState = {
            currentPath: window.location.hash.slice(1) || CONFIG.defaultPath,
            properties: [], // Akan diisi dari data mock
            searchFilters: { location: '', type: '', minPrice: '', maxPrice: '', beds: '' },
            isDarkMode: localStorage.getItem(CONFIG.themeKey) === 'dark' ||
                (!localStorage.getItem(CONFIG.themeKey) && window.matchMedia('(prefers-color-scheme: dark)').matches),
            isLoading: false,
            mobileMenuOpen: false,
            propertyDetailCache: {}, // Cache sederhana untuk detail properti
            currentPageTitle: CONFIG.appName,
        };

        // --- DATA MOCK PROPERTI (Lebih beragam dan detail) ---
        const mockProperties = [
            // ... (Data properti dari kode Anda akan saya masukkan dan sedikit modifikasi)
            { id: 1, name: 'Villa Azure Dengan Pemandangan Samudra', type: 'Villa', location: 'Bukit Jimbaran, Bali', price: 7500000000, beds: 5, baths: 6, area: 650, image: 'https://images.unsplash.com/photo-1613490493576-7fde63acd811?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: true, amenities: ['Kolam Renang Pribadi Infinity', 'Bioskop Mini', 'Gym & Spa Pribadi', 'Pemandangan Laut Lepas 180¬∞', 'Garasi 3 Mobil', 'Taman Tropis Luas', 'Ruang Anggur', 'Sistem Keamanan Canggih'], agent: { name: 'Rizky Pratama', phone: '0812-3456-7890', avatar: 'https://randomuser.me/api/portraits/men/32.jpg' } },
            { id: 2, name: 'Apartemen Urban Chic di Jantung Metropolis', type: 'Apartemen', location: 'SCBD, Jakarta Selatan', price: 3200000000, beds: 2, baths: 2, area: 120, image: 'https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: true, amenities: ['Akses Lift Pribadi', 'Smart Home System Terintegrasi', 'Kolam Renang Rooftop dengan Pemandangan Kota', 'Fitness Center & Sauna', 'Area BBQ & Lounge', 'Parkir Basement Khusus'], agent: { name: 'Siti Aminah', phone: '0812-9876-5432', avatar: 'https://randomuser.me/api/portraits/women/44.jpg' } },
            { id: 3, name: 'Rumah Keluarga Klasik Elegan dan Luas', type: 'Rumah', location: 'Pondok Indah, Jakarta Selatan', price: 15000000000, beds: 4, baths: 4, area: 450, image: 'https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: false, amenities: ['Taman Belakang Luas dengan Gazebo', 'Ruang Kerja Pribadi', 'Dapur Kering & Basah Modern', 'Garasi 2 Mobil + Carport 2 Mobil', 'Keamanan 24 Jam One Gate System', 'Dekat Sekolah Internasional'], agent: { name: 'Budi Santoso', phone: '0812-1122-3344', avatar: 'https://randomuser.me/api/portraits/men/35.jpg' } },
            { id: 4, name: 'Studio Minimalis Modern untuk Profesional', type: 'Apartemen', location: 'BSD City, Tangerang', price: 850000000, beds: 1, baths: 1, area: 45, image: 'https://images.unsplash.com/photo-1484154218962-a197022b5858?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: true, amenities: ['Co-working Space & Library', 'Kolam Renang Bersama Olympic Size', 'Jogging Track & Outdoor Gym', 'Dekat Stasiun KRL & Akses Tol', 'Shuttle Bus ke Area Komersial'], agent: { name: 'Lina Mariska', phone: '0812-5566-7788', avatar: 'https://randomuser.me/api/portraits/women/30.jpg' } },
            { id: 5, name: 'Townhouse Eksklusif Komunitas Asri', type: 'Rumah', location: 'Sentul City, Bogor', price: 2100000000, beds: 3, baths: 3, area: 180, image: 'https://images.unsplash.com/photo-1582268611958-ebfd161ef9cf?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: false, amenities: ['Clubhouse Komunitas Lengkap', 'Taman Bermain Anak Tematik', 'Sistem Satu Gerbang dengan CCTV', 'Udara Segar Pegunungan', 'Dekat Area Wisata Alam'], agent: { name: 'Agus Wijaya', phone: '0812-9988-7766', avatar: 'https://randomuser.me/api/portraits/men/40.jpg' } },
            { id: 6, name: 'Penthouse Mewah Pemandangan Kota 360¬∞', type: 'Apartemen', location: 'Kuningan, Jakarta Pusat', price: 25000000000, beds: 4, baths: 5, area: 500, image: 'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', featured: true, amenities: ['Jacuzzi Pribadi di Balkon Utama', 'Rooftop Garden Pribadi', 'Layanan Concierge 24/7', 'Akses Helipad (Opsional)', 'Interior Desainer Ternama', 'Material Impor Berkualitas Tinggi'], agent: { name: 'Dewi Lestari', phone: '0812-0011-2233', avatar: 'https://randomuser.me/api/portraits/women/50.jpg' } },
        ];
        appState.properties = mockProperties;


        // --- FUNGSI UTILITAS ---
        const utils = {
            createElement: (tag, props = {}, ...children) => {
                const element = document.createElement(tag);
                Object.entries(props).forEach(([key, value]) => {
                    if (key.startsWith('on') && typeof value === 'function') {
                        element.addEventListener(key.substring(2).toLowerCase(), value);
                    } else if (key === 'className') {
                        element.className = value;
                    } else if (key === 'style' && typeof value === 'object') {
                        Object.assign(element.style, value);
                    } else if (key === 'dangerouslySetInnerHTML' && value && typeof value.__html === 'string') {
                        // Gunakan dengan HATI-HATI dan hanya untuk konten tepercaya (seperti dari AI kita)
                        element.innerHTML = value.__html;
                    } else if (key === 'ref' && typeof value === 'function') {
                        value(element); // Callback untuk mendapatkan referensi elemen
                    }
                    else if (value !== null && value !== undefined && value !== false) {
                        element.setAttribute(key, value);
                    }
                });
                children.flat().forEach(child => {
                    if (child instanceof Node) {
                        element.appendChild(child);
                    } else if (child !== null && child !== undefined && child !== false) {
                        element.appendChild(document.createTextNode(String(child)));
                    }
                });
                return element;
            },
            debounce: (func, delay) => {
                let timeout;
                return (...args) => {
                    clearTimeout(timeout);
                    timeout = setTimeout(() => func.apply(this, args), delay);
                };
            },
            // Throttle tidak terlalu dibutuhkan di sini, tapi tetap ada untuk kelengkapan
            throttle: (func, limit) => {
                let inThrottle;
                return (...args) => {
                    if (!inThrottle) {
                        func.apply(this, args);
                        inThrottle = true;
                        setTimeout(() => inThrottle = false, limit);
                    }
                };
            },
            setLoading: (isLoading) => {
                appState.isLoading = isLoading;
                const overlay = document.getElementById('loading-overlay');
                if (overlay) {
                    overlay.classList.toggle('visible', isLoading);
                }
            },
            formatCurrency: (amount) => {
                if (typeof amount !== 'number') return 'N/A';
                return `Rp ${amount.toLocaleString('id-ID', { minimumFractionDigits: 0, maximumFractionDigits: 0 })}`;
            },
            applyStaggerAnimation: (parentElement, delayIncrement = 100) => {
                if (!parentElement || !parentElement.classList.contains('stagger-animation')) return;
                const children = Array.from(parentElement.children);
                parentElement.classList.add('animate-children');
                children.forEach((child, index) => {
                    child.style.animationDelay = `${index * delayIncrement}ms`;
                });
            },
            scrollToTop: () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            },
            updateDocumentTitle: (pageTitle) => {
                document.title = `${pageTitle} | ${CONFIG.appName}`;
                appState.currentPageTitle = pageTitle;
            }
        };

        // --- ROUTER SEDERHANA (Berbasis Hash) ---
        const router = {
            routes: {},
            addRoute: (path, componentFunction, title) => {
                router.routes[path] = { component: componentFunction, title };
            },
            navigateTo: async (path, params = {}) => {
                // Tidak perlu setLoading(true) di sini, akan dihandle di renderApp/resolveRoute
                let targetPath = path;
                for (const key in params) {
                    targetPath = targetPath.replace(`:${key}`, encodeURIComponent(params[key]));
                }
                if (window.location.hash.slice(1) === targetPath) {
                    // Jika navigasi ke path yang sama, panggil renderApp untuk refresh jika perlu
                    // (misalnya jika ada state yang berubah tapi path tidak)
                    // Untuk SPA sederhana ini, biasanya tidak perlu kecuali ada aksi khusus
                    console.log("Navigasi ke path yang sama, tidak ada perubahan hash.");
                    return; // Atau paksa render jika memang diinginkan
                }
                window.location.hash = targetPath;
                // Perubahan hash akan memicu event 'hashchange' yang akan memanggil renderApp
            },
            resolveRoute: () => {
                const rawPath = window.location.hash.slice(1) || CONFIG.defaultPath;
                const pathName = rawPath.split('?')[0]; // Abaikan query string untuk pencocokan rute

                for (const routePattern in router.routes) {
                    const routePatternParts = routePattern.split('/');
                    const pathNameParts = pathName.split('/');

                    if (routePatternParts.length === pathNameParts.length) {
                        const params = {};
                        let match = true;
                        for (let i = 0; i < routePatternParts.length; i++) {
                            if (routePatternParts[i].startsWith(':')) {
                                params[routePatternParts[i].slice(1)] = decodeURIComponent(pathNameParts[i]);
                            } else if (routePatternParts[i] !== pathNameParts[i]) {
                                match = false;
                                break;
                            }
                        }
                        if (match) {
                            appState.currentPath = routePattern; // Simpan pattern rute yang cocok
                            return { ...router.routes[routePattern], params };
                        }
                    }
                }
                // Jika tidak ada rute yang cocok, arahkan ke 404
                appState.currentPath = '/404'; // Pastikan rute /404 terdaftar
                return { ...router.routes['/404'], params: {} };
            }
        };

        // --- KOMPONEN-KOMPONEN UI (Fungsi yang mengembalikan elemen DOM) ---

        function NavbarComponent() {
            const { createElement } = utils;
            const navItems = [
                { path: '/', label: 'Beranda', icon: 'fa-solid fa-house-chimney' },
                { path: '/search', label: 'Cari Properti', icon: 'fa-solid fa-magnifying-glass-location' },
                { path: '/about', label: 'Tentang Kami', icon: 'fa-solid fa-users' },
                { path: '/contact', label: 'Hubungi Kami', icon: 'fa-solid fa-envelope' },
            ];

            const createNavLink = (item, isMobile = false) => {
                let classNames = appState.currentPath === item.path ? 'active' : '';
                if (isMobile) {
                    classNames = `btn btn--secondary w-full text-left ${appState.currentPath === item.path ? 'active' : ''}`;
                }
                return createElement('a', {
                    href: `#${item.path}`,
                    className: classNames,
                    onClick: (e) => {
                        e.preventDefault();
                        router.navigateTo(item.path);
                        if (isMobile) toggleMobileMenu(false); // Tutup menu setelah klik di mobile
                    }
                }, createElement('i', { className: `${item.icon} mr-2` }), item.label);
            };

            const desktopNav = createElement('ul', { className: 'nav__list hidden md:flex' },
                ...navItems.map(item => createElement('li', { className: 'nav__item' }, createNavLink(item)))
            );

            const mobileNavMenu = createElement('nav', { id: 'mobile-nav-menu', className: 'mobile-nav' });

            const updateMobileNavItems = () => {
                mobileNavMenu.innerHTML = ''; // Kosongkan dulu
                navItems.forEach(item => {
                    mobileNavMenu.appendChild(createElement('li', { className: 'nav__item' }, createNavLink(item, true)));
                });
                mobileNavMenu.appendChild(
                    createElement('button', {
                        className: 'btn btn--primary w-full mt-2',
                        onClick: () => {
                            alert('Fitur login/autentikasi akan segera hadir!');
                            toggleMobileMenu(false);
                        }
                    }, createElement('i', { className: 'fa-solid fa-right-to-bracket mr-2' }), 'Masuk / Daftar')
                );
            };

            const toggleMobileMenu = (forceState) => {
                appState.mobileMenuOpen = typeof forceState === 'boolean' ? forceState : !appState.mobileMenuOpen;
                mobileNavMenu.classList.toggle('open', appState.mobileMenuOpen);
                const menuIcon = document.getElementById('mobile-menu-icon');
                if (menuIcon) menuIcon.className = `fas ${appState.mobileMenuOpen ? 'fa-times' : 'fa-bars'}`;
                const button = document.getElementById('mobile-menu-button');
                if (button) button.setAttribute('aria-expanded', appState.mobileMenuOpen.toString());
                // Panggil updateMobileNavItems hanya jika menu akan dibuka atau saat inisialisasi
                if (appState.mobileMenuOpen || forceState === undefined) { // forceState undefined berarti toggle dari button
                    updateMobileNavItems();
                }
            };
            // Panggil sekali untuk inisialisasi (menu tertutup, tapi items perlu ada jika dibuka nanti)
            updateMobileNavItems();


            const mobileMenuButton = createElement('button', {
                id: 'mobile-menu-button',
                className: 'btn btn--icon btn--secondary md:hidden', // Tampil hanya di mobile
                onClick: () => toggleMobileMenu(),
                'aria-label': 'Buka Menu Navigasi',
                'aria-expanded': 'false', // Default
                'aria-controls': 'mobile-nav-menu'
            }, createElement('i', { id: 'mobile-menu-icon', className: 'fas fa-bars' }));

            return createElement('header', { className: 'navbar', id: 'main-navbar' },
                createElement('div', { className: 'container navbar__container' },
                    createElement('a', {
                        href: '#/',
                        className: 'navbar__brand',
                        title: `Kembali ke Beranda ${CONFIG.appName}`,
                        onClick: (e) => { e.preventDefault(); router.navigateTo('/'); }
                    },
                        createElement('i', { className: 'fas fa-mountain-city' }),
                        CONFIG.appName.split(' ')[0] // "Green"
                    ),
                    desktopNav,
                    createElement('div', { className: 'flex items-center gap-2' },
                        createElement('button', {
                            className: 'btn btn--icon btn--secondary',
                            onClick: () => {
                                appState.isDarkMode = !appState.isDarkMode;
                                document.body.classList.toggle('dark-mode', appState.isDarkMode);
                                localStorage.setItem(CONFIG.themeKey, appState.isDarkMode ? 'dark' : 'light');
                                // Tidak perlu renderApp() penuh hanya untuk dark mode jika CSS sudah reaktif
                                // Namun, jika ada komponen yang logikanya bergantung pada appState.isDarkMode, renderApp() diperlukan.
                                // Untuk amannya, kita bisa panggil renderApp() atau buat mekanisme update yang lebih granular.
                                // Untuk sekarang, biarkan tanpa renderApp() agar lebih ringan, CSS variables akan handle.
                            },
                            'aria-label': appState.isDarkMode ? 'Aktifkan Mode Terang' : 'Aktifkan Mode Gelap',
                            title: appState.isDarkMode ? 'Mode Terang' : 'Mode Gelap'
                        }, createElement('i', { className: `fas ${appState.isDarkMode ? 'fa-sun' : 'fa-moon'}` })),
                        createElement('button', {
                            className: 'btn btn--primary hidden md:flex',
                            onClick: () => alert('Fitur login/autentikasi akan segera hadir!')
                        }, createElement('i', { className: 'fa-solid fa-right-to-bracket mr-2' }), 'Masuk'),
                        mobileMenuButton
                    )
                ),
                mobileNavMenu
            );
        }

        function FooterComponent() {
            const { createElement } = utils;
            const currentYear = new Date().getFullYear();
            return createElement('footer', { className: 'footer' },
                createElement('div', { className: 'container' },
                    createElement('div', { className: 'footer__grid' },
                        createElement('div', { className: 'footer__column' },
                            createElement('h5', {}, CONFIG.appName),
                            createElement('p', { style: { fontSize: '0.9rem', color: 'var(--text-muted-dark)' } }, 'Menemukan properti impian Anda adalah misi kami. Dengan layanan profesional dan daftar properti pilihan, kami siap membantu Anda mengambil langkah selanjutnya.')
                        ),
                        createElement('div', { className: 'footer__column' },
                            createElement('h5', {}, 'Navigasi Cepat'),
                            createElement('ul', {},
                                ['Beranda', 'Cari Properti', 'Tentang Kami', 'Hubungi Kami', 'Syarat & Ketentuan'].map(label => {
                                    const pathMap = { 'Beranda': '/', 'Cari Properti': '/search', 'Tentang Kami': '/about', 'Hubungi Kami': '/contact', 'Syarat & Ketentuan': '/terms' };
                                    return createElement('li', {}, createElement('a', { href: `#${pathMap[label]}`, onClick: e => { e.preventDefault(); router.navigateTo(pathMap[label]); } }, label));
                                })
                            )
                        ),
                        createElement('div', { className: 'footer__column' },
                            createElement('h5', {}, 'Hubungi Kami'),
                            createElement('p', { style: { fontSize: '0.9rem', color: 'var(--text-muted-dark)' } }, 'Jl. Properti Impian No. 123, Green Valley City'),
                            createElement('p', { style: { fontSize: '0.9rem', color: 'var(--text-muted-dark)' } }, 'Email: info@greenvalley.com'),
                            createElement('p', { style: { fontSize: '0.9rem', color: 'var(--text-muted-dark)' } }, 'Telepon: (021) 555-0123')
                        ),
                        createElement('div', { className: 'footer__column' },
                            createElement('h5', {}, 'Ikuti Kami'),
                            createElement('div', { className: 'footer__socials' },
                                [['facebook-f', 'Facebook'], ['twitter', 'Twitter'], ['instagram', 'Instagram'], ['linkedin-in', 'LinkedIn']].map(([icon, title]) =>
                                    createElement('a', { href: `https://${title.toLowerCase()}.com`, target: '_blank', rel: 'noopener noreferrer', title: `${title} Green Valley`, 'aria-label': `Kunjungi ${title} kami` },
                                        createElement('i', { className: `fab fa-${icon}` })
                                    )
                                )
                            )
                        )
                    ),
                    createElement('div', { className: 'footer__bottom' },
                        createElement('p', {}, `Hak Cipta ¬© ${currentYear} ${CONFIG.appName}. Semua Hak Dilindungi. Dirancang dengan ‚ù§Ô∏è untuk Anda.`)
                    )
                )
            );
        }

        function PropertyCardComponent({ property, index = 0, animate = true }) {
            const { createElement, formatCurrency } = utils;
            return createElement('article', {
                className: `card ${animate ? 'animate-fade-in-up' : ''}`,
                style: animate ? { animationDelay: `${index * 100}ms` } : {},
                onClick: () => router.navigateTo('/property/:id', { id: property.id }),
                'aria-labelledby': `property-title-${property.id}`,
                role: 'listitem'
            },
                createElement('div', { className: 'card__image-container' },
                    createElement('img', {
                        src: `${property.image}&random=${property.id}`,
                        alt: `Eksterior menawan dari ${property.name}`,
                        className: 'card__image',
                        loading: 'lazy'
                    })
                ),
                createElement('div', { className: 'card__content' },
                    createElement('h3', { id: `property-title-${property.id}`, className: 'card__title' }, property.name), // .truncate sudah ada di CSS
                    createElement('p', { className: 'card__price' }, formatCurrency(property.price)),
                    createElement('p', { className: 'card__location' },
                        createElement('i', { className: 'fas fa-map-marker-alt' }),
                        property.location
                    ),
                    createElement('div', { className: 'flex flex-wrap gap-2 mt-2 text-xs' },
                        createElement('span', { className: 'px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded-md' }, `${property.beds} KT`),
                        createElement('span', { className: 'px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded-md' }, `${property.baths} KM`),
                        createElement('span', { className: 'px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded-md' }, `${property.area} m¬≤`)
                    ),
                    createElement('div', { className: 'card__footer' },
                        createElement('button', { className: 'btn btn--primary w-full', 'aria-label': `Lihat detail untuk ${property.name}` }, 'Lihat Detail')
                    )
                )
            );
        }


        // --- HALAMAN-HALAMAN APLIKASI ---

        async function HomePage() {
            utils.updateDocumentTitle('Beranda');
            const { createElement } = utils;
            const featuredProperties = appState.properties.filter(p => p.featured).slice(0, 3);

            const aiSloganElement = createElement('p', { className: 'text-lg italic text-emerald-300 animate-fade-in', style: { animationDelay: '0.5s', minHeight: '1.5em' } });
            geminiService.generateText("slogan iklan singkat dan menarik untuk perusahaan properti Green Valley")
                .then(slogan => { aiSloganElement.innerHTML = `<em>"${slogan}"</em>`; })
                .catch(() => { aiSloganElement.textContent = "Green Valley: Wujudkan Rumah Impian Anda."; });

            let searchLocation = appState.searchFilters.location || '';
            let searchType = appState.searchFilters.type || '';
            const heroForm = createElement('form', {
                className: 'hero__form animate-fade-in-up',
                style: { animationDelay: '0.7s' },
                onSubmit: (e) => {
                    e.preventDefault();
                    appState.searchFilters = { ...appState.searchFilters, location: searchLocation, type: searchType };
                    router.navigateTo('/search');
                }
            },
                createElement('div', { className: 'form-group' },
                    createElement('i', { className: 'fas fa-map-marker-alt' }),
                    createElement('input', { type: 'text', id: 'hero-location', value: searchLocation, onInput: (e) => searchLocation = e.target.value, placeholder: 'Mis: Jakarta, Bali', 'aria-label': 'Lokasi Properti' })
                ),
                createElement('div', { className: 'form-group' },
                    createElement('i', { className: 'fas fa-building' }),
                    createElement('select', { id: 'hero-type', value: searchType, onChange: (e) => searchType = e.target.value, 'aria-label': 'Tipe Properti' },
                        createElement('option', { value: '' }, 'Semua Tipe'),
                        ['Rumah', 'Apartemen', 'Villa', 'Tanah'].map(type => createElement('option', { value: type }, type))
                    )
                ),
                createElement('button', { type: 'submit', className: 'btn btn--primary' }, createElement('i', { className: 'fas fa-search mr-2' }), 'Cari Properti')
            );

            const pageContent = createElement('div', {},
                createElement('section', { className: 'hero' },
                    createElement('div', { className: 'hero__content' },
                        createElement('h1', { className: 'animate-fade-in-up' }, 'Temukan Properti Impian Anda di ', createElement('span', { style: { color: 'var(--color-primary-light)' } }, 'Green Valley')),
                        createElement('p', { className: 'animate-fade-in-up', style: { animationDelay: '0.3s' } }, 'Jelajahi koleksi properti eksklusif kami dan temukan tempat yang benar-benar Anda sebut rumah.'),
                        aiSloganElement,
                        heroForm
                    )
                ),
                createElement('section', { className: 'section', id: 'featured-properties', 'aria-labelledby': 'featured-title' },
                    createElement('div', { className: 'container' },
                        createElement('div', { className: 'section__header animate-fade-in-up' },
                            createElement('h2', { id: 'featured-title', className: 'section__title' }, 'Properti Unggulan Kami'),
                            createElement('p', { className: 'section__subtitle' }, 'Pilihan terbaik yang dikurasi khusus untuk Anda.')
                        ),
                        featuredProperties.length > 0
                            ? createElement('div', { className: 'grid grid-auto-fit gap-6 lg:gap-8 stagger-animation', role: 'list', ref: el => utils.applyStaggerAnimation(el) },
                                ...featuredProperties.map((prop, idx) => PropertyCardComponent({ property: prop, index: idx, animate: false })) // animate dikontrol stagger
                            )
                            : createElement('p', { className: 'text-center' }, 'Saat ini belum ada properti unggulan.'),
                        createElement('div', { className: 'text-center mt-8 animate-fade-in-up', style: { animationDelay: '0.5s' } },
                            createElement('button', { onClick: () => router.navigateTo('/search'), className: 'btn btn--accent btn--lg' }, createElement('i', { className: 'fas fa-th-list mr-2' }), 'Lihat Semua Properti')
                        )
                    )
                ),
                createElement('section', { className: 'section section--highlight', id: 'why-us', 'aria-labelledby': 'why-us-title' },
                    createElement('div', { className: 'container' },
                        createElement('div', { className: 'section__header animate-fade-in-up' },
                            createElement('h2', { id: 'why-us-title', className: 'section__title' }, 'Mengapa Memilih Green Valley?'),
                            createElement('p', { className: 'section__subtitle' }, 'Kami berkomitmen memberikan pengalaman terbaik dalam perjalanan properti Anda.')
                        ),
                        createElement('div', { className: 'grid md:grid-cols-3 gap-8 stagger-animation', ref: el => utils.applyStaggerAnimation(el, 150) },
                            [
                                { icon: 'fa-award', title: 'Pilihan Properti Terbaik', desc: 'Koleksi properti berkualitas tinggi yang telah diverifikasi.' },
                                { icon: 'fa-headset', title: 'Layanan Profesional', desc: 'Tim agen berpengalaman kami siap membantu Anda di setiap langkah.' },
                                { icon: 'fa-shield-alt', title: 'Transparan & Aman', desc: 'Kami menjunjung tinggi integritas dan keamanan dalam setiap transaksi.' }
                            ].map(item =>
                                createElement('div', { className: 'text-center p-6' },
                                    createElement('i', { className: `fas ${item.icon} fa-3x text-primary mb-4`, style: { color: 'var(--color-primary)' }, 'aria-hidden': 'true' }),
                                    createElement('h4', {}, item.title),
                                    createElement('p', { className: 'text-sm text-muted-light dark:text-muted-dark' }, item.desc)
                                )
                            )
                        )
                    )
                ),
                createElement('section', { className: 'section', id: 'testimonials', 'aria-labelledby': 'testimonials-title' },
                    createElement('div', { className: 'container' },
                        createElement('div', { className: 'section__header animate-fade-in-up' },
                            createElement('h2', { id: 'testimonials-title', className: 'section__title' }, 'Apa Kata Mereka?'),
                            createElement('p', { className: 'section__subtitle' }, 'Dengarkan pengalaman klien kami yang puas.')
                        ),
                        createElement('div', { className: 'grid md:grid-cols-2 gap-8 stagger-animation', ref: el => utils.applyStaggerAnimation(el, 150) },
                            [
                                { quote: '"Proses pembelian rumah pertama saya sangat lancar berkat Green Valley. Agennya sangat membantu!"', name: 'Anisa Putri', role: 'Pembeli Rumah, Jakarta', avatar: 'https://randomuser.me/api/portraits/women/68.jpg' },
                                { quote: '"Menjual apartemen saya melalui Green Valley adalah keputusan tepat. Profesional dan cepat!"', name: 'David Lee', role: 'Penjual Apartemen, Surabaya', avatar: 'https://randomuser.me/api/portraits/men/75.jpg' }
                            ].map(testimonial =>
                                createElement('blockquote', { className: 'card p-6' }, // Menggunakan blockquote untuk testimonial
                                    createElement('p', { className: 'italic mb-4 text-muted-light dark:text-muted-dark' }, testimonial.quote),
                                    createElement('footer', { className: 'flex items-center' },
                                        createElement('img', { src: testimonial.avatar, alt: `Foto Klien ${testimonial.name}`, className: 'w-12 h-12 rounded-full mr-4' }),
                                        createElement('div', {},
                                            createElement('h5', { className: 'font-semibold' }, testimonial.name),
                                            createElement('p', { className: 'text-sm text-primary' }, testimonial.role)
                                        )
                                    )
                                )
                            )
                        )
                    )
                )
            );
            return pageContent;
        }


        async function SearchPage() {
            utils.updateDocumentTitle('Cari Properti');
            const { createElement, formatCurrency } = utils;
            let localFilters = { ...appState.searchFilters }; // Filter lokal untuk form

            const handleFilterChange = utils.debounce((filterName, value) => {
                localFilters[filterName] = value;
                appState.searchFilters = { ...localFilters }; // Update state global
                renderApp(); // Re-render untuk update hasil pencarian
            }, 500); // Debounce untuk performa saat user mengetik/mengubah cepat

            const filteredProperties = appState.properties.filter(property => {
                const { location, type, minPrice, maxPrice, beds } = appState.searchFilters;
                let match = true;
                if (location && !property.location.toLowerCase().includes(location.toLowerCase())) match = false;
                if (type && property.type !== type) match = false;
                if (minPrice && property.price < parseInt(minPrice)) match = false;
                if (maxPrice && property.price > parseInt(maxPrice)) match = false;
                if (beds && property.beds < parseInt(beds)) match = false;
                return match;
            });

            const filterForm = createElement('form', {
                className: 'p-6 mb-8 bg-light-alt dark:bg-dark-alt rounded-lg shadow-lg grid md:grid-cols-3 lg:grid-cols-5 gap-4 items-end animate-fade-in-up',
                id: 'search-filters-form',
                onSubmit: e => e.preventDefault()
            },
                createElement('div', {},
                    createElement('label', { htmlFor: 'filter-location', className: 'block text-sm font-medium mb-1' }, 'Lokasi'),
                    createElement('input', { type: 'text', id: 'filter-location', placeholder: 'cth. Jakarta', value: localFilters.location, onInput: e => handleFilterChange('location', e.target.value), className: 'w-full' })
                ),
                createElement('div', {},
                    createElement('label', { htmlFor: 'filter-type', className: 'block text-sm font-medium mb-1' }, 'Tipe Properti'),
                    createElement('select', { id: 'filter-type', value: localFilters.type, onChange: e => handleFilterChange('type', e.target.value), className: 'w-full' },
                        createElement('option', { value: '' }, 'Semua Tipe'),
                        ['Rumah', 'Apartemen', 'Villa', 'Tanah'].map(type => createElement('option', { value: type }, type))
                    )
                ),
                createElement('div', {},
                    createElement('label', { htmlFor: 'filter-beds', className: 'block text-sm font-medium mb-1' }, 'Min. Kamar Tidur'),
                    createElement('select', { id: 'filter-beds', value: localFilters.beds, onChange: e => handleFilterChange('beds', e.target.value), className: 'w-full' },
                        createElement('option', { value: '' }, 'Semua'),
                        [1, 2, 3, 4, 5].map(n => createElement('option', { value: n.toString() }, `${n}+ KT`))
                    )
                ),
                createElement('div', {},
                    createElement('label', { htmlFor: 'filter-min-price', className: 'block text-sm font-medium mb-1' }, 'Harga Min.'),
                    createElement('input', { type: 'number', id: 'filter-min-price', placeholder: 'Rp', value: localFilters.minPrice, onInput: e => handleFilterChange('minPrice', e.target.value), className: 'w-full', step: 100000000, min: "0" })
                ),
                createElement('div', {},
                    createElement('label', { htmlFor: 'filter-max-price', className: 'block text-sm font-medium mb-1' }, 'Harga Maks.'),
                    createElement('input', { type: 'number', id: 'filter-max-price', placeholder: 'Rp', value: localFilters.maxPrice, onInput: e => handleFilterChange('maxPrice', e.target.value), className: 'w-full', step: 100000000, min: "0" })
                )
            );

            const pageContent = createElement('main', { className: 'container py-8 animate-fade-in', 'aria-live': 'polite' }, // aria-live untuk memberitahu screen reader tentang perubahan hasil
                createElement('div', { className: 'section__header' },
                    createElement('h1', { className: 'section__title' }, 'Temukan Properti Ideal Anda'),
                    createElement('p', { className: 'section__subtitle' }, `Menampilkan ${filteredProperties.length} properti yang sesuai. Gunakan filter untuk menyaring.`)
                ),
                filterForm,
                filteredProperties.length > 0
                    ? createElement('div', { className: 'grid grid-auto-fit gap-6 lg:gap-8 stagger-animation', role: 'list', ref: el => utils.applyStaggerAnimation(el) },
                        ...filteredProperties.map((prop, idx) => PropertyCardComponent({ property: prop, index: idx, animate: false }))
                    )
                    : createElement('div', { className: 'text-center py-16 animate-fade-in-up' },
                        createElement('i', { className: 'fas fa-search-minus fa-4x text-gray-400 dark:text-gray-500 mb-4', 'aria-hidden': 'true' }),
                        createElement('h3', { className: 'text-xl font-semibold mb-2' }, 'Tidak Ada Properti Ditemukan'),
                        createElement('p', { className: 'text-muted-light dark:text-muted-dark' }, 'Coba sesuaikan filter pencarian Anda atau periksa kembali nanti.')
                    )
            );
            return pageContent;
        }


        async function PropertyDetailPage({ id }) {
            const propertyId = parseInt(id);
            let property = appState.propertyDetailCache[propertyId];

            if (!property) {
                property = appState.properties.find(p => p.id === propertyId);
                if (property) appState.propertyDetailCache[propertyId] = property;
            }

            const { createElement, formatCurrency } = utils;

            if (!property) {
                utils.updateDocumentTitle('Properti Tidak Ditemukan');
                return NotFoundPage(); // Ini juga async, jadi return promise
            }

            utils.updateDocumentTitle(property.name);

            const aiDescriptionElement = createElement('div', { className: 'prose dark:prose-invert max-w-none mt-6 animate-fade-in-up', style: { animationDelay: '0.5s', minHeight: '10em' } });
            aiDescriptionElement.innerHTML = '<p class="italic text-muted-light dark:text-muted-dark">Memuat deskripsi menarik dari AI...</p>';
            geminiService.generateText("Buatkan deskripsi listing properti yang menarik dan profesional", property)
                .then(desc => { aiDescriptionElement.innerHTML = desc; })
                .catch(err => {
                    console.error(err);
                    aiDescriptionElement.innerHTML = `<p>Properti ${property.type} ini berlokasi di ${property.location}, dengan ${property.beds} kamar tidur dan ${property.baths} kamar mandi. Luas total ${property.area} m¬≤.</p>`;
                });

            const agent = property.agent || { name: 'Agen Green Valley', phone: 'N/A', avatar: `https://ui-avatars.com/api/?name=Agent&background=random&color=fff` };

            const pageContent = createElement('main', { className: 'container py-8 animate-fade-in' },
                createElement('div', { className: 'mb-6' },
                    createElement('button', {
                        onClick: () => window.history.length > 2 ? window.history.back() : router.navigateTo('/search'), // Kembali atau ke search
                        className: 'btn btn--secondary'
                    }, createElement('i', { className: 'fas fa-arrow-left mr-2' }), 'Kembali')
                ),
                createElement('article', { className: 'bg-light-alt dark:bg-dark-alt p-4 md:p-8 rounded-lg shadow-xl' },
                    createElement('div', { className: 'grid md:grid-cols-3 gap-8' },
                        createElement('div', { className: 'md:col-span-2' },
                            createElement('img', { src: `${property.image}&w=1200&h=800&fit=crop`, alt: `Pemandangan utama ${property.name}`, className: 'property-detail__image animate-scale-in' }),
                            createElement('div', { className: 'grid grid-cols-3 sm:grid-cols-4 gap-2 mt-4', 'aria-label': 'Galeri gambar tambahan' },
                                ...[1, 2, 3, 4].map(i => createElement('img', {
                                    src: `https://picsum.photos/seed/prop${property.id}_img${i}/200/150`, // Menggunakan Picsum untuk placeholder galeri
                                    alt: `Detail gambar ${i} dari ${property.name}`,
                                    className: 'rounded-md object-cover aspect-video cursor-pointer hover:opacity-80 transition-opacity',
                                    loading: 'lazy'
                                }))
                            )
                        ),
                        createElement('div', { className: 'md:col-span-1' },
                            createElement('h1', { className: 'text-3xl md:text-4xl font-bold mb-2 animate-fade-in-up' }, property.name),
                            createElement('p', { className: 'text-lg text-muted-light dark:text-muted-dark mb-1 animate-fade-in-up', style: { animationDelay: '0.1s' } },
                                createElement('i', { className: 'fas fa-map-marker-alt mr-2 text-primary' }), property.location
                            ),
                            createElement('p', { className: 'text-2xl md:text-3xl font-bold text-primary mb-6 animate-fade-in-up', style: { animationDelay: '0.2s' } }, formatCurrency(property.price)),

                            createElement('h4', { className: 'text-xl font-semibold mb-2 mt-4' }, 'Detail Properti:'),
                            createElement('ul', { className: 'property-detail__features animate-fade-in-up', style: { animationDelay: '0.3s' } },
                                [
                                    { icon: 'fa-bed', text: `${property.beds} Kamar Tidur` },
                                    { icon: 'fa-bath', text: `${property.baths} Kamar Mandi` },
                                    { icon: 'fa-ruler-combined', text: `${property.area} m¬≤ Luas` },
                                    { icon: 'fa-home', text: `Tipe: ${property.type}` }
                                ].map(item => createElement('li', {}, createElement('i', { className: `fas ${item.icon}` }), item.text))
                            ),
                            createElement('h4', { className: 'text-xl font-semibold mb-2 mt-6' }, 'Fasilitas Unggulan:'),
                            createElement('ul', { className: 'list-disc list-inside pl-1 space-y-1 text-muted-light dark:text-muted-dark animate-fade-in-up', style: { animationDelay: '0.4s' } },
                                ...(property.amenities || ['Tidak ada data fasilitas']).slice(0, 5).map(item => createElement('li', {}, item)), // Batasi 5 fasilitas
                                (property.amenities && property.amenities.length > 5) ? createElement('li', {}, '...dan lainnya.') : null
                            ),
                            aiDescriptionElement,
                            createElement('div', { className: 'property-detail__agent-card mt-8 animate-fade-in-up', style: { animationDelay: '0.6s' } },
                                createElement('h4', { className: 'text-xl font-semibold mb-4 text-center' }, 'Hubungi Agen Kami'),
                                createElement('div', { className: 'flex items-center mb-4' },
                                    createElement('img', { src: agent.avatar, alt: `Foto agen ${agent.name}`, className: 'agent-card__avatar' }),
                                    createElement('div', {},
                                        createElement('h5', { className: 'text-lg font-semibold' }, agent.name),
                                        createElement('p', { className: 'text-sm text-primary' }, 'Agen Properti Profesional')
                                    )
                                ),
                                createElement('a', { href: `tel:${agent.phone.replace(/\D/g, '')}`, className: 'btn btn--primary w-full mb-2' }, createElement('i', { className: 'fas fa-phone-alt mr-2' }), `Telepon: ${agent.phone}`),
                                createElement('a', { href: `https://wa.me/${agent.phone.replace(/\D/g, '')}?text=${encodeURIComponent(`Halo ${agent.name}, saya tertarik dengan properti ${property.name} (ID: ${property.id}) di Green Valley.`)}`, target: '_blank', rel: 'noopener noreferrer', className: 'btn btn--secondary w-full flex items-center justify-center' }, createElement('i', { className: 'fab fa-whatsapp mr-2' }), 'Chat via WhatsApp')
                            )
                        )
                    )
                )
            );
            return pageContent;
        }


        async function AboutPage() {
            utils.updateDocumentTitle('Tentang Kami');
            const { createElement } = utils;
            const aiMissionElement = createElement('div', { className: 'prose dark:prose-invert max-w-none mt-4', style: { minHeight: '10em' } });
            geminiService.generateText("visi dan misi perusahaan properti Green Valley yang inspiratif dan profesional dalam 2-3 paragraf dengan heading H4 untuk Visi dan Misi")
                .then(text => aiMissionElement.innerHTML = text)
                .catch(() => aiMissionElement.innerHTML = "<p>Visi kami adalah menjadi mitra properti terdepan. Misi kami adalah menyediakan solusi properti komprehensif.</p>");

            const pageContent = createElement('main', { className: 'container py-12 animate-fade-in' },
                createElement('div', { className: 'section__header mb-12' },
                    createElement('h1', { className: 'section__title' }, 'Tentang Green Valley Properties'),
                    createElement('p', { className: 'section__subtitle' }, 'Mitra Anda dalam mewujudkan impian hunian.')
                ),
                createElement('div', { className: 'grid md:grid-cols-2 gap-12 items-center mb-12' },
                    createElement('div', { className: 'animate-fade-in-up' },
                        createElement('h2', { className: 'text-2xl font-semibold mb-4' }, 'Kisah Kami'),
                        createElement('p', { className: 'mb-4 text-muted-light dark:text-muted-dark' }, 'Didirikan dengan semangat menghubungkan orang dengan tempat tinggal ideal, Green Valley Properties telah tumbuh menjadi nama tepercaya. Kami percaya rumah adalah fondasi kebahagiaan.'),
                        createElement('p', { className: 'text-muted-light dark:text-muted-dark' }, 'Tim kami terdiri dari profesional berpengalaman dengan pengetahuan pasar mendalam dan komitmen terhadap layanan pelanggan.'),
                        aiMissionElement
                    ),
                    createElement('div', { className: 'animate-scale-in', style: { animationDelay: '0.2s' } },
                        createElement('img', { src: 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=70', alt: 'Tim Green Valley Properties sedang berdiskusi', className: 'rounded-lg shadow-xl w-full h-auto object-cover' })
                    )
                ),
                createElement('div', { className: 'section--highlight py-12 rounded-lg' },
                    createElement('h2', { className: 'text-2xl font-semibold text-center mb-8' }, 'Tim Profesional Kami'),
                    createElement('div', { className: 'grid sm:grid-cols-2 lg:grid-cols-4 gap-8 stagger-animation', ref: el => utils.applyStaggerAnimation(el, 100) },
                        [
                            { name: 'Dr. Amanda Sari', role: 'CEO & Founder', avatar: 'https://randomuser.me/api/portraits/women/1.jpg' },
                            { name: 'Bambang Wijaya', role: 'Head of Sales', avatar: 'https://randomuser.me/api/portraits/men/2.jpg' },
                            { name: 'Citra Kirana', role: 'Marketing Director', avatar: 'https://randomuser.me/api/portraits/women/3.jpg' },
                            { name: 'Dharma Putra', role: 'Lead Property Analyst', avatar: 'https://randomuser.me/api/portraits/men/4.jpg' }
                        ].map((member, idx) =>
                            createElement('div', { className: 'text-center animate-fade-in-up', style: { animationDelay: `${idx * 100}ms` } }, // Stagger manual di sini
                                createElement('img', { src: member.avatar, alt: `Foto ${member.name}`, className: 'w-32 h-32 rounded-full mx-auto mb-4 shadow-md border-4 border-primary-light' }),
                                createElement('h5', { className: 'text-lg font-semibold' }, member.name),
                                createElement('p', { className: 'text-sm text-primary' }, member.role)
                            )
                        )
                    )
                )
            );
            return pageContent;
        }


        async function ContactPage() {
            utils.updateDocumentTitle('Hubungi Kami');
            const { createElement } = utils;
            const handleSubmit = async (event) => {
                event.preventDefault();
                utils.setLoading(true);
                const formData = new FormData(event.target);
                // Simulasi: Kumpulkan data, tapi jangan kirim ke server sungguhan
                const data = Object.fromEntries(formData.entries());
                console.log("Data Formulir Kontak:", data);

                await new Promise(resolve => setTimeout(resolve, 1500)); // Simulasi pengiriman
                utils.setLoading(false);
                alert(`Terima kasih, ${data.name}! Pesan Anda telah diterima (simulasi). Kami akan segera menghubungi Anda melalui ${data.email}.`);
                event.target.reset();
            };

            const pageContent = createElement('main', { className: 'container py-12 animate-fade-in' },
                createElement('div', { className: 'section__header mb-12' },
                    createElement('h1', { className: 'section__title' }, 'Hubungi Tim Green Valley'),
                    createElement('p', { className: 'section__subtitle' }, 'Kami siap mendengar dari Anda. Jangan ragu untuk menghubungi kami.')
                ),
                createElement('div', { className: 'grid md:grid-cols-2 gap-12' },
                    createElement('div', { className: 'animate-fade-in-up' },
                        createElement('h2', { className: 'text-2xl font-semibold mb-6' }, 'Kirim Pesan Langsung'),
                        createElement('form', { className: 'space-y-6', onSubmit: handleSubmit },
                            ['Nama Lengkap Anda', 'Alamat Email Anda', 'Subjek Pesan'].map(label => {
                                const name = label.split(' ')[0].toLowerCase();
                                const type = name === 'email' ? 'email' : 'text';
                                const placeholder = label.includes('Nama') ? 'cth. Budi Doremi' : label.includes('Email') ? 'cth. budi@example.com' : 'cth. Pertanyaan Properti';
                                return createElement('div', {},
                                    createElement('label', { htmlFor: `contact-${name}`, className: 'block text-sm font-medium mb-1' }, label),
                                    createElement('input', { type: type, name: name, id: `contact-${name}`, required: true, className: 'w-full', placeholder: placeholder })
                                )
                            }),
                            createElement('div', {},
                                createElement('label', { htmlFor: 'contact-message', className: 'block text-sm font-medium mb-1' }, 'Pesan Anda'),
                                createElement('textarea', { name: 'message', id: 'contact-message', rows: '5', required: true, className: 'w-full', placeholder: 'Tuliskan pesan detail Anda di sini...' })
                            ),
                            createElement('button', { type: 'submit', className: 'btn btn--primary btn--lg' }, createElement('i', { className: 'fas fa-paper-plane mr-2' }), 'Kirim Pesan')
                        )
                    ),
                    createElement('div', { className: 'animate-fade-in-up', style: { animationDelay: '0.2s' } },
                        createElement('h2', { className: 'text-2xl font-semibold mb-6' }, 'Informasi Kontak Lainnya'),
                        createElement('div', { className: 'space-y-4 text-muted-light dark:text-muted-dark' },
                            [
                                { icon: 'fa-map-marker-alt', title: 'Alamat Kantor Pusat:', lines: ['Green Valley Tower, Lt. 25, Jl. Properti Sejahtera No. 1, Jakarta Pusat, Indonesia 10220'] },
                                { icon: 'fa-phone-alt', title: 'Telepon:', lines: [{ text: '(021) 555-0123', href: 'tel:+62215550123' }] },
                                { icon: 'fa-envelope', title: 'Email:', lines: [{ text: 'info@greenvalley.com', href: 'mailto:info@greenvalley.com' }] },
                                { icon: 'fa-clock', title: 'Jam Operasional:', lines: ['Senin - Jumat: 09:00 - 18:00 WIB', 'Sabtu: 10:00 - 15:00 WIB (By Appointment)'] }
                            ].map(item =>
                                createElement('div', { className: 'flex items-start gap-3' },
                                    createElement('i', { className: `fas ${item.icon} fa-fw text-xl text-primary mt-1`, 'aria-hidden': 'true' }),
                                    createElement('div', {},
                                        createElement('h5', { className: 'font-semibold text-dark dark:text-light' }, item.title),
                                        ...item.lines.map(line => typeof line === 'string' ? createElement('p', {}, line) : createElement('p', {}, createElement('a', { href: line.href, className: 'hover:underline' }, line.text)))
                                    )
                                )
                            )
                        ),
                        createElement('div', { className: 'mt-8 rounded-lg overflow-hidden shadow-lg aspect-video bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-gray-500 dark:text-gray-400', role: 'img', 'aria-label': 'Peta lokasi kantor Green Valley Properties' },
                            createElement('div', { className: 'text-center' },
                                createElement('i', { className: 'fas fa-map-marked-alt fa-3x mb-2', 'aria-hidden': 'true' }),
                                createElement('p', {}, 'Lokasi Peta Kantor Kami (Placeholder)')
                            )
                        )
                    )
                )
            );
            return pageContent;
        }


        async function TermsPage() {
            utils.updateDocumentTitle('Syarat & Ketentuan');
            const { createElement } = utils;
            const pageContent = createElement('main', { className: 'container py-12 animate-fade-in' },
                createElement('div', { className: 'section__header mb-8' },
                    createElement('h1', { className: 'section__title' }, 'Syarat dan Ketentuan Penggunaan'),
                    createElement('p', { className: 'section__subtitle' }, 'Harap baca dengan saksama sebelum menggunakan layanan kami.')
                ),
                createElement('div', { className: 'prose dark:prose-invert max-w-none' }, // `max-w-none` agar mengambil lebar kontainer
                    createElement('p', {}, 'Selamat datang di situs web Green Valley Properties ("Situs"). Dengan mengakses atau menggunakan Situs ini, Anda setuju untuk terikat oleh Syarat dan Ketentuan ini ("Syarat"). Jika Anda tidak setuju dengan semua Syarat ini, jangan gunakan Situs ini.'),
                    ['Penggunaan Situs', 'Konten Properti', 'Kekayaan Intelektual', 'Batasan Tanggung Jawab', 'Perubahan Syarat'].map((title, index) =>
                        createElement('div', { key: index },
                            createElement('h3', { className: 'mt-6 !text-xl' }, `${index + 1}. ${title}`), // Pakai !text-xl untuk override
                            createElement('p', {}, `Isi detail mengenai ${title.toLowerCase()} akan dijelaskan di sini. Green Valley Properties berhak mengubah syarat ini kapan saja. Informasi properti disediakan "sebagaimana adanya" dan kami tidak menjamin keakuratannya sepenuhnya. Anda bertanggung jawab atas penggunaan situs ini. Seluruh konten adalah milik ${CONFIG.appName} atau pemasoknya.`)
                        )
                    ),
                    createElement('p', { className: 'mt-8' }, `Syarat dan Ketentuan ini terakhir diperbarui pada: ${new Date().toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' })}.`)
                )
            );
            return pageContent;
        }


        async function NotFoundPage() {
            utils.updateDocumentTitle('404 Halaman Tidak Ditemukan');
            const { createElement } = utils;
            const pageContent = createElement('main', { className: 'container flex flex-col items-center justify-center text-center py-16 min-h-[70vh] animate-fade-in' },
                createElement('i', { className: 'fas fa-compass-slash fa-5x text-red-500 mb-6', 'aria-hidden': 'true' }),
                createElement('h1', { className: 'text-4xl md:text-6xl font-bold mb-4' }, '404 - Oops!'),
                createElement('h2', { className: 'text-2xl md:text-3xl text-muted-light dark:text-muted-dark mb-6' }, 'Halaman Tidak Ditemukan'),
                createElement('p', { className: 'text-lg mb-8 max-w-md' }, 'Maaf, halaman yang Anda cari sepertinya tersesat atau tidak pernah ada. Mungkin tautannya salah atau halaman telah dipindahkan.'),
                createElement('div', { className: 'flex flex-wrap gap-4 justify-center' }, // flex-wrap untuk mobile
                    createElement('button', { onClick: () => window.history.length > 2 ? window.history.back() : router.navigateTo('/'), className: 'btn btn--secondary btn--lg' }, createElement('i', { className: 'fas fa-arrow-left mr-2' }), 'Kembali'),
                    createElement('button', { onClick: () => router.navigateTo('/'), className: 'btn btn--primary btn--lg' }, createElement('i', { className: 'fas fa-home mr-2' }), 'Ke Beranda')
                )
            );
            return pageContent;
        }

        // --- STRUKTUR APLIKASI UTAMA ---
        function AppShell() {
            const { createElement } = utils;
            const { component: CurrentPage, params } = router.resolveRoute();
            const pageContainer = createElement('div', { id: 'page-content', className: 'flex-grow' });

            // Konten halaman dimuat secara async di sini
            utils.setLoading(true); // Tampilkan loading saat halaman mulai dimuat
            if (CurrentPage) {
                Promise.resolve(CurrentPage(params || {})) // Pastikan CurrentPage selalu promise
                    .then(pageElement => {
                        pageContainer.innerHTML = '';
                        if (pageElement instanceof Node) {
                            pageContainer.appendChild(pageElement);
                        } else {
                            console.error("Komponen halaman tidak mengembalikan elemen DOM yang valid.");
                            pageContainer.appendChild(NotFoundPage()); // Fallback jika ada masalah
                        }
                    })
                    .catch(error => {
                        console.error("Gagal merender halaman:", error);
                        pageContainer.innerHTML = '';
                        pageContainer.appendChild(NotFoundPage());
                    })
                    .finally(() => {
                        utils.setLoading(false); // Sembunyikan loading setelah halaman selesai (baik sukses maupun gagal)
                        utils.scrollToTop(); // Scroll ke atas setelah konten baru dimuat
                    });
            } else { // Seharusnya tidak pernah terjadi jika routing 404 benar
                console.error("Tidak ada komponen untuk rute saat ini:", appState.currentPath);
                pageContainer.appendChild(NotFoundPage());
                utils.setLoading(false);
            }

            return createElement('div', { className: 'app-wrapper min-h-screen flex flex-col' },
                NavbarComponent(),
                pageContainer,
                FooterComponent()
            );
        }

        // --- INISIALISASI DAN RENDER APLIKASI ---
        const rootElement = document.getElementById('app-root');

        const renderApp = () => {
            // utils.setLoading(true); // Dipindah ke dalam AppShell saat resolveRoute/load page
            rootElement.innerHTML = ''; // Hapus konten lama
            rootElement.appendChild(AppShell());

            // Pastikan dark mode class di body selalu sinkron
            document.body.classList.toggle('dark-mode', appState.isDarkMode);

            // Update state UI Navbar yang mungkin berubah (misal ikon dark mode, status aktif link)
            // Ini bisa dilakukan di dalam NavbarComponent atau di sini.
            // Karena NavbarComponent dipanggil ulang, ia akan menggunakan appState terbaru.
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const menuIcon = document.getElementById('mobile-menu-icon');
            if (mobileMenuButton && menuIcon) {
                mobileMenuButton.setAttribute('aria-expanded', appState.mobileMenuOpen.toString());
                menuIcon.className = `fas ${appState.mobileMenuOpen ? 'fa-times' : 'fa-bars'}`;
            }
            const mobileNavMenu = document.getElementById('mobile-nav-menu');
            if (mobileNavMenu) {
                mobileNavMenu.classList.toggle('open', appState.mobileMenuOpen);
                // Jika menu terbuka, pastikan itemnya ter-update (jika ada perubahan state)
                if (appState.mobileMenuOpen) {
                    // Logika untuk re-populate mobileNavMenu.items jika perlu (sudah dihandle di NavbarComponent)
                }
            }
            // utils.setLoading(false); // Dipindah ke dalam AppShell
        };

        // Daftarkan Rute-rute Aplikasi
        router.addRoute('/', HomePage, 'Beranda');
        router.addRoute('/search', SearchPage, 'Cari Properti');
        router.addRoute('/property/:id', PropertyDetailPage, 'Detail Properti');
        router.addRoute('/about', AboutPage, 'Tentang Kami');
        router.addRoute('/contact', ContactPage, 'Hubungi Kami');
        router.addRoute('/terms', TermsPage, 'Syarat & Ketentuan');
        router.addRoute('/404', NotFoundPage, 'Halaman Tidak Ditemukan');

        // Event Listener untuk Perubahan Hash (Navigasi SPA)
        window.addEventListener('hashchange', () => {
            // Simpan path sebelum merender untuk dibandingkan di Navbar
            // appState.currentPath sudah diupdate oleh resolveRoute() di dalam AppShell()
            if (appState.mobileMenuOpen) { // Selalu tutup menu mobile saat navigasi
                appState.mobileMenuOpen = false;
            }
            renderApp();
        });

        // Event listener untuk menutup menu mobile jika diklik di luar area menu
        document.addEventListener('click', (event) => {
            const mobileNav = document.getElementById('mobile-nav-menu');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            if (appState.mobileMenuOpen && mobileNav && mobileMenuButton) {
                // Cek apakah klik BUKAN pada tombol menu DAN BUKAN di dalam menu itu sendiri
                if (!mobileMenuButton.contains(event.target) && !mobileNav.contains(event.target)) {
                    appState.mobileMenuOpen = false;
                    renderApp(); // Re-render untuk update UI menu
                }
            }
        });

        // Inisialisasi Aplikasi Pertama Kali
        const initializeApp = () => {
            const initialLoader = document.querySelector('.initial-loader');
            if (initialLoader) {
                initialLoader.style.opacity = '0';
                initialLoader.style.transition = 'opacity 0.3s ease-out, visibility 0s 0.3s ease-out';
                initialLoader.style.visibility = 'hidden'; // Sembunyikan setelah transisi
                setTimeout(() => {
                    initialLoader.remove();
                    renderApp(); // Render aplikasi utama setelah loader hilang
                }, 300); // Waktu harus sama dengan transisi
            } else {
                renderApp(); // Jika tidak ada loader (misal hot reload)
            }
        };

        // Pastikan DOM siap sebelum inisialisasi
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }

    </script>
</body>

</html>