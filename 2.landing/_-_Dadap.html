<!DOCTYPE html>
<html lang="id" data-theme="light">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Green Valley - Platform sewa apartemen premium dengan virtual tour interaktif dan pembayaran aman. Temukan hunian mewah impian Anda.">
  <meta name="keywords"
    content="sewa apartemen, apartemen premium, virtual tour, green valley, properti mewah, hunian eksklusif">
  <meta name="author" content="Green Valley">
  <title>Green Valley - Sewa Apartemen Premium & Virtual Tour</title>

  <!-- Favicon (Contoh menggunakan emoji, idealnya ganti dengan file .ico atau .png) -->
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè°</text></svg>">

  <!-- Font Awesome Icons (CDN) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Google Fonts: Inter & Montserrat untuk tampilan yang lebih fancy -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Montserrat:wght@700;800;900&display=swap"
    rel="stylesheet">

  <style>
    /* === SISTEM DESAIN & VARIABEL GLOBAL === */
    :root {
      /* Palet Warna Utama (Light Mode) */
      --primary-hue: 150;
      /* Hijau menenangkan */
      --secondary-hue: 210;
      /* Biru profesional */

      --primary-color: hsl(var(--primary-hue), 55%, 45%);
      --primary-color-light: hsl(var(--primary-hue), 55%, 55%);
      --primary-color-dark: hsl(var(--primary-hue), 55%, 35%);
      --primary-color-text: hsl(0, 0%, 100%);

      --secondary-color: hsl(var(--secondary-hue), 70%, 50%);
      --secondary-color-light: hsl(var(--secondary-hue), 70%, 60%);
      --secondary-color-dark: hsl(var(--secondary-hue), 70%, 40%);

      --background-color: hsl(0, 0%, 98%);
      --surface-color: hsl(0, 0%, 100%);
      --on-surface-color: hsl(var(--secondary-hue), 15%, 20%);
      --on-surface-variant-color: hsl(var(--secondary-hue), 10%, 40%);
      --border-color: hsl(var(--secondary-hue), 15%, 88%);
      --muted-color: hsl(var(--secondary-hue), 10%, 60%);

      /* Tipografi */
      --font-family-base: 'Inter', sans-serif;
      --font-family-heading: 'Montserrat', sans-serif;
      --font-size-base: 16px;
      --line-height-base: 1.7;

      /* Spasi & Radius */
      --spacing-unit: 8px;
      --radius-sm: calc(var(--spacing-unit) * 0.5);
      /* 4px */
      --radius-md: var(--spacing-unit);
      /* 8px */
      --radius-lg: calc(var(--spacing-unit) * 2);
      /* 16px */
      --radius-pill: 999px;

      /* Transisi & Bayangan */
      --transition-duration: 0.3s;
      --transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      --transition-base: all var(--transition-duration) var(--transition-timing-function);

      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 30px -10px rgba(0, 0, 0, 0.15), 0 8px 16px -8px rgba(0, 0, 0, 0.1);
    }

    /* Dark Mode Variables */
    html[data-theme="dark"] {
      --primary-color: hsl(var(--primary-hue), 50%, 55%);
      --primary-color-light: hsl(var(--primary-hue), 50%, 65%);
      --primary-color-dark: hsl(var(--primary-hue), 50%, 45%);

      --background-color: hsl(var(--secondary-hue), 15%, 12%);
      --surface-color: hsl(var(--secondary-hue), 15%, 18%);
      --on-surface-color: hsl(0, 0%, 95%);
      --on-surface-variant-color: hsl(var(--secondary-hue), 10%, 70%);
      --border-color: hsl(var(--secondary-hue), 15%, 30%);
      --muted-color: hsl(var(--secondary-hue), 10%, 55%);

      --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.15);
      --shadow-md: 0 5px 15px rgba(0, 0, 0, 0.25);
      --shadow-lg: 0 10px 30px -10px rgba(0, 0, 0, 0.35), 0 8px 16px -8px rgba(0, 0, 0, 0.3);
    }

    /* === RESET & GAYA DASAR === */
    *,
    *::before,
    *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    html {
      scroll-behavior: smooth;
      /* Efek scroll halus */
      font-size: var(--font-size-base);
    }

    body {
      font-family: var(--font-family-base);
      background-color: var(--background-color);
      color: var(--on-surface-color);
      line-height: var(--line-height-base);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      transition: background-color var(--transition-duration), color var(--transition-duration);
    }

    main {
      flex-grow: 1;
      /* Agar footer selalu di bawah */
    }

    /* Menyembunyikan semua section SPA secara default, kecuali yang aktif */
    .spa-section {
      display: none;
      animation: fadeIn var(--transition-duration) var(--transition-timing-function);
    }

    .spa-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* === SISTEM GRID & CONTAINER === */
    .container {
      width: 90%;
      max-width: 1200px;
      /* Sedikit lebih sempit untuk tampilan elegan */
      margin-left: auto;
      margin-right: auto;
      padding-top: calc(var(--spacing-unit) * 6);
      /* 48px */
      padding-bottom: calc(var(--spacing-unit) * 6);
    }

    /* === KOMPONEN UI UMUM === */
    .button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-unit);
      padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 3);
      /* 12px 24px */
      border-radius: var(--radius-pill);
      /* Fancy pill shape */
      font-weight: 600;
      text-decoration: none;
      border: 2px solid transparent;
      cursor: pointer;
      transition: var(--transition-base), transform 0.15s ease-out;
      font-size: 0.95rem;
      white-space: nowrap;
    }

    .button--primary {
      background-color: var(--primary-color);
      color: var(--primary-color-text);
      border-color: var(--primary-color);
    }

    .button--primary:hover,
    .button--primary:focus-visible {
      background-color: var(--primary-color-light);
      border-color: var(--primary-color-light);
      transform: translateY(-2px) scale(1.02);
      box-shadow: var(--shadow-md);
    }

    .button--primary:active {
      transform: translateY(0px) scale(0.98);
      background-color: var(--primary-color-dark);
    }

    .button--secondary {
      background-color: var(--surface-color);
      color: var(--primary-color);
      border-color: var(--primary-color);
    }

    .button--secondary:hover,
    .button--secondary:focus-visible {
      background-color: hsl(var(--primary-hue), 55%, 95%);
      color: var(--primary-color-dark);
      border-color: var(--primary-color-dark);
      transform: translateY(-2px) scale(1.02);
      box-shadow: var(--shadow-sm);
    }

    html[data-theme="dark"] .button--secondary:hover,
    html[data-theme="dark"] .button--secondary:focus-visible {
      background-color: hsl(var(--primary-hue), 55%, 25%);
    }


    .button--icon {
      padding: var(--spacing-unit);
      border-radius: 50%;
      font-size: 1.2rem;
    }

    .button--icon i {
      margin-right: 0;
    }


    .form-group {
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .form-label {
      display: block;
      font-weight: 600;
      margin-bottom: var(--spacing-unit);
      color: var(--on-surface-variant-color);
      font-size: 0.9rem;
    }

    .form-input,
    .form-textarea,
    .form-select {
      width: 100%;
      padding: calc(var(--spacing-unit) * 1.5) calc(var(--spacing-unit) * 2);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      font-family: var(--font-family-base);
      font-size: 1rem;
      background-color: var(--surface-color);
      color: var(--on-surface-color);
      transition: var(--transition-base);
    }

    .form-input:focus,
    .form-textarea:focus,
    .form-select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px hsla(var(--primary-hue), 55%, 45%, 0.3);
    }

    .form-textarea {
      resize: vertical;
      min-height: 120px;
    }

    /* === HEADER & NAVIGASI === */
    .header {
      background-color: hsla(0, 0%, 100%, 0.8);
      /* Sedikit transparan untuk efek modern */
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      /* Untuk Safari */
      box-shadow: var(--shadow-sm);
      position: sticky;
      top: 0;
      z-index: 1000;
      width: 100%;
      transition: background-color var(--transition-duration), box-shadow var(--transition-duration);
    }

    html[data-theme="dark"] .header {
      background-color: hsla(var(--secondary-hue), 15%, 12%, 0.8);
    }

    .nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: calc(var(--spacing-unit) * 1.5) 0;
      /* 12px */
      height: calc(var(--spacing-unit) * 9);
      /* 72px */
    }

    .nav__logo {
      font-family: var(--font-family-heading);
      font-weight: 800;
      font-size: 1.8rem;
      color: var(--primary-color);
      text-decoration: none;
      transition: var(--transition-base);
    }

    .nav__logo:hover {
      opacity: 0.8;
    }

    .nav__logo i {
      margin-right: calc(var(--spacing-unit) * 0.5);
    }

    .nav__links {
      display: flex;
      align-items: center;
      gap: calc(var(--spacing-unit) * 3);
      /* 24px */
    }

    .nav__link {
      text-decoration: none;
      color: var(--on-surface-variant-color);
      font-weight: 600;
      font-size: 0.95rem;
      padding: calc(var(--spacing-unit) * 0.5) var(--spacing-unit);
      border-radius: var(--radius-sm);
      position: relative;
      transition: var(--transition-base);
    }

    .nav__link::after {
      /* Efek garis bawah fancy saat hover */
      content: '';
      position: absolute;
      bottom: -2px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 2px;
      background-color: var(--primary-color);
      transition: width var(--transition-duration) var(--transition-timing-function);
    }

    .nav__link:hover,
    .nav__link:focus-visible,
    .nav__link.active {
      color: var(--primary-color);
      outline: none;
    }

    .nav__link:hover::after,
    .nav__link:focus-visible::after,
    .nav__link.active::after {
      width: 100%;
    }

    .nav__actions {
      display: flex;
      align-items: center;
      gap: var(--spacing-unit);
    }

    .theme-toggle {
      /* Menggunakan class .button .button--secondary */
      font-size: 1rem;
      /* Ukuran ikon disesuaikan */
      padding: calc(var(--spacing-unit) * 1.25);
      /* 10px */
    }

    .theme-toggle i {
      transition: transform var(--transition-duration) ease-in-out;
    }

    html[data-theme="dark"] .theme-toggle .fa-moon {
      display: none;
    }

    html[data-theme="light"] .theme-toggle .fa-sun {
      display: none;
    }

    .mobile-menu-toggle {
      display: none;
      /* Hanya muncul di mobile */
      background: none;
      border: none;
      color: var(--on-surface-color);
      font-size: 1.5rem;
      cursor: pointer;
      padding: var(--spacing-unit);
    }

    /* === SECTION JUDUL HALAMAN (FANCY) === */
    .section-title {
      text-align: center;
      margin-bottom: calc(var(--spacing-unit) * 5);
      /* 40px */
    }

    .section-title__heading {
      font-family: var(--font-family-heading);
      font-size: 2.5rem;
      font-weight: 800;
      color: var(--on-surface-color);
      margin-bottom: var(--spacing-unit);
      position: relative;
      display: inline-block;
    }

    .section-title__heading::after {
      /* Garis bawah dekoratif */
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 4px;
      background-color: var(--primary-color);
      border-radius: var(--radius-pill);
    }

    .section-title__subheading {
      font-size: 1.1rem;
      color: var(--on-surface-variant-color);
      max-width: 600px;
      margin: 0 auto;
      margin-top: calc(var(--spacing-unit) * 2);
    }

    /* === HERO SECTION === */
    .hero {
      background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80') no-repeat center center/cover;
      color: var(--primary-color-text);
      padding: calc(var(--spacing-unit) * 12) 0;
      /* 96px */
      text-align: center;
      min-height: 80vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hero .container {
      padding-top: 0;
      padding-bottom: 0;
    }

    .hero__title {
      font-family: var(--font-family-heading);
      font-size: 3.5rem;
      font-weight: 900;
      margin-bottom: calc(var(--spacing-unit) * 2);
      /* 16px */
      line-height: 1.2;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }

    .hero__subtitle {
      font-size: 1.25rem;
      max-width: 700px;
      margin: 0 auto calc(var(--spacing-unit) * 4);
      /* 32px */
      line-height: 1.8;
      opacity: 0.9;
    }

    .hero .button {
      padding: calc(var(--spacing-unit) * 2) calc(var(--spacing-unit) * 4);
      /* 16px 32px */
      font-size: 1.1rem;
    }

    /* === PROPERTY SECTION === */
    .property-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: calc(var(--spacing-unit) * 4);
      /* 32px */
    }

    .property-card {
      background-color: var(--surface-color);
      border-radius: var(--radius-lg);
      /* Lebih bulat */
      overflow: hidden;
      box-shadow: var(--shadow-md);
      transition: var(--transition-base), transform 0.2s ease-out;
      display: flex;
      flex-direction: column;
    }

    .property-card:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: var(--shadow-lg);
    }

    .property-card__image-wrapper {
      position: relative;
      height: 220px;
      overflow: hidden;
    }

    .property-card__image {
      width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      transition: transform 0.5s var(--transition-timing-function);
    }

    .property-card:hover .property-card__image {
      transform: scale(1.1);
      /* Efek zoom halus pada gambar */
    }

    .property-card__image-overlay {
      /* Untuk info tambahan di atas gambar */
      position: absolute;
      top: var(--spacing-unit);
      left: var(--spacing-unit);
      background-color: hsla(var(--primary-hue), 55%, 45%, 0.8);
      color: var(--primary-color-text);
      padding: calc(var(--spacing-unit) * 0.5) var(--spacing-unit);
      border-radius: var(--radius-sm);
      font-size: 0.8rem;
      font-weight: 600;
    }

    .property-card__details {
      padding: calc(var(--spacing-unit) * 2.5);
      /* 20px */
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      /* Agar konten memenuhi kartu */
    }

    .property-card__title {
      font-family: var(--font-family-heading);
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: calc(var(--spacing-unit) * 0.5);
      color: var(--on-surface-color);
    }

    .property-card__price {
      font-weight: 700;
      font-size: 1.3rem;
      color: var(--primary-color);
      margin-bottom: var(--spacing-unit);
    }

    .property-card__location {
      display: flex;
      align-items: center;
      gap: calc(var(--spacing-unit) * 0.75);
      margin-bottom: var(--spacing-unit);
      color: var(--muted-color);
      font-size: 0.9rem;
    }

    .property-card__description {
      font-size: 0.95rem;
      color: var(--on-surface-variant-color);
      margin-bottom: calc(var(--spacing-unit) * 1.5);
      flex-grow: 1;
      /* Dorong fitur ke bawah jika deskripsi pendek */
    }

    .property-card__features {
      display: flex;
      flex-wrap: wrap;
      gap: calc(var(--spacing-unit) * 1.5);
      margin-bottom: calc(var(--spacing-unit) * 2);
      color: var(--muted-color);
      font-size: 0.85rem;
    }

    .property-card__features span {
      display: inline-flex;
      align-items: center;
      gap: calc(var(--spacing-unit) * 0.5);
    }

    .property-card__actions {
      margin-top: auto;
      /* Dorong tombol ke bawah */
    }

    /* === VIRTUAL TOUR SECTION === */
    .virtual-tour-showcase {
      background-color: var(--surface-color);
      border-radius: var(--radius-lg);
      padding: calc(var(--spacing-unit) * 3);
      box-shadow: var(--shadow-md);
      text-align: center;
    }

    .virtual-tour__player {
      position: relative;
      border-radius: var(--radius-md);
      overflow: hidden;
      background-color: #222;
      /* Latar belakang jika gambar tidak ada */
      aspect-ratio: 16 / 9;
      /* Menjaga rasio aspek video */
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .virtual-tour__image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* Pastikan gambar mengisi area tanpa distorsi */
      display: block;
      transition: opacity var(--transition-duration);
    }

    .virtual-tour__image.loading {
      opacity: 0.5;
      /* Efek loading sederhana */
    }

    .virtual-tour__controls {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 1;
      transition: var(--transition-base);
    }

    .virtual-tour__player:hover .virtual-tour__controls--play {
      transform: translate(-50%, -50%) scale(1.1);
    }

    .virtual-tour__status {
      font-style: italic;
      color: var(--muted-color);
      margin-top: var(--spacing-unit);
    }

    /* === PAYMENT SECTION === */
    .payment-methods {
      display: flex;
      flex-wrap: wrap;
      gap: calc(var(--spacing-unit) * 2);
      margin-bottom: calc(var(--spacing-unit) * 3);
      justify-content: center;
    }

    .payment-card {
      padding: calc(var(--spacing-unit) * 2.5);
      /* 20px */
      border: 2px solid var(--border-color);
      background-color: var(--surface-color);
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: var(--transition-base), transform 0.2s ease-out;
      text-align: center;
      min-width: 180px;
      flex: 1;
      max-width: 250px;
      /* Batasi lebar kartu pembayaran */
    }

    .payment-card:hover,
    .payment-card:focus-visible {
      border-color: var(--primary-color);
      transform: translateY(-5px);
      box-shadow: var(--shadow-md);
      outline: none;
    }

    .payment-card.active {
      border-color: var(--primary-color);
      background-color: hsl(var(--primary-hue), 55%, 95%);
      box-shadow: var(--shadow-md);
    }

    html[data-theme="dark"] .payment-card.active {
      background-color: hsl(var(--primary-hue), 55%, 25%);
    }

    .payment-card i {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: var(--spacing-unit);
      display: block;
    }

    .payment-card h3 {
      font-family: var(--font-family-base);
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--on-surface-color);
    }

    .payment-details {
      background-color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 3);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      margin-top: calc(var(--spacing-unit) * 2);
      animation: fadeIn 0.5s;
      /* Animasi saat muncul */
    }

    .payment-details__grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: calc(var(--spacing-unit) * 2);
    }


    /* === REVIEW SECTION === */
    .review-layout {
      display: grid;
      grid-template-columns: 1fr;
      gap: calc(var(--spacing-unit) * 5);
    }

    @media (min-width: 992px) {

      /* Layout 2 kolom di desktop */
      .review-layout {
        grid-template-columns: 1fr 1.5fr;
        /* Form lebih kecil, list lebih besar */
      }
    }

    .review-form {
      background-color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 3);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
    }

    .review-form h3 {
      font-family: var(--font-family-heading);
      font-size: 1.5rem;
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .rating-stars {
      display: flex;
      gap: calc(var(--spacing-unit) * 0.5);
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .rating-stars__star {
      font-size: 2rem;
      /* Bintang lebih besar */
      color: var(--muted-color);
      cursor: pointer;
      transition: color 0.2s, transform 0.2s;
    }

    .rating-stars__star:hover {
      transform: scale(1.2);
    }

    .rating-stars__star.selected,
    .rating-stars__star.hovered {
      color: #FFD700;
      /* Warna emas klasik untuk bintang */
    }

    .reviews-list {
      max-height: 500px;
      /* Batasi tinggi agar bisa scroll */
      overflow-y: auto;
      padding-right: var(--spacing-unit);
      /* Untuk scrollbar */
    }

    .review-card {
      background-color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 2.5);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      margin-bottom: calc(var(--spacing-unit) * 2);
      box-shadow: var(--shadow-sm);
      transition: var(--transition-base);
    }

    .review-card:hover {
      border-color: var(--primary-color);
      box-shadow: var(--shadow-md);
    }

    .review-card__header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-unit);
    }

    .review-card__author {
      font-weight: 600;
      color: var(--on-surface-color);
    }

    .review-card__rating {
      font-size: 1rem;
      color: #FFD700;
    }

    .review-card__text {
      color: var(--on-surface-variant-color);
      margin-bottom: var(--spacing-unit);
      line-height: 1.6;
    }

    .review-card__date {
      font-size: 0.8rem;
      color: var(--muted-color);
      text-align: right;
    }

    /* === ABOUT & CONTACT SECTION === */
    .about-content,
    .contact-form-container {
      background-color: var(--surface-color);
      padding: calc(var(--spacing-unit) * 4);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-md);
      max-width: 800px;
      margin: 0 auto;
    }

    .about-content p {
      margin-bottom: calc(var(--spacing-unit) * 2);
      font-size: 1.05rem;
      line-height: 1.8;
    }

    .about-content p:last-child {
      margin-bottom: 0;
    }

    .contact-form .button {
      width: 100%;
    }

    @media (min-width: 576px) {
      .contact-form .button {
        width: auto;
      }
    }


    /* === FOOTER === */
    .footer {
      background-color: hsl(var(--secondary-hue), 15%, 15%);
      /* Warna gelap konsisten */
      color: hsl(var(--secondary-hue), 10%, 75%);
      padding: calc(var(--spacing-unit) * 6) 0 calc(var(--spacing-unit) * 3);
      font-size: 0.9rem;
    }

    html[data-theme="dark"] .footer {
      background-color: hsl(var(--secondary-hue), 15%, 10%);
    }

    .footer .container {
      padding-top: 0;
      padding-bottom: 0;
    }

    .footer__grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: calc(var(--spacing-unit) * 4);
      margin-bottom: calc(var(--spacing-unit) * 4);
    }

    .footer__column h3 {
      font-family: var(--font-family-heading);
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--primary-color-text);
      margin-bottom: calc(var(--spacing-unit) * 2);
    }

    .footer__column ul {
      list-style: none;
    }

    .footer__column li {
      margin-bottom: var(--spacing-unit);
    }

    .footer__link {
      text-decoration: none;
      color: hsl(var(--secondary-hue), 10%, 75%);
      transition: var(--transition-base);
    }

    .footer__link:hover,
    .footer__link:focus-visible {
      color: var(--primary-color);
      outline: none;
    }

    .footer__column i {
      margin-right: var(--spacing-unit);
      color: var(--primary-color);
      width: 20px;
      /* Untuk alignment */
      text-align: center;
    }

    .social-links {
      display: flex;
      gap: calc(var(--spacing-unit) * 1.5);
    }

    .social-links .footer__link {
      font-size: 1.3rem;
      /* Icon sosial lebih besar */
    }

    .footer__copyright {
      text-align: center;
      padding-top: calc(var(--spacing-unit) * 3);
      border-top: 1px solid hsl(var(--secondary-hue), 15%, 25%);
      color: hsl(var(--secondary-hue), 10%, 60%);
    }

    html[data-theme="dark"] .footer__copyright {
      border-top-color: hsl(var(--secondary-hue), 15%, 20%);
    }

    /* === CHAT WIDGET === */
    .chat-widget {
      position: fixed;
      bottom: calc(var(--spacing-unit) * 2);
      right: calc(var(--spacing-unit) * 2);
      z-index: 1001;
      width: 340px;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      /* Agar window muncul di atas tombol */
    }

    .chat-toggle-button {
      /* Menggunakan class .button .button--primary .button--icon */
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 1.5rem;
      box-shadow: var(--shadow-lg);
      display: flex;
      /* Untuk ikon */
      align-items: center;
      justify-content: center;
    }

    .chat-toggle-button .fa-times {
      display: none;
    }

    /* Sembunyikan ikon close awal */
    .chat-widget.open .chat-toggle-button .fa-comments {
      display: none;
    }

    .chat-widget.open .chat-toggle-button .fa-times {
      display: inline-block;
    }

    .chat-window {
      background-color: var(--surface-color);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      width: 100%;
      max-height: 450px;
      /* Batasi tinggi window chat */
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transform: translateY(20px) scale(0.95);
      opacity: 0;
      visibility: hidden;
      transition: transform var(--transition-duration) var(--transition-timing-function),
        opacity var(--transition-duration) var(--transition-timing-function),
        visibility 0s var(--transition-duration);
      /* Tunda visibility */
      margin-bottom: var(--spacing-unit);
      /* Jarak dari tombol toggle */
    }

    .chat-widget.open .chat-window {
      transform: translateY(0) scale(1);
      opacity: 1;
      visibility: visible;
      transition-delay: 0s;
    }

    .chat-header {
      background-color: var(--primary-color);
      color: var(--primary-color-text);
      padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
      font-weight: 600;
      border-top-left-radius: var(--radius-lg);
      border-top-right-radius: var(--radius-lg);
    }

    .chat-messages {
      flex-grow: 1;
      padding: calc(var(--spacing-unit) * 2);
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    .chat-msg {
      margin-bottom: calc(var(--spacing-unit) * 1.5);
      display: flex;
      max-width: 85%;
      /* Pesan tidak terlalu lebar */
    }

    .chat-msg p {
      padding: var(--spacing-unit) calc(var(--spacing-unit) * 1.5);
      border-radius: var(--radius-md);
      line-height: 1.5;
      word-break: break-word;
    }

    .chat-msg__time {
      font-size: 0.75rem;
      color: var(--muted-color);
      margin-top: calc(var(--spacing-unit) * 0.5);
    }

    .chat-msg--user {
      margin-left: auto;
      /* Dorong ke kanan */
      flex-direction: column;
      align-items: flex-end;
    }

    .chat-msg--user p {
      background-color: var(--primary-color);
      color: var(--primary-color-text);
      border-bottom-right-radius: var(--radius-sm);
      /* Efek chat bubble */
    }

    .chat-msg--system {
      margin-right: auto;
      /* Dorong ke kiri */
      flex-direction: column;
      align-items: flex-start;
    }

    .chat-msg--system p {
      background-color: var(--border-color);
      color: var(--on-surface-color);
      border-bottom-left-radius: var(--radius-sm);
      /* Efek chat bubble */
    }

    html[data-theme="dark"] .chat-msg--system p {
      background-color: hsl(var(--secondary-hue), 15%, 25%);
    }

    .chat-input-area {
      display: flex;
      padding: var(--spacing-unit);
      border-top: 1px solid var(--border-color);
    }

    .chat-input {
      /* Menggunakan .form-input */
      flex-grow: 1;
      border-radius: var(--radius-pill);
      padding-right: calc(var(--spacing-unit) * 5);
      /* Ruang untuk tombol send */
    }

    .chat-send-button {
      /* Menggunakan .button .button--primary .button--icon */
      position: absolute;
      right: calc(var(--spacing-unit) * 1.5);
      top: 50%;
      transform: translateY(-50%);
      padding: calc(var(--spacing-unit) * 0.75);
      /* Tombol send lebih kecil */
      font-size: 1rem;
    }

    .chat-input-wrapper {
      position: relative;
      flex-grow: 1;
    }

    /* === UTILITIES TAMBAHAN === */
    .text-primary {
      color: var(--primary-color) !important;
    }

    .text-center {
      text-align: center;
    }

    .sr-only {
      /* Screen reader only */
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    .loading-spinner {
      border: 4px solid hsla(0, 0%, 100%, .3);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    /* === RESPONSIVE DESIGN === */
    @media (max-width: 991px) {

      /* Tablet dan di bawahnya */
      .nav__links {
        display: none;
        /* Sembunyikan link utama */
        position: absolute;
        top: calc(var(--spacing-unit) * 9);
        /* Di bawah header */
        left: 0;
        right: 0;
        background-color: var(--surface-color);
        box-shadow: var(--shadow-md);
        flex-direction: column;
        align-items: stretch;
        padding: var(--spacing-unit);
        gap: 0;
        border-bottom-left-radius: var(--radius-md);
        border-bottom-right-radius: var(--radius-md);
      }

      .nav__links.open {
        display: flex;
        /* Tampilkan saat menu mobile terbuka */
        animation: slideDown 0.3s var(--transition-timing-function);
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }

        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .nav__link {
        padding: var(--spacing-unit) calc(var(--spacing-unit) * 2);
        border-radius: var(--radius-sm);
        text-align: center;
      }

      .nav__link:hover,
      .nav__link.active {
        background-color: hsl(var(--primary-hue), 55%, 95%);
      }

      html[data-theme="dark"] .nav__link:hover,
      html[data-theme="dark"] .nav__link.active {
        background-color: hsl(var(--primary-hue), 55%, 25%);
      }

      .nav__link::after {
        display: none;
      }

      /* Hilangkan garis bawah di mobile */

      .mobile-menu-toggle {
        display: block;
        /* Tampilkan tombol hamburger */
      }

      .hero__title {
        font-size: 2.8rem;
      }

      .hero__subtitle {
        font-size: 1.1rem;
      }

      .section-title__heading {
        font-size: 2rem;
      }
    }

    @media (max-width: 768px) {

      /* Mobile besar */
      .container {
        width: 95%;
      }

      .hero__title {
        font-size: 2.2rem;
      }

      .property-grid {
        grid-template-columns: 1fr;
      }

      /* Satu kolom di mobile */
      .payment-methods {
        flex-direction: column;
      }

      .payment-card {
        min-width: 100%;
        max-width: 100%;
      }

      .footer__grid {
        grid-template-columns: 1fr;
      }

      /* Satu kolom di mobile kecil */
      .footer__column {
        text-align: center;
      }

      .social-links {
        justify-content: center;
      }
    }

    @media (max-width: 480px) {

      /* Mobile kecil */
      .hero__title {
        font-size: 2rem;
      }

      .chat-widget {
        width: calc(100% - (var(--spacing-unit) * 4));
        /* Widget chat lebih lebar */
        right: var(--spacing-unit);
        left: var(--spacing-unit);
        bottom: var(--spacing-unit);
        align-items: center;
        /* Pusatkan tombol toggle */
      }

      .chat-window {
        width: 100%;
      }
    }
  </style>
</head>

<body>
  <!-- Header Aplikasi -->
  <header class="header" id="appHeader">
    <div class="container">
      <nav class="nav">
        <a href="#beranda" class="nav__logo spa-link">
          <i class="fas fa-home"></i> GreenValley
        </a>
        <div class="nav__links" id="mainNavLinks">
          <a href="#beranda" class="nav__link spa-link active" data-section="beranda">Beranda</a>
          <a href="#properti" class="nav__link spa-link" data-section="properti">Properti</a>
          <a href="#virtual-tour" class="nav__link spa-link" data-section="virtual-tour">Virtual Tour</a>
          <a href="#tentang" class="nav__link spa-link" data-section="tentang">Tentang Kami</a>
          <a href="#kontak" class="nav__link spa-link" data-section="kontak">Kontak</a>
        </div>
        <div class="nav__actions">
          <button class="theme-toggle button button--secondary button--icon" id="themeToggleBtn"
            aria-label="Toggle tema gelap/terang">
            <i class="fas fa-moon"></i>
            <i class="fas fa-sun"></i>
          </button>
          <button class="mobile-menu-toggle" id="mobileMenuToggleBtn" aria-label="Buka menu navigasi"
            aria-expanded="false" aria-controls="mainNavLinks">
            <i class="fas fa-bars"></i>
          </button>
        </div>
      </nav>
    </div>
  </header>

  <!-- Konten Utama Aplikasi (SPA) -->
  <main id="appMain">
    <!-- Section: Beranda -->
    <section class="hero spa-section" id="beranda" data-title="Beranda">
      <div class="container">
        <h1 class="hero__title">Temukan Apartemen Premium Impian Anda di Green Valley</h1>
        <p class="hero__subtitle">Jelajahi hunian eksklusif dengan fitur virtual tour interaktif dan proses sewa yang
          mudah serta aman. Kenyamanan Anda adalah prioritas kami.</p>
        <a href="#properti" class="button button--primary spa-link" data-section="properti">
          <i class="fas fa-search"></i>
          Lihat Properti Unggulan
        </a>
      </div>
    </section>

    <!-- Section: Properti Unggulan -->
    <section class="spa-section" id="properti" data-title="Properti Unggulan">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Properti Unggulan Kami</h2>
          <p class="section-title__subheading">Pilihan apartemen premium terbaik yang dirancang untuk kenyamanan dan
            gaya hidup modern Anda.</p>
        </div>
        <div class="property-grid" id="propertyGrid">
          <!-- Kartu properti akan di-generate oleh JavaScript -->
          <div class="loading-spinner" id="propertyLoader"></div>
        </div>
      </div>
    </section>

    <!-- Section: Virtual Tour -->
    <section class="spa-section" id="virtual-tour" data-title="Virtual Tour Interaktif">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Virtual Tour Interaktif</h2>
          <p class="section-title__subheading">Rasakan pengalaman menjelajahi properti secara mendalam dari kenyamanan
            rumah Anda.</p>
        </div>
        <div class="virtual-tour-showcase">
          <div class="virtual-tour__player" id="virtualTourPlayer">
            <img
              src="https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1920&q=80"
              alt="Interior apartemen mewah untuk virtual tour" class="virtual-tour__image" id="virtualTourImage">
            <div class="virtual-tour__controls virtual-tour__controls--play" id="virtualTourPlayButtonContainer">
              <button class="button button--primary button--icon" aria-label="Mulai Virtual Tour"
                id="playVirtualTourBtn">
                <i class="fas fa-play-circle fa-3x"></i>
              </button>
            </div>
            <div class="virtual-tour__controls" id="virtualTourLoadingIndicator" style="display: none;">
              <div class="loading-spinner"></div>
            </div>
          </div>
          <p class="virtual-tour__status" id="virtualTourStatus">Pilih properti dan klik tombol play untuk memulai tur
            virtual.</p>
        </div>
      </div>
    </section>

    <!-- Section: Pembayaran (Contoh, bisa diintegrasikan lebih lanjut) -->
    <section class="spa-section" id="pembayaran" data-title="Metode Pembayaran">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Sistem Pembayaran Aman</h2>
          <p class="section-title__subheading">Pilih metode pembayaran yang paling nyaman dan aman untuk Anda.</p>
        </div>
        <div class="payment-methods">
          <button class="payment-card active" aria-label="Pilih Kartu Kredit" data-payment-method="credit-card">
            <i class="fas fa-credit-card"></i>
            <h3>Kartu Kredit/Debit</h3>
          </button>
          <button class="payment-card" aria-label="Pilih Transfer Bank" data-payment-method="bank-transfer">
            <i class="fas fa-university"></i>
            <h3>Transfer Bank</h3>
          </button>
          <button class="payment-card" aria-label="Pilih E-Wallet" data-payment-method="ewallet">
            <i class="fas fa-wallet"></i>
            <h3>Dompet Digital</h3>
          </button>
        </div>
        <div id="paymentDetailsContainer" class="payment-details">
          <!-- Detail form pembayaran akan di-render di sini oleh JavaScript -->
        </div>
      </div>
    </section>

    <!-- Section: Ulasan Pengguna -->
    <section class="spa-section" id="ulasan" data-title="Ulasan Pengguna">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Apa Kata Mereka?</h2>
          <p class="section-title__subheading">Simak pengalaman dan ulasan dari para penyewa yang puas dengan layanan
            Green Valley.</p>
        </div>
        <div class="review-layout">
          <form class="review-form" id="reviewForm" aria-labelledby="reviewFormHeading">
            <h3 id="reviewFormHeading">Bagikan Pengalaman Anda</h3>
            <div class="form-group">
              <label for="reviewerName" class="form-label">Nama Anda</label>
              <input type="text" id="reviewerName" class="form-input" placeholder="Nama lengkap Anda" required>
            </div>
            <div class="form-group">
              <label class="form-label">Rating Anda</label>
              <div class="rating-stars" id="ratingStars" role="radiogroup"
                aria-label="Beri rating dari 1 sampai 5 bintang">
                <!-- Bintang akan di-generate JavaScript -->
              </div>
              <input type="hidden" id="reviewRating" name="reviewRating" value="0" required>
            </div>
            <div class="form-group">
              <label for="reviewText" class="form-label">Ulasan Anda</label>
              <textarea id="reviewText" class="form-textarea" placeholder="Tulis ulasan Anda di sini..." rows="5"
                required></textarea>
            </div>
            <button type="submit" class="button button--primary">
              <i class="fas fa-paper-plane"></i> Kirim Ulasan
            </button>
          </form>
          <div class="reviews-list-container">
            <div id="reviewsList" class="reviews-list" aria-live="polite">
              <!-- Ulasan akan di-render di sini -->
              <div class="loading-spinner" id="reviewLoader"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section: Tentang Kami -->
    <section class="spa-section" id="tentang" data-title="Tentang Green Valley">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Tentang Green Valley</h2>
          <p class="section-title__subheading">Mengenal lebih dekat visi dan misi kami dalam menyediakan hunian premium
            terbaik.</p>
        </div>
        <div class="about-content">
          <p><strong>Green Valley</strong> adalah platform properti inovatif yang berdedikasi untuk merevolusi cara Anda
            menemukan dan menyewa apartemen premium. Kami percaya bahwa mencari hunian impian seharusnya menjadi
            pengalaman yang menyenangkan, transparan, dan efisien.</p>
          <p>Dengan teknologi virtual tour termutakhir, kami membawa properti langsung ke layar Anda, memungkinkan
            eksplorasi mendalam tanpa harus meninggalkan kenyamanan rumah. Sistem pembayaran kami dirancang dengan
            standar keamanan tertinggi, memberikan ketenangan pikiran dalam setiap transaksi.</p>
          <p>Tim kami terdiri dari para profesional berpengalaman di bidang properti dan teknologi, yang berkomitmen
            untuk memberikan layanan pelanggan terbaik dan memastikan setiap aspek pengalaman Anda bersama Green Valley
            adalah luar biasa. Bergabunglah dengan komunitas Green Valley dan temukan standar baru dalam kemewahan hidup
            urban.</p>
        </div>
      </div>
    </section>

    <!-- Section: Kontak -->
    <section class="spa-section" id="kontak" data-title="Hubungi Kami">
      <div class="container">
        <div class="section-title">
          <h2 class="section-title__heading">Hubungi Tim Kami</h2>
          <p class="section-title__subheading">Punya pertanyaan atau butuh bantuan? Jangan ragu untuk menghubungi kami.
            Kami siap melayani Anda.</p>
        </div>
        <div class="contact-form-container">
          <form class="contact-form" id="contactForm">
            <div class="form-group">
              <label for="contactName" class="form-label">Nama Lengkap</label>
              <input type="text" id="contactName" class="form-input" placeholder="Masukkan nama Anda" required>
            </div>
            <div class="form-group">
              <label for="contactEmail" class="form-label">Alamat Email</label>
              <input type="email" id="contactEmail" class="form-input" placeholder="cth: email@anda.com" required>
            </div>
            <div class="form-group">
              <label for="contactSubject" class="form-label">Subjek Pesan</label>
              <input type="text" id="contactSubject" class="form-input" placeholder="Subjek pesan Anda" required>
            </div>
            <div class="form-group">
              <label for="contactMessage" class="form-label">Pesan Anda</label>
              <textarea id="contactMessage" class="form-textarea" rows="6"
                placeholder="Tuliskan pesan atau pertanyaan Anda di sini..." required></textarea>
            </div>
            <button type="submit" class="button button--primary">
              <i class="fas fa-paper-plane"></i> Kirim Pesan
            </button>
          </form>
          <div id="contactFormStatus" role="alert" aria-live="assertive" style="margin-top: 1rem;"></div>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer Aplikasi -->
  <footer class="footer">
    <div class="container">
      <div class="footer__grid">
        <div class="footer__column">
          <h3>Green Valley</h3>
          <p>Platform sewa apartemen premium dengan virtual tour interaktif dan sistem pembayaran yang aman dan
            terpercaya untuk kenyamanan hidup urban Anda.</p>
        </div>
        <div class="footer__column">
          <h3>Navigasi Cepat</h3>
          <ul>
            <li><a href="#beranda" class="footer__link spa-link" data-section="beranda"><i
                  class="fas fa-angle-right"></i> Beranda</a></li>
            <li><a href="#properti" class="footer__link spa-link" data-section="properti"><i
                  class="fas fa-angle-right"></i> Properti</a></li>
            <li><a href="#virtual-tour" class="footer__link spa-link" data-section="virtual-tour"><i
                  class="fas fa-angle-right"></i> Virtual Tour</a></li>
            <li><a href="#ulasan" class="footer__link spa-link" data-section="ulasan"><i class="fas fa-angle-right"></i>
                Ulasan</a></li>
            <li><a href="#tentang" class="footer__link spa-link" data-section="tentang"><i
                  class="fas fa-angle-right"></i> Tentang Kami</a></li>
            <li><a href="#kontak" class="footer__link spa-link" data-section="kontak"><i class="fas fa-angle-right"></i>
                Kontak</a></li>
          </ul>
        </div>
        <div class="footer__column">
          <h3>Hubungi Kami</h3>
          <ul>
            <li><i class="fas fa-map-marker-alt"></i> Jl. Apartemen Indah No. 1, Jakarta Pusat, Indonesia</li>
            <li><i class="fas fa-phone"></i> +62 21 5555 7777</li>
            <li><i class="fas fa-envelope"></i> support@greenvalley.id</li>
          </ul>
        </div>
        <div class="footer__column">
          <h3>Ikuti Kami</h3>
          <div class="social-links">
            <a href="#" class="footer__link" aria-label="Green Valley di Facebook" target="_blank"
              rel="noopener noreferrer"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="footer__link" aria-label="Green Valley di Twitter" target="_blank"
              rel="noopener noreferrer"><i class="fab fa-twitter"></i></a>
            <a href="#" class="footer__link" aria-label="Green Valley di Instagram" target="_blank"
              rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
            <a href="#" class="footer__link" aria-label="Green Valley di LinkedIn" target="_blank"
              rel="noopener noreferrer"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>
      </div>
      <div class="footer__copyright">
        <p>&copy; <span id="currentYear"></span> Green Valley. Semua Hak Cipta Dilindungi.</p>
        <p>Dirancang dengan <i class="fas fa-heart text-primary"></i> oleh Tim Green Valley.</p>
      </div>
    </div>
  </footer>

  <!-- Widget Chat Interaktif -->
  <aside class="chat-widget" id="chatWidget">
    <div class="chat-window" id="chatWindow" aria-hidden="true">
      <div class="chat-header">Chat Bantuan Green Valley</div>
      <div class="chat-messages" id="chatMessagesContainer" role="log" aria-live="polite">
        <!-- Pesan chat akan di-render di sini -->
      </div>
      <form class="chat-input-area" id="chatForm">
        <div class="chat-input-wrapper">
          <input type="text" class="form-input chat-input" id="chatInput" placeholder="Ketik pesan Anda..."
            aria-label="Input pesan chat">
          <button type="submit" class="button button--primary button--icon chat-send-button" aria-label="Kirim pesan">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </form>
    </div>
    <button class="chat-toggle-button button button--primary button--icon" id="chatToggleBtn"
      aria-label="Buka jendela chat" aria-expanded="false" aria-controls="chatWindow">
      <i class="fas fa-comments"></i>
      <i class="fas fa-times"></i>
    </button>
  </aside>

  <!-- Template untuk kartu properti (untuk JavaScript) -->
  <template id="propertyCardTemplate">
    <article class="property-card">
      <div class="property-card__image-wrapper">
        <div class="property-card__image" style="background-image: url('')"></div>
        <span class="property-card__image-overlay">Baru!</span>
      </div>
      <div class="property-card__details">
        <h3 class="property-card__title">Nama Properti</h3>
        <div class="property-card__price">Rp 0/bulan</div>
        <div class="property-card__location">
          <i class="fas fa-map-marker-alt"></i>
          <span>Lokasi Properti</span>
        </div>
        <p class="property-card__description">Deskripsi singkat properti...</p>
        <div class="property-card__features">
          <span><i class="fas fa-bed"></i> <span data-feature="beds">0</span> Kamar Tidur</span>
          <span><i class="fas fa-bath"></i> <span data-feature="baths">0</span> Kamar Mandi</span>
          <span><i class="fas fa-ruler-combined"></i> <span data-feature="area">0</span> m¬≤</span>
        </div>
        <div class="property-card__actions">
          <a href="#virtual-tour" class="button button--secondary spa-link" data-section="virtual-tour"
            data-property-id="">
            <i class="fas fa-vr-cardboard"></i>
            Virtual Tour
          </a>
        </div>
      </div>
    </article>
  </template>

  <!-- Template untuk kartu ulasan (untuk JavaScript) -->
  <template id="reviewCardTemplate">
    <article class="review-card">
      <div class="review-card__header">
        <span class="review-card__author">Nama Pengulas</span>
        <div class="review-card__rating" aria-label="Rating bintang">
          <!-- Bintang rating akan diisi JS -->
        </div>
      </div>
      <p class="review-card__text">Isi ulasan...</p>
      <div class="review-card__date">Tanggal</div>
    </article>
  </template>


  <script>
    // === MODUL UTILITIES ===
    // Berisi fungsi-fungsi bantuan yang sering digunakan di berbagai modul.
    // Kode ini memastikan fungsi umum tidak terduplikasi dan mudah diakses.
    const Utils = {
      // Membersihkan input string untuk mencegah XSS sederhana.
      // Menggunakan DOMParser untuk keamanan lebih baik daripada textContent.
      sanitizeInput: (input) => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(input, 'text/html');
        return doc.body.textContent || "";
      },

      // Fungsi debounce untuk menunda eksekusi fungsi hingga pengguna selesai melakukan aksi (mis: mengetik).
      // Berguna untuk optimasi performa pada event listener yang sering terpicu.
      debounce: (func, delay) => {
        let timeoutId;
        return (...args) => {
          clearTimeout(timeoutId);
          timeoutId = setTimeout(() => {
            func.apply(this, args);
          }, delay);
        };
      },

      // Fungsi throttle untuk membatasi frekuensi eksekusi fungsi.
      // Berguna untuk event seperti scroll atau resize.
      throttle: (func, limit) => {
        let inThrottle;
        return (...args) => {
          if (!inThrottle) {
            func.apply(this, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
          }
        };
      },

      // Mendapatkan elemen DOM dengan aman.
      qs: (selector, parent = document) => parent.querySelector(selector),
      qsAll: (selector, parent = document) => parent.querySelectorAll(selector),

      // Menampilkan pesan status (sukses/error) pada elemen tertentu.
      displayStatusMessage: (element, message, type = 'success') => {
        if (!element) return;
        element.textContent = message;
        element.className = `status-message status-message--${type}`; // Untuk styling
        // Bisa ditambahkan logika untuk menghapus pesan setelah beberapa detik
        setTimeout(() => {
          element.textContent = '';
          element.className = '';
        }, 5000);
      },
      // Format angka menjadi format mata uang Rupiah
      formatCurrency: (amount) => {
        return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);
      }
    };

    // === MODUL SINGLE PAGE APPLICATION (SPA) MANAGER ===
    // Mengelola navigasi antar "halaman" atau section dalam satu file HTML.
    // Ini menciptakan ilusi perpindahan halaman tanpa reload penuh.
    const SpaManager = {
      currentSectionId: 'beranda', // Section awal yang aktif
      sections: {}, // Objek untuk menyimpan referensi elemen section
      navLinks: [],   // Array untuk menyimpan referensi link navigasi

      // Inisialisasi: Mengumpulkan semua section dan link navigasi, menampilkan section awal.
      init: () => {
        Utils.qsAll('.spa-section').forEach(section => {
          SpaManager.sections[section.id] = section;
        });

        Utils.qsAll('.spa-link').forEach(link => {
          SpaManager.navLinks.push(link);
          link.addEventListener('click', SpaManager.handleNavClick);
        });

        // Cek hash URL saat load awal (jika ada bookmark)
        const initialHash = window.location.hash.substring(1);
        if (initialHash && SpaManager.sections[initialHash]) {
          SpaManager.navigateTo(initialHash);
        } else {
          SpaManager.navigateTo(SpaManager.currentSectionId); // Tampilkan section beranda
        }

        // Listener untuk tombol back/forward browser
        window.addEventListener('popstate', SpaManager.handlePopState);
      },

      // Handler saat link navigasi di-klik.
      handleNavClick: (event) => {
        event.preventDefault();
        const sectionId = event.currentTarget.dataset.section || event.currentTarget.hash.substring(1);
        if (sectionId) {
          SpaManager.navigateTo(sectionId);
        }
      },

      // Handler untuk event popstate (navigasi browser back/forward)
      handlePopState: (event) => {
        const sectionId = window.location.hash.substring(1) || 'beranda';
        if (SpaManager.sections[sectionId]) {
          SpaManager.navigateTo(sectionId, false); // false agar tidak push state lagi
        }
      },

      // Fungsi utama untuk berpindah ke section tertentu.
      navigateTo: (sectionId, pushState = true) => {
        if (!SpaManager.sections[sectionId] || sectionId === SpaManager.currentSectionId && Utils.qs(`#${sectionId}`).classList.contains('active')) {
          return; // Jangan lakukan apa-apa jika section tidak ada atau sudah aktif
        }

        // Sembunyikan section yang sedang aktif
        if (SpaManager.sections[SpaManager.currentSectionId]) {
          SpaManager.sections[SpaManager.currentSectionId].classList.remove('active');
        }

        // Tampilkan section baru
        SpaManager.sections[sectionId].classList.add('active');
        SpaManager.currentSectionId = sectionId;

        // Update judul dokumen dan URL hash (jika pushState true)
        const sectionTitle = SpaManager.sections[sectionId].dataset.title || 'Green Valley';
        document.title = `${sectionTitle} - Green Valley`;
        if (pushState) {
          history.pushState({ section: sectionId }, document.title, `#${sectionId}`);
        }

        // Update kelas 'active' pada link navigasi
        SpaManager.updateActiveNavLink(sectionId);

        // Scroll ke atas halaman
        window.scrollTo(0, 0);

        // Tutup menu mobile jika terbuka
        MobileMenuManager.closeMenu();

        // Trigger event kustom jika diperlukan oleh modul lain
        document.dispatchEvent(new CustomEvent('spaSectionChanged', { detail: { sectionId } }));
      },

      // Mengupdate tampilan link navigasi yang aktif.
      updateActiveNavLink: (activeSectionId) => {
        SpaManager.navLinks.forEach(link => {
          const linkSection = link.dataset.section || link.hash.substring(1);
          if (linkSection === activeSectionId) {
            link.classList.add('active');
            link.setAttribute('aria-current', 'page');
          } else {
            link.classList.remove('active');
            link.removeAttribute('aria-current');
          }
        });
      }
    };

    // === MODUL THEME MANAGER ===
    // Mengelola pergantian tema (light/dark).
    // Menyimpan preferensi tema pengguna di localStorage.
    const ThemeManager = {
      themeToggleButton: null,
      currentTheme: 'light',

      // Inisialisasi: Mendapatkan tombol, mengecek tema tersimpan, dan menambahkan event listener.
      init: () => {
        ThemeManager.themeToggleButton = Utils.qs('#themeToggleBtn');
        if (!ThemeManager.themeToggleButton) return;

        ThemeManager.themeToggleButton.addEventListener('click', ThemeManager.toggleTheme);

        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
          ThemeManager.setTheme(savedTheme);
        } else {
          // Cek preferensi sistem jika tidak ada tema tersimpan
          const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          ThemeManager.setTheme(prefersDark ? 'dark' : 'light');
        }
      },

      // Mengganti tema saat ini.
      toggleTheme: () => {
        const newTheme = ThemeManager.currentTheme === 'light' ? 'dark' : 'light';
        ThemeManager.setTheme(newTheme);
      },

      // Menerapkan tema ke elemen <html> dan menyimpan preferensi.
      setTheme: (theme) => {
        document.documentElement.setAttribute('data-theme', theme);
        ThemeManager.currentTheme = theme;
        localStorage.setItem('theme', theme);

        // Update ikon tombol (jika ada) dan aria-label
        const moonIcon = ThemeManager.themeToggleButton.querySelector('.fa-moon');
        const sunIcon = ThemeManager.themeToggleButton.querySelector('.fa-sun');

        if (theme === 'dark') {
          if (moonIcon) moonIcon.style.display = 'none';
          if (sunIcon) sunIcon.style.display = 'inline-block';
          ThemeManager.themeToggleButton.setAttribute('aria-label', 'Ganti ke tema terang');
        } else {
          if (moonIcon) moonIcon.style.display = 'inline-block';
          if (sunIcon) sunIcon.style.display = 'none';
          ThemeManager.themeToggleButton.setAttribute('aria-label', 'Ganti ke tema gelap');
        }
      }
    };

    // === MODUL MOBILE MENU MANAGER ===
    // Mengelola tampilan menu navigasi pada perangkat mobile.
    const MobileMenuManager = {
      toggleButton: null,
      navLinksContainer: null,
      isOpen: false,

      init: () => {
        MobileMenuManager.toggleButton = Utils.qs('#mobileMenuToggleBtn');
        MobileMenuManager.navLinksContainer = Utils.qs('#mainNavLinks');

        if (!MobileMenuManager.toggleButton || !MobileMenuManager.navLinksContainer) return;

        MobileMenuManager.toggleButton.addEventListener('click', MobileMenuManager.toggleMenu);
      },

      toggleMenu: () => {
        MobileMenuManager.isOpen = !MobileMenuManager.isOpen;
        MobileMenuManager.navLinksContainer.classList.toggle('open', MobileMenuManager.isOpen);
        MobileMenuManager.toggleButton.setAttribute('aria-expanded', MobileMenuManager.isOpen);

        // Ganti ikon hamburger/close
        const icon = MobileMenuManager.toggleButton.querySelector('i');
        if (MobileMenuManager.isOpen) {
          icon.classList.remove('fa-bars');
          icon.classList.add('fa-times');
          MobileMenuManager.toggleButton.setAttribute('aria-label', 'Tutup menu navigasi');
        } else {
          icon.classList.remove('fa-times');
          icon.classList.add('fa-bars');
          MobileMenuManager.toggleButton.setAttribute('aria-label', 'Buka menu navigasi');
        }
      },
      closeMenu: () => {
        if (MobileMenuManager.isOpen) {
          MobileMenuManager.toggleMenu(); // Panggil toggleMenu untuk menutup
        }
      }
    };

    // === MODUL PROPERTY MANAGER ===
    // Mengelola data dan tampilan daftar properti.
    // Menggunakan template HTML untuk membuat kartu properti secara dinamis.
    const PropertyManager = {
      propertyGrid: null,
      propertyCardTemplate: null,
      loader: null,
      // Data properti (contoh, idealnya dari API)
      properties: [
        {
          id: 'sudirman-luxury',
          name: 'Apartemen Mewah Sudirman',
          price: 15000000,
          location: 'Sudirman, Jakarta Pusat',
          description: 'Apartemen mewah dengan pemandangan kota, fasilitas lengkap, dan akses mudah ke pusat bisnis.',
          features: { beds: 2, baths: 2, area: 85 },
          image: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=60',
          isNew: true
        },
        {
          id: 'kemang-exclusive',
          name: 'Apartemen Eksklusif Kemang',
          price: 12500000,
          location: 'Kemang, Jakarta Selatan',
          description: 'Apartemen eksklusif di area premium dengan fasilitas kolam renang, gym, dan keamanan 24 jam.',
          features: { beds: 3, baths: 2, area: 100 },
          image: 'https://images.unsplash.com/photo-1560185007-5f0bb1866cab?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=60',
          isNew: false
        },
        {
          id: 'kuningan-modern',
          name: 'Apartemen Modern Kuningan',
          price: 10000000,
          location: 'Kuningan, Jakarta Selatan',
          description: 'Apartemen modern dengan desain minimalis, lokasi strategis, dan akses mudah ke mall dan perkantoran.',
          features: { beds: 2, baths: 1, area: 75 },
          image: 'https://images.unsplash.com/photo-1493809842364-78817add7ffb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=60',
          isNew: false
        },
        {
          id: 'pondok-indah-suite',
          name: 'Suite Keluarga Pondok Indah',
          price: 22000000,
          location: 'Pondok Indah, Jakarta Selatan',
          description: 'Suite keluarga yang luas dengan interior elegan, dekat dengan sekolah internasional dan pusat perbelanjaan elit.',
          features: { beds: 4, baths: 3, area: 150 },
          image: 'https://images.unsplash.com/photo-1505691938895-1758d7feb511?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=800&q=60',
          isNew: true
        }
      ],

      init: () => {
        PropertyManager.propertyGrid = Utils.qs('#propertyGrid');
        PropertyManager.propertyCardTemplate = Utils.qs('#propertyCardTemplate');
        PropertyManager.loader = Utils.qs('#propertyLoader');

        if (!PropertyManager.propertyGrid || !PropertyManager.propertyCardTemplate || !PropertyManager.loader) {
          console.error('Elemen untuk PropertyManager tidak ditemukan.');
          return;
        }

        // Simulasikan pengambilan data dari API
        PropertyManager.loader.style.display = 'block';
        setTimeout(() => {
          PropertyManager.renderProperties();
          PropertyManager.loader.style.display = 'none';
        }, 1000); // delay 1 detik
      },

      renderProperties: () => {
        PropertyManager.propertyGrid.innerHTML = ''; // Bersihkan grid sebelum render ulang
        PropertyManager.properties.forEach(property => {
          const cardClone = PropertyManager.propertyCardTemplate.content.cloneNode(true);
          const cardElement = cardClone.querySelector('.property-card');

          Utils.qs('.property-card__image', cardElement).style.backgroundImage = `url('${property.image}')`;
          const overlay = Utils.qs('.property-card__image-overlay', cardElement);
          if (property.isNew) {
            overlay.style.display = 'inline-block';
          } else {
            overlay.style.display = 'none';
          }

          Utils.qs('.property-card__title', cardElement).textContent = property.name;
          Utils.qs('.property-card__price', cardElement).textContent = `${Utils.formatCurrency(property.price)}/bulan`;
          Utils.qs('.property-card__location span', cardElement).textContent = property.location;
          Utils.qs('.property-card__description', cardElement).textContent = property.description;

          Utils.qs('[data-feature="beds"]', cardElement).textContent = property.features.beds;
          Utils.qs('[data-feature="baths"]', cardElement).textContent = property.features.baths;
          Utils.qs('[data-feature="area"]', cardElement).textContent = property.features.area;

          const virtualTourButton = Utils.qs('.spa-link[data-section="virtual-tour"]', cardElement);
          if (virtualTourButton) {
            virtualTourButton.dataset.propertyId = property.id;
            // Tambahkan event listener untuk mengirim data properti ke VirtualTourManager
            virtualTourButton.addEventListener('click', (e) => {
              const propertyId = e.currentTarget.dataset.propertyId;
              const selectedProperty = PropertyManager.properties.find(p => p.id === propertyId);
              if (selectedProperty) {
                // Panggil SpaManager untuk navigasi, lalu kirim data ke VirtualTourManager
                SpaManager.navigateTo('virtual-tour');
                // Kita butuh cara agar VirtualTourManager tahu properti mana yang dipilih
                // Mungkin melalui custom event setelah section berganti
                document.dispatchEvent(new CustomEvent('propertySelectedForTour', { detail: selectedProperty }));
              }
            });
          }
          PropertyManager.propertyGrid.appendChild(cardElement);
        });
      }
    };

    // === MODUL VIRTUAL TOUR MANAGER ===
    // Mengelola interaksi pada bagian Virtual Tour.
    const VirtualTourManager = {
      player: null,
      imageElement: null,
      playButtonContainer: null,
      playButton: null,
      loadingIndicator: null,
      statusElement: null,
      isTourActive: false,
      currentProperty: null,

      init: () => {
        VirtualTourManager.player = Utils.qs('#virtualTourPlayer');
        VirtualTourManager.imageElement = Utils.qs('#virtualTourImage');
        VirtualTourManager.playButtonContainer = Utils.qs('#virtualTourPlayButtonContainer');
        VirtualTourManager.playButton = Utils.qs('#playVirtualTourBtn');
        VirtualTourManager.loadingIndicator = Utils.qs('#virtualTourLoadingIndicator');
        VirtualTourManager.statusElement = Utils.qs('#virtualTourStatus');

        if (!VirtualTourManager.player || !VirtualTourManager.playButton) {
          console.error('Elemen untuk VirtualTourManager tidak ditemukan.');
          return;
        }

        VirtualTourManager.playButton.addEventListener('click', VirtualTourManager.toggleTour);

        // Dengar event ketika properti dipilih untuk tur
        document.addEventListener('propertySelectedForTour', (event) => {
          VirtualTourManager.loadTourForProperty(event.detail);
        });
      },

      loadTourForProperty: (property) => {
        VirtualTourManager.currentProperty = property;
        if (VirtualTourManager.imageElement && property.image) {
          VirtualTourManager.imageElement.src = property.image;
          VirtualTourManager.imageElement.alt = `Virtual tour untuk ${property.name}`;
        }
        if (VirtualTourManager.statusElement) {
          VirtualTourManager.statusElement.textContent = `Siap memulai tur virtual untuk ${property.name}. Klik tombol play.`;
        }
        // Reset state tur jika sebelumnya aktif
        if (VirtualTourManager.isTourActive) {
          VirtualTourManager.stopTour();
        }
      },

      toggleTour: () => {
        if (!VirtualTourManager.currentProperty) {
          if (VirtualTourManager.statusElement) VirtualTourManager.statusElement.textContent = 'Silakan pilih properti dari halaman Properti terlebih dahulu.';
          return;
        }

        if (VirtualTourManager.isTourActive) {
          VirtualTourManager.stopTour();
        } else {
          VirtualTourManager.startTour();
        }
      },

      startTour: () => {
        VirtualTourManager.isTourActive = true;
        if (VirtualTourManager.playButtonContainer) VirtualTourManager.playButtonContainer.style.display = 'none';
        if (VirtualTourManager.loadingIndicator) VirtualTourManager.loadingIndicator.style.display = 'flex';
        if (VirtualTourManager.imageElement) VirtualTourManager.imageElement.classList.add('loading');
        if (VirtualTourManager.statusElement) VirtualTourManager.statusElement.textContent = `Memuat tur virtual untuk ${VirtualTourManager.currentProperty.name}...`;

        // Simulasikan pemuatan tur
        setTimeout(() => {
          if (VirtualTourManager.loadingIndicator) VirtualTourManager.loadingIndicator.style.display = 'none';
          // Di sini idealnya akan ada iframe atau library 360 viewer.
          // Untuk demo, kita hanya ganti status.
          if (VirtualTourManager.statusElement) VirtualTourManager.statusElement.textContent = `Tur virtual untuk ${VirtualTourManager.currentProperty.name} sedang aktif. (Ini adalah simulasi, klik ikon stop untuk mengakhiri).`;
          if (VirtualTourManager.playButton) {
            VirtualTourManager.playButton.innerHTML = '<i class="fas fa-stop-circle fa-3x"></i>';
            VirtualTourManager.playButton.setAttribute('aria-label', 'Hentikan Virtual Tour');
          }
          if (VirtualTourManager.playButtonContainer) VirtualTourManager.playButtonContainer.style.display = 'flex'; // Tampilkan kembali tombol (sekarang jadi stop)
          if (VirtualTourManager.imageElement) VirtualTourManager.imageElement.classList.remove('loading');
        }, 2000);
      },

      stopTour: () => {
        VirtualTourManager.isTourActive = false;
        if (VirtualTourManager.statusElement) VirtualTourManager.statusElement.textContent = `Tur virtual untuk ${VirtualTourManager.currentProperty.name} dihentikan. Klik play untuk memulai lagi.`;
        if (VirtualTourManager.playButton) {
          VirtualTourManager.playButton.innerHTML = '<i class="fas fa-play-circle fa-3x"></i>';
          VirtualTourManager.playButton.setAttribute('aria-label', 'Mulai Virtual Tour');
        }
        if (VirtualTourManager.imageElement) VirtualTourManager.imageElement.classList.remove('loading');
      }
    };

    // === MODUL PAYMENT MANAGER ===
    // Mengelola pilihan metode pembayaran dan tampilan form terkait.
    const PaymentManager = {
      methodButtons: [],
      detailsContainer: null,
      currentMethod: 'credit-card', // Metode default

      // Template HTML untuk detail form masing-masing metode pembayaran.
      // Ini membuat kode lebih bersih dan mudah dikelola.
      paymentFormTemplates: {
        'credit-card': `
                <h4>Detail Kartu Kredit/Debit</h4>
                <div class="payment-details__grid">
                    <div class="form-group">
                        <label for="cardNumber" class="form-label">Nomor Kartu</label>
                        <input type="text" id="cardNumber" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                    <div class="form-group">
                        <label for="cardName" class="form-label">Nama pada Kartu</label>
                        <input type="text" id="cardName" class="form-input" placeholder="Nama Lengkap Anda" required>
                    </div>
                    <div class="form-group">
                        <label for="cardExpiry" class="form-label">Tanggal Kedaluwarsa (MM/YY)</label>
                        <input type="text" id="cardExpiry" class="form-input" placeholder="MM/YY" required>
                    </div>
                    <div class="form-group">
                        <label for="cardCvv" class="form-label">CVV</label>
                        <input type="text" id="cardCvv" class="form-input" placeholder="‚Ä¢‚Ä¢‚Ä¢" required>
                    </div>
                </div>
                <button type="submit" class="button button--primary" style="margin-top: 1rem;"><i class="fas fa-lock"></i> Bayar Sekarang</button>
            `,
        'bank-transfer': `
                <h4>Detail Transfer Bank</h4>
                <p>Silakan transfer ke salah satu rekening berikut:</p>
                <ul>
                    <li>Bank BCA: 123-456-7890 a.n. Green Valley Properti</li>
                    <li>Bank Mandiri: 098-765-4321 a.n. Green Valley Properti</li>
                </ul>
                <p>Setelah transfer, mohon konfirmasi pembayaran.</p>
                <div class="form-group" style="margin-top: 1rem;">
                    <label for="uploadProof" class="form-label">Unggah Bukti Transfer (Opsional)</label>
                    <input type="file" id="uploadProof" class="form-input">
                </div>
                <button type="submit" class="button button--primary" style="margin-top: 1rem;"><i class="fas fa-check-circle"></i> Konfirmasi Pembayaran</button>
            `,
        'ewallet': `
                <h4>Detail Dompet Digital</h4>
                <div class="form-group">
                    <label for="ewalletType" class="form-label">Pilih Dompet Digital</label>
                    <select id="ewalletType" class="form-select" required>
                        <option value="">-- Pilih Dompet --</option>
                        <option value="gopay">GoPay</option>
                        <option value="ovo">OVO</option>
                        <option value="dana">DANA</option>
                        <option value="linkaja">LinkAja</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="ewalletPhone" class="form-label">Nomor Telepon Terdaftar</label>
                    <input type="tel" id="ewalletPhone" class="form-input" placeholder="08XXXXXXXXXX" required>
                </div>
                <button type="submit" class="button button--primary" style="margin-top: 1rem;"><i class="fas fa-qrcode"></i> Lanjutkan Pembayaran</button>
            `
      },

      init: () => {
        PaymentManager.detailsContainer = Utils.qs('#paymentDetailsContainer');
        Utils.qsAll('.payment-card').forEach(button => {
          PaymentManager.methodButtons.push(button);
          button.addEventListener('click', PaymentManager.handleMethodSelect);
        });

        if (!PaymentManager.detailsContainer || PaymentManager.methodButtons.length === 0) {
          console.warn('Elemen untuk PaymentManager tidak sepenuhnya ditemukan. Section Pembayaran mungkin tidak berfungsi.');
          return;
        }
        // Render form untuk metode default saat inisialisasi
        PaymentManager.renderPaymentForm(PaymentManager.currentMethod);
      },

      handleMethodSelect: (event) => {
        const selectedButton = event.currentTarget;
        const method = selectedButton.dataset.paymentMethod;

        if (method && method !== PaymentManager.currentMethod) {
          PaymentManager.currentMethod = method;
          PaymentManager.renderPaymentForm(method);

          // Update tampilan tombol aktif
          PaymentManager.methodButtons.forEach(btn => btn.classList.remove('active'));
          selectedButton.classList.add('active');
        }
      },

      renderPaymentForm: (method) => {
        if (PaymentManager.paymentFormTemplates[method]) {
          PaymentManager.detailsContainer.innerHTML = PaymentManager.paymentFormTemplates[method];
          // Tambahkan event listener untuk form submit jika perlu
          const form = PaymentManager.detailsContainer.querySelector('button[type="submit"]');
          if (form) {
            form.closest('div').addEventListener('submit', (e) => { // Asumsi tombol ada di dalam div form-like
              e.preventDefault();
              alert(`Proses pembayaran dengan ${method} akan dilanjutkan (simulasi).`);
            });
          }
        } else {
          PaymentManager.detailsContainer.innerHTML = '<p>Detail pembayaran untuk metode ini belum tersedia.</p>';
        }
      }
    };

    // === MODUL REVIEW MANAGER ===
    // Mengelola sistem ulasan: input rating bintang, submit ulasan, dan tampilan daftar ulasan.
    // Menyimpan ulasan di localStorage untuk persistensi sederhana.
    const ReviewManager = {
      form: null,
      nameInput: null,
      ratingInput: null,
      textInput: null,
      starsContainer: null,
      reviewsList: null,
      reviewCardTemplate: null,
      loader: null,
      currentRating: 0,
      reviews: [], // Array untuk menyimpan objek ulasan

      init: () => {
        ReviewManager.form = Utils.qs('#reviewForm');
        ReviewManager.nameInput = Utils.qs('#reviewerName');
        ReviewManager.ratingInput = Utils.qs('#reviewRating');
        ReviewManager.textInput = Utils.qs('#reviewText');
        ReviewManager.starsContainer = Utils.qs('#ratingStars');
        ReviewManager.reviewsList = Utils.qs('#reviewsList');
        ReviewManager.reviewCardTemplate = Utils.qs('#reviewCardTemplate');
        ReviewManager.loader = Utils.qs('#reviewLoader');

        if (!ReviewManager.form || !ReviewManager.starsContainer || !ReviewManager.reviewsList || !ReviewManager.reviewCardTemplate || !ReviewManager.loader) {
          console.warn('Elemen untuk ReviewManager tidak sepenuhnya ditemukan. Section Ulasan mungkin tidak berfungsi.');
          return;
        }

        ReviewManager.generateStars();
        ReviewManager.loadReviews(); // Muat ulasan dari localStorage

        ReviewManager.form.addEventListener('submit', ReviewManager.handleSubmit);
      },

      // Membuat bintang rating secara dinamis.
      generateStars: () => {
        ReviewManager.starsContainer.innerHTML = ''; // Kosongkan dulu
        for (let i = 1; i <= 5; i++) {
          const star = document.createElement('span');
          star.classList.add('rating-stars__star');
          star.innerHTML = '&#9733;'; // Karakter bintang Unicode
          star.dataset.value = i;
          star.setAttribute('role', 'radio');
          star.setAttribute('aria-checked', 'false');
          star.setAttribute('aria-label', `${i} bintang`);
          star.tabIndex = 0; // Dapat di-fokus keyboard

          star.addEventListener('click', () => ReviewManager.setRating(i));
          star.addEventListener('mouseover', () => ReviewManager.hoverRating(i));
          star.addEventListener('mouseout', () => ReviewManager.hoverRating(0)); // Reset hover
          star.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              ReviewManager.setRating(i);
            }
          });
          ReviewManager.starsContainer.appendChild(star);
        }
      },

      // Mengatur rating yang dipilih.
      setRating: (rating) => {
        ReviewManager.currentRating = rating;
        ReviewManager.ratingInput.value = rating;
        ReviewManager.updateStarDisplay();
        // Update aria-checked untuk bintang
        Utils.qsAll('.rating-stars__star', ReviewManager.starsContainer).forEach((s, idx) => {
          s.setAttribute('aria-checked', (idx < rating) ? 'true' : 'false');
        });
      },

      // Efek hover pada bintang.
      hoverRating: (rating) => {
        Utils.qsAll('.rating-stars__star', ReviewManager.starsContainer).forEach((star, index) => {
          if (rating === 0) { // Jika mouseout, kembali ke rating yang dipilih
            star.classList.toggle('hovered', index < ReviewManager.currentRating);
          } else { // Jika mouseover
            star.classList.toggle('hovered', index < rating);
          }
        });
      },

      // Mengupdate tampilan visual bintang.
      updateStarDisplay: () => {
        Utils.qsAll('.rating-stars__star', ReviewManager.starsContainer).forEach((star, index) => {
          star.classList.toggle('selected', index < ReviewManager.currentRating);
          star.classList.remove('hovered'); // Hapus class hover setelah klik
        });
      },

      // Menangani submit form ulasan.
      handleSubmit: (event) => {
        event.preventDefault();
        const name = Utils.sanitizeInput(ReviewManager.nameInput.value.trim());
        const text = Utils.sanitizeInput(ReviewManager.textInput.value.trim());
        const rating = parseInt(ReviewManager.ratingInput.value, 10);

        if (!name || !text || rating === 0) {
          alert('Harap isi semua kolom dan berikan rating.');
          return;
        }

        const newReview = {
          id: Date.now().toString(), // ID unik sederhana
          author: name,
          text: text,
          rating: rating,
          date: new Date().toLocaleDateString('id-ID', { year: 'numeric', month: 'long', day: 'numeric' })
        };

        ReviewManager.reviews.unshift(newReview); // Tambah di awal array
        ReviewManager.saveReviews();
        ReviewManager.renderReviews();

        // Reset form
        ReviewManager.form.reset();
        ReviewManager.setRating(0); // Reset rating bintang
        alert('Terima kasih! Ulasan Anda telah berhasil dikirim.');
      },

      // Menyimpan ulasan ke localStorage.
      saveReviews: () => {
        try {
          localStorage.setItem('greenValleyReviews', JSON.stringify(ReviewManager.reviews));
        } catch (e) {
          console.error('Gagal menyimpan ulasan ke localStorage:', e);
        }
      },

      // Memuat ulasan dari localStorage.
      loadReviews: () => {
        ReviewManager.loader.style.display = 'block';
        ReviewManager.reviewsList.innerHTML = ''; // Kosongkan list dulu

        // Simulasikan loading
        setTimeout(() => {
          try {
            const storedReviews = localStorage.getItem('greenValleyReviews');
            if (storedReviews) {
              ReviewManager.reviews = JSON.parse(storedReviews);
            } else {
              // Jika tidak ada ulasan, tambahkan contoh ulasan
              ReviewManager.reviews = [
                { id: '1', author: 'Budi Santoso', rating: 5, text: 'Pelayanan sangat memuaskan, apartemennya bersih dan sesuai dengan foto. Virtual tour sangat membantu!', date: '15 Mei 2024' },
                { id: '2', author: 'Citra Lestari', rating: 4, text: 'Proses sewa cepat dan mudah. Tim Green Valley responsif. Akan merekomendasikan ke teman.', date: '10 Mei 2024' }
              ];
              ReviewManager.saveReviews(); // Simpan contoh ulasan
            }
          } catch (e) {
            console.error('Gagal memuat ulasan dari localStorage:', e);
            ReviewManager.reviews = []; // Default ke array kosong jika ada error
          }
          ReviewManager.renderReviews();
          ReviewManager.loader.style.display = 'none';
        }, 1200);
      },

      // Merender semua ulasan ke DOM.
      renderReviews: () => {
        ReviewManager.reviewsList.innerHTML = ''; // Kosongkan dulu
        if (ReviewManager.reviews.length === 0) {
          ReviewManager.reviewsList.innerHTML = '<p>Belum ada ulasan. Jadilah yang pertama memberikan ulasan!</p>';
          return;
        }

        ReviewManager.reviews.forEach(review => {
          const cardClone = ReviewManager.reviewCardTemplate.content.cloneNode(true);
          const cardElement = cardClone.querySelector('.review-card');

          Utils.qs('.review-card__author', cardElement).textContent = review.author;
          Utils.qs('.review-card__text', cardElement).textContent = review.text;
          Utils.qs('.review-card__date', cardElement).textContent = review.date;

          const ratingStarsDisplay = Utils.qs('.review-card__rating', cardElement);
          ratingStarsDisplay.innerHTML = ''; // Kosongkan bintang
          for (let i = 0; i < 5; i++) {
            const starIcon = document.createElement('i');
            starIcon.classList.add('fas', 'fa-star');
            if (i >= review.rating) {
              starIcon.style.opacity = '0.3'; // Bintang yang tidak terisi dibuat transparan
            }
            ratingStarsDisplay.appendChild(starIcon);
          }
          ratingStarsDisplay.setAttribute('aria-label', `${review.rating} dari 5 bintang`);

          ReviewManager.reviewsList.appendChild(cardElement);
        });
      }
    };

    // === MODUL CONTACT FORM MANAGER ===
    // Mengelola fungsionalitas form kontak.
    const ContactFormManager = {
      form: null,
      nameInput: null,
      emailInput: null,
      subjectInput: null,
      messageInput: null,
      statusElement: null,

      init: () => {
        ContactFormManager.form = Utils.qs('#contactForm');
        if (!ContactFormManager.form) {
          console.warn('Form kontak tidak ditemukan.');
          return;
        }

        ContactFormManager.nameInput = Utils.qs('#contactName', ContactFormManager.form);
        ContactFormManager.emailInput = Utils.qs('#contactEmail', ContactFormManager.form);
        ContactFormManager.subjectInput = Utils.qs('#contactSubject', ContactFormManager.form);
        ContactFormManager.messageInput = Utils.qs('#contactMessage', ContactFormManager.form);
        ContactFormManager.statusElement = Utils.qs('#contactFormStatus');

        ContactFormManager.form.addEventListener('submit', ContactFormManager.handleSubmit);
      },

      handleSubmit: (event) => {
        event.preventDefault();
        const name = Utils.sanitizeInput(ContactFormManager.nameInput.value.trim());
        const email = Utils.sanitizeInput(ContactFormManager.emailInput.value.trim());
        const subject = Utils.sanitizeInput(ContactFormManager.subjectInput.value.trim());
        const message = Utils.sanitizeInput(ContactFormManager.messageInput.value.trim());

        // Validasi sederhana
        if (!name || !email || !subject || !message) {
          Utils.displayStatusMessage(ContactFormManager.statusElement, 'Semua kolom wajib diisi.', 'error');
          return;
        }
        if (!ContactFormManager.isValidEmail(email)) {
          Utils.displayStatusMessage(ContactFormManager.statusElement, 'Format email tidak valid.', 'error');
          return;
        }

        // Simulasikan pengiriman data
        Utils.displayStatusMessage(ContactFormManager.statusElement, 'Mengirim pesan...', 'info');
        setTimeout(() => {
          // Di aplikasi nyata, di sini akan ada AJAX request ke server
          console.log('Data Form Kontak:', { name, email, subject, message });
          Utils.displayStatusMessage(ContactFormManager.statusElement, 'Pesan Anda telah berhasil terkirim. Terima kasih!', 'success');
          ContactFormManager.form.reset(); // Kosongkan form
        }, 1500);
      },

      isValidEmail: (email) => {
        // Regex sederhana untuk validasi email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }
    };

    // === MODUL CHAT WIDGET MANAGER ===
    // Mengelola fungsionalitas widget chat interaktif.
    const ChatWidgetManager = {
      widget: null,
      toggleButton: null,
      chatWindow: null,
      messagesContainer: null,
      chatForm: null,
      chatInput: null,
      isOpen: false,
      messages: [], // Array untuk menyimpan objek pesan chat

      init: () => {
        ChatWidgetManager.widget = Utils.qs('#chatWidget');
        ChatWidgetManager.toggleButton = Utils.qs('#chatToggleBtn');
        ChatWidgetManager.chatWindow = Utils.qs('#chatWindow');
        ChatWidgetManager.messagesContainer = Utils.qs('#chatMessagesContainer');
        ChatWidgetManager.chatForm = Utils.qs('#chatForm');
        ChatWidgetManager.chatInput = Utils.qs('#chatInput');

        if (!ChatWidgetManager.widget || !ChatWidgetManager.toggleButton || !ChatWidgetManager.chatWindow) {
          console.warn('Elemen untuk ChatWidgetManager tidak sepenuhnya ditemukan. Widget Chat mungkin tidak berfungsi.');
          return;
        }

        ChatWidgetManager.toggleButton.addEventListener('click', ChatWidgetManager.toggleChat);
        ChatWidgetManager.chatForm.addEventListener('submit', ChatWidgetManager.handleSendMessage);

        // Pesan sambutan awal dari sistem
        ChatWidgetManager.addMessage('Selamat datang di Green Valley! Ada yang bisa kami bantu hari ini?', 'system');
      },

      toggleChat: () => {
        ChatWidgetManager.isOpen = !ChatWidgetManager.isOpen;
        ChatWidgetManager.widget.classList.toggle('open', ChatWidgetManager.isOpen);
        ChatWidgetManager.chatWindow.setAttribute('aria-hidden', !ChatWidgetManager.isOpen);
        ChatWidgetManager.toggleButton.setAttribute('aria-expanded', ChatWidgetManager.isOpen);
        ChatWidgetManager.toggleButton.setAttribute('aria-label', ChatWidgetManager.isOpen ? 'Tutup jendela chat' : 'Buka jendela chat');

        if (ChatWidgetManager.isOpen) {
          ChatWidgetManager.chatInput.focus(); // Fokus ke input saat chat dibuka
          // Update ikon pada tombol toggle
          ChatWidgetManager.toggleButton.querySelector('.fa-comments').style.display = 'none';
          ChatWidgetManager.toggleButton.querySelector('.fa-times').style.display = 'inline-block';
        } else {
          ChatWidgetManager.toggleButton.querySelector('.fa-comments').style.display = 'inline-block';
          ChatWidgetManager.toggleButton.querySelector('.fa-times').style.display = 'none';
        }
      },

      handleSendMessage: (event) => {
        event.preventDefault();
        const messageText = Utils.sanitizeInput(ChatWidgetManager.chatInput.value.trim());
        if (!messageText) return;

        ChatWidgetManager.addMessage(messageText, 'user');
        ChatWidgetManager.chatInput.value = ''; // Kosongkan input

        // Simulasikan balasan dari sistem
        setTimeout(() => {
          ChatWidgetManager.addMessage('Terima kasih atas pesan Anda. Tim kami akan segera merespons. Untuk bantuan cepat, Anda bisa menghubungi kami di +62 21 5555 7777.', 'system');
        }, 1000 + Math.random() * 1000); // Waktu respons acak
      },

      addMessage: (text, sender) => {
        const timestamp = new Date();
        const message = {
          text,
          sender, // 'user' atau 'system'
          timestamp: timestamp.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' })
        };
        ChatWidgetManager.messages.push(message);
        ChatWidgetManager.renderMessage(message);
      },

      renderMessage: (message) => {
        const messageElement = document.createElement('div');
        messageElement.classList.add('chat-msg', `chat-msg--${message.sender}`);

        const textElement = document.createElement('p');
        textElement.textContent = message.text;

        const timeElement = document.createElement('span');
        timeElement.classList.add('chat-msg__time');
        timeElement.textContent = message.timestamp;

        messageElement.appendChild(textElement);
        messageElement.appendChild(timeElement);

        ChatWidgetManager.messagesContainer.appendChild(messageElement);
        ChatWidgetManager.scrollToBottom();
      },

      scrollToBottom: () => {
        ChatWidgetManager.messagesContainer.scrollTop = ChatWidgetManager.messagesContainer.scrollHeight;
      }
    };

    // === INISIALISASI GLOBAL APLIKASI ===
    // Menjalankan fungsi init dari semua modul setelah DOM siap.
    // Ini adalah titik masuk utama untuk JavaScript aplikasi.
    document.addEventListener('DOMContentLoaded', () => {
      // Selalu update tahun di copyright footer
      const currentYearElement = Utils.qs('#currentYear');
      if (currentYearElement) {
        currentYearElement.textContent = new Date().getFullYear();
      }

      // Inisialisasi semua modul
      ThemeManager.init();
      MobileMenuManager.init();
      SpaManager.init(); // SPA Manager harus diinisialisasi agar section awal benar
      PropertyManager.init();
      VirtualTourManager.init();
      PaymentManager.init();
      ReviewManager.init();
      ContactFormManager.init();
      ChatWidgetManager.init();

      console.log('Aplikasi Green Valley berhasil dimuat dan diinisialisasi. (Vanilla JS Monolith)');
    });

  </script>
</body>

</html>