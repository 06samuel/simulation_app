<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Green Valley - Temukan apartemen impian Anda di lokasi strategis dengan fasilitas modern. Hunian eksklusif dengan desain menawan.">
    <meta name="keywords"
        content="apartemen, green valley, properti, hunian modern, sewa apartemen, beli apartemen, investasi properti">
    <meta name="author" content="Green Valley Properties">
    <meta name="theme-color" content="#2E7D32"> <!-- Warna tema untuk address bar browser mobile -->

    <!-- Font Awesome untuk Ikon Gratis dan Fancy -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />

    <title>Green Valley - Hunian Modern & Strategis</title>

    <style>
        /* CSS Reset & Global Styles yang Ditingkatkan dan Dirapikan */
        :root {
            --primary-color: #2E7D32;
            /* Hijau Tua - Lebih Elegan */
            --secondary-color: #66BB6A;
            /* Hijau Muda - Aksen Segar */
            --accent-color: #FFB300;
            /* Kuning Emas - Aksen Hangat */
            --text-color: #37474F;
            /* Biru Abu Tua - Kontras Baik */
            --bg-color: #ECEFF1;
            /* Biru Abu Sangat Muda - Latar Bersih */
            --card-bg-color: #FFFFFF;
            --border-color: #CFD8DC;
            /* Biru Abu Muda - Batas Halus */
            --header-height: 75px;
            --font-family: 'Poppins', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            --box-shadow-light: 0 5px 15px rgba(0, 0, 0, 0.08);
            --box-shadow-strong: 0 8px 25px rgba(0, 0, 0, 0.12);
            --border-radius: 12px;
            /* Border radius lebih besar untuk kesan modern */
            --transition-speed: 0.3s;
            --primary-color-rgb: 46, 125, 50;
            /* RGB dari --primary-color (akan diupdate JS jika tema berubah) */
            --success-color: #4CAF50;
            --error-color: #F44336;
            --warning-color: #FF9800;
            --info-color: #2196F3;
        }

        body.dark-theme {
            --primary-color: #66BB6A;
            /* Hijau Muda untuk tema gelap */
            --secondary-color: #4CAF50;
            /* Hijau lebih tua sebagai sekunder di tema gelap */
            --accent-color: #FFCA28;
            /* Kuning lebih cerah */
            --text-color: #E0E0E0;
            /* Teks lebih terang */
            --bg-color: #1E272E;
            /* Latar Gelap Lebih Dalam */
            --card-bg-color: #2D3A43;
            /* Warna Kartu Gelap */
            --border-color: #455A64;
            /* Batas lebih terang dari background gelap */
            --box-shadow-light: 0 5px 15px rgba(255, 255, 255, 0.05);
            --box-shadow-strong: 0 8px 25px rgba(255, 255, 255, 0.08);
            --primary-color-rgb: 102, 187, 106;
            /* RGB dari --primary-color dark mode */
            --success-color: #81C784;
            --error-color: #E57373;
            --warning-color: #FFB74D;
            --info-color: #64B5F6;
        }

        /* Import Google Fonts (Poppins) */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        *,
        *::before,
        *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-font-smoothing: antialiased;
            /* Teks lebih halus di Webkit */
            -moz-osx-font-smoothing: grayscale;
            /* Teks lebih halus di Firefox */
        }

        html {
            scroll-behavior: smooth;
            /* Scroll halus antar seksi */
            font-size: 16px;
            /* Ukuran font dasar, memudahkan kalkulasi rem */
        }

        body {
            font-family: var(--font-family);
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            /* Keterbacaan yang lebih baik */
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
            padding-top: var(--header-height);
            /* Ruang untuk header fixed */
            overflow-x: hidden;
            /* Mencegah scroll horizontal yang tidak diinginkan */
        }

        /* Utilitas Umum yang Fancy */
        .container {
            width: 90%;
            /* Persentase untuk fleksibilitas */
            max-width: 1280px;
            /* Batas maksimal agar tidak terlalu lebar di layar besar */
            margin: 30px auto;
            /* Pusatkan konten dan beri jarak atas/bawah */
            padding: 0 20px;
            /* Padding horizontal internal */
        }

        img,
        picture {
            /* Pastikan gambar responsif */
            max-width: 100%;
            height: auto;
            /* Pertahankan aspek rasio */
            display: block;
            /* Hilangkan spasi ekstra di bawah gambar */
        }

        button,
        input,
        select,
        textarea {
            /* Warisi font family agar konsisten */
            font-family: inherit;
            font-size: 1rem;
        }

        /* Header & Navigation yang Lebih Fancy dan Fungsional */
        .app-header {
            background-color: var(--card-bg-color);
            /* Warna latar header */
            padding: 0 2.5%;
            /* Padding horizontal fleksibel */
            display: flex;
            /* Gunakan flexbox untuk alignment */
            justify-content: space-between;
            /* Item terdistribusi rata */
            align-items: center;
            /* Item terpusat vertikal */
            position: fixed;
            /* Header tetap di atas saat scroll */
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            box-shadow: var(--box-shadow-light);
            /* Bayangan halus */
            z-index: 1000;
            /* Di atas konten lain */
            transition: background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }

        .app-header .logo {
            font-size: 1.9rem;
            /* Ukuran font logo */
            font-weight: 700;
            /* Ketebalan font logo */
            color: var(--primary-color);
            /* Warna logo sesuai tema */
            text-decoration: none;
            /* Hilangkan garis bawah link */
            display: flex;
            /* Untuk ikon dan teks sejajar */
            align-items: center;
            transition: color var(--transition-speed) ease, transform 0.2s ease-out;
        }

        .app-header .logo:hover {
            transform: scale(1.03);
            /* Efek hover halus */
        }

        .app-header .logo i {
            margin-right: 10px;
            /* Jarak ikon dari teks logo */
            font-size: 1.5rem;
            /* Ukuran ikon logo */
        }

        .app-nav ul {
            list-style: none;
            /* Hilangkan bullet list */
            display: flex;
            /* Item navigasi berjajar horizontal */
            align-items: center;
        }

        .app-nav ul li {
            margin-left: 10px;
            /* Jarak antar item navigasi */
        }

        .app-nav ul li a {
            color: var(--text-color);
            text-decoration: none;
            padding: 12px 18px;
            /* Padding internal link navigasi */
            font-weight: 500;
            /* Ketebalan font link */
            border-radius: var(--border-radius);
            transition: color var(--transition-speed) ease, background-color var(--transition-speed) ease;
            display: flex;
            /* Untuk ikon dan teks sejajar */
            align-items: center;
            position: relative;
            /* Untuk pseudo-element hover/active */
        }

        .app-nav ul li a i {
            margin-right: 8px;
            /* Jarak ikon dari teks link */
            font-size: 0.9em;
            /* Ukuran ikon link */
        }

        .app-nav ul li a::before {
            /* Garis bawah halus untuk hover/active */
            content: '';
            position: absolute;
            bottom: 5px;
            /* Posisi garis */
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: var(--primary-color);
            transition: width var(--transition-speed) ease-out;
        }

        .app-nav ul li a:hover::before,
        .app-nav ul li a.active::before {
            width: 60%;
            /* Lebar garis saat hover/active */
        }

        .app-nav ul li a:hover,
        .app-nav ul li a.active {
            color: var(--primary-color);
            /* Warna teks saat hover/active */
            background-color: rgba(var(--primary-color-rgb), 0.1);
            /* Latar belakang transparan dengan warna primer */
            font-weight: 600;
            /* Teks lebih tebal */
        }

        .header-actions {
            /* Kontainer untuk tombol aksi di header */
            display: flex;
            align-items: center;
            gap: 12px;
            /* Jarak antar tombol aksi */
        }

        /* Styling konsisten untuk tombol di header (Tema & Offcanvas) */
        .theme-toggle,
        .offcanvas-trigger-btn {
            background: transparent;
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            font-size: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            box-shadow: var(--box-shadow-light);
        }

        .theme-toggle i,
        .offcanvas-trigger-btn i {
            margin-right: 8px;
            font-size: 1.1em;
        }

        .theme-toggle:hover,
        .offcanvas-trigger-btn:hover {
            background-color: var(--primary-color);
            color: var(--card-bg-color);
            /* Teks kontras dengan background hover */
            border-color: var(--primary-color);
            transform: translateY(-2px) scale(1.02);
            /* Efek angkat halus */
            box-shadow: var(--box-shadow-strong);
        }


        /* Hamburger Menu untuk Mobile */
        .nav-toggle {
            display: none;
            /* Sembunyikan di desktop */
            cursor: pointer;
            background: none;
            border: none;
            font-size: 1.8rem;
            color: var(--primary-color);
            padding: 5px;
            z-index: 1001;
            /* Di atas nav mobile jika nav menutupi sebagian header */
        }

        /* Main Content Area */
        #app-content {
            padding: 30px 0;
            /* Padding atas/bawah untuk konten utama */
            min-height: calc(100vh - var(--header-height) - 100px);
            /* Pastikan konten mengisi layar (100px perkiraan tinggi footer) */
        }

        /* Flash Message Container (di bawah header, di atas konten) */
        #flash-message-container {
            position: sticky;
            /* Menempel di bawah header saat scroll */
            top: var(--header-height);
            z-index: 999;
            /* Di bawah header, di atas konten */
            width: 100%;
        }

        .flash-message {
            padding: 15px 20px;
            margin: 0;
            color: white;
            /* Teks selalu putih untuk kontras */
            text-align: center;
            font-weight: 500;
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: fadeInDown 0.5s ease-out, fadeOutUp 0.5s ease-out 4.5s forwards;
            /* Muncul dan hilang otomatis setelah 5s total (0.5s fadein, 4s visible, 0.5s fadeout) */
        }

        .flash-message.success {
            background-color: var(--success-color);
        }

        .flash-message.error {
            background-color: var(--error-color);
        }

        .flash-message.info {
            background-color: var(--info-color);
        }

        .flash-message.warning {
            background-color: var(--warning-color);
        }

        .flash-message .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0 5px;
            opacity: 0.8;
            transition: opacity var(--transition-speed) ease;
        }

        .flash-message .close-btn:hover {
            opacity: 1;
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }

            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }


        /* Section Title yang Lebih Menarik dan Fancy */
        .section-title {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 40px;
            /* Jarak lebih besar */
            text-align: center;
            font-weight: 700;
            position: relative;
            padding-bottom: 20px;
            /* Ruang untuk dekorasi bawah */
        }

        .section-title::after {
            /* Dekorasi garis bawah */
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--accent-color);
            border-radius: 2px;
        }

        /* Hero Section yang Fancy dan Memukau */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Mnx8dmlsbGF8ZW58MHx8MHx8fDA%3D&auto=format&fit=crop&w=1200&q=80') no-repeat center center/cover;
            color: #FFFFFF;
            /* Teks putih di atas gambar gelap */
            padding: 100px 30px;
            text-align: center;
            border-radius: var(--border-radius);
            /* Sudut melengkung yang konsisten */
            margin-bottom: 50px;
            /* Jarak bawah yang lebih besar */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 450px;
            /* Tinggi minimal hero section */
            box-shadow: var(--box-shadow-strong);
            /* Bayangan untuk efek kedalaman */
        }

        .hero h1 {
            font-size: 3.2rem;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
            /* Bayangan teks lebih kuat */
        }

        .hero p {
            font-size: 1.5rem;
            margin-bottom: 30px;
            max-width: 700px;
            /* Batasi lebar subjudul agar mudah dibaca */
            font-weight: 400;
            line-height: 1.6;
        }

        .hero .cta-button {
            background-color: var(--accent-color);
            color: #333;
            /* Teks gelap di atas tombol kuning */
            padding: 15px 35px;
            text-decoration: none;
            font-size: 1.2rem;
            font-weight: 600;
            border-radius: var(--border-radius);
            transition: transform var(--transition-speed) ease-out, background-color var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            box-shadow: var(--box-shadow-light);
            display: inline-flex;
            /* Untuk ikon dan teks sejajar */
            align-items: center;
            border: 2px solid transparent;
            /* Untuk efek border saat hover */
        }

        .hero .cta-button i {
            margin-left: 10px;
            /* Jarak ikon dari teks tombol */
            transition: transform 0.3s ease;
        }

        .hero .cta-button:hover {
            transform: translateY(-4px) scale(1.03);
            /* Efek angkat dan perbesar */
            background-color: #FFC107;
            /* Warna lebih cerah saat hover */
            box-shadow: var(--box-shadow-strong);
            border-color: rgba(255, 255, 255, 0.5);
            /* Border halus saat hover */
        }

        .hero .cta-button:hover i {
            transform: translateX(5px);
            /* Ikon bergeser sedikit */
        }


        /* Property Listings - Grid yang Ditingkatkan dengan Flexbox Internal */
        .property-listings {
            display: grid;
            /* Gunakan grid untuk layout kartu */
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            /* Kolom responsif */
            gap: 30px;
            /* Jarak antar kartu */
        }

        .property-card {
            background-color: var(--card-bg-color);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-light);
            overflow: hidden;
            /* Pastikan konten tidak meluber dari border radius */
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
            display: flex;
            /* Gunakan flexbox untuk struktur internal kartu */
            flex-direction: column;
            /* Susun elemen kartu secara vertikal */
        }

        .property-card:hover {
            transform: translateY(-8px);
            /* Efek angkat kartu saat hover */
            box-shadow: var(--box-shadow-strong);
            /* Bayangan lebih kuat saat hover */
        }

        body.dark-theme .property-card:hover {
            /* Bayangan khusus untuk tema gelap */
            box-shadow: 0 10px 20px rgba(255, 255, 255, 0.1);
        }

        .property-card__image-wrapper {
            position: relative;
            /* Untuk potensi elemen overlay di atas gambar */
            width: 100%;
            height: 220px;
            /* Tinggi gambar yang proporsional */
            overflow: hidden;
            /* Pastikan gambar tidak meluber saat di-zoom */
        }

        .property-card__image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            /* Gambar mengisi area tanpa distorsi */
            transition: transform 0.4s ease;
            /* Transisi halus untuk zoom gambar */
        }

        .property-card:hover .property-card__image {
            transform: scale(1.05);
            /* Efek zoom pada gambar saat hover kartu */
        }


        .property-card__content {
            padding: 25px;
            flex-grow: 1;
            /* Konten mengisi sisa ruang kartu */
            display: flex;
            flex-direction: column;
            /* Susun elemen konten secara vertikal */
        }

        .property-card__title {
            font-size: 1.6rem;
            color: var(--primary-color);
            margin-bottom: 12px;
            font-weight: 600;
            line-height: 1.3;
            /* Keterbacaan judul panjang */
        }

        .property-card__price {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 15px;
        }

        .property-card__description {
            font-size: 1rem;
            color: var(--text-color);
            margin-bottom: 20px;
            flex-grow: 1;
            /* Deskripsi mengisi ruang sebelum tombol */
            line-height: 1.6;
        }

        .property-card__button {
            /* Tombol konsisten dengan CTA Hero */
            background-color: var(--primary-color);
            color: white;
            /* Teks putih di atas tombol hijau */
            border: none;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color var(--transition-speed) ease, transform var(--transition-speed) ease;
            align-self: flex-start;
            /* Tombol tidak meregang penuh */
            font-weight: 500;
            display: inline-flex;
            /* Untuk ikon dan teks sejajar */
            align-items: center;
        }

        .property-card__button i {
            margin-left: 8px;
            /* Jarak ikon dari teks tombol */
        }

        .property-card__button:hover {
            background-color: var(--secondary-color);
            /* Warna lebih terang saat hover */
            transform: scale(1.03);
            /* Efek perbesar halus */
        }

        /* Dashboard Styles yang Lebih Terstruktur dan Visual */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .dashboard-widget {
            background-color: var(--card-bg-color);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-light);
            border: 1px solid var(--border-color);
            transition: all var(--transition-speed) ease;
            display: flex;
            /* Untuk layout internal yang lebih fleksibel */
            flex-direction: column;
        }

        .dashboard-widget:hover {
            transform: translateY(-5px);
            box-shadow: var(--box-shadow-strong);
        }

        .dashboard-widget h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 12px;
            font-size: 1.4rem;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .dashboard-widget h3 i {
            margin-right: 10px;
            color: var(--secondary-color);
            font-size: 1.2em;
            /* Ikon sedikit lebih besar dari teks judul */
        }

        .dashboard-widget ul {
            list-style: none;
            margin-bottom: 15px;
            /* Jarak bawah list */
        }

        .dashboard-widget ul li {
            padding: 10px 5px;
            /* Padding kiri-kanan agar tidak terlalu mepet */
            border-bottom: 1px dashed var(--border-color);
            transition: background-color var(--transition-speed) ease, padding-left var(--transition-speed) ease;
            border-radius: 4px;
        }

        .dashboard-widget ul li:hover {
            background-color: rgba(var(--primary-color-rgb), 0.05);
            padding-left: 10px;
            /* Efek indent saat hover */
        }

        .dashboard-widget ul li:last-child {
            border-bottom: none;
        }

        .dashboard-widget .highlight {
            font-weight: 700;
            color: var(--accent-color);
            font-size: 1.1em;
        }

        .dashboard-widget p {
            font-size: 1rem;
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .dashboard-widget .quick-actions button {
            margin-bottom: 10px;
            width: 100%;
            /* Tombol full width dalam widget Aksi Cepat */
            padding: 12px;
        }

        /* Notification Styles yang Lebih Jelas dan Informatif */
        .notification-list {
            list-style: none;
            max-width: 800px;
            /* Batasi lebar list notifikasi agar mudah dibaca */
            margin: 0 auto;
            /* Pusatkan list */
        }

        .notification-item {
            background-color: var(--card-bg-color);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            border-left: 6px solid var(--primary-color);
            /* Indikator visual tipe notifikasi */
            box-shadow: var(--box-shadow-light);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            /* Konten dan timestamp align ke atas */
            transition: all var(--transition-speed) ease;
        }

        .notification-item:hover {
            transform: translateX(5px);
            /* Efek geser halus saat hover */
            box-shadow: var(--box-shadow-strong);
        }

        .notification-item.unread {
            /* Styling khusus untuk notifikasi belum dibaca */
            border-left-color: var(--accent-color);
            background-color: color-mix(in srgb, var(--card-bg-color) 95%, var(--accent-color) 5%);
            /* Campuran warna untuk latar yang sedikit berbeda */
        }

        body.dark-theme .notification-item.unread {
            background-color: color-mix(in srgb, var(--card-bg-color) 90%, var(--accent-color) 10%);
        }


        .notification-item__content {
            flex-grow: 1;
            /* Konten mengisi ruang */
            padding-right: 15px;
            /* Jarak agar tidak mepet timestamp */
        }

        .notification-item__message {
            font-size: 1.05rem;
            margin: 0 0 8px 0;
            font-weight: 500;
            line-height: 1.5;
        }

        .notification-item__meta {
            display: flex;
            align-items: center;
            gap: 10px;
            /* Jarak antar elemen meta (seperti badge) */
        }

        .notification-item__type-badge {
            font-size: 0.8em;
            padding: 4px 10px;
            /* Padding lebih nyaman */
            border-radius: 6px;
            background-color: var(--secondary-color);
            color: white;
            font-weight: 500;
            text-transform: uppercase;
            /* Teks badge kapital */
            letter-spacing: 0.5px;
            /* Spasi huruf agar lebih rapi */
        }

        .notification-item.unread .notification-item__type-badge {
            background-color: var(--accent-color);
            color: #333;
            /* Teks gelap di atas badge kuning */
        }

        .notification-item__timestamp {
            font-size: 0.85em;
            color: #777;
            margin-left: auto;
            /* Dorong timestamp ke kanan (bekerja karena flex di parent) */
            padding-left: 15px;
            /* Jarak dari konten notifikasi */
            white-space: nowrap;
            /* Pastikan timestamp tidak terpotong ke baris baru */
            flex-shrink: 0;
            /* Mencegah timestamp menyusut */
        }

        body.dark-theme .notification-item__timestamp {
            color: #aaa;
        }

        /* Footer yang Lebih Informatif dan Rapi */
        .app-footer {
            background-color: #263238;
            /* Warna footer lebih gelap dari bg utama */
            color: #B0BEC5;
            /* Warna teks footer lebih lembut */
            text-align: center;
            padding: 40px 20px;
            /* Padding lebih besar */
            margin-top: 50px;
            /* Jarak dari konten terakhir */
            border-top: 4px solid var(--primary-color);
            /* Aksen warna primer di atas footer */
        }

        .app-footer p {
            margin: 0 0 15px 0;
            /* Jarak bawah untuk copyright */
            font-size: 0.95rem;
        }

        .app-footer .footer-links {
            margin-top: 10px;
            display: flex;
            /* Link sejajar dan mudah di-manage */
            justify-content: center;
            gap: 20px;
            /* Jarak antar link */
            flex-wrap: wrap;
            /* Bungkus link jika tidak muat */
        }

        .app-footer .footer-links a {
            color: var(--secondary-color);
            /* Warna link footer */
            text-decoration: none;
            transition: color var(--transition-speed) ease, text-decoration var(--transition-speed) ease;
            padding-bottom: 3px;
            /* Ruang untuk garis bawah */
            border-bottom: 1px solid transparent;
            /* Garis bawah transparan awal */
        }

        .app-footer .footer-links a:hover {
            color: var(--accent-color);
            /* Warna hover link */
            border-bottom-color: var(--accent-color);
            /* Garis bawah muncul saat hover */
        }


        /* Placeholder untuk halaman/konten kosong yang Fancy */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            /* Padding lebih besar */
            color: var(--text-color);
            opacity: 0.7;
            /* Sedikit transparan agar tidak terlalu dominan */
            border: 2px dashed var(--border-color);
            /* Batas putus-putus */
            border-radius: var(--border-radius);
            background-color: rgba(var(--primary-color-rgb), 0.03);
            /* Latar belakang sangat tipis */
        }

        .empty-state i {
            font-size: 4.5rem;
            /* Ikon lebih besar */
            color: var(--primary-color);
            /* Warna ikon sesuai tema */
            margin-bottom: 25px;
            display: block;
            /* Agar margin-bottom bekerja dengan baik */
        }

        .empty-state p {
            font-size: 1.3rem;
            /* Teks lebih besar dan jelas */
            font-weight: 500;
        }


        /* Animasi Sederhana untuk Konten (Fade In) */
        .fade-in {
            animation: fadeInAnimation 0.6s ease-in-out;
            /* Durasi sedikit lebih lama */
        }

        @keyframes fadeInAnimation {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            /* Mulai dari bawah sedikit */
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Toast Notification System (Pemberitahuan Non-Blocking) */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 2000;
            /* Di atas segalanya */
            display: flex;
            flex-direction: column;
            /* Toast menumpuk ke atas */
            gap: 10px;
            /* Jarak antar toast */
            pointer-events: none;
            /* Agar tidak menghalangi klik di bawahnya kecuali pada toast itu sendiri */
        }

        .toast {
            background-color: var(--card-bg-color);
            color: var(--text-color);
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-strong);
            /* Bayangan kuat agar menonjol */
            border-left: 5px solid var(--info-color);
            /* Indikator tipe toast */
            display: flex;
            align-items: center;
            gap: 12px;
            /* Jarak ikon dan teks */
            /* Default animation removed from here, will be set by JS for dynamic delays */
            min-width: 280px;
            /* Lebar minimal toast */
            max-width: 380px;
            /* Lebar maksimal toast */
            pointer-events: all;
            /* Toast bisa diinteraksi */
        }

        .toast i.toast-icon {
            font-size: 1.3rem;
        }

        /* Ukuran ikon toast */

        .toast.success {
            border-left-color: var(--success-color);
        }

        .toast.success i.toast-icon {
            color: var(--success-color);
        }

        .toast.error {
            border-left-color: var(--error-color);
        }

        .toast.error i.toast-icon {
            color: var(--error-color);
        }

        .toast.warning {
            border-left-color: var(--warning-color);
        }

        .toast.warning i.toast-icon {
            color: var(--warning-color);
        }

        .toast.info {
            border-left-color: var(--info-color);
        }

        .toast.info i.toast-icon {
            color: var(--info-color);
        }

        .toast-message {
            flex-grow: 1;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .toast-close-btn {
            background: none;
            border: none;
            color: var(--text-color);
            opacity: 0.7;
            font-size: 1.3rem;
            /* Tombol close lebih besar */
            cursor: pointer;
            padding: 0 5px;
            transition: opacity var(--transition-speed) ease;
        }

        .toast-close-btn:hover {
            opacity: 1;
        }

        @keyframes toastInRight {
            from {
                transform: translateX(110%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes toastOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }

            to {
                transform: translateX(110%);
                opacity: 0;
            }
        }

        /* Custom Alert (Modal) yang Fancy */
        .custom-alert-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.65);
            /* Overlay lebih gelap */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1900;
            /* Di bawah toast, di atas offcanvas overlay jika ada */
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed) ease, visibility 0s var(--transition-speed) ease;
        }

        .custom-alert-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }

        .custom-alert-box {
            background-color: var(--card-bg-color);
            padding: 35px;
            /* Padding lebih besar */
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow-strong);
            width: 90%;
            max-width: 500px;
            text-align: center;
            transform: scale(0.9) translateY(20px);
            /* Efek muncul dari bawah dan membesar */
            opacity: 0;
            transition: transform var(--transition-speed) cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity var(--transition-speed) ease;
        }

        .custom-alert-overlay.visible .custom-alert-box {
            transform: scale(1) translateY(0);
            opacity: 1;
        }

        .custom-alert-box h3 {
            color: var(--primary-color);
            margin-top: 0;
            margin-bottom: 20px;
            /* Jarak judul ke pesan */
            font-size: 1.7rem;
            /* Judul lebih besar */
            font-weight: 600;
        }

        .custom-alert-box p {
            margin-bottom: 30px;
            /* Jarak pesan ke tombol */
            font-size: 1.1rem;
            line-height: 1.7;
            color: var(--text-color);
        }

        .custom-alert-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .custom-alert-actions button {
            /* Styling tombol alert konsisten */
            padding: 12px 30px;
            /* Padding tombol lebih besar */
            border-radius: var(--border-radius);
            font-weight: 600;
            /* Teks tombol lebih tebal */
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            min-width: 120px;
            /* Lebar minimal tombol */
            box-shadow: var(--box-shadow-light);
        }

        .custom-alert-actions button:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-strong);
        }

        .custom-alert-confirm-btn {
            background-color: var(--primary-color);
            color: white;
            border: 2px solid var(--primary-color);
        }

        .custom-alert-confirm-btn:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }

        .custom-alert-cancel-btn {
            background-color: transparent;
            color: var(--text-color);
            border: 2px solid var(--border-color);
        }

        .custom-alert-cancel-btn:hover {
            background-color: var(--bg-color);
            border-color: var(--text-color);
            color: var(--primary-color);
        }

        /* Off-Canvas Panel (Panel Samping) yang Fancy */
        .offcanvas-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: opacity var(--transition-speed) ease, visibility 0s var(--transition-speed) ease;
        }

        .offcanvas-overlay.visible {
            opacity: 1;
            visibility: visible;
            transition-delay: 0s;
        }

        .offcanvas-panel {
            position: fixed;
            top: 0;
            right: -380px;
            /* Mulai dari luar layar kanan, lebar panel 350px + margin */
            width: 100%;
            max-width: 350px;
            /* Lebar panel samping */
            height: 100%;
            background-color: var(--card-bg-color);
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.15);
            /* Bayangan lebih kuat */
            z-index: 1600;
            transition: right 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            /* Transisi geser lebih smooth */
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            /* Scroll jika konten melebihi tinggi */
        }

        .offcanvas-panel.open {
            right: 0;
        }

        .offcanvas-header {
            padding: 20px 25px;
            /* Padding header panel */
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(var(--primary-color-rgb), 0.05);
            /* Latar header sedikit berbeda */
        }

        .offcanvas-header h3 {
            margin: 0;
            font-size: 1.5rem;
            /* Judul panel lebih besar */
            color: var(--primary-color);
            font-weight: 600;
        }

        .offcanvas-close-btn {
            background: none;
            border: none;
            font-size: 1.8rem;
            /* Tombol close lebih besar */
            color: var(--text-color);
            cursor: pointer;
            padding: 5px;
            line-height: 1;
            border-radius: 50%;
            /* Tombol close bulat */
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
        }

        .offcanvas-close-btn:hover {
            background-color: rgba(var(--primary-color-rgb), 0.1);
            color: var(--primary-color);
        }

        .offcanvas-content {
            padding: 25px;
            /* Padding konten panel */
            flex-grow: 1;
            /* Konten mengisi sisa ruang */
        }


        /* Penyesuaian Responsif yang Komprehensif dan Rapi */
        @media (max-width: 992px) {

            /* Tablet dan layar sedang */
            .hero h1 {
                font-size: 2.8rem;
            }

            .hero p {
                font-size: 1.3rem;
            }

            .section-title {
                font-size: 2.2rem;
            }

            .property-listings {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }

            /* Kartu sedikit lebih kecil */
        }

        @media (max-width: 768px) {

            /* Tablet kecil dan mobile besar */
            :root {
                --header-height: 65px;
            }

            /* Header lebih ramping */
            body {
                padding-top: var(--header-height);
            }

            .container {
                width: 95%;
                margin-top: 20px;
                padding: 0 15px;
            }

            .app-header {
                padding: 0 5%;
            }

            .app-nav {
                /* Navigasi mobile sebagai menu dropdown */
                display: none;
                flex-direction: column;
                position: absolute;
                top: var(--header-height);
                left: 0;
                width: 100%;
                background-color: var(--card-bg-color);
                box-shadow: var(--box-shadow-strong);
                /* Bayangan lebih jelas untuk menu mobile */
                padding: 15px 0;
                border-top: 1px solid var(--border-color);
                max-height: calc(100vh - var(--header-height));
                /* Batasi tinggi menu agar bisa discroll jika item banyak */
                overflow-y: auto;
                animation: slideDownNav 0.3s ease-out;
            }

            @keyframes slideDownNav {
                from {
                    opacity: 0;
                    transform: translateY(-20px);
                }

                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            .app-nav.active {
                display: flex;
            }

            .app-nav ul {
                flex-direction: column;
                width: 100%;
            }

            .app-nav ul li {
                margin: 8px 0;
                width: 90%;
                margin-left: auto;
                margin-right: auto;
            }

            /* Item nav lebih terpusat */
            .app-nav ul li a {
                display: block;
                text-align: left;
                padding: 15px 25px;
            }

            /* Padding lebih besar, align kiri */
            .app-nav ul li a::before {
                display: none;
            }

            /* Hilangkan garis bawah di mobile nav */
            .app-nav ul li a.active {
                background-color: rgba(var(--primary-color-rgb), 0.15);
            }

            /* Latar lebih jelas untuk active */

            .nav-toggle {
                display: block;
            }

            /* Tampilkan hamburger */

            .header-actions .offcanvas-trigger-btn span {
                display: none;
            }

            /* Sembunyikan teks tombol Offcanvas */
            .header-actions .offcanvas-trigger-btn i {
                margin-right: 0;
            }

            .hero {
                padding: 60px 20px;
                min-height: 350px;
            }

            .hero h1 {
                font-size: 2.2rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .hero .cta-button {
                padding: 12px 25px;
                font-size: 1.1rem;
            }

            .property-listings,
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            /* Stack di layar kecil */

            .property-card__title {
                font-size: 1.4rem;
            }

            .property-card__price {
                font-size: 1.2rem;
            }

            .section-title {
                font-size: 1.8rem;
                margin-bottom: 25px;
                padding-bottom: 15px;
            }

            .section-title::after {
                width: 60px;
                height: 3px;
            }

            .theme-toggle,
            .offcanvas-trigger-btn {
                padding: 8px 12px;
            }

            .app-header .logo {
                font-size: 1.6rem;
            }

            .app-header .logo i {
                font-size: 1.3rem;
            }

            .notification-item {
                flex-direction: column;
                align-items: flex-start;
            }

            .notification-item__content {
                padding-right: 0;
                width: 100%;
            }

            .notification-item__timestamp {
                margin-left: 0;
                margin-top: 10px;
                padding-left: 0;
                font-size: 0.8em;
            }

            #toast-container {
                right: 10px;
                bottom: 10px;
                left: 10px;
                align-items: stretch;
            }

            .toast {
                max-width: none;
                min-width: auto;
            }

            /* Toast full width di mobile */

            .offcanvas-panel {
                max-width: 300px;
                right: -300px;
            }

            /* Panel samping sedikit lebih kecil */
        }

        @media (max-width: 480px) {

            /* Mobile kecil */
            .hero h1 {
                font-size: 1.8rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .hero .cta-button {
                font-size: 1rem;
                padding: 10px 20px;
            }

            .property-card__content {
                padding: 20px;
            }

            .dashboard-widget {
                padding: 20px;
            }

            .dashboard-widget h3 {
                font-size: 1.2rem;
            }

            .notification-item {
                padding: 15px;
            }

            .notification-item__message {
                font-size: 1rem;
            }

            .custom-alert-box {
                padding: 25px 20px;
            }

            /* Padding vertikal lebih besar dari horizontal */
            .custom-alert-box h3 {
                font-size: 1.4rem;
            }

            .custom-alert-box p {
                font-size: 1rem;
            }

            .custom-alert-actions {
                flex-direction: column;
                gap: 10px;
            }

            /* Tombol alert stack vertikal */
            .custom-alert-actions button {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <!-- Struktur Aplikasi Utama (Monolith HTML5 Semantik) -->
    <header class="app-header" role="banner">
        <a href="#home" class="logo nav-link" aria-label="Ke Halaman Utama Green Valley">
            <i class="fas fa-home-lg-alt" aria-hidden="true"></i> <!-- Icon rumah yang lebih modern -->
            GreenValley
        </a>
        <nav class="app-nav" id="appNavigation" role="navigation" aria-label="Navigasi Utama">
            <ul>
                <li><a href="#home" class="nav-link" aria-label="Navigasi ke Beranda"><i class="fas fa-home"
                            aria-hidden="true"></i>Beranda</a></li>
                <li><a href="#dashboard" class="nav-link" aria-label="Navigasi ke Dashboard Pemilik"><i
                            class="fas fa-tachometer-alt" aria-hidden="true"></i>Dashboard</a></li>
                <li><a href="#notifications" class="nav-link" aria-label="Navigasi ke Notifikasi"><i class="fas fa-bell"
                            aria-hidden="true"></i>Notifikasi <span class="badge" id="notif-badge"
                            style="display:none;"></span></a></li>
            </ul>
        </nav>
        <div class="header-actions">
            <button id="openOffcanvasBtn" class="offcanvas-trigger-btn" aria-label="Buka Panel Pengaturan"
                aria-haspopup="dialog">
                <i class="fas fa-cog" aria-hidden="true"></i>
                <span>Pengaturan</span>
            </button>
            <button id="themeToggle" class="theme-toggle" aria-label="Ganti Tema Warna" aria-live="polite">
                <i class="fas fa-moon" aria-hidden="true"></i>
                <span class="theme-toggle-text">Mode Gelap</span>
            </button>
            <button class="nav-toggle" id="navToggle" aria-label="Buka atau tutup navigasi" aria-expanded="false"
                aria-controls="appNavigation">
                <i class="fas fa-bars" aria-hidden="true"></i>
            </button>
        </div>
    </header>

    <!-- Container untuk Flash Messages (Pesan Global) -->
    <div id="flash-message-container" role="status" aria-live="assertive"></div>

    <main id="app-content" class="container" role="main">
        <!-- Placeholder loading awal -->
        <div class="loading-placeholder" style="text-align: center; padding: 50px;">
            <i class="fas fa-spinner fa-spin fa-3x" style="color: var(--primary-color);"></i>
            <p style="margin-top: 15px; font-size: 1.2rem; color: var(--text-color);">Memuat konten aplikasi...</p>
        </div>
    </main>

    <footer class="app-footer" role="contentinfo">
        <p>&copy; <span id="currentYear"></span> Green Valley Properties. Semua hak dilindungi undang-undang.</p>
        <div class="footer-links">
            <a href="#privacy-policy">Kebijakan Privasi</a>
            <a href="#terms-conditions">Syarat & Ketentuan</a>
            <a href="#contact-us">Hubungi Kami</a>
        </div>
    </footer>

    <!-- Container untuk Toast Notifications (Pesan Non-Blocking) -->
    <div id="toast-container" role="status" aria-live="polite"></div>

    <!-- Overlay dan Box untuk Custom Alert (Modal) -->
    <div id="custom-alert-overlay" class="custom-alert-overlay">
        <div id="custom-alert-box" class="custom-alert-box" role="alertdialog" aria-modal="true"
            aria-labelledby="custom-alert-title" aria-describedby="custom-alert-message">
            <h3 id="custom-alert-title">Pemberitahuan</h3>
            <p id="custom-alert-message">Ini adalah pesan alert standar.</p>
            <div class="custom-alert-actions">
                <button id="custom-alert-confirm-btn" class="custom-alert-confirm-btn">OK</button>
                <button id="custom-alert-cancel-btn" class="custom-alert-cancel-btn"
                    style="display:none;">Batal</button>
            </div>
        </div>
    </div>

    <!-- Overlay dan Panel untuk Off-Canvas (Panel Samping) -->
    <div id="offcanvas-overlay" class="offcanvas-overlay"></div>
    <div id="generic-offcanvas-panel" class="offcanvas-panel" role="dialog" aria-modal="true"
        aria-labelledby="offcanvas-title">
        <div class="offcanvas-header">
            <h3 id="offcanvas-title">Panel Samping</h3>
            <button id="offcanvas-close-btn" class="offcanvas-close-btn"
                aria-label="Tutup panel samping">&times;</button>
        </div>
        <div id="offcanvas-panel-content" class="offcanvas-content">
            <p>Konten untuk panel samping akan muncul di sini. Anda bisa menambahkan form, link, atau informasi lainnya.
            </p>
        </div>
    </div>


    <!-- TEMPLATES HTML UNTUK KONTEN DINAMIS (KONSEP KOMPONEN SPA) -->
    <template id="home-page-template">
        <section class="hero fade-in">
            <h1>Temukan Hunian Impian Anda</h1>
            <p>Apartemen modern, nyaman, dan berlokasi strategis di jantung Green Valley. Kualitas hidup terbaik menanti
                Anda dengan desain yang memanjakan mata.</p>
            <a href="#properties" class="cta-button nav-link">Lihat Properti Unggulan <i class="fas fa-arrow-right"
                    aria-hidden="true"></i></a>
        </section>
        <section id="properties" class="fade-in" style="animation-delay: 0.2s;">
            <h2 class="section-title">Properti Unggulan Kami</h2>
            <div class="property-listings">
                <!-- Kartu properti akan dirender di sini oleh JavaScript -->
            </div>
        </section>
    </template>

    <template id="property-card-template">
        <article class="property-card" tabindex="0" aria-labelledby="property-title-{id}">
            <div class="property-card__image-wrapper">
                <img src="" alt="Gambar Properti" class="property-card__image">
            </div>
            <div class="property-card__content">
                <h3 class="property-card__title" id="property-title-{id}"></h3>
                <p class="property-card__price"></p>
                <p class="property-card__description"></p>
                <button class="property-card__button" data-property-id="">
                    Lihat Detail <i class="fas fa-info-circle" aria-hidden="true"></i>
                </button>
            </div>
        </article>
    </template>

    <template id="dashboard-page-template">
        <section class="dashboard-owner fade-in">
            <h2 class="section-title">Dashboard Analitik Pemilik</h2>
            <div class="dashboard-grid">
                <div class="dashboard-widget">
                    <h3><i class="fas fa-home-user" aria-hidden="true"></i>Properti Saya</h3>
                    <ul id="dashboard-property-list">
                        <!-- Daftar properti pemilik akan dirender di sini -->
                    </ul>
                </div>
                <div class="dashboard-widget">
                    <h3><i class="fas fa-chart-line" aria-hidden="true"></i>Laporan Pendapatan (Simulasi)</h3>
                    <p>Total Estimasi Pendapatan (Bulan Ini): <span class="highlight" id="dashboard-total-income">Rp
                            0</span></p>
                    <p>Jumlah Properti Tersewa: <span class="highlight" id="dashboard-rented-count">0</span> dari <span
                            id="dashboard-total-properties">0</span></p>
                    <p>Okupansi Rata-rata: <span class="highlight" id="dashboard-occupancy-rate">0%</span></p>
                </div>
                <div class="dashboard-widget quick-actions">
                    <h3><i class="fas fa-tasks" aria-hidden="true"></i>Manajemen Cepat</h3>
                    <button class="property-card__button" aria-label="Tambah Properti Baru (Fitur Simulasi)"
                        id="addPropertyBtn"><i class="fas fa-plus-circle" aria-hidden="true"></i> Tambah
                        Properti</button>
                    <button class="property-card__button" aria-label="Lihat Semua Transaksi Keuangan (Fitur Simulasi)"
                        id="viewTransactionsBtn"><i class="fas fa-file-invoice-dollar" aria-hidden="true"></i> Lihat
                        Transaksi</button>
                </div>
            </div>
        </section>
    </template>

    <template id="notifications-page-template">
        <section class="notifications fade-in">
            <h2 class="section-title">Pusat Notifikasi</h2>
            <ul class="notification-list" id="notification-items-container">
                <!-- Item notifikasi akan dirender di sini -->
            </ul>
        </section>
    </template>

    <template id="notification-item-template">
        <li class="notification-item" tabindex="0">
            <div class="notification-item__content">
                <p class="notification-item__message"></p>
                <div class="notification-item__meta">
                    <span class="notification-item__type-badge"></span>
                </div>
            </div>
            <span class="notification-item__timestamp"></span>
        </li>
    </template>

    <template id="empty-state-template">
        <div class="empty-state">
            <i class="fas fa-folder-open" aria-hidden="true"></i>
            <p class="empty-state-message">Saat ini tidak ada data untuk ditampilkan di sini.</p>
        </div>
    </template>


    <script>
        // --- DATA DUMMY (Untuk Simulasi Aplikasi Nyata) ---
        const DUMMY_PROPERTIES_DATA = [
            { id: "prop001", title: "Apartemen Studio Elegan - City View", price: "Rp 5.500.000/bulan", description: "Studio modern fully-furnished dengan pemandangan kota yang menakjubkan. Ideal untuk profesional muda yang dinamis dan menghargai kenyamanan.", image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8NHx8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=600&q=80", ownerId: 101, features: ["1 Kamar Tidur", "1 Kamar Mandi", "45m²", "Full Furnished", "Balkon"] },
            { id: "prop002", title: "Apartemen Keluarga 2 Kamar Tidur Premium", price: "Rp 12.500.000/bulan", description: "Hunian luas dan nyaman, fasilitas lengkap, dekat sekolah internasional dan pusat perbelanjaan ternama. Sempurna untuk keluarga kecil.", image: "https://images.unsplash.com/photo-1616594039964-ae9021a400a0?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGFwYXJ0bWVudHxlbnwwfHwwfHx8MA&auto=format&fit=crop&w=600&q=80", ownerId: 101, features: ["2 Kamar Tidur", "2 Kamar Mandi", "90m²", "Dapur Modern", "Kolam Renang Akses"] },
            { id: "prop003", title: "Penthouse Eksklusif Green Valley Panorama", price: "Rp 28.000.000/bulan", description: "Nikmati pemandangan 360 derajat kota, fasilitas privat, lift pribadi, dan desain interior mewah nan kustom. Kehidupan mewah di puncaknya.", image: "https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8Nnx8YXBhcnRtZW50fGVufDB8fDB8fHww&auto=format&fit=crop&w=600&q=80", ownerId: 102, features: ["3 Kamar Tidur", "3 Kamar Mandi", "220m²", "Private Pool", "Sky Garden", "Lift Pribadi"] },
            { id: "prop004", title: "Apartemen Compact & Fungsional Urban Living", price: "Rp 4.800.000/bulan", description: "Desain minimalis modern yang efisien, memaksimalkan ruang. Pilihan tepat untuk mahasiswa atau pekerja kantoran yang mencari kepraktisan.", image: "https://images.unsplash.com/photo-1484154218962-a197022b5858?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTJ8fGFwYXJ0bWVudCUyMGludGVyaW9yfGVufDB8fDB8fHww&auto=format&fit=crop&w=600&q=80", ownerId: 101, features: ["1 Kamar Tidur", "1 Kamar Mandi", "35m²", "Smart Home Ready"] }
        ];

        const DUMMY_NOTIFICATIONS_DATA = [
            { id: "notif001", message: "Pembayaran sewa untuk 'Apartemen Studio Elegan' telah dikonfirmasi oleh sistem.", timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString(), unread: true, type: "Pembayaran", targetRole: "Pemilik" }, // 2 jam lalu
            { id: "notif002", message: "Permintaan perbaikan unit AC di 'Apartemen Keluarga 2 Kamar'. Mohon segera ditindaklanjuti oleh tim maintenance.", timestamp: new Date(Date.now() - 20 * 60 * 60 * 1000).toISOString(), unread: false, type: "Perbaikan", targetRole: "Pemilik" }, // 20 jam lalu
            { id: "notif003", message: "Jadwal pemeliharaan lift gedung B akan dilaksanakan pada 30 Juli 2024, pukul 09:00-12:00 WIB. Mohon maaf atas ketidaknyamanannya.", timestamp: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(), unread: true, type: "Info Umum", targetRole: "Semua" }, // 2 hari lalu
            { id: "notif004", message: "Selamat! Properti Anda 'Penthouse Eksklusif' telah dilihat 125 kali minggu ini. Pertimbangkan untuk memperbarui foto galeri.", timestamp: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(), unread: false, type: "Statistik", targetRole: "Pemilik" }, // 3 hari lalu
            { id: "notif005", message: "Ada pesan baru dari calon penyewa untuk 'Apartemen Compact'. Segera periksa kotak masuk Anda.", timestamp: new Date(Date.now() - 5 * 60 * 1000).toISOString(), unread: true, type: "Pesan", targetRole: "Pemilik" } // 5 menit lalu
        ];

        // --- KONFIGURASI APLIKASI & STATE GLOBAL ---
        const AppState = {
            currentOwnerId: 101, // ID pemilik yang sedang login (simulasi)
            currentUserRole: "Pemilik", // Peran pengguna saat ini (Pemilik, Penyewa, Admin - untuk simulasi)
            theme: localStorage.getItem('greenValleyTheme') || 'light', // Ambil tema dari localStorage atau default 'light'
            activeRoute: '', // Menyimpan rute yang sedang aktif
            unreadNotificationsCount: 0,
        };

        // --- REFERENSI ELEMEN DOM UTAMA (Cache untuk Performa) ---
        const DOM = {
            appContent: document.getElementById('app-content'),
            themeToggleButton: document.getElementById('themeToggle'),
            themeToggleText: document.querySelector('#themeToggle .theme-toggle-text'),
            themeToggleIcon: document.querySelector('#themeToggle i'),
            navLinks: document.querySelectorAll('.app-header .nav-link'), // Termasuk logo sebagai nav-link
            appNavigation: document.getElementById('appNavigation'),
            navToggle: document.getElementById('navToggle'),
            currentYearSpan: document.getElementById('currentYear'),
            loadingPlaceholder: document.querySelector('.loading-placeholder'),
            toastContainer: document.getElementById('toast-container'),
            flashMessageContainer: document.getElementById('flash-message-container'),
            customAlertOverlay: document.getElementById('custom-alert-overlay'),
            customAlertBox: document.getElementById('custom-alert-box'),
            customAlertTitle: document.getElementById('custom-alert-title'),
            customAlertMessage: document.getElementById('custom-alert-message'),
            customAlertConfirmBtn: document.getElementById('custom-alert-confirm-btn'),
            customAlertCancelBtn: document.getElementById('custom-alert-cancel-btn'),
            offcanvasPanel: document.getElementById('generic-offcanvas-panel'),
            offcanvasOverlay: document.getElementById('offcanvas-overlay'),
            offcanvasTitle: document.getElementById('offcanvas-title'),
            offcanvasContent: document.getElementById('offcanvas-panel-content'),
            offcanvasCloseBtn: document.getElementById('offcanvas-close-btn'),
            openOffcanvasBtn: document.getElementById('openOffcanvasBtn'),
            notifBadge: document.getElementById('notif-badge'),
        };

        // --- FUNGSI UTILITAS (Pembantu Umum & UI Manager) ---
        const Utils = {
            /** Membersihkan konten utama aplikasi. */
            clearAppContent: function () {
                if (DOM.appContent) DOM.appContent.innerHTML = '';
            },

            /** Menandai link navigasi yang aktif. */
            setActiveNavLink: function (currentHash) {
                const targetHash = currentHash || '#home'; // Default ke #home jika hash kosong
                DOM.navLinks.forEach(link => {
                    link.classList.remove('active');
                    link.removeAttribute('aria-current');
                    if (link.getAttribute('href') === targetHash) {
                        link.classList.add('active');
                        link.setAttribute('aria-current', 'page'); // Aksesibilitas: tandai halaman saat ini
                    }
                });
                // Tutup navigasi mobile jika terbuka setelah link diklik
                if (DOM.appNavigation.classList.contains('active')) {
                    MobileNavManager.toggleMobileNav();
                }
            },

            /** Mengupdate variabel CSS --primary-color-rgb berdasarkan tema saat ini. */
            updatePrimaryColorRGBVariable: function () {
                try {
                    const computedPrimaryColor = getComputedStyle(document.documentElement).getPropertyValue('--primary-color').trim();
                    let r = 0, g = 0, b = 0;
                    if (computedPrimaryColor.startsWith('#')) { // Handle format HEX
                        const hex = computedPrimaryColor.replace('#', '');
                        r = parseInt(hex.substring(0, 2), 16);
                        g = parseInt(hex.substring(2, 4), 16);
                        b = parseInt(hex.substring(4, 6), 16);
                    } else if (computedPrimaryColor.startsWith('rgb')) { // Handle format RGB
                        const parts = computedPrimaryColor.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);
                        if (parts) { [, r, g, b] = parts.map(Number); }
                    } else { // Fallback jika format tidak dikenal (seharusnya tidak terjadi dengan CSS kita)
                        const fallbackRgb = document.body.classList.contains('dark-theme') ? '102, 187, 106' : '46, 125, 50';
                        [r, g, b] = fallbackRgb.split(',').map(Number);
                        console.warn("Format warna primer tidak dikenali, menggunakan fallback RGB.");
                    }
                    document.documentElement.style.setProperty('--primary-color-rgb', `${r}, ${g}, ${b}`);
                } catch (error) {
                    console.error("Gagal mengupdate variabel --primary-color-rgb:", error);
                    // Set fallback aman jika terjadi error
                    const fallbackRgb = document.body.classList.contains('dark-theme') ? '102, 187, 106' : '46, 125, 50';
                    document.documentElement.style.setProperty('--primary-color-rgb', fallbackRgb);
                }
            },

            /** Memformat tanggal menjadi format Indonesia yang mudah dibaca. */
            formatDate: function (dateInput) {
                if (!dateInput) return "Tanggal tidak valid";
                try {
                    const date = new Date(dateInput);
                    return date.toLocaleDateString('id-ID', {
                        day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: false
                    }) + " WIB";
                } catch (error) {
                    console.error("Error memformat tanggal:", dateInput, error);
                    return "Format tanggal error";
                }
            },

            /** Merender tampilan 'kosong' jika tidak ada data. */
            renderEmptyState: function (container, message = "Saat ini tidak ada item untuk ditampilkan.") {
                const template = document.getElementById('empty-state-template');
                if (!template) {
                    console.error("Template 'empty-state-template' tidak ditemukan.");
                    container.innerHTML = `<p>${message}</p>`; // Fallback sederhana
                    return;
                }
                const emptyStateNode = template.content.cloneNode(true);
                const messageElement = emptyStateNode.querySelector('.empty-state-message');
                if (messageElement) messageElement.textContent = message;
                container.appendChild(emptyStateNode);
            },

            /** Menerapkan animasi sederhana ke elemen. */
            animateElement: function (element, animationClass = 'fade-in', delay = 0) {
                if (element && typeof element.classList !== 'undefined') {
                    element.style.animationDelay = `${delay}s`;
                    element.classList.add(animationClass);
                    // Hapus class animasi setelah selesai agar bisa di-trigger lagi jika perlu
                    element.addEventListener('animationend', () => {
                        element.classList.remove(animationClass);
                        element.style.animationDelay = ''; // Reset delay
                    }, { once: true });
                } else {
                    console.warn("Elemen tidak valid untuk animasi:", element);
                }
            },

            // --- TOAST NOTIFICATION SYSTEM ---
            /** Menampilkan notifikasi toast. */
            showToast: function (message, type = 'info', durationVisible = 3500) {
                // durationVisible: how long the toast stays visible before starting to fade out.
                // Default: 3.5s visible, 0.5s fade-out = 4s total.
                if (!DOM.toastContainer) return;

                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.setAttribute('role', 'status');
                toast.setAttribute('aria-live', 'polite');

                const iconClass = {
                    info: 'fas fa-info-circle', success: 'fas fa-check-circle',
                    error: 'fas fa-times-circle', warning: 'fas fa-exclamation-triangle'
                }[type] || 'fas fa-info-circle';

                toast.innerHTML = `
                    <i class="toast-icon ${iconClass}" aria-hidden="true"></i>
                    <span class="toast-message">${message}</span>
                    <button class="toast-close-btn" aria-label="Tutup Notifikasi Toast">×</button>
                `;
                DOM.toastContainer.appendChild(toast);

                const fadeInAnimationDurationMs = 500; // Matches toastInRight duration
                const fadeOutAnimationName = 'toastOutRight';
                const fadeOutAnimationDurationMs = 500; // Matches toastOutRight duration

                // 1. Animate In
                toast.style.animation = `toastInRight ${fadeInAnimationDurationMs / 1000}s cubic-bezier(0.25, 0.8, 0.25, 1) forwards`;

                let domRemovalTimer;
                let isBeingRemoved = false;

                const finalRemoveToastElement = () => {
                    if (toast.parentElement) {
                        toast.remove();
                    }
                    isBeingRemoved = true; // Mark as removed to prevent multiple calls
                };

                const startFadeOutAndRemove = () => {
                    if (isBeingRemoved || !toast.parentElement) return; // Already handled or detached

                    // Clear any pending auto-dismiss timer
                    clearTimeout(domRemovalTimer);
                    isBeingRemoved = true; // Prevent re-triggering fade-out

                    toast.style.animation = `${fadeOutAnimationName} ${fadeOutAnimationDurationMs / 1000}s cubic-bezier(0.25, 0.8, 0.25, 1) forwards`;

                    toast.addEventListener('animationend', (e) => {
                        if (e.animationName === fadeOutAnimationName) {
                            finalRemoveToastElement();
                        }
                    }, { once: true });

                    // Fallback: In case animationend doesn't fire
                    setTimeout(finalRemoveToastElement, fadeOutAnimationDurationMs + 100);
                };

                // 2. Set timer for auto-dismissal (starts fade-out after durationVisible)
                // This timer will be cleared if the close button is clicked.
                domRemovalTimer = setTimeout(startFadeOutAndRemove, durationVisible);

                // 3. Handle close button
                const closeBtn = toast.querySelector('.toast-close-btn');
                if (closeBtn) {
                    closeBtn.addEventListener('click', startFadeOutAndRemove);
                }
            },

            // --- CUSTOM ALERT SYSTEM (MODAL) ---
            _currentAlertResolve: null, // Untuk menyimpan fungsi resolve dari Promise
            /** Menampilkan custom alert modal. Mengembalikan Promise. */
            showAlert: function (title, message, options = {}) {
                return new Promise((resolve) => {
                    Utils._currentAlertResolve = resolve; // Simpan resolve untuk dipakai di handler tombol
                    if (DOM.customAlertTitle) DOM.customAlertTitle.textContent = title;
                    if (DOM.customAlertMessage) DOM.customAlertMessage.innerHTML = message; // Izinkan HTML sederhana untuk format

                    if (DOM.customAlertConfirmBtn) {
                        DOM.customAlertConfirmBtn.textContent = options.confirmButtonText || 'OK';
                        DOM.customAlertConfirmBtn.style.display = 'inline-block';
                        // Fokus pada tombol konfirmasi secara default
                        setTimeout(() => DOM.customAlertConfirmBtn.focus(), 100); // Sedikit delay agar transisi selesai
                    }

                    if (DOM.customAlertCancelBtn) {
                        if (options.showCancelButton) {
                            DOM.customAlertCancelBtn.textContent = options.cancelButtonText || 'Batal';
                            DOM.customAlertCancelBtn.style.display = 'inline-block';
                        } else {
                            DOM.customAlertCancelBtn.style.display = 'none';
                        }
                    }
                    if (DOM.customAlertOverlay) DOM.customAlertOverlay.classList.add('visible');
                    document.body.style.overflow = 'hidden'; // Cegah scroll background
                });
            },
            /** Handler untuk tombol konfirmasi alert. */
            _handleAlertConfirm: function () {
                if (Utils._currentAlertResolve) Utils._currentAlertResolve(true);
                Utils._closeAlert();
            },
            /** Handler untuk tombol batal alert. */
            _handleAlertCancel: function () {
                if (Utils._currentAlertResolve) Utils._currentAlertResolve(false);
                Utils._closeAlert();
            },
            /** Fungsi internal untuk menutup alert. */
            _closeAlert: function () {
                if (DOM.customAlertOverlay) DOM.customAlertOverlay.classList.remove('visible');
                Utils._currentAlertResolve = null;
                document.body.style.overflow = ''; // Kembalikan scroll background
            },

            // --- FLASH MESSAGE SYSTEM ---
            /** Menampilkan flash message di bawah header. */
            showFlashMessage: function (message, type = 'info', autoDismissDelay = 5000) {
                // autoDismissDelay is total time including fade in/out.
                // CSS animation handles: 0.5s fadein, (autoDismissDelay - 1s) visible, 0.5s fadeout.
                if (!DOM.flashMessageContainer) return;
                DOM.flashMessageContainer.innerHTML = ''; // Hapus pesan flash sebelumnya

                const flashDiv = document.createElement('div');
                flashDiv.className = `flash-message ${type}`;
                flashDiv.setAttribute('role', 'alert'); // Peran untuk aksesibilitas
                flashDiv.innerHTML = `
                    <span>${message}</span>
                    <button class="close-btn" aria-label="Tutup pesan flash">×</button>
                `;

                // Dynamically set animation delays based on autoDismissDelay
                const fadeInDuration = 0.5;
                const fadeOutDuration = 0.5;
                const visibleDuration = (autoDismissDelay / 1000) - fadeInDuration - fadeOutDuration;

                if (visibleDuration > 0) {
                    flashDiv.style.animation = `fadeInDown ${fadeInDuration}s ease-out, fadeOutUp ${fadeOutDuration}s ease-out ${fadeInDuration + visibleDuration}s forwards`;
                } else { // If total duration is too short, just fade in and out quickly
                    flashDiv.style.animation = `fadeInDown ${fadeInDuration}s ease-out, fadeOutUp ${fadeOutDuration}s ease-out ${fadeInDuration}s forwards`;
                }

                DOM.flashMessageContainer.appendChild(flashDiv);

                const removeFlash = () => {
                    // Ensure fadeOutUp animation is triggered if not already done by CSS auto-dismiss
                    if (getComputedStyle(flashDiv).animationName.includes('fadeOutUp')) {
                        // If already fading out, just wait for it to remove
                        flashDiv.addEventListener('animationend', () => {
                            if (flashDiv.parentElement) flashDiv.remove();
                        }, { once: true });
                    } else {
                        flashDiv.style.animation = `fadeOutUp ${fadeOutDuration}s ease-out forwards`;
                        flashDiv.addEventListener('animationend', () => {
                            if (flashDiv.parentElement) flashDiv.remove();
                        }, { once: true });
                    }
                };

                const closeFlashBtn = flashDiv.querySelector('.close-btn');
                if (closeFlashBtn) {
                    closeFlashBtn.addEventListener('click', () => {
                        // Clear existing animation to start fadeOut immediately
                        flashDiv.style.animation = '';
                        removeFlash();
                    });
                }

                // Fallback timer to ensure removal, slightly after CSS animation should have completed
                setTimeout(() => {
                    if (flashDiv.parentElement) {
                        // Check if it's still there and not already fading out due to manual close
                        if (getComputedStyle(flashDiv).opacity !== "0") {
                            removeFlash(); // This will trigger fadeOut if not already
                        } else if (flashDiv.parentElement) { // If it's opacity 0 but not removed
                            flashDiv.remove();
                        }
                    }
                }, autoDismissDelay + 200); // A bit longer to ensure CSS animation has time
            },

            // --- OFF-CANVAS PANEL SYSTEM ---
            /** Membuka panel off-canvas. */
            openOffcanvas: function (title, contentHTML) {
                if (!DOM.offcanvasPanel || !DOM.offcanvasOverlay) return;
                if (DOM.offcanvasTitle) DOM.offcanvasTitle.textContent = title;
                if (DOM.offcanvasContent) DOM.offcanvasContent.innerHTML = contentHTML;

                DOM.offcanvasPanel.classList.add('open');
                DOM.offcanvasOverlay.classList.add('visible');
                // Fokus pada tombol close di dalam offcanvas untuk aksesibilitas
                setTimeout(() => { if (DOM.offcanvasCloseBtn) DOM.offcanvasCloseBtn.focus(); }, 100);
                document.body.style.overflow = 'hidden'; // Cegah scroll background
            },
            /** Menutup panel off-canvas. */
            closeOffcanvas: function () {
                if (!DOM.offcanvasPanel || !DOM.offcanvasOverlay) return;
                DOM.offcanvasPanel.classList.remove('open');
                DOM.offcanvasOverlay.classList.remove('visible');
                document.body.style.overflow = ''; // Kembalikan scroll background
                // Kembalikan fokus ke tombol yang membuka offcanvas
                if (DOM.openOffcanvasBtn) DOM.openOffcanvasBtn.focus();
            },

            /** Memperbarui badge notifikasi. */
            updateNotificationBadge: function () {
                AppState.unreadNotificationsCount = DUMMY_NOTIFICATIONS_DATA.filter(n =>
                    n.unread && (n.targetRole === "Semua" || n.targetRole === AppState.currentUserRole)
                ).length;

                if (DOM.notifBadge) {
                    if (AppState.unreadNotificationsCount > 0) {
                        DOM.notifBadge.textContent = AppState.unreadNotificationsCount > 9 ? '9+' : AppState.unreadNotificationsCount;
                        DOM.notifBadge.style.display = 'inline-block'; // Tampilkan badge
                        DOM.notifBadge.style.padding = '2px 6px';
                        DOM.notifBadge.style.fontSize = '0.7em';
                        DOM.notifBadge.style.backgroundColor = 'var(--error-color)';
                        DOM.notifBadge.style.color = 'white';
                        DOM.notifBadge.style.borderRadius = '10px';
                        DOM.notifBadge.style.marginLeft = '5px';
                        DOM.notifBadge.style.fontWeight = 'bold';

                    } else {
                        DOM.notifBadge.style.display = 'none'; // Sembunyikan badge
                    }
                }
            }
        };


        // --- FUNGSI PEMBUATAN KOMPONEN (Dari Template HTML) ---
        const ComponentFactory = {
            /** Membuat kartu properti dari template. */
            createPropertyCard: function (property) {
                const template = document.getElementById('property-card-template');
                if (!template) { console.error("Template 'property-card-template' tidak ditemukan."); return document.createDocumentFragment(); }

                const cardFragment = template.content.cloneNode(true);
                const cardElement = cardFragment.querySelector('.property-card');
                const titleElement = cardFragment.querySelector('.property-card__title');
                const imageElement = cardFragment.querySelector('.property-card__image');
                const priceElement = cardFragment.querySelector('.property-card__price');
                const descElement = cardFragment.querySelector('.property-card__description');
                const detailButton = cardFragment.querySelector('.property-card__button');

                if (cardElement) cardElement.setAttribute('aria-labelledby', `property-title-${property.id}`);
                if (titleElement) {
                    titleElement.id = `property-title-${property.id}`;
                    titleElement.textContent = property.title;
                }
                if (imageElement) {
                    imageElement.src = property.image;
                    imageElement.alt = `Pemandangan eksterior ${property.title}`; // Alt text lebih deskriptif
                }
                if (priceElement) priceElement.textContent = property.price;
                if (descElement) descElement.textContent = property.description;

                if (detailButton) {
                    detailButton.dataset.propertyId = property.id;
                    detailButton.setAttribute('aria-label', `Lihat detail lengkap untuk ${property.title}`);
                    detailButton.addEventListener('click', async () => {
                        const propertyFeatures = property.features ? `<li>${property.features.join('</li><li>')}</li>` : 'Tidak ada fitur tercantum.';
                        const propertyDetailsHTML = `
                            <p style="text-align:left; margin-bottom: 15px;"><strong>Harga:</strong> ${property.price}</p>
                            <p style="text-align:left; margin-bottom: 15px;"><strong>Deskripsi:</strong> ${property.description}</p>
                            <p style="text-align:left; margin-bottom: 5px;"><strong>Fitur Utama:</strong></p>
                            <ul style="text-align:left; list-style-position: inside; margin-left: 10px; margin-bottom: 20px;">${propertyFeatures}</ul>
                        `;
                        const userChoice = await Utils.showAlert(
                            `Detail Properti: ${property.title}`,
                            propertyDetailsHTML,
                            { confirmButtonText: "Hubungi Agen", showCancelButton: true, cancelButtonText: "Tutup Detail" }
                        );
                        if (userChoice) { // Jika pengguna klik "Hubungi Agen"
                            Utils.showToast(`Anda memilih untuk menghubungi agen mengenai ${property.title}. (Fitur simulasi, akan diarahkan ke form kontak)`, 'info', 6000);
                            // Simulasi: window.location.hash = '#contact-us';
                        }
                    });
                }
                return cardFragment;
            },

            /** Membuat item notifikasi dari template. */
            createNotificationItem: function (notification) {
                const template = document.getElementById('notification-item-template');
                if (!template) { console.error("Template 'notification-item-template' tidak ditemukan."); return document.createDocumentFragment(); }

                const itemFragment = template.content.cloneNode(true);
                const itemElement = itemFragment.querySelector('.notification-item');
                const messageElement = itemFragment.querySelector('.notification-item__message');
                const typeBadgeElement = itemFragment.querySelector('.notification-item__type-badge');
                const timestampElement = itemFragment.querySelector('.notification-item__timestamp');

                if (itemElement) {
                    if (notification.unread) {
                        itemElement.classList.add('unread');
                        itemElement.setAttribute('aria-live', 'polite'); // Beritahu screen reader jika ada notif baru
                    }
                    itemElement.setAttribute('aria-label', `Notifikasi ${notification.unread ? 'belum dibaca' : 'telah dibaca'}: ${notification.message}, tipe: ${notification.type}, waktu: ${Utils.formatDate(notification.timestamp)}`);
                    itemElement.addEventListener('click', () => { // Tandai sebagai terbaca saat diklik
                        if (notification.unread) {
                            notification.unread = false;
                            itemElement.classList.remove('unread');
                            itemElement.removeAttribute('aria-live');
                            Utils.updateNotificationBadge();
                            Utils.showToast(`Notifikasi "${notification.type}" ditandai terbaca.`, 'info', 2500);
                        }
                    });
                }
                if (messageElement) messageElement.textContent = notification.message;
                if (typeBadgeElement) typeBadgeElement.textContent = notification.type;
                if (timestampElement) timestampElement.textContent = Utils.formatDate(notification.timestamp);

                return itemFragment;
            }
        };

        // --- FUNGSI RENDER HALAMAN (Kontroler Tampilan untuk SPA) ---
        const PageRenderer = {
            renderHomePage: function () {
                Utils.clearAppContent();
                const template = document.getElementById('home-page-template');
                if (!template) { Utils.renderEmptyState(DOM.appContent, "Halaman Beranda tidak dapat dimuat."); return; }

                const homePageNode = template.content.cloneNode(true);
                const propertyListingsContainer = homePageNode.querySelector('.property-listings');

                if (propertyListingsContainer) {
                    if (DUMMY_PROPERTIES_DATA.length === 0) {
                        Utils.renderEmptyState(propertyListingsContainer, "Belum ada properti unggulan yang tersedia saat ini. Silakan cek kembali nanti.");
                    } else {
                        // Tampilkan hanya 3 properti unggulan di beranda untuk contoh
                        DUMMY_PROPERTIES_DATA.slice(0, 3).forEach(property => {
                            const cardFragment = ComponentFactory.createPropertyCard(property);
                            propertyListingsContainer.appendChild(cardFragment);
                        });
                    }
                }
                DOM.appContent.appendChild(homePageNode);
                // Animasikan elemen utama halaman
                Utils.animateElement(DOM.appContent.querySelector('.hero'));
                Utils.animateElement(DOM.appContent.querySelector('#properties'), 'fade-in', 0.2);

                Utils.showFlashMessage('Selamat datang di Green Valley! Temukan hunian impian Anda dengan mudah dan nyaman.', 'success');
                document.title = "Green Valley - Hunian Modern & Strategis | Beranda";
            },

            renderDashboardPage: function () {
                Utils.clearAppContent();
                const template = document.getElementById('dashboard-page-template');
                if (!template) { Utils.renderEmptyState(DOM.appContent, "Halaman Dashboard tidak dapat dimuat."); return; }

                const dashboardNode = template.content.cloneNode(true);
                const propertyListUl = dashboardNode.querySelector('#dashboard-property-list');
                const totalIncomeEl = dashboardNode.querySelector('#dashboard-total-income');
                const rentedCountEl = dashboardNode.querySelector('#dashboard-rented-count');
                const totalPropertiesEl = dashboardNode.querySelector('#dashboard-total-properties');
                const occupancyRateEl = dashboardNode.querySelector('#dashboard-occupancy-rate');

                let ownerPropertiesCount = 0;
                let totalSimulatedIncome = 0;
                let rentedSimulatedCount = 0;
                const ownerProperties = DUMMY_PROPERTIES_DATA.filter(p => p.ownerId === AppState.currentOwnerId);

                if (propertyListUl) {
                    if (ownerProperties.length === 0) {
                        Utils.renderEmptyState(propertyListUl, "Anda belum memiliki properti terdaftar di sistem kami.");
                    } else {
                        ownerProperties.forEach(property => {
                            const li = document.createElement('li');
                            li.innerHTML = `<i class="fas fa-check-circle" style="color:var(--secondary-color); margin-right: 8px;" aria-hidden="true"></i>${property.title} - <span style="font-style:italic; opacity:0.8;">Status: Tersedia (Simulasi)</span>`;
                            propertyListUl.appendChild(li);
                            ownerPropertiesCount++;
                            // Simulasi properti tersewa dan pendapatan
                            if (Math.random() > 0.4) { // 60% kemungkinan tersewa
                                totalSimulatedIncome += parseFloat(property.price.replace(/[^0-9.-]+/g, '')) || 0;
                                rentedSimulatedCount++;
                            }
                        });
                    }
                }

                if (totalIncomeEl) totalIncomeEl.textContent = `Rp ${totalSimulatedIncome.toLocaleString('id-ID')},-`;
                if (rentedCountEl) rentedCountEl.textContent = rentedSimulatedCount;
                if (totalPropertiesEl) totalPropertiesEl.textContent = ownerPropertiesCount;
                const occupancy = ownerPropertiesCount > 0 ? (rentedSimulatedCount / ownerPropertiesCount * 100) : 0;
                if (occupancyRateEl) occupancyRateEl.textContent = `${occupancy.toFixed(1)}%`;

                DOM.appContent.appendChild(dashboardNode);
                Utils.animateElement(DOM.appContent.querySelector('.dashboard-owner'));
                Utils.showToast('Dashboard analitik berhasil dimuat.', 'success', 3000);
                document.title = "Green Valley - Dashboard Pemilik";

                // Event listener untuk tombol di dashboard
                const addPropertyBtn = DOM.appContent.querySelector('#addPropertyBtn');
                const viewTransactionsBtn = DOM.appContent.querySelector('#viewTransactionsBtn');

                if (addPropertyBtn) {
                    addPropertyBtn.addEventListener('click', async () => {
                        const confirmed = await Utils.showAlert('Tambah Properti Baru', 'Fitur ini sedang dalam tahap pengembangan dan akan segera tersedia. Apakah Anda ingin mendapatkan notifikasi saat fitur ini siap?', { showCancelButton: true, confirmButtonText: "Ya, Notifikasi Saya", cancelButtonText: "Tidak Sekarang" });
                        if (confirmed) {
                            Utils.showToast('Terima kasih! Anda akan dinotifikasi. (Simulasi)', 'info', 4000);
                        }
                    });
                }
                if (viewTransactionsBtn) {
                    viewTransactionsBtn.addEventListener('click', () => {
                        Utils.showToast('Membuka halaman detail transaksi... (Simulasi, fitur dalam pengembangan)', 'info', 4000);
                    });
                }
            },

            renderNotificationsPage: function () {
                Utils.clearAppContent();
                const template = document.getElementById('notifications-page-template');
                if (!template) { Utils.renderEmptyState(DOM.appContent, "Halaman Notifikasi tidak dapat dimuat."); return; }

                const notificationsNode = template.content.cloneNode(true);
                const notificationsContainer = notificationsNode.querySelector('#notification-items-container');

                if (notificationsContainer) {
                    const relevantNotifications = DUMMY_NOTIFICATIONS_DATA.filter(n =>
                        n.targetRole === "Semua" || n.targetRole === AppState.currentUserRole
                    );

                    if (relevantNotifications.length === 0) {
                        Utils.renderEmptyState(notificationsContainer, "Hore! Tidak ada notifikasi baru untuk Anda saat ini.");
                    } else {
                        relevantNotifications
                            .sort((a, b) => new Date(b.timestamp).getTime() - new Date(a.timestamp).getTime()) // Urutkan dari terbaru
                            .forEach(notification => {
                                const itemFragment = ComponentFactory.createNotificationItem(notification);
                                notificationsContainer.appendChild(itemFragment);
                            });
                    }
                }
                DOM.appContent.appendChild(notificationsNode);
                Utils.animateElement(DOM.appContent.querySelector('.notifications'));
                document.title = "Green Valley - Pusat Notifikasi";
            },
            renderGenericPage: function (pageId, title, content) {
                Utils.clearAppContent();
                const section = document.createElement('section');
                section.className = 'fade-in';
                section.innerHTML = `
                    <h2 class="section-title">${title}</h2>
                    <div style="background-color: var(--card-bg-color); padding: 30px; border-radius: var(--border-radius); box-shadow: var(--box-shadow-light);">
                        ${content}
                    </div>
                `;
                DOM.appContent.appendChild(section);
                document.title = `Green Valley - ${title}`;
            }
        };

        // --- ROUTER SEDERHANA (Logika Navigasi SPA) ---
        const Router = {
            routes: {
                '#home': PageRenderer.renderHomePage,
                '#dashboard': PageRenderer.renderDashboardPage,
                '#notifications': PageRenderer.renderNotificationsPage,
                '#properties': () => {
                    if (AppState.activeRoute !== '#home') {
                        window.location.hash = '#home';
                        setTimeout(() => {
                            const propertiesSection = document.getElementById('properties');
                            if (propertiesSection) propertiesSection.scrollIntoView({ behavior: 'smooth' });
                        }, 100);
                    } else {
                        const propertiesSection = document.getElementById('properties');
                        if (propertiesSection) propertiesSection.scrollIntoView({ behavior: 'smooth' });
                    }
                },
                '#privacy-policy': () => PageRenderer.renderGenericPage(
                    'privacy-policy',
                    'Kebijakan Privasi',
                    '<p>Di Green Valley, kami sangat menghargai privasi Anda. Informasi pribadi yang Anda berikan hanya akan digunakan untuk keperluan layanan terkait properti dan tidak akan dibagikan kepada pihak ketiga tanpa persetujuan Anda, kecuali diwajibkan oleh hukum.</p><p>Kami menggunakan teknologi enkripsi standar industri untuk melindungi data Anda. Penggunaan cookie di situs kami bertujuan untuk meningkatkan pengalaman pengguna dan analisis statistik internal.</p><p>Kebijakan ini dapat diperbarui dari waktu ke waktu. Perubahan signifikan akan diinformasikan melalui situs web atau email.</p>'
                ),
                '#terms-conditions': () => PageRenderer.renderGenericPage(
                    'terms-conditions',
                    'Syarat & Ketentuan',
                    '<p>Dengan mengakses dan menggunakan situs web Green Valley, Anda setuju untuk mematuhi syarat dan ketentuan yang berlaku. Semua informasi properti yang ditampilkan bersifat indikatif dan dapat berubah tanpa pemberitahuan sebelumnya.</p><p>Green Valley tidak bertanggung jawab atas kerugian atau kerusakan yang timbul dari penggunaan informasi di situs ini. Pengguna bertanggung jawab penuh atas keputusan yang diambil berdasarkan informasi yang diperoleh.</p><p>Setiap transaksi properti akan diatur dalam perjanjian terpisah. Dilarang keras menyalin, mendistribusikan, atau mereproduksi konten situs ini tanpa izin tertulis.</p>'
                ),
                '#contact-us': () => PageRenderer.renderGenericPage(
                    'contact-us',
                    'Hubungi Kami',
                    `
                    <p>Kami senang mendengar dari Anda! Jika Anda memiliki pertanyaan, membutuhkan informasi lebih lanjut, atau ingin menjadwalkan kunjungan, jangan ragu untuk menghubungi kami melalui:</p>
                    <ul>
                        <li><strong>Email:</strong> <a href="mailto:info@greenvalley.id">info@greenvalley.id</a></li>
                        <li><strong>Telepon:</strong> <a href="tel:+62215551234">(021) 555-1234</a></li>
                        <li><strong>Kantor Pemasaran:</strong> Jl. Lembah Hijau No. 1, Green Valley, Jakarta Selatan</li>
                    </ul>
                    <p>Anda juga dapat mengisi formulir kontak di bawah ini (fitur simulasi):</p>
                    <form onsubmit="event.preventDefault(); Utils.showToast('Pesan Anda telah terkirim (Simulasi)!', 'success'); this.reset();">
                        <div style="margin-bottom:15px;"><label for="contactName" style="display:block; margin-bottom:5px;">Nama:</label><input type="text" id="contactName" required style="width:100%; padding:10px; border-radius:var(--border-radius); border:1px solid var(--border-color);"></div>
                        <div style="margin-bottom:15px;"><label for="contactEmail" style="display:block; margin-bottom:5px;">Email:</label><input type="email" id="contactEmail" required style="width:100%; padding:10px; border-radius:var(--border-radius); border:1px solid var(--border-color);"></div>
                        <div style="margin-bottom:20px;"><label for="contactMessage" style="display:block; margin-bottom:5px;">Pesan:</label><textarea id="contactMessage" rows="4" required style="width:100%; padding:10px; border-radius:var(--border-radius); border:1px solid var(--border-color);"></textarea></div>
                        <button type="submit" class="property-card__button">Kirim Pesan</button>
                    </form>
                    `
                ),
            },

            handleRouteChange: function () {
                if (DOM.loadingPlaceholder && DOM.loadingPlaceholder.parentElement === DOM.appContent) {
                    DOM.loadingPlaceholder.style.display = 'none';
                }
                DOM.flashMessageContainer.innerHTML = '';

                const hash = window.location.hash || '#home';
                AppState.activeRoute = hash;
                const renderFunction = this.routes[hash];

                if (typeof renderFunction === 'function') {
                    if (hash === '#dashboard' && AppState.currentUserRole !== "Pemilik") {
                        Utils.showFlashMessage("Akses Ditolak: Halaman Dashboard hanya untuk Pemilik Properti.", "error");
                        Utils.showToast("Anda akan dialihkan ke Beranda.", "warning", 3000);
                        setTimeout(() => window.location.hash = '#home', 500);
                        return;
                    }
                    renderFunction();
                } else {
                    PageRenderer.renderGenericPage('404', 'Halaman Tidak Ditemukan', '<p>Maaf, halaman yang Anda cari tidak dapat ditemukan. Mungkin URL salah atau halaman telah dipindahkan.</p><p><a href="#home" class="nav-link">Kembali ke Beranda</a></p>');
                    console.warn(`Rute tidak ditemukan untuk hash: ${hash}`);
                }

                Utils.setActiveNavLink(hash);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        };

        // --- MANAJEMEN TEMA (Terang/Gelap) ---
        const ThemeManager = {
            toggleTheme: function () {
                document.body.classList.toggle('dark-theme');
                AppState.theme = document.body.classList.contains('dark-theme') ? 'dark' : 'light';
                localStorage.setItem('greenValleyTheme', AppState.theme);
                this.updateThemeToggleButton();
                Utils.updatePrimaryColorRGBVariable();
                Utils.showToast(`Tema diubah ke Mode ${AppState.theme === 'dark' ? 'Gelap' : 'Terang'}!`, 'info', 2500);
            },
            applyInitialTheme: function () {
                if (AppState.theme === 'dark') {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
                this.updateThemeToggleButton();
                Utils.updatePrimaryColorRGBVariable();
            },
            updateThemeToggleButton: function () {
                if (!DOM.themeToggleText || !DOM.themeToggleIcon || !DOM.themeToggleButton) return;
                if (document.body.classList.contains('dark-theme')) {
                    DOM.themeToggleText.textContent = 'Mode Terang';
                    DOM.themeToggleIcon.className = 'fas fa-sun';
                    DOM.themeToggleButton.setAttribute('aria-label', 'Ganti ke Mode Terang');
                } else {
                    DOM.themeToggleText.textContent = 'Mode Gelap';
                    DOM.themeToggleIcon.className = 'fas fa-moon';
                    DOM.themeToggleButton.setAttribute('aria-label', 'Ganti ke Mode Gelap');
                }
            }
        };

        // --- MANAJEMEN NAVIGASI MOBILE (Hamburger Menu) ---
        const MobileNavManager = {
            toggleMobileNav: function () {
                if (!DOM.appNavigation || !DOM.navToggle) return;
                const isExpanded = DOM.appNavigation.classList.toggle('active');
                DOM.navToggle.setAttribute('aria-expanded', isExpanded.toString());
                if (isExpanded) {
                    DOM.navToggle.innerHTML = '<i class="fas fa-times" aria-hidden="true"></i>';
                    DOM.navToggle.setAttribute('aria-label', 'Tutup navigasi');
                    document.body.style.overflow = 'hidden';
                } else {
                    DOM.navToggle.innerHTML = '<i class="fas fa-bars" aria-hidden="true"></i>';
                    DOM.navToggle.setAttribute('aria-label', 'Buka navigasi');
                    document.body.style.overflow = '';
                }
            }
        };


        // --- INISIALISASI APLIKASI & EVENT LISTENER GLOBAL ---
        function initializeApp() {
            if (DOM.loadingPlaceholder) DOM.loadingPlaceholder.remove();

            if (DOM.currentYearSpan) {
                DOM.currentYearSpan.textContent = new Date().getFullYear();
            }

            ThemeManager.applyInitialTheme();
            Router.handleRouteChange();
            Utils.updateNotificationBadge();

            // Event Listener Global
            window.addEventListener('hashchange', Router.handleRouteChange.bind(Router));
            if (DOM.themeToggleButton) DOM.themeToggleButton.addEventListener('click', ThemeManager.toggleTheme.bind(ThemeManager));
            if (DOM.navToggle) DOM.navToggle.addEventListener('click', MobileNavManager.toggleMobileNav);

            if (DOM.customAlertConfirmBtn) DOM.customAlertConfirmBtn.addEventListener('click', Utils._handleAlertConfirm);
            if (DOM.customAlertCancelBtn) DOM.customAlertCancelBtn.addEventListener('click', Utils._handleAlertCancel);
            if (DOM.customAlertOverlay) DOM.customAlertOverlay.addEventListener('click', (e) => {
                if (e.target === DOM.customAlertOverlay) Utils._handleAlertCancel();
            });

            if (DOM.openOffcanvasBtn) DOM.openOffcanvasBtn.addEventListener('click', () => {
                const offcanvasDemoContent = `
                    <h4>Pengaturan Aplikasi (Contoh)</h4>
                    <p style="margin-bottom:15px;">Panel ini dapat digunakan untuk berbagai pengaturan atau informasi tambahan.</p>
                    <div style="margin-bottom:15px;">
                        <label for="sample-setting" style="display:block; margin-bottom:5px; font-weight:500;">Bahasa Tampilan:</label>
                        <select id="sample-setting" style="width:100%; padding:10px; border-radius:var(--border-radius); border:1px solid var(--border-color); background-color: var(--bg-color); color: var(--text-color);">
                            <option value="id">Bahasa Indonesia</option>
                            <option value="en">English (Simulasi)</option>
                        </select>
                    </div>
                     <div style="margin-bottom:20px;">
                        <label for="notif-pref" style="display:block; margin-bottom:5px; font-weight:500;">Preferensi Notifikasi Email:</label>
                        <input type="checkbox" id="notif-pref-promo" checked> <label for="notif-pref-promo" style="font-weight:normal;">Promo & Penawaran</label><br>
                        <input type="checkbox" id="notif-pref-update"> <label for="notif-pref-update" style="font-weight:normal;">Update Sistem</label>
                    </div>
                    <button class="property-card__button" onclick="Utils.showToast('Pengaturan berhasil disimpan (Simulasi)!', 'success'); Utils.closeOffcanvas();">Simpan Pengaturan</button>
                `;
                Utils.openOffcanvas('Panel Pengaturan', offcanvasDemoContent);
            });
            if (DOM.offcanvasCloseBtn) DOM.offcanvasCloseBtn.addEventListener('click', Utils.closeOffcanvas);
            if (DOM.offcanvasOverlay) DOM.offcanvasOverlay.addEventListener('click', Utils.closeOffcanvas);

            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' || e.key === 'Esc') {
                    if (DOM.offcanvasPanel && DOM.offcanvasPanel.classList.contains('open')) {
                        Utils.closeOffcanvas();
                    } else if (DOM.customAlertOverlay && DOM.customAlertOverlay.classList.contains('visible')) {
                        if (DOM.customAlertCancelBtn && DOM.customAlertCancelBtn.style.display !== 'none') {
                            Utils._handleAlertCancel();
                        } else {
                            Utils._handleAlertConfirm();
                        }
                    }
                }
            });

            document.addEventListener('click', function (event) {
                if (!DOM.appNavigation || !DOM.navToggle) return;
                const isClickInsideNav = DOM.appNavigation.contains(event.target);
                const isClickOnToggle = DOM.navToggle.contains(event.target);
                if (!isClickInsideNav && !isClickOnToggle && DOM.appNavigation.classList.contains('active')) {
                    MobileNavManager.toggleMobileNav();
                }
            });

            console.info("Aplikasi Green Valley SPA berhasil diinisialisasi. Semua sistem berjalan normal.");
        }

        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>
</body>

</html>