<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Manajemen Properti</title>
     <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  /* style.css */

/* --- Variabel CSS untuk Tema --- */
:root {
    --background-color-light: #f4f7f6;
    --text-color-light: #333;
    --card-background-light: #fff;
    --header-background-light: #e0e0e0;
    --footer-background-light: #e0e0e0;
    --button-primary-background-light: #007bff;
    --button-primary-text-light: #fff;
    --button-secondary-background-light: #6c757d;
    --button-secondary-text-light: #fff;
    --border-color-light: #ddd;
    --hover-background-light: #f0f0f0;
    --modal-background-light: rgba(0, 0, 0, 0.5);

    --background-color-dark: #1e1e1e;
    --text-color-dark: #f4f7f6;
    --card-background-dark: #2d2d2d;
    --header-background-dark: #333;
    --footer-background-dark: #333;
    --button-primary-background-dark: #0056b3;
    --button-primary-text-dark: #fff;
    --button-secondary-background-dark: #5a6268;
    --button-secondary-text-dark: #fff;
    --border-color-dark: #444;
    --hover-background-dark: #3a3a3a;
    --modal-background-dark: rgba(255, 255, 255, 0.2);

    --background-color: var(--background-color-light);
    --text-color: var(--text-color-light);
    --card-background: var(--card-background-light);
    --header-background: var(--header-background-light);
    --footer-background: var(--footer-background-light);
    --button-primary-background: var(--button-primary-background-light);
    --button-primary-text: var(--button-primary-text-light);
    --button-secondary-background: var(--button-secondary-background-light);
    --button-secondary-text: var(--button-secondary-text-light);
    --border-color: var(--border-color-light);
    --hover-background: var(--hover-background-light);
    --modal-background: var(--modal-background-light);

    --spacing-small: 8px;
    --spacing-medium: 16px;
    --spacing-large: 24px;
    --border-radius: 8px;
    --transition-speed: 0.3s;
}

/* --- Tema Gelap --- */
body.dark-mode {
    --background-color: var(--background-color-dark);
    --text-color: var(--text-color-dark);
    --card-background: var(--card-background-dark);
    --header-background: var(--header-background-dark);
    --footer-background: var(--footer-background-dark);
    --button-primary-background: var(--button-primary-background-dark);
    --button-primary-text: var(--button-primary-text-dark);
    --button-secondary-background: var(--button-secondary-background-dark);
    --button-secondary-text: var(--button-secondary-text-dark);
    --border-color: var(--border-color-dark);
    --hover-background: var(--hover-background-dark);
    --modal-background: var(--modal-background-dark);
}

/* --- Reset dan Gaya Dasar --- */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Poppins', sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: var(--background-color);
    transition: background-color var(--transition-speed), color var(--transition-speed);
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--spacing-medium);
}

a {
    color: var(--button-primary-background);
    text-decoration: none;
    transition: color var(--transition-speed);
}

a:hover {
    text-decoration: underline;
}

ul {
    list-style: none;
}

/* --- Header --- */
.site-header {
    background-color: var(--header-background);
    color: var(--text-color);
    padding: var(--spacing-medium) 0;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    transition: background-color var(--transition-speed), color var(--transition-speed);
}

.site-header .container {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap; /* Allow wrapping on smaller screens */
}

.site-title {
    margin: 0;
    font-size: 1.8em;
}

.site-nav ul {
    display: flex;
    gap: var(--spacing-medium);
}

.nav-link {
    font-weight: 600;
    padding: var(--spacing-small) 0;
    position: relative;
}

.nav-link::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    width: 0;
    height: 2px;
    background-color: var(--button-primary-background);
    transition: width var(--transition-speed) ease-in-out;
}

.nav-link:hover::after,
.nav-link:focus::after {
    width: 100%;
}

.theme-toggle-button {
    background: none;
    border: 1px solid var(--text-color);
    color: var(--text-color);
    padding: var(--spacing-small) var(--spacing-medium);
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: background-color var(--transition-speed), color var(--transition-speed), border-color var(--transition-speed);
}

.theme-toggle-button:hover {
    background-color: var(--text-color);
    color: var(--background-color);
}


/* --- Main Content --- */
.site-main {
    padding: var(--spacing-large) var(--spacing-medium);
}

.dashboard-section {
    margin-bottom: var(--spacing-large) * 2;
}

.section-title {
    font-size: 2em;
    margin-bottom: var(--spacing-small);
    color: var(--button-primary-background);
}

.section-description {
    margin-bottom: var(--spacing-large);
    color: var(--text-color);
}

/* --- Tombol --- */
.button {
    display: inline-block;
    padding: var(--spacing-small) var(--spacing-medium);
    border-radius: var(--border-radius);
    cursor: pointer;
    font-size: 1em;
    border: none;
    text-align: center;
    transition: background-color var(--transition-speed), opacity var(--transition-speed);
}

.primary-button {
    background-color: var(--button-primary-background);
    color: var(--button-primary-text);
}

.primary-button:hover {
    opacity: 0.9;
}

.secondary-button {
    background-color: var(--button-secondary-background);
    color: var(--button-secondary-text);
}

.secondary-button:hover {
    opacity: 0.9;
}

/* --- Grid Properti --- */
.grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--spacing-medium);
}

.property-card {
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: transform var(--transition-speed) ease-in-out, box-shadow var(--transition-speed) ease-in-out, background-color var(--transition-speed);
    cursor: pointer;
}

.property-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.property-card img {
    width: 100%;
    height: 200px;
    object-fit: cover;
    display: block;
}

.property-card-content {
    padding: var(--spacing-medium);
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

.property-card-content h3 {
    margin-top: 0;
    margin-bottom: var(--spacing-small);
    font-size: 1.2em;
    color: var(--button-primary-background);
}

.property-card-content p {
    margin-bottom: var(--spacing-small);
    font-size: 0.9em;
}

.property-actions {
    display: flex;
    gap: var(--spacing-small);
    margin-top: auto; /* Push actions to the bottom */
}

.property-actions .button {
    flex-grow: 1;
    font-size: 0.9em;
    padding: var(--spacing-small);
}


/* --- Laporan Keuangan --- */
.report-summary {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--spacing-medium);
    margin-bottom: var(--spacing-large);
}

.report-card {
    background-color: var(--card-background);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    padding: var(--spacing-medium);
    text-align: center;
    transition: background-color var(--transition-speed);
}

.report-card h3 {
    margin-top: 0;
    font-size: 1.1em;
    color: var(--button-primary-background);
}

.report-value {
    font-size: 2em;
    font-weight: 600;
    margin-top: var(--spacing-small);
    color: var(--text-color);
}

.transaction-list {
    margin-top: var(--spacing-large);
}

.transaction-list h3 {
    margin-bottom: var(--spacing-medium);
    color: var(--button-primary-background);
}

.transaction-list ul {
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    overflow: hidden;
    transition: border-color var(--transition-speed);
}

.transaction-list li {
    padding: var(--spacing-small) var(--spacing-medium);
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}

.transaction-list li:last-child {
    border-bottom: none;
}

.transaction-list li:nth-child(even) {
    background-color: var(--hover-background); /* Subtle stripe */
}


/* --- Notifikasi --- */
.notification-list {
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    overflow: hidden;
    transition: border-color var(--transition-speed);
}

.notification-list li {
    padding: var(--spacing-medium);
    border-bottom: 1px solid var(--border-color);
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}

.notification-list li:last-child {
    border-bottom: none;
}

.notification-list li strong {
    color: var(--button-primary-background);
}

/* --- Modal --- */
.modal {
    display: none; /* Hidden by default */
    position: fixed; /* Stay in place */
    z-index: 1000; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    overflow: auto; /* Enable scroll if needed */
    background-color: var(--modal-background); /* Black with opacity */
    backdrop-filter: blur(5px); /* Optional blur effect */
    -webkit-backdrop-filter: blur(5px); /* Safari support */
    padding-top: 60px;
    transition: background-color var(--transition-speed);
}

.modal-content {
    background-color: var(--card-background);
    margin: 5% auto; /* 15% from the top and centered */
    padding: var(--spacing-large);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    width: 90%; /* Could be more responsive */
    max-width: 600px;
    position: relative;
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}

.close-button {
    color: var(--text-color);
    position: absolute;
    top: var(--spacing-medium);
    right: var(--spacing-medium);
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
    transition: color var(--transition-speed);
}

.close-button:hover,
.close-button:focus {
    color: var(--button-primary-background);
    text-decoration: none;
}

/* --- Form Styling --- */
.form-group {
    margin-bottom: var(--spacing-medium);
}

.form-group label {
    display: block;
    margin-bottom: var(--spacing-small);
    font-weight: 600;
    color: var(--text-color);
}

.form-group input[type="text"],
.form-group input[type="number"],
.form-group input[type="email"],
.form-group input[type="url"] {
    width: 100%;
    padding: var(--spacing-small);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    background-color: var(--background-color);
    color: var(--text-color);
    transition: border-color var(--transition-speed), background-color var(--transition-speed), color var(--transition-speed);
}

.form-group input[type="text"]:focus,
.form-group input[type="number"]:focus,
.form-group input[type="email"]:focus,
.form-group input[type="url"]:focus {
    outline: none;
    border-color: var(--button-primary-background);
    box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
}

/* --- Detail Modal Specifics --- */
.detail-image {
    max-width: 100%;
    height: auto;
    border-radius: var(--border-radius);
    margin-bottom: var(--spacing-medium);
}

.detail-map-placeholder {
    width: 100%;
    height: 200px; /* Placeholder height */
    background-color: var(--hover-background);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    margin-bottom: var(--spacing-medium);
    display: flex;
    justify-content: center;
    align-items: center;
    color: var(--text-color);
    font-style: italic;
    transition: background-color var(--transition-speed), border-color var(--transition-speed), color var(--transition-speed);
}

/* --- Info Messages --- */
.info-message {
    padding: var(--spacing-medium);
    background-color: var(--hover-background);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius);
    text-align: center;
    margin-top: var(--spacing-medium);
    transition: background-color var(--transition-speed), border-color var(--transition-speed);
}

#payment-status {
    margin-top: var(--spacing-medium);
    padding: var(--spacing-medium);
    border-radius: var(--border-radius);
    text-align: center;
}

.payment-success {
    background-color: #d4edda; /* Light green */
    color: #155724; /* Dark green */
    border-color: #c3e6cb; /* Green border */
}

.payment-failure {
    background-color: #f8d7da; /* Light red */
    color: #721c24; /* Dark red */
    border-color: #f5c6cb; /* Red border */
}

body.dark-mode .payment-success {
     background-color: #0f3d1a; /* Darker green */
    color: #a3e0b4; /* Lighter green */
    border-color: #1a5a2a; /* Darker green border */
}

body.dark-mode .payment-failure {
    background-color: #5a1d24; /* Darker red */
    color: #f1aeb5; /* Lighter red */
    border-color: #7a2830; /* Darker red border */
}


/* --- Footer --- */
.site-footer {
    background-color: var(--footer-background);
    color: var(--text-color);
    text-align: center;
    padding: var(--spacing-medium) 0;
    margin-top: var(--spacing-large) * 2;
    transition: background-color var(--transition-speed), color var(--transition-speed);
}

/* --- Responsif --- */
@media (max-width: 768px) {
    .site-header .container {
        flex-direction: column;
        gap: var(--spacing-medium);
    }

    .site-nav ul {
        flex-direction: column;
        gap: var(--spacing-small);
        text-align: center;
    }

    .site-title {
        margin-bottom: var(--spacing-small);
    }

    .theme-toggle-button {
        width: 100%;
    }

    .grid-container {
        grid-template-columns: 1fr; /* Stack items on small screens */
    }

    .modal-content {
        margin: 10% auto;
        width: 95%;
    }
}

@media (max-width: 480px) {
    .site-title {
        font-size: 1.5em;
    }

    .section-title {
        font-size: 1.8em;
    }

    .report-value {
        font-size: 1.5em;
    }

    .property-actions {
        flex-direction: column;
        gap: var(--spacing-small);
    }
}
</style>
    </head>
<body>
    <header class="site-header">
        <div class="container">
            <h1 class="site-title">Dashboard Properti</h1>
            <nav class="site-nav">
                <ul>
                    <li><a href="#properti" class="nav-link">Properti Saya</a></li>
                    <li><a href="#laporan" class="nav-link">Laporan Keuangan</a></li>
                    <li><a href="#notifikasi" class="nav-link">Notifikasi</a></li>
                </ul>
            </nav>
            <button id="theme-toggle" class="theme-toggle-button" aria-label="Toggle light/dark mode">Mode Gelap</button>
        </div>
    </header>

    <main class="site-main container">
        <section id="properti" class="dashboard-section">
            <h2 class="section-title">Properti Saya</h2>
            <p class="section-description">Kelola daftar properti Anda dengan mudah. Tambahkan, edit, atau hapus properti kapan saja.</p>
            <button id="add-property-button" class="button primary-button">Tambah Properti Baru</button>

            <div class="property-list grid-container">
                <!-- Daftar properti akan dimuat di sini oleh JavaScript -->
                <p id="no-properties-message" class="info-message">Belum ada properti ditambahkan. Klik "Tambah Properti Baru" untuk memulai!</p>
            </div>
        </section>

        <section id="laporan" class="dashboard-section">
            <h2 class="section-title">Laporan Keuangan</h2>
            <p class="section-description">Lihat ringkasan pendapatan dan transaksi properti Anda.</p>
            <div class="report-summary">
                <div class="report-card">
                    <h3>Total Pendapatan (Simulasi)</h3>
                    <p id="total-revenue" class="report-value">Rp 0</p>
                </div>
                <div class="report-card">
                    <h3>Transaksi Selesai (Simulasi)</h3>
                    <p id="completed-transactions" class="report-value">0</p>
                </div>
            </div>
            <div class="transaction-list">
                <h3>Detail Transaksi (Simulasi)</h3>
                <ul id="transaction-items">
                    <!-- Detail transaksi akan dimuat di sini oleh JavaScript -->
                    <li class="info-message">Belum ada transaksi tercatat.</li>
                </ul>
            </div>
        </section>

        <section id="notifikasi" class="dashboard-section">
            <h2 class="section-title">Notifikasi</h2>
            <p class="section-description">Pesan penting dan pembaruan terkait properti Anda.</p>
            <ul id="notification-list" class="notification-list">
                <!-- Daftar notifikasi akan dimuat di sini oleh JavaScript -->
                <li class="info-message">Tidak ada notifikasi baru.</li>
            </ul>
        </section>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2024 Dashboard Manajemen Properti. Semua Hak Dilindungi.</p>
        </div>
    </footer>

    <!-- Modal untuk Tambah/Edit Properti -->
    <div id="property-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modal-title">Tambah Properti</h2>
            <form id="property-form">
                <input type="hidden" id="property-id">
                <div class="form-group">
                    <label for="property-name">Nama Properti:</label>
                    <input type="text" id="property-name" required>
                </div>
                <div class="form-group">
                    <label for="property-location">Lokasi:</label>
                    <input type="text" id="property-location" required>
                </div>
                <div class="form-group">
                    <label for="property-price">Harga Sewa per Bulan (Rp):</label>
                    <input type="number" id="property-price" required min="0">
                </div>
                 <div class="form-group">
                    <label for="property-image">URL Gambar (Opsional):</label>
                    <input type="url" id="property-image">
                </div>
                <button type="submit" class="button primary-button">Simpan Properti</button>
            </form>
        </div>
    </div>

    <!-- Modal untuk Detail Properti dan Booking -->
     <div id="detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="detail-title">Detail Properti</h2>
            <div id="detail-content">
                <img id="detail-image" src="" alt="Gambar Properti" class="detail-image">
                <h3 id="detail-name"></h3>
                <p><strong>Lokasi:</strong> <span id="detail-location"></span></p>
                <p><strong>Harga Sewa:</strong> <span id="detail-price"></span> per bulan</p>
                <div id="detail-map" class="detail-map-placeholder">
                    <!-- Simulasi Peta -->
                    <p>Simulasi Tampilan Peta Lokasi</p>
                </div>

                <h4>Tertarik? Ajukan Booking!</h4>
                <form id="booking-form">
                    <input type="hidden" id="booking-property-id">
                     <div class="form-group">
                        <label for="booking-name">Nama Lengkap:</label>
                        <input type="text" id="booking-name" required>
                    </div>
                     <div class="form-group">
                        <label for="booking-email">Email:</label>
                        <input type="email" id="booking-email" required>
                    </div>
                     <div class="form-group">
                        <label for="booking-duration">Durasi Sewa (Bulan):</label>
                        <input type="number" id="booking-duration" required min="1">
                    </div>
                    <button type="submit" class="button primary-button">Ajukan Booking & Lanjutkan Pembayaran</button>
                </form>
                 <div id="payment-status" class="info-message" style="display: none;"></div>
            </div>
        </div>
    </div>


    <script>
      // script.js

document.addEventListener('DOMContentLoaded', () => {
    // --- Data Simulasi ---
    let properties = [
        { id: 1, name: 'Apartemen Mewah Pusat Kota', location: 'Jakarta Pusat', price: 15000000, imageUrl: 'https://via.placeholder.com/400x200?text=Apartemen+Pusat+Kota' },
        { id: 2, name: 'Rumah Minimalis Strategis', location: 'Bandung', price: 8000000, imageUrl: 'https://via.placeholder.com/400x200?text=Rumah+Bandung' },
        { id: 3, name: 'Studio Nyaman Dekat Kampus', location: 'Yogyakarta', price: 3500000, imageUrl: 'https://via.placeholder.com/400x200?text=Studio+Yogya' },
    ];

    let transactions = [];
    let notifications = [
        { id: 1, message: 'Selamat datang di Dashboard Manajemen Properti Anda!' },
        { id: 2, message: 'Properti "Apartemen Mewah Pusat Kota" memiliki permintaan tinggi.' },
    ];

    // --- Elemen DOM ---
    const propertyList = document.querySelector('.property-list');
    const noPropertiesMessage = document.getElementById('no-properties-message');
    const addPropertyButton = document.getElementById('add-property-button');
    const propertyModal = document.getElementById('property-modal');
    const detailModal = document.getElementById('detail-modal');
    const closeModalButtons = document.querySelectorAll('.modal .close-button');
    const propertyForm = document.getElementById('property-form');
    const propertyIdInput = document.getElementById('property-id');
    const propertyNameInput = document.getElementById('property-name');
    const propertyLocationInput = document.getElementById('property-location');
    const propertyPriceInput = document.getElementById('property-price');
    const propertyImageInput = document.getElementById('property-image');
    const modalTitle = document.getElementById('modal-title');

    const detailTitle = document.getElementById('detail-title');
    const detailImage = document.getElementById('detail-image');
    const detailName = document.getElementById('detail-name');
    const detailLocation = document.getElementById('detail-location');
    const detailPrice = document.getElementById('detail-price');
    const detailMapPlaceholder = document.getElementById('detail-map');
    const bookingForm = document.getElementById('booking-form');
    const bookingPropertyIdInput = document.getElementById('booking-property-id');
    const bookingNameInput = document.getElementById('booking-name');
    const bookingEmailInput = document.getElementById('booking-email');
    const bookingDurationInput = document.getElementById('booking-duration');
    const paymentStatusDiv = document.getElementById('payment-status');

    const totalRevenueElement = document.getElementById('total-revenue');
    const completedTransactionsElement = document.getElementById('completed-transactions');
    const transactionItemsList = document.getElementById('transaction-items');
    const notificationListElement = document.getElementById('notification-list');
    const themeToggleButton = document.getElementById('theme-toggle');

    // --- Fungsi Utilitas ---
    const formatCurrency = (amount) => {
        return new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', minimumFractionDigits: 0 }).format(amount);
    };

    const showModal = (modalElement) => {
        modalElement.style.display = 'block';
        // Add a slight delay before adding the active class for transition effect
        setTimeout(() => {
             modalElement.classList.add('active');
        }, 10);
    };

    const hideModal = (modalElement) => {
         modalElement.classList.remove('active');
         // Delay display: none until transition finishes
         setTimeout(() => {
            modalElement.style.display = 'none';
         }, 300); // Match CSS transition duration
    };

    // --- Render Fungsi ---
    const renderProperties = () => {
        propertyList.innerHTML = ''; // Bersihkan daftar properti
        if (properties.length === 0) {
            noPropertiesMessage.style.display = 'block';
        } else {
            noPropertiesMessage.style.display = 'none';
            properties.forEach(property => {
                const propertyCard = document.createElement('div');
                propertyCard.classList.add('property-card');
                propertyCard.dataset.id = property.id; // Simpan ID properti

                propertyCard.innerHTML = `
                    <img src="${property.imageUrl || 'https://via.placeholder.com/400x200?text=Tidak+Ada+Gambar'}" alt="Gambar ${property.name}">
                    <div class="property-card-content">
                        <h3>${property.name}</h3>
                        <p><strong>Lokasi:</strong> ${property.location}</p>
                        <p><strong>Harga:</strong> ${formatCurrency(property.price)} / bulan</p>
                        <div class="property-actions">
                            <button class="button secondary-button edit-button">Edit</button>
                            <button class="button secondary-button delete-button">Hapus</button>
                        </div>
                    </div>
                `;
                propertyList.appendChild(propertyCard);
            });
        }
    };

    const renderReports = () => {
        const totalRevenue = transactions.reduce((sum, t) => sum + t.amount, 0);
        totalRevenueElement.textContent = formatCurrency(totalRevenue);
        completedTransactionsElement.textContent = transactions.length;

        transactionItemsList.innerHTML = '';
        if (transactions.length === 0) {
            const li = document.createElement('li');
            li.classList.add('info-message');
            li.textContent = 'Belum ada transaksi tercatat.';
            transactionItemsList.appendChild(li);
        } else {
            transactions.forEach(transaction => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <span>Transaksi untuk <strong>${transaction.propertyName}</strong> oleh ${transaction.customerName}</span>
                    <span>${formatCurrency(transaction.amount)}</span>
                `;
                transactionItemsList.appendChild(li);
            });
        }
    };

    const renderNotifications = () => {
        notificationListElement.innerHTML = '';
        if (notifications.length === 0) {
             const li = document.createElement('li');
             li.classList.add('info-message');
             li.textContent = 'Tidak ada notifikasi baru.';
             notificationListElement.appendChild(li);
        } else {
            notifications.forEach(notification => {
                const li = document.createElement('li');
                li.innerHTML = `<strong>Notifikasi:</strong> ${notification.message}`;
                notificationListElement.appendChild(li);
            });
        }
    };

    // --- Event Listeners ---

    // Buka modal tambah properti
    addPropertyButton.addEventListener('click', () => {
        modalTitle.textContent = 'Tambah Properti Baru';
        propertyForm.reset();
        propertyIdInput.value = ''; // Kosongkan ID untuk mode tambah
        showModal(propertyModal);
    });

    // Tutup modal
    closeModalButtons.forEach(button => {
        button.addEventListener('click', () => {
            hideModal(propertyModal);
            hideModal(detailModal);
            paymentStatusDiv.style.display = 'none'; // Sembunyikan status pembayaran saat menutup detail modal
        });
    });

    // Tutup modal saat klik di luar area modal
    window.addEventListener('click', (event) => {
        if (event.target === propertyModal) {
            hideModal(propertyModal);
        }
        if (event.target === detailModal) {
            hideModal(detailModal);
             paymentStatusDiv.style.display = 'none'; // Sembunyikan status pembayaran saat menutup detail modal
        }
    });

    // Submit form properti (Tambah/Edit)
    propertyForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const id = propertyIdInput.value ? parseInt(propertyIdInput.value) : Date.now(); // Gunakan timestamp sebagai ID baru
        const name = propertyNameInput.value;
        const location = propertyLocationInput.value;
        const price = parseInt(propertyPriceInput.value);
        const imageUrl = propertyImageInput.value;

        if (propertyIdInput.value) {
            // Mode Edit
            properties = properties.map(prop =>
                prop.id === id ? { ...prop, name, location, price, imageUrl } : prop
            );
            // Tambahkan notifikasi edit
             notifications.push({ id: Date.now(), message: `Properti "${name}" berhasil diperbarui.` });
        } else {
            // Mode Tambah
            const newProperty = { id, name, location, price, imageUrl };
            properties.push(newProperty);
             // Tambahkan notifikasi tambah
             notifications.push({ id: Date.now(), message: `Properti "${name}" berhasil ditambahkan.` });
        }

        renderProperties();
        renderNotifications();
        hideModal(propertyModal);
    });

    // Delegasi event untuk tombol Edit dan Hapus pada daftar properti
    propertyList.addEventListener('click', (event) => {
        const target = event.target;
        const propertyCard = target.closest('.property-card');
        if (!propertyCard) return;

        const propertyId = parseInt(propertyCard.dataset.id);
        const property = properties.find(prop => prop.id === propertyId);

        if (target.classList.contains('edit-button')) {
            // Buka modal edit
            modalTitle.textContent = 'Edit Properti';
            propertyIdInput.value = property.id;
            propertyNameInput.value = property.name;
            propertyLocationInput.value = property.location;
            propertyPriceInput.value = property.price;
            propertyImageInput.value = property.imageUrl || '';
            showModal(propertyModal);
        } else if (target.classList.contains('delete-button')) {
            // Hapus properti (dengan konfirmasi sederhana)
            if (confirm(`Apakah Anda yakin ingin menghapus properti "${property.name}"?`)) {
                properties = properties.filter(prop => prop.id !== propertyId);
                renderProperties();
                 // Tambahkan notifikasi hapus
                 notifications.push({ id: Date.now(), message: `Properti "${property.name}" berhasil dihapus.` });
                 renderNotifications();
            }
        } else if (property && !target.closest('.property-actions')) {
             // Buka modal detail jika klik di area card selain tombol aksi
             detailTitle.textContent = property.name;
             detailImage.src = property.imageUrl || 'https://via.placeholder.com/400x200?text=Tidak+Ada+Gambar';
             detailImage.alt = `Gambar ${property.name}`;
             detailName.textContent = property.name;
             detailLocation.textContent = property.location;
             detailPrice.textContent = formatCurrency(property.price);
             bookingPropertyIdInput.value = property.id; // Set ID properti untuk form booking
             bookingForm.reset(); // Reset form booking
             paymentStatusDiv.style.display = 'none'; // Sembunyikan status pembayaran
             paymentStatusDiv.textContent = ''; // Kosongkan teks status pembayaran

             // Simulasi Peta - bisa diganti dengan library peta sungguhan jika diizinkan
             detailMapPlaceholder.innerHTML = `<p>Simulasi Tampilan Peta Lokasi: ${property.location}</p>`;


             showModal(detailModal);
        }
    });

    // Submit form booking (Simulasi Pembayaran)
    bookingForm.addEventListener('submit', (event) => {
        event.preventDefault();

        const propertyId = parseInt(bookingPropertyIdInput.value);
        const property = properties.find(prop => prop.id === propertyId);
        const customerName = bookingNameInput.value;
        const customerEmail = bookingEmailInput.value;
        const duration = parseInt(bookingDurationInput.value);
        const totalAmount = property.price * duration;

        // Simulasi proses pembayaran
        paymentStatusDiv.style.display = 'block';
        paymentStatusDiv.textContent = 'Memproses pembayaran...';
        paymentStatusDiv.className = 'info-message'; // Reset class

        // Simulasi delay pembayaran
        setTimeout(() => {
            const isSuccess = Math.random() > 0.2; // 80% sukses, 20% gagal

            if (isSuccess) {
                const transaction = {
                    id: Date.now(),
                    propertyId: property.id,
                    propertyName: property.name,
                    customerName: customerName,
                    amount: totalAmount,
                    date: new Date().toISOString().split('T')[0] // Tanggal hari ini
                };
                transactions.push(transaction);
                renderReports();

                paymentStatusDiv.textContent = `Pembayaran berhasil! Total: ${formatCurrency(totalAmount)}. Transaksi dicatat.`;
                paymentStatusDiv.classList.add('payment-success');

                // Tambahkan notifikasi transaksi berhasil
                notifications.push({ id: Date.now(), message: `Transaksi berhasil untuk properti "${property.name}" oleh ${customerName}.` });
                renderNotifications();

            } else {
                paymentStatusDiv.textContent = 'Pembayaran gagal. Silakan coba lagi.';
                paymentStatusDiv.classList.add('payment-failure');

                 // Tambahkan notifikasi transaksi gagal
                 notifications.push({ id: Date.now(), message: `Pembayaran gagal untuk properti "${property.name}" oleh ${customerName}.` });
                 renderNotifications();
            }
        }, 2000); // Simulasi 2 detik proses pembayaran
    });


    // Toggle Tema Terang/Gelap
    themeToggleButton.addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        const isDarkMode = document.body.classList.contains('dark-mode');
        themeToggleButton.textContent = isDarkMode ? 'Mode Terang' : 'Mode Gelap';
        // Simpan preferensi tema di localStorage (opsional)
        localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
    });

    // Muat preferensi tema saat halaman dimuat
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-mode');
        themeToggleButton.textContent = 'Mode Terang';
    } else {
         themeToggleButton.textContent = 'Mode Gelap';
    }


    // --- Inisialisasi ---
    renderProperties();
    renderReports();
    renderNotifications();
});
    </script>
</body>
</html>